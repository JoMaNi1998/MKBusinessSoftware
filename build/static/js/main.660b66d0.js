/*! For license information please see main.660b66d0.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},153:(e,t,n)=>{var r=n(43),s=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,l=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,a={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,r)&&!o.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:s,type:e,key:c,ref:u,props:a,_owner:l.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,g={};function x(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}x.prototype.isReactComponent={},x.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},x.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=x.prototype;var b=v.prototype=new y;b.constructor=v,f(b,x.prototype),b.isPureReactComponent=!0;var w=Array.isArray,j=Object.prototype.hasOwnProperty,N={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,r){var s,a={},i=null,l=null;if(null!=t)for(s in void 0!==t.ref&&(l=t.ref),void 0!==t.key&&(i=""+t.key),t)j.call(t,s)&&!k.hasOwnProperty(s)&&(a[s]=t[s]);var o=arguments.length-2;if(1===o)a.children=r;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(s in o=e.defaultProps)void 0===a[s]&&(a[s]=o[s]);return{$$typeof:n,type:e,key:i,ref:l,props:a,_owner:N.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function A(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function I(e,t,s,a,i){var l=typeof e;"undefined"!==l&&"boolean"!==l||(e=null);var o=!1;if(null===e)o=!0;else switch(l){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case n:case r:o=!0}}if(o)return i=i(o=e),e=""===a?"."+A(o,0):a,w(i)?(s="",null!=e&&(s=e.replace(E,"$&/")+"/"),I(i,t,s,"",function(e){return e})):null!=i&&(C(i)&&(i=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,s+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(E,"$&/")+"/")+e)),t.push(i)),1;if(o=0,a=""===a?".":a+":",w(e))for(var c=0;c<e.length;c++){var u=a+A(l=e[c],c);o+=I(l,t,s,u,i)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=m&&e[m]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(l=e.next()).done;)o+=I(l=l.value,t,s,u=a+A(l,c++),i);else if("object"===l)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function _(e,t,n){if(null==e)return e;var r=[],s=0;return I(e,r,"","",function(e){return t.call(n,e,s++)}),r}function T(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},P={transition:null},M={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:P,ReactCurrentOwner:N};function R(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:_,forEach:function(e,t,n){_(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return _(e,function(){t++}),t},toArray:function(e){return _(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=x,t.Fragment=s,t.Profiler=i,t.PureComponent=v,t.StrictMode=a,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,t.act=R,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=f({},e.props),a=e.key,i=e.ref,l=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,l=N.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)j.call(t,c)&&!k.hasOwnProperty(c)&&(s[c]=void 0===t[c]&&void 0!==o?o[c]:t[c])}var c=arguments.length-2;if(1===c)s.children=r;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];s.children=o}return{$$typeof:n,type:e.type,key:a,ref:i,props:s,_owner:l}},t.createContext=function(e){return(e={$$typeof:o,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:l,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:T}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=R,t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,n){return D.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,n){return D.current.useReducer(e,t,n)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return D.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return D.current.useTransition()},t.version="18.3.1"},232:(e,t,n)=>{n.d(t,{MF:()=>de,j6:()=>ie,xZ:()=>le,om:()=>ae,Sx:()=>me,Wp:()=>he,KO:()=>pe});var r=n(555),s=n(606),a=n(965),i=n(776);let l,o;const c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,m=new WeakMap;let p={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return u.get(e);if("objectStoreNames"===t)return e.objectStoreNames||d.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return x(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function f(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(o||(o=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(y(this),n),x(c.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return x(e.apply(y(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];const a=e.call(y(this),t,...r);return d.set(a,t.sort?t.sort():[t]),x(a)}}function g(e){return"function"===typeof e?f(e):(e instanceof IDBTransaction&&function(e){if(u.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",a),e.removeEventListener("abort",a)},s=()=>{t(),r()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",s),e.addEventListener("error",a),e.addEventListener("abort",a)});u.set(e,t)}(e),t=e,(l||(l=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,p):e);var t}function x(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",s),e.removeEventListener("error",a)},s=()=>{t(x(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener("success",s),e.addEventListener("error",a)});return t.then(t=>{t instanceof IDBCursor&&c.set(t,e)}).catch(()=>{}),m.set(t,e),t}(e);if(h.has(e))return h.get(e);const t=g(e);return t!==e&&(h.set(e,t),m.set(t,e)),t}const y=e=>m.get(e);const v=["get","getKey","getAll","getAllKeys","count"],b=["put","add","delete","clear"],w=new Map;function j(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(w.get(t))return w.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=b.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!v.includes(n))return;const a=async function(e){const t=this.transaction(e,s?"readwrite":"readonly");let a=t.store;for(var i=arguments.length,l=new Array(i>1?i-1:0),o=1;o<i;o++)l[o-1]=arguments[o];return r&&(a=a.index(l.shift())),(await Promise.all([a[n](...l),s&&t.done]))[0]};return w.set(t,a),a}p=(e=>(0,r.A)((0,r.A)({},e),{},{get:(t,n,r)=>j(t,n)||e.get(t,n,r),has:(t,n)=>!!j(t,n)||e.has(t,n)}))(p);class N{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const k="@firebase/app",S="0.14.1",C=new a.Vy("@firebase/app"),E="@firebase/app-compat",A="@firebase/analytics-compat",I="@firebase/analytics",_="@firebase/app-check-compat",T="@firebase/app-check",D="@firebase/auth",P="@firebase/auth-compat",M="@firebase/database",R="@firebase/data-connect",O="@firebase/database-compat",L="@firebase/functions",F="@firebase/functions-compat",V="@firebase/installations",z="@firebase/installations-compat",U="@firebase/messaging",K="@firebase/messaging-compat",B="@firebase/performance",q="@firebase/performance-compat",H="@firebase/remote-config",G="@firebase/remote-config-compat",W="@firebase/storage",Q="@firebase/storage-compat",J="@firebase/firestore",Z="@firebase/ai",X="@firebase/firestore-compat",Y="firebase",$="[DEFAULT]",ee={[k]:"fire-core",[E]:"fire-core-compat",[I]:"fire-analytics",[A]:"fire-analytics-compat",[T]:"fire-app-check",[_]:"fire-app-check-compat",[D]:"fire-auth",[P]:"fire-auth-compat",[M]:"fire-rtdb",[R]:"fire-data-connect",[O]:"fire-rtdb-compat",[L]:"fire-fn",[F]:"fire-fn-compat",[V]:"fire-iid",[z]:"fire-iid-compat",[U]:"fire-fcm",[K]:"fire-fcm-compat",[B]:"fire-perf",[q]:"fire-perf-compat",[H]:"fire-rc",[G]:"fire-rc-compat",[W]:"fire-gcs",[Q]:"fire-gcs-compat",[J]:"fire-fst",[X]:"fire-fst-compat",[Z]:"fire-vertex","fire-js":"fire-js",[Y]:"fire-js-all"},te=new Map,ne=new Map,re=new Map;function se(e,t){try{e.container.addComponent(t)}catch(n){C.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function ae(e){const t=e.name;if(re.has(t))return C.debug("There were multiple attempts to register component ".concat(t,".")),!1;re.set(t,e);for(const n of te.values())se(n,e);for(const n of ne.values())se(n,e);return!0}function ie(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function le(e){return null!==e&&void 0!==e&&void 0!==e.settings}const oe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ce=new i.FA("app","Firebase",oe);class ue{constructor(e,t,n){this._isDeleted=!1,this._options=(0,r.A)({},e),this._config=(0,r.A)({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new s.uA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ce.create("app-deleted",{appName:this._name})}}const de="12.1.0";function he(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const a=(0,r.A)({name:$,automaticDataCollectionEnabled:!0},t),l=a.name;if("string"!==typeof l||!l)throw ce.create("bad-app-name",{appName:String(l)});if(n||(n=(0,i.T9)()),!n)throw ce.create("no-options");const o=te.get(l);if(o){if((0,i.bD)(n,o.options)&&(0,i.bD)(a,o.config))return o;throw ce.create("duplicate-app",{appName:l})}const c=new s.h1(l);for(const r of re.values())c.addComponent(r);const u=new ue(n,a,c);return te.set(l,u),u}function me(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$;const t=te.get(e);if(!t&&e===$&&(0,i.T9)())return he();if(!t)throw ce.create("no-app",{appName:e});return t}function pe(e,t,n){var r;let a=null!==(r=ee[e])&&void 0!==r?r:e;n&&(a+="-".concat(n));const i=a.match(/\s|\//),l=t.match(/\s|\//);if(i||l){const e=['Unable to register library "'.concat(a,'" with version "').concat(t,'":')];return i&&e.push('library name "'.concat(a,'" contains illegal characters (whitespace or "/")')),i&&l&&e.push("and"),l&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void C.warn(e.join(" "))}ae(new s.uA("".concat(a,"-version"),()=>({library:a,version:t}),"VERSION"))}const fe="firebase-heartbeat-store";let ge=null;function xe(){return ge||(ge=function(e,t){let{blocked:n,upgrade:r,blocking:s,terminated:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=indexedDB.open(e,t),l=x(i);return r&&i.addEventListener("upgradeneeded",e=>{r(x(i.result),e.oldVersion,e.newVersion,x(i.transaction),e)}),n&&i.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),l.then(e=>{a&&e.addEventListener("close",()=>a()),s&&e.addEventListener("versionchange",e=>s(e.oldVersion,e.newVersion,e))}).catch(()=>{}),l}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(fe)}catch(n){console.warn(n)}}}).catch(e=>{throw ce.create("idb-open",{originalErrorMessage:e.message})})),ge}async function ye(e,t){try{const n=(await xe()).transaction(fe,"readwrite"),r=n.objectStore(fe);await r.put(t,ve(e)),await n.done}catch(n){if(n instanceof i.g)C.warn(n.message);else{const e=ce.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});C.warn(e.message)}}}function ve(e){return"".concat(e.name,"!").concat(e.options.appId)}class be{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new je(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{var e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=we();var t;if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats))if(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){C.warn(n)}}async getHeartbeatsHeader(){try{var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=we(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const s of e){const e=n.find(e=>e.agent===s.agent);if(e){if(e.dates.push(s.date),Ne(n)>t){e.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Ne(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),s=(0,i.Uj)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return C.warn(t),""}}}function we(){return(new Date).toISOString().substring(0,10)}class je{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,i.zW)()&&(0,i.eX)().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await xe()).transaction(fe),n=await t.objectStore(fe).get(ve(e));return await t.done,n}catch(t){if(t instanceof i.g)C.warn(t.message);else{const e=ce.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});C.warn(e.message)}}}(this.app);return null!==e&&void 0!==e&&e.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return ye(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return ye(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Ne(e){return(0,i.Uj)(JSON.stringify({version:2,heartbeats:e})).length}var ke;ke="",ae(new s.uA("platform-logger",e=>new N(e),"PRIVATE")),ae(new s.uA("heartbeat",e=>new be(e),"PRIVATE")),pe(k,S,ke),pe(k,S,"esm2020"),pe("fire-js","")},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,s=e[r];if(!(0<a(s,t)))break e;e[r]=t,e[n]=s,n=r}}function r(e){return 0===e.length?null:e[0]}function s(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,s=e.length,i=s>>>1;r<i;){var l=2*(r+1)-1,o=e[l],c=l+1,u=e[c];if(0>a(o,n))c<s&&0>a(u,o)?(e[r]=u,e[c]=n,r=c):(e[r]=o,e[l]=n,r=l);else{if(!(c<s&&0>a(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();t.unstable_now=function(){return l.now()-o}}var c=[],u=[],d=1,h=null,m=3,p=!1,f=!1,g=!1,x="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,v="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(u);null!==t;){if(null===t.callback)s(u);else{if(!(t.startTime<=e))break;s(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function w(e){if(g=!1,b(e),!f)if(null!==r(c))f=!0,P(j);else{var t=r(u);null!==t&&M(w,t.startTime-e)}}function j(e,n){f=!1,g&&(g=!1,y(C),C=-1),p=!0;var a=m;try{for(b(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!I());){var i=h.callback;if("function"===typeof i){h.callback=null,m=h.priorityLevel;var l=i(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof l?h.callback=l:h===r(c)&&s(c),b(n)}else s(c);h=r(c)}if(null!==h)var o=!0;else{var d=r(u);null!==d&&M(w,d.startTime-n),o=!1}return o}finally{h=null,m=a,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var N,k=!1,S=null,C=-1,E=5,A=-1;function I(){return!(t.unstable_now()-A<E)}function _(){if(null!==S){var e=t.unstable_now();A=e;var n=!0;try{n=S(!0,e)}finally{n?N():(k=!1,S=null)}}else k=!1}if("function"===typeof v)N=function(){v(_)};else if("undefined"!==typeof MessageChannel){var T=new MessageChannel,D=T.port2;T.port1.onmessage=_,N=function(){D.postMessage(null)}}else N=function(){x(_,0)};function P(e){S=e,k||(k=!0,N())}function M(e,n){C=x(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||p||(f=!0,P(j))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(m){case 1:case 2:case 3:var t=3;break;default:t=m}var n=m;m=t;try{return e()}finally{m=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=m;m=e;try{return t()}finally{m=n}},t.unstable_scheduleCallback=function(e,s,a){var i=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?i+a:i:a=i,e){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return e={id:d++,callback:s,priorityLevel:e,startTime:a,expirationTime:l=a+l,sortIndex:-1},a>i?(e.sortIndex=a,n(u,e),null===r(c)&&e===r(u)&&(g?(y(C),C=-1):g=!0,M(w,a-i))):(e.sortIndex=l,n(c,e),f||p||(f=!0,P(j))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=m;return function(){var n=m;m=t;try{return e.apply(this,arguments)}finally{m=n}}}},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},555:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function s(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=r(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function a(e,t,n){return(t=s(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}n.d(t,{A:()=>l})},579:(e,t,n)=>{e.exports=n(153)},606:(e,t,n)=>{n.d(t,{h1:()=>l,uA:()=>s});var r=n(776);class s{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const a="[DEFAULT]";class i{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new r.cY;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:a})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,a]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(s)&&a.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),s=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;s.add(e),this.onInitCallbacks.set(r,s);const a=this.instances.get(r);return a&&e(a,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(s=t,s===a?void 0:s),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(i){}var s;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;return this.component?this.component.multipleInstances?e:a:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class l{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new i(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},667:(e,t,n)=>{n.d(t,{gS:()=>hc,rJ:()=>eo,kd:()=>dc,H9:()=>to,x7:()=>ic,GG:()=>oc,aU:()=>lo,aQ:()=>mc,My:()=>Jo,P:()=>qo,O5:()=>gc,BN:()=>cc,mZ:()=>uc,_M:()=>Go});var r,s,a=n(555),i=n(232),l=n(606),o=n(965),c=n(776),u="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},d={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var s=0;16>s;++s)r[s]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(s=0;16>s;++s)r[s]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],s=e.g[2];var a=e.g[3],i=t+(a^n&(s^a))+r[0]+3614090360&4294967295;i=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=n+(i<<7&4294967295|i>>>25))+((i=a+(s^t&(n^s))+r[1]+3905402710&4294967295)<<12&4294967295|i>>>20))+((i=s+(n^a&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|i>>>15))+((i=n+(t^s&(a^t))+r[3]+3250441966&4294967295)<<22&4294967295|i>>>10))+((i=t+(a^n&(s^a))+r[4]+4118548399&4294967295)<<7&4294967295|i>>>25))+((i=a+(s^t&(n^s))+r[5]+1200080426&4294967295)<<12&4294967295|i>>>20))+((i=s+(n^a&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|i>>>15))+((i=n+(t^s&(a^t))+r[7]+4249261313&4294967295)<<22&4294967295|i>>>10))+((i=t+(a^n&(s^a))+r[8]+1770035416&4294967295)<<7&4294967295|i>>>25))+((i=a+(s^t&(n^s))+r[9]+2336552879&4294967295)<<12&4294967295|i>>>20))+((i=s+(n^a&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|i>>>15))+((i=n+(t^s&(a^t))+r[11]+2304563134&4294967295)<<22&4294967295|i>>>10))+((i=t+(a^n&(s^a))+r[12]+1804603682&4294967295)<<7&4294967295|i>>>25))+((i=a+(s^t&(n^s))+r[13]+4254626195&4294967295)<<12&4294967295|i>>>20))+((i=s+(n^a&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|i>>>15))+((i=n+(t^s&(a^t))+r[15]+1236535329&4294967295)<<22&4294967295|i>>>10))+((i=t+(s^a&(n^s))+r[1]+4129170786&4294967295)<<5&4294967295|i>>>27))+((i=a+(n^s&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|i>>>23))+((i=s+(t^n&(a^t))+r[11]+643717713&4294967295)<<14&4294967295|i>>>18))+((i=n+(a^t&(s^a))+r[0]+3921069994&4294967295)<<20&4294967295|i>>>12))+((i=t+(s^a&(n^s))+r[5]+3593408605&4294967295)<<5&4294967295|i>>>27))+((i=a+(n^s&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|i>>>23))+((i=s+(t^n&(a^t))+r[15]+3634488961&4294967295)<<14&4294967295|i>>>18))+((i=n+(a^t&(s^a))+r[4]+3889429448&4294967295)<<20&4294967295|i>>>12))+((i=t+(s^a&(n^s))+r[9]+568446438&4294967295)<<5&4294967295|i>>>27))+((i=a+(n^s&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|i>>>23))+((i=s+(t^n&(a^t))+r[3]+4107603335&4294967295)<<14&4294967295|i>>>18))+((i=n+(a^t&(s^a))+r[8]+1163531501&4294967295)<<20&4294967295|i>>>12))+((i=t+(s^a&(n^s))+r[13]+2850285829&4294967295)<<5&4294967295|i>>>27))+((i=a+(n^s&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|i>>>23))+((i=s+(t^n&(a^t))+r[7]+1735328473&4294967295)<<14&4294967295|i>>>18))+((i=n+(a^t&(s^a))+r[12]+2368359562&4294967295)<<20&4294967295|i>>>12))+((i=t+(n^s^a)+r[5]+4294588738&4294967295)<<4&4294967295|i>>>28))+((i=a+(t^n^s)+r[8]+2272392833&4294967295)<<11&4294967295|i>>>21))+((i=s+(a^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|i>>>16))+((i=n+(s^a^t)+r[14]+4259657740&4294967295)<<23&4294967295|i>>>9))+((i=t+(n^s^a)+r[1]+2763975236&4294967295)<<4&4294967295|i>>>28))+((i=a+(t^n^s)+r[4]+1272893353&4294967295)<<11&4294967295|i>>>21))+((i=s+(a^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|i>>>16))+((i=n+(s^a^t)+r[10]+3200236656&4294967295)<<23&4294967295|i>>>9))+((i=t+(n^s^a)+r[13]+681279174&4294967295)<<4&4294967295|i>>>28))+((i=a+(t^n^s)+r[0]+3936430074&4294967295)<<11&4294967295|i>>>21))+((i=s+(a^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|i>>>16))+((i=n+(s^a^t)+r[6]+76029189&4294967295)<<23&4294967295|i>>>9))+((i=t+(n^s^a)+r[9]+3654602809&4294967295)<<4&4294967295|i>>>28))+((i=a+(t^n^s)+r[12]+3873151461&4294967295)<<11&4294967295|i>>>21))+((i=s+(a^t^n)+r[15]+530742520&4294967295)<<16&4294967295|i>>>16))+((i=n+(s^a^t)+r[2]+3299628645&4294967295)<<23&4294967295|i>>>9))+((i=t+(s^(n|~a))+r[0]+4096336452&4294967295)<<6&4294967295|i>>>26))+((i=a+(n^(t|~s))+r[7]+1126891415&4294967295)<<10&4294967295|i>>>22))+((i=s+(t^(a|~n))+r[14]+2878612391&4294967295)<<15&4294967295|i>>>17))+((i=n+(a^(s|~t))+r[5]+4237533241&4294967295)<<21&4294967295|i>>>11))+((i=t+(s^(n|~a))+r[12]+1700485571&4294967295)<<6&4294967295|i>>>26))+((i=a+(n^(t|~s))+r[3]+2399980690&4294967295)<<10&4294967295|i>>>22))+((i=s+(t^(a|~n))+r[10]+4293915773&4294967295)<<15&4294967295|i>>>17))+((i=n+(a^(s|~t))+r[1]+2240044497&4294967295)<<21&4294967295|i>>>11))+((i=t+(s^(n|~a))+r[8]+1873313359&4294967295)<<6&4294967295|i>>>26))+((i=a+(n^(t|~s))+r[15]+4264355552&4294967295)<<10&4294967295|i>>>22))+((i=s+(t^(a|~n))+r[6]+2734768916&4294967295)<<15&4294967295|i>>>17))+((i=n+(a^(s|~t))+r[13]+1309151649&4294967295)<<21&4294967295|i>>>11))+((a=(t=n+((i=t+(s^(n|~a))+r[4]+4149444226&4294967295)<<6&4294967295|i>>>26))+((i=a+(n^(t|~s))+r[11]+3174756917&4294967295)<<10&4294967295|i>>>22))^((s=a+((i=s+(t^(a|~n))+r[2]+718787259&4294967295)<<15&4294967295|i>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(s+(i<<21&4294967295|i>>>11))&4294967295,e.g[2]=e.g[2]+s&4294967295,e.g[3]=e.g[3]+a&4294967295}function a(e,t){this.h=t;for(var n=[],r=!0,s=e.length-1;0<=s;s--){var a=0|e[s];r&&a==t||(n[s]=a,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var s=Array(arguments.length-2),a=2;a<arguments.length;a++)s[a-2]=arguments[a];return t.prototype[n].apply(e,s)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,s=this.B,a=this.h,i=0;i<t;){if(0==a)for(;i<=r;)n(this,e,i),i+=this.blockSize;if("string"===typeof e){for(;i<t;)if(s[a++]=e.charCodeAt(i++),a==this.blockSize){n(this,s),a=0;break}}else for(;i<t;)if(s[a++]=e[i++],a==this.blockSize){n(this,s),a=0;break}}this.h=a,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var i={};function l(e){return-128<=e&&128>e?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new a([0|e],0>e?-1:0)}):new a([0|e],0>e?-1:0)}function o(e){if(isNaN(e)||!isFinite(e))return c;if(0>e)return f(o(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new a(t,0)}var c=l(0),u=l(1),h=l(16777216);function m(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function p(e){return-1==e.h}function f(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new a(n,~e.h).add(u)}function g(e,t){return e.add(f(t))}function x(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function y(e,t){this.g=e,this.h=t}function v(e,t){if(m(t))throw Error("division by zero");if(m(e))return new y(c,c);if(p(e))return t=v(f(e),t),new y(f(t.g),f(t.h));if(p(t))return t=v(e,f(t)),new y(f(t.g),t.h);if(30<e.g.length){if(p(e)||p(t))throw Error("slowDivide_ only works with positive integers.");for(var n=u,r=t;0>=r.l(e);)n=b(n),r=b(r);var s=w(n,1),a=w(r,1);for(r=w(r,2),n=w(n,2);!m(r);){var i=a.add(r);0>=i.l(e)&&(s=s.add(n),a=i),r=w(r,1),n=w(n,1)}return t=g(e,s.j(t)),new y(s,t)}for(s=c;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),i=(a=o(n)).j(t);p(i)||0<i.l(e);)i=(a=o(n-=r)).j(t);m(a)&&(a=u),s=s.add(a),e=g(e,i)}return new y(s,e)}function b(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new a(n,e.h)}function w(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,s=[],i=0;i<r;i++)s[i]=0<t?e.i(i+n)>>>t|e.i(i+n+1)<<32-t:e.i(i+n);return new a(s,e.h)}(e=a.prototype).m=function(){if(p(this))return-f(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(m(this))return"0";if(p(this))return"-"+f(this).toString(e);for(var t=o(Math.pow(e,6)),n=this,r="";;){var s=v(n,t).g,a=((0<(n=g(n,s.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(m(n=s))return a+r;for(;6>a.length;)a="0"+a;r=a+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return p(e=g(this,e))?-1:m(e)?0:1},e.abs=function(){return p(this)?f(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,s=0;s<=t;s++){var i=r+(65535&this.i(s))+(65535&e.i(s)),l=(i>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);r=l>>>16,i&=65535,l&=65535,n[s]=l<<16|i}return new a(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(m(this)||m(e))return c;if(p(this))return p(e)?f(this).j(f(e)):f(f(this).j(e));if(p(e))return f(this.j(f(e)));if(0>this.l(h)&&0>e.l(h))return o(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<e.g.length;s++){var i=this.i(r)>>>16,l=65535&this.i(r),u=e.i(s)>>>16,d=65535&e.i(s);n[2*r+2*s]+=l*d,x(n,2*r+2*s),n[2*r+2*s+1]+=i*d,x(n,2*r+2*s+1),n[2*r+2*s+1]+=l*u,x(n,2*r+2*s+1),n[2*r+2*s+2]+=i*u,x(n,2*r+2*s+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new a(n,0)},e.A=function(e){return v(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new a(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new a(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new a(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,s=d.Md5=t,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=o,a.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return f(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=o(Math.pow(n,8)),s=c,a=0;a<t.length;a+=8){var i=Math.min(8,t.length-a),l=parseInt(t.substring(a,a+i),n);8>i?(i=o(Math.pow(n,i)),s=s.j(i).add(o(l))):s=(s=s.j(r)).add(o(l))}return s},r=d.Integer=a}).apply("undefined"!==typeof u?u:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var h,m,p,f,g,x,y,v,b="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},w={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof b&&b];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var s=n;e=e.split(".");for(var a=0;a<e.length-1;a++){var i=e[a];if(!(i in s))break e;s=s[i]}(r=r(a=s[e=e[e.length-1]]))!=a&&null!=r&&t(s,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,s={next:function(){if(!r&&n<e.length){var s=n++;return{value:t(s,e[s]),done:!1}}return r=!0,{done:!0,value:void 0}}};return s[Symbol.iterator]=function(){return s},s}(this,function(e,t){return t})}});var r=r||{},s=this||self;function a(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function i(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function l(e,t,n){return e.call.apply(e.bind,arguments)}function o(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?l:o).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var s=Array(arguments.length-2),a=2;a<arguments.length;a++)s[a-2]=arguments[a];return t.prototype[n].apply(e,s)}}function j(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function N(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(a(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let s=0;s<r;s++)e[n+s]=t[s]}else e.push(t)}}function k(e){return/^[\s\xa0]*$/.test(e)}function S(){var e=s.navigator;return e&&(e=e.userAgent)?e:""}function C(e){return C[" "](e),e}C[" "]=function(){};var E=-1!=S().indexOf("Gecko")&&!(-1!=S().toLowerCase().indexOf("webkit")&&-1==S().indexOf("Edge"))&&!(-1!=S().indexOf("Trident")||-1!=S().indexOf("MSIE"))&&-1==S().indexOf("Edge");function A(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function I(e){const t={};for(const n in e)t[n]=e[n];return t}const _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(e,t){let n,r;for(let s=1;s<arguments.length;s++){for(n in r=arguments[s],r)e[n]=r[n];for(let t=0;t<_.length;t++)n=_[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function D(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function P(e){s.setTimeout(()=>{throw e},0)}function M(){var e=V;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var R=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new O,e=>e.reset());class O{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let L,F=!1,V=new class{constructor(){this.h=this.g=null}add(e,t){const n=R.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},z=()=>{const e=s.Promise.resolve(void 0);L=()=>{e.then(U)}};var U=()=>{for(var e;e=M();){try{e.h.call(e.g)}catch(n){P(n)}var t=R;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}F=!1};function K(){this.s=this.s,this.C=this.C}function B(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}K.prototype.s=!1,K.prototype.ma=function(){this.s||(this.s=!0,this.N())},K.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},B.prototype.h=function(){this.defaultPrevented=!0};var q=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};s.addEventListener("test",e,t),s.removeEventListener("test",e,t)}catch(n){}return e}();function H(e,t){if(B.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(E){e:{try{C(t.nodeName);var s=!0;break e}catch(a){}s=!1}s||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:G[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&H.aa.h.call(this)}}d(H,B);var G={2:"touch",3:"pen",4:"mouse"};H.prototype.h=function(){H.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var W="closure_listenable_"+(1e6*Math.random()|0),Q=0;function J(e,t,n,r,s){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=s,this.key=++Q,this.da=this.fa=!1}function Z(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function X(e){this.src=e,this.g={},this.h=0}function Y(e,t){var n=t.type;if(n in e.g){var r,s=e.g[n],a=Array.prototype.indexOf.call(s,t,void 0);(r=0<=a)&&Array.prototype.splice.call(s,a,1),r&&(Z(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function $(e,t,n,r){for(var s=0;s<e.length;++s){var a=e[s];if(!a.da&&a.listener==t&&a.capture==!!n&&a.ha==r)return s}return-1}X.prototype.add=function(e,t,n,r,s){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var i=$(e,t,r,s);return-1<i?(t=e[i],n||(t.fa=!1)):((t=new J(t,this.src,a,!!r,s)).fa=n,e.push(t)),t};var ee="closure_lm_"+(1e6*Math.random()|0),te={};function ne(e,t,n,r,s){if(r&&r.once)return se(e,t,n,r,s);if(Array.isArray(t)){for(var a=0;a<t.length;a++)ne(e,t[a],n,r,s);return null}return n=de(n),e&&e[W]?e.K(t,n,i(r)?!!r.capture:!!r,s):re(e,t,n,!1,r,s)}function re(e,t,n,r,s,a){if(!t)throw Error("Invalid event type");var l=i(s)?!!s.capture:!!s,o=ce(e);if(o||(e[ee]=o=new X(e)),(n=o.add(t,n,r,l,a)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=oe;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)q||(s=l),void 0===s&&(s=!1),e.addEventListener(t.toString(),r,s);else if(e.attachEvent)e.attachEvent(le(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function se(e,t,n,r,s){if(Array.isArray(t)){for(var a=0;a<t.length;a++)se(e,t[a],n,r,s);return null}return n=de(n),e&&e[W]?e.L(t,n,i(r)?!!r.capture:!!r,s):re(e,t,n,!0,r,s)}function ae(e,t,n,r,s){if(Array.isArray(t))for(var a=0;a<t.length;a++)ae(e,t[a],n,r,s);else r=i(r)?!!r.capture:!!r,n=de(n),e&&e[W]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=$(a=e.g[t],n,r,s))&&(Z(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--)))):e&&(e=ce(e))&&(t=e.g[t.toString()],e=-1,t&&(e=$(t,n,r,s)),(n=-1<e?t[e]:null)&&ie(n))}function ie(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[W])Y(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(le(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=ce(t))?(Y(n,e),0==n.h&&(n.src=null,t[ee]=null)):Z(e)}}}function le(e){return e in te?te[e]:te[e]="on"+e}function oe(e,t){if(e.da)e=!0;else{t=new H(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&ie(e),e=n.call(r,t)}return e}function ce(e){return(e=e[ee])instanceof X?e:null}var ue="__closure_events_fn_"+(1e9*Math.random()>>>0);function de(e){return"function"===typeof e?e:(e[ue]||(e[ue]=function(t){return e.handleEvent(t)}),e[ue])}function he(){K.call(this),this.i=new X(this),this.M=this,this.F=null}function me(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new B(t,e);else if(t instanceof B)t.target=t.target||e;else{var s=t;T(t=new B(r,e),s)}if(s=!0,n)for(var a=n.length-1;0<=a;a--){var i=t.g=n[a];s=pe(i,r,!0,t)&&s}if(s=pe(i=t.g=e,r,!0,t)&&s,s=pe(i,r,!1,t)&&s,n)for(a=0;a<n.length;a++)s=pe(i=t.g=n[a],r,!1,t)&&s}function pe(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var s=!0,a=0;a<t.length;++a){var i=t[a];if(i&&!i.da&&i.capture==n){var l=i.listener,o=i.ha||i.src;i.fa&&Y(e.i,i),s=!1!==l.call(o,r)&&s}}return s&&!r.defaultPrevented}function fe(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:s.setTimeout(e,t||0)}function ge(e){e.g=fe(()=>{e.g=null,e.i&&(e.i=!1,ge(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}d(he,K),he.prototype[W]=!0,he.prototype.removeEventListener=function(e,t,n,r){ae(this,e,t,n,r)},he.prototype.N=function(){if(he.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Z(n[r]);delete t.g[e],t.h--}}this.F=null},he.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},he.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class xe extends K{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ge(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ye(e){K.call(this),this.h=e,this.g={}}d(ye,K);var ve=[];function be(e){A(e.g,function(e,t){this.g.hasOwnProperty(t)&&ie(e)},e),e.g={}}ye.prototype.N=function(){ye.aa.N.call(this),be(this)},ye.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var we=s.JSON.stringify,je=s.JSON.parse,Ne=class{stringify(e){return s.JSON.stringify(e,void 0)}parse(e){return s.JSON.parse(e,void 0)}};function ke(){}function Se(e){return e.h||(e.h=e.i())}function Ce(){}ke.prototype.h=null;var Ee={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ae(){B.call(this,"d")}function Ie(){B.call(this,"c")}d(Ae,B),d(Ie,B);var _e={},Te=null;function De(){return Te=Te||new he}function Pe(e){B.call(this,_e.La,e)}function Me(e){const t=De();me(t,new Pe(t))}function Re(e,t){B.call(this,_e.STAT_EVENT,e),this.stat=t}function Oe(e){const t=De();me(t,new Re(t,e))}function Le(e,t){B.call(this,_e.Ma,e),this.size=t}function Fe(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){e()},t)}function Ve(){this.g=!0}function ze(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var a=s[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var i=1;i<s.length;i++)s[i]=""}}}return we(n)}catch(l){return t}}(e,n)+(r?" "+r:"")})}_e.La="serverreachability",d(Pe,B),_e.STAT_EVENT="statevent",d(Re,B),_e.Ma="timingevent",d(Le,B),Ve.prototype.xa=function(){this.g=!1},Ve.prototype.info=function(){};var Ue,Ke={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Be={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function qe(){}function He(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new ye(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ge}function Ge(){this.i=null,this.g="",this.h=!1}d(qe,ke),qe.prototype.g=function(){return new XMLHttpRequest},qe.prototype.i=function(){return{}},Ue=new qe;var We={},Qe={};function Je(e,t,n){e.L=1,e.v=wt(gt(t)),e.m=n,e.P=!0,Ze(e,null)}function Ze(e,t){e.F=Date.now(),$e(e),e.A=gt(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),Rt(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Ge,e.g=Nn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new xe(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var s="readystatechange";Array.isArray(s)||(s&&(ve[0]=s.toString()),s=ve);for(var a=0;a<s.length;a++){var i=ne(n,s[a],r||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}t=e.H?I(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Me(),function(e,t,n,r,s,a){e.info(function(){if(e.g)if(a)for(var i="",l=a.split("&"),o=0;o<l.length;o++){var c=l[o].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");i=2<=d.length&&"type"==d[1]?i+(u+"=")+c+"&":i+(u+"=redacted&")}}else i=null;else i=a;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+t+"\n"+n+"\n"+i})}(e.i,e.u,e.A,e.l,e.R,e.m)}function Xe(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Ye(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Qe:(n=Number(t.substring(n,r)),isNaN(n)?We:(r+=1)+n>t.length?Qe:(t=t.slice(r,r+n),e.C=r+n,t))}function $e(e){e.S=Date.now()+e.I,et(e,e.I)}function et(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Fe(c(e.ba,e),t)}function tt(e){e.B&&(s.clearTimeout(e.B),e.B=null)}function nt(e){0==e.j.G||e.J||yn(e.j,e)}function rt(e){tt(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,be(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function st(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||ct(n.h,e)))if(!e.K&&ct(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;xn(n),ln(n)}pn(n),Oe(18)}}else n.za=s[1],0<n.za-n.T&&37500>s[2]&&n.F&&0==n.v&&!n.C&&(n.C=Fe(c(n.Za,n),6e3));if(1>=ot(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else bn(n,11)}else if((e.K||n.g==e)&&xn(n),!k(t))for(s=n.Da.g.parse(t),t=0;t<s.length;t++){let c=s[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const s=c[4];null!=s&&(n.Aa=s,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var a=r.h;a.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(a.j=a.l,a.g=new Set,a.h&&(ut(a,a.h),a.h=null))}if(r.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,bt(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var i=e;if((r=n).qa=jn(r,r.J?r.ia:null,r.W),i.K){dt(r.h,i);var l=i,o=r.L;o&&(l.I=o),l.B&&(tt(l),$e(l)),r.g=i}else mn(r);0<n.i.length&&cn(n)}else"stop"!=c[0]&&"close"!=c[0]||bn(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?bn(n,7):an(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}Me()}catch(u){}}He.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==tn(e)?t.j():this.Y(e)},He.prototype.Y=function(e){try{if(e==this.g)e:{const h=tn(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||nn(this.g)))){this.J||4!=h||7==t||Me(),tt(this);var n=this.g.Z();this.X=n;t:if(Xe(this)){var r=nn(this.g);e="";var a=r.length,i=4==tn(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){rt(this),nt(this);var l="";break t}this.h.i=new s.TextDecoder}for(t=0;t<a;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(i&&t==a-1)});r.length=0,this.h.g+=e,this.C=0,l=this.h.g}else l=this.g.oa();if(this.o=200==n,function(e,t,n,r,s,a,i){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+t+"\n"+n+"\n"+a+" "+i})}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var o,c=this.g;if((o=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(o)){var u=o;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Oe(12),rt(this),nt(this);break e}ze(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,st(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<l.length;){if(e=Ye(this,l),e==Qe){4==h&&(this.s=4,Oe(14),n=!1),ze(this.i,this.l,null,"[Incomplete Response]");break}if(e==We){this.s=4,Oe(15),ze(this.i,this.l,l,"[Invalid Chunk]"),n=!1;break}ze(this.i,this.l,e,null),st(this,e)}if(Xe(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=l.length||this.h.h||(this.s=1,Oe(16),n=!1),this.o=this.o&&n,n){if(0<l.length&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+l.length),fn(d),d.M=!0,Oe(11))}}else ze(this.i,this.l,l,"[Invalid Chunked Response]"),rt(this),nt(this)}else ze(this.i,this.l,l,null),st(this,l);4==h&&rt(this),this.o&&!this.J&&(4==h?yn(this.j,this):(this.o=!1,$e(this)))}else(function(e){const t={};e=(e.g&&2<=tn(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(k(e[r]))continue;var n=D(e[r]);const s=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const a=t[s]||[];t[s]=a,a.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<l.indexOf("Unknown SID")?(this.s=3,Oe(12)):(this.s=0,Oe(13)),rt(this),nt(this)}}}catch(h){}},He.prototype.cancel=function(){this.J=!0,rt(this)},He.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(Me(),Oe(17)),rt(this),this.s=2,nt(this)):et(this,this.S-e)};var at=class{constructor(e,t){this.g=e,this.map=t}};function it(e){this.l=e||10,s.PerformanceNavigationTiming?e=0<(e=s.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function lt(e){return!!e.h||!!e.g&&e.g.size>=e.j}function ot(e){return e.h?1:e.g?e.g.size:0}function ct(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function ut(e,t){e.g?e.g.add(t):e.h=t}function dt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function ht(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return j(e.i)}function mt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(a(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(a(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(a(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),s=r.length,i=0;i<s;i++)t.call(void 0,r[i],n&&n[i],e)}it.prototype.cancel=function(){if(this.i=ht(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var pt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ft(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof ft){this.h=e.h,xt(this,e.j),this.o=e.o,this.g=e.g,yt(this,e.s),this.l=e.l;var t=e.i,n=new Tt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),vt(this,n),this.m=e.m}else e&&(t=String(e).match(pt))?(this.h=!1,xt(this,t[1]||"",!0),this.o=jt(t[2]||""),this.g=jt(t[3]||"",!0),yt(this,t[4]),this.l=jt(t[5]||"",!0),vt(this,t[6]||"",!0),this.m=jt(t[7]||"")):(this.h=!1,this.i=new Tt(null,this.h))}function gt(e){return new ft(e)}function xt(e,t,n){e.j=n?jt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function yt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function vt(e,t,n){t instanceof Tt?(e.i=t,function(e,t){t&&!e.j&&(Dt(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(Pt(this,t),Rt(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=Nt(t,It)),e.i=new Tt(t,e.h))}function bt(e,t,n){e.i.set(t,n)}function wt(e){return bt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function jt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Nt(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,kt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function kt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}ft.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Nt(t,Ct,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(Nt(t,Ct,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Nt(n,"/"==n.charAt(0)?At:Et,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",Nt(n,_t)),e.join("")};var St,Ct=/[#\/\?@]/g,Et=/[#\?:]/g,At=/[#\?]/g,It=/[#\?@]/g,_t=/#/g;function Tt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Dt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),s=null;if(0<=r){var a=e[n].substring(0,r);s=e[n].substring(r+1)}else a=e[n];t(a,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function Pt(e,t){Dt(e),t=Ot(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Mt(e,t){return Dt(e),t=Ot(e,t),e.g.has(t)}function Rt(e,t,n){Pt(e,t),0<n.length&&(e.i=null,e.g.set(Ot(e,t),j(n)),e.h+=n.length)}function Ot(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Lt(e,t,n,r,s){try{s&&(s.onload=null,s.onerror=null,s.onabort=null,s.ontimeout=null),r(n)}catch(a){}}function Ft(){this.g=new Ne}function Vt(e,t,n){const r=n||"";try{mt(e,function(e,n){let s=e;i(e)&&(s=we(e)),t.push(r+n+"="+encodeURIComponent(s))})}catch(s){throw t.push(r+"type="+encodeURIComponent("_badmap")),s}}function zt(e){this.l=e.Ub||null,this.j=e.eb||!1}function Ut(e,t){he.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Kt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Bt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,qt(e)}function qt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Ht(e){let t="";return A(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Gt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Ht(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):bt(e,t,n))}function Wt(e){he.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=Tt.prototype).add=function(e,t){Dt(this),this.i=null,e=Ot(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Dt(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.na=function(){Dt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const s=e[r];for(let e=0;e<s.length;e++)n.push(t[r])}return n},e.V=function(e){Dt(this);let t=[];if("string"===typeof e)Mt(this,e)&&(t=t.concat(this.g.get(Ot(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return Dt(this),this.i=null,Mt(this,e=Ot(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const a=encodeURIComponent(String(r)),i=this.V(r);for(r=0;r<i.length;r++){var s=a;""!==i[r]&&(s+="="+encodeURIComponent(String(i[r]))),e.push(s)}}return this.i=e.join("&")},d(zt,ke),zt.prototype.g=function(){return new Ut(this.l,this.j)},zt.prototype.i=(St={},function(){return St}),d(Ut,he),(e=Ut.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,qt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||s).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Bt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,qt(this)),this.g&&(this.readyState=3,qt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof s.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Kt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Bt(this):qt(this),3==this.readyState&&Kt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Bt(this))},e.Qa=function(e){this.g&&(this.response=e,Bt(this))},e.ga=function(){this.g&&Bt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Ut.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),d(Wt,he);var Qt=/^https?$/i,Jt=["POST","PUT"];function Zt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Xt(e),$t(e)}function Xt(e){e.A||(e.A=!0,me(e,"complete"),me(e,"error"))}function Yt(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=tn(e)||2!=e.Z()))if(e.u&&4==tn(e))fe(e.Ea,0,e);else if(me(e,"readystatechange"),4==tn(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var a;if(a=0===r){var i=String(e.D).match(pt)[1]||null;!i&&s.self&&s.self.location&&(i=s.self.location.protocol.slice(0,-1)),a=!Qt.test(i?i.toLowerCase():"")}n=a}if(n)me(e,"complete"),me(e,"success");else{e.m=6;try{var l=2<tn(e)?e.g.statusText:""}catch(o){l=""}e.l=l+" ["+e.Z()+"]",Xt(e)}}finally{$t(e)}}}function $t(e,t){if(e.g){en(e);const r=e.g,s=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||me(e,"ready");try{r.onreadystatechange=s}catch(n){}}}function en(e){e.I&&(s.clearTimeout(e.I),e.I=null)}function tn(e){return e.g?e.g.readyState:0}function nn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function rn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function sn(e){this.Aa=0,this.i=[],this.j=new Ve,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=rn("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=rn("baseRetryDelayMs",5e3,e),this.cb=rn("retryDelaySeedMs",1e4,e),this.Wa=rn("forwardChannelMaxRetries",2,e),this.wa=rn("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new it(e&&e.concurrentRequestLimit),this.Da=new Ft,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function an(e){if(on(e),3==e.G){var t=e.U++,n=gt(e.I);if(bt(n,"SID",e.K),bt(n,"RID",t),bt(n,"TYPE","terminate"),dn(e,n),(t=new He(e,e.j,t)).L=2,t.v=wt(gt(n)),n=!1,s.navigator&&s.navigator.sendBeacon)try{n=s.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&s.Image&&((new Image).src=t.v,n=!0),n||(t.g=Nn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),$e(t)}wn(e)}function ln(e){e.g&&(fn(e),e.g.cancel(),e.g=null)}function on(e){ln(e),e.u&&(s.clearTimeout(e.u),e.u=null),xn(e),e.h.cancel(),e.s&&("number"===typeof e.s&&s.clearTimeout(e.s),e.s=null)}function cn(e){if(!lt(e.h)&&!e.s){e.s=!0;var t=e.Ga;L||z(),F||(L(),F=!0),V.add(t,e),e.B=0}}function un(e,t){var n;n=t?t.l:e.U++;const r=gt(e.I);bt(r,"SID",e.K),bt(r,"RID",n),bt(r,"AID",e.T),dn(e,r),e.m&&e.o&&Gt(r,e.m,e.o),n=new He(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=hn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),ut(e.h,n),Je(n,r,t)}function dn(e,t){e.H&&A(e.H,function(e,n){bt(t,n,e)}),e.l&&mt({},function(e,n){bt(t,n,e)})}function hn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?c(e.l.Na,e.l,e):null;e:{var s=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=s[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let i=!0;for(let l=0;l<n;l++){let n=s[l].g;const o=s[l].map;if(n-=t,0>n)t=Math.max(0,s[l].g-100),i=!1;else try{Vt(o,e,"req"+n+"_")}catch(a){r&&r(o)}}if(i){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function mn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;L||z(),F||(L(),F=!0),V.add(t,e),e.v=0}}function pn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Fe(c(e.Fa,e),vn(e,e.v)),e.v++,!0)}function fn(e){null!=e.A&&(s.clearTimeout(e.A),e.A=null)}function gn(e){e.g=new He(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=gt(e.qa);bt(t,"RID","rpc"),bt(t,"SID",e.K),bt(t,"AID",e.T),bt(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&bt(t,"TO",e.ja),bt(t,"TYPE","xmlhttp"),dn(e,t),e.m&&e.o&&Gt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=wt(gt(t)),n.m=null,n.P=!0,Ze(n,e)}function xn(e){null!=e.C&&(s.clearTimeout(e.C),e.C=null)}function yn(e,t){var n=null;if(e.g==t){xn(e),fn(e),e.g=null;var r=2}else{if(!ct(e.h,t))return;n=t.D,dt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var s=e.B;me(r=De(),new Le(r,n)),cn(e)}else mn(e);else if(3==(s=t.s)||0==s&&0<t.X||!(1==r&&function(e,t){return!(ot(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Fe(c(e.Ga,e,t),vn(e,e.B)),e.B++,!0))}(e,t)||2==r&&pn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),s){case 1:bn(e,5);break;case 4:bn(e,10);break;case 3:bn(e,6);break;default:bn(e,2)}}function vn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function bn(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),r=e.Xa;const t=!r;r=new ft(r||"//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||xt(r,"https"),wt(r),t?function(e,t){const n=new Ve;if(s.Image){const r=new Image;r.onload=u(Lt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(Lt,n,"TestLoadImage: error",!1,t,r),r.onabort=u(Lt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(Lt,n,"TestLoadImage: timeout",!1,t,r),s.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ve;const n=new AbortController,r=setTimeout(()=>{n.abort(),Lt(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?Lt(0,0,!0,t):Lt(0,0,!1,t)}).catch(()=>{clearTimeout(r),Lt(0,0,!1,t)})}(r.toString(),n)}else Oe(2);e.G=0,e.l&&e.l.sa(t),wn(e),on(e)}function wn(e){if(e.G=0,e.ka=[],e.l){const t=ht(e.h);0==t.length&&0==e.i.length||(N(e.ka,t),N(e.ka,e.i),e.h.i.length=0,j(e.i),e.i.length=0),e.l.ra()}}function jn(e,t,n){var r=n instanceof ft?gt(n):new ft(n);if(""!=r.g)t&&(r.g=t+"."+r.g),yt(r,r.s);else{var a=s.location;r=a.protocol,t=t?t+"."+a.hostname:a.hostname,a=+a.port;var i=new ft(null);r&&xt(i,r),t&&(i.g=t),a&&yt(i,a),n&&(i.l=n),r=i}return n=e.D,t=e.ya,n&&t&&bt(r,n,t),bt(r,"VER",e.la),dn(e,r),r}function Nn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Wt(new zt({eb:n})):new Wt(e.pa)).Ha(e.J),t}function kn(){}function Sn(){}function Cn(e,t){he.call(this),this.g=new sn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!k(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!k(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new In(this)}function En(e){Ae.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function An(){Ie.call(this),this.status=1}function In(e){this.g=e}(e=Wt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ue.g(),this.v=this.o?Se(this.o):Se(Ue),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(i){return void Zt(this,i)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var a in r)n.set(a,r[a]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),a=s.FormData&&e instanceof s.FormData,!(0<=Array.prototype.indexOf.call(Jt,t,void 0))||r||a||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,l]of n)this.g.setRequestHeader(s,l);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{en(this),this.u=!0,this.g.send(e),this.u=!1}catch(i){Zt(this,i)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,me(this,"complete"),me(this,"abort"),$t(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$t(this,!0)),Wt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Yt(this):this.bb())},e.bb=function(){Yt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<tn(this)?this.g.status:-1}catch(St){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(St){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),je(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=sn.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Oe(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=jn(this,null,this.W),cn(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const s=new He(this,this.j,e);let a=this.o;if(this.S&&(a?(a=I(a),T(a,this.S)):a=this.S),null!==this.m||this.O||(s.H=a,a=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=hn(this,s,t),bt(n=gt(this.I),"RID",e),bt(n,"CVER",22),this.D&&bt(n,"X-HTTP-Session-Id",this.D),dn(this,n),a&&(this.O?t="headers="+encodeURIComponent(String(Ht(a)))+"&"+t:this.m&&Gt(n,this.m,a)),ut(this.h,s),this.Ua&&bt(n,"TYPE","init"),this.P?(bt(n,"$req",t),bt(n,"SID","null"),s.T=!0,Je(s,n,null)):Je(s,n,t),this.G=2}}else 3==this.G&&(e?un(this,e):0==this.i.length||lt(this.h)||un(this))},e.Fa=function(){if(this.u=null,gn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Fe(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Oe(10),ln(this),gn(this))},e.Za=function(){null!=this.C&&(this.C=null,ln(this),pn(this),Oe(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Oe(2)):(this.j.info("Failed to ping google.com"),Oe(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=kn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},Sn.prototype.g=function(e,t){return new Cn(e,t)},d(Cn,he),Cn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Cn.prototype.close=function(){an(this.g)},Cn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=we(e),e=n);t.i.push(new at(t.Ya++,e)),3==t.G&&cn(t)},Cn.prototype.N=function(){this.g.l=null,delete this.j,an(this.g),delete this.g,Cn.aa.N.call(this)},d(En,Ae),d(An,Ie),d(In,kn),In.prototype.ua=function(){me(this.g,"a")},In.prototype.ta=function(e){me(this.g,new En(e))},In.prototype.sa=function(e){me(this.g,new An)},In.prototype.ra=function(){me(this.g,"b")},Sn.prototype.createWebChannel=Sn.prototype.g,Cn.prototype.send=Cn.prototype.o,Cn.prototype.open=Cn.prototype.m,Cn.prototype.close=Cn.prototype.close,v=w.createWebChannelTransport=function(){return new Sn},y=w.getStatEventTarget=function(){return De()},x=w.Event=_e,g=w.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ke.NO_ERROR=0,Ke.TIMEOUT=8,Ke.HTTP_ERROR=6,f=w.ErrorCode=Ke,Be.COMPLETE="complete",p=w.EventType=Be,Ce.EventType=Ee,Ee.OPEN="a",Ee.CLOSE="b",Ee.ERROR="c",Ee.MESSAGE="d",he.prototype.listen=he.prototype.K,m=w.WebChannel=Ce,w.FetchXmlHttpFactory=zt,Wt.prototype.listenOnce=Wt.prototype.L,Wt.prototype.getLastError=Wt.prototype.Ka,Wt.prototype.getLastErrorCode=Wt.prototype.Ba,Wt.prototype.getStatus=Wt.prototype.Z,Wt.prototype.getResponseJson=Wt.prototype.Oa,Wt.prototype.getResponseText=Wt.prototype.oa,Wt.prototype.send=Wt.prototype.ea,Wt.prototype.setWithCredentials=Wt.prototype.Ha,h=w.XhrIo=Wt}).apply("undefined"!==typeof b?b:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const j="@firebase/firestore",N="4.9.0";class k{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}k.UNAUTHENTICATED=new k(null),k.GOOGLE_CREDENTIALS=new k("google-credentials-uid"),k.FIRST_PARTY=new k("first-party-uid"),k.MOCK_USER=new k("mock-user");let S="12.0.0";const C=new o.Vy("@firebase/firestore");function E(){return C.logLevel}function A(e){if(C.logLevel<=o.$b.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=n.map(T);C.debug("Firestore (".concat(S,"): ").concat(e),...s)}}function I(e){if(C.logLevel<=o.$b.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=n.map(T);C.error("Firestore (".concat(S,"): ").concat(e),...s)}}function _(e){if(C.logLevel<=o.$b.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=n.map(T);C.warn("Firestore (".concat(S,"): ").concat(e),...s)}}function T(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function D(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,P(e,r,n)}function P(e,t,n){let r="FIRESTORE (".concat(S,") INTERNAL ASSERTION FAILED: ").concat(t," (ID: ").concat(e.toString(16),")");if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw I(r),new Error(r)}function M(e,t,n,r){let s="Unexpected state";"string"==typeof n?s=n:r=n,e||P(t,s,r)}function R(e,t){return e}const O={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class L extends c.g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class F{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class V{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class z{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(k.UNAUTHENTICATED))}shutdown(){}}class U{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class K{constructor(e){this.t=e,this.currentUser=k.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){M(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let s=new F;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new F,e.enqueueRetryable(()=>r(this.currentUser))};const a=()=>{const t=s;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},i=e=>{A("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(e=>i(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?i(e):(A("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new F)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(A("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(M("string"==typeof t.accessToken,31837,{l:t}),new V(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return M(null===e||"string"==typeof e,2055,{h:e}),new k(e)}}class B{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=k.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class q{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new B(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(k.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class H{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class G{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,(0,i.xZ)(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){M(void 0===this.o,3512);const n=e=>{null!=e.error&&A("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.m;return this.m=e.token,A("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{A("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):A("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new H(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(M("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new H(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function W(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class Q{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=W(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function J(e,t){return e<t?-1:e>t?1:0}function Z(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.charAt(r),s=t.charAt(r);if(n!==s)return $(n)===$(s)?J(n,s):$(n)?1:-1}return J(e.length,t.length)}const X=55296,Y=57343;function $(e){const t=e.charCodeAt(0);return t>=X&&t<=Y}function ee(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}const te="__name__";class ne{constructor(e,t,n){void 0===t?t=0:t>e.length&&D(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&D(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===ne.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ne?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=ne.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return J(e.length,t.length)}static compareSegments(e,t){const n=ne.isNumericId(e),r=ne.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?ne.extractNumericId(e).compare(ne.extractNumericId(t)):Z(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return r.fromString(e.substring(4,e.length-2))}}class re extends ne{construct(e,t,n){return new re(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const s of n){if(s.indexOf("//")>=0)throw new L(O.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));e.push(...s.split("/").filter(e=>e.length>0))}return new re(e)}static emptyPath(){return new re([])}}const se=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ae extends ne{construct(e,t,n){return new ae(e,t,n)}static isValidIdentifier(e){return se.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ae.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===te}static keyField(){return new ae([te])}static fromServerFormat(e){const t=[];let n="",r=0;const s=()=>{if(0===n.length)throw new L(O.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let a=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new L(O.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new L(O.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(a=!a,r++):"."!==t||a?(n+=t,r++):(s(),r++)}if(s(),a)throw new L(O.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ae(t)}static emptyPath(){return new ae([])}}class ie{constructor(e){this.path=e}static fromPath(e){return new ie(re.fromString(e))}static fromName(e){return new ie(re.fromString(e).popFirst(5))}static empty(){return new ie(re.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===re.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return re.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ie(new re(e.slice()))}}function le(e,t,n){if(!n)throw new L(O.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function oe(e){if(!ie.isDocumentKey(e))throw new L(O.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function ce(e){if(ie.isDocumentKey(e))throw new L(O.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function ue(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function de(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":D(12329,{type:typeof e})}function he(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new L(O.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=de(e);throw new L(O.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function me(e,t){const n={typeString:e};return t&&(n.value=t),n}function pe(e,t){if(!ue(e))throw new L(O.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const s=t[r].typeString,a="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n="JSON missing required field: '".concat(r,"'");break}const i=e[r];if(s&&typeof i!==s){n="JSON field '".concat(r,"' must be a ").concat(s,".");break}if(void 0!==a&&i!==a.value){n="Expected '".concat(r,"' field to equal '").concat(a.value,"'");break}}if(n)throw new L(O.INVALID_ARGUMENT,n);return!0}const fe=-62135596800,ge=1e6;class xe{static now(){return xe.fromMillis(Date.now())}static fromDate(e){return xe.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*ge);return new xe(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new L(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new L(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<fe)throw new L(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ge}_compareTo(e){return this.seconds===e.seconds?J(this.nanoseconds,e.nanoseconds):J(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(pe(e,xe._jsonSchema))return new xe(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-fe;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xe._jsonSchemaVersion="firestore/timestamp/1.0",xe._jsonSchema={type:me("string",xe._jsonSchemaVersion),seconds:me("number"),nanoseconds:me("number")};class ye{static fromTimestamp(e){return new ye(e)}static min(){return new ye(new xe(0,0))}static max(){return new ye(new xe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ve=-1;class be{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}be.UNKNOWN_ID=-1;function we(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,s=ye.fromTimestamp(1e9===r?new xe(n+1,0):new xe(n,r));return new Ne(s,ie.empty(),t)}function je(e){return new Ne(e.readTime,e.key,ve)}class Ne{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Ne(ye.min(),ie.empty(),ve)}static max(){return new Ne(ye.max(),ie.empty(),ve)}}function ke(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=ie.comparator(e.documentKey,t.documentKey),0!==n?n:J(e.largestBatchId,t.largestBatchId))}const Se="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ce{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function Ee(e){if(e.code!==O.FAILED_PRECONDITION||e.message!==Se)throw e;A("LocalStore","Unexpectedly lost primary lease")}class Ae{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&D(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ae((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Ae?t:Ae.resolve(t)}catch(e){return Ae.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Ae.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Ae.reject(t)}static resolve(e){return new Ae((t,n)=>{t(e)})}static reject(e){return new Ae((t,n)=>{n(e)})}static waitFor(e){return new Ae((t,n)=>{let r=0,s=0,a=!1;e.forEach(e=>{++r,e.next(()=>{++s,a&&s===r&&t()},e=>n(e))}),a=!0,s===r&&t()})}static or(e){let t=Ae.resolve(!1);for(const n of e)t=t.next(e=>e?Ae.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new Ae((n,r)=>{const s=e.length,a=new Array(s);let i=0;for(let l=0;l<s;l++){const o=l;t(e[o]).next(e=>{a[o]=e,++i,i===s&&n(a)},e=>r(e))}})}static doWhile(e,t){return new Ae((n,r)=>{const s=()=>{!0===e()?t().next(()=>{s()},r):n()};s()})}}function Ie(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function _e(e){return"IndexedDbTransactionError"===e.name}class Te{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Te.ce=-1;const De=-1;function Pe(e){return null==e}function Me(e){return 0===e&&1/e==-1/0}function Re(e){return"number"==typeof e&&Number.isInteger(e)&&!Me(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const Oe="\x01";function Le(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Ve(t)),t=Fe(e.get(n),t);return Ve(t)}function Fe(e,t){let n=t;const r=e.length;for(let s=0;s<r;s++){const t=e.charAt(s);switch(t){case"\0":n+="\x01\x10";break;case Oe:n+="\x01\x11";break;default:n+=t}}return n}function Ve(e){return e+Oe+"\x01"}const ze="remoteDocuments",Ue="owner",Ke="mutationQueues",Be="mutations";const qe="documentMutations",He="remoteDocumentsV14",Ge="remoteDocumentGlobal",We="targets",Qe="targetDocuments",Je="targetGlobal",Ze="collectionParents",Xe="clientMetadata",Ye="bundles",$e="namedQueries",et="indexConfiguration",tt="indexState",nt="indexEntries",rt="documentOverlays",st="globals",at=[Ke,Be,qe,ze,We,Ue,Je,Qe,Xe,Ge,Ze,Ye,$e],it=[Ke,Be,qe,He,We,Ue,Je,Qe,Xe,Ge,Ze,Ye,$e,rt],lt=it,ot=[...lt,et,tt,nt];function ct(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function ut(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function dt(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class ht{constructor(e,t){this.comparator=e,this.root=t||pt.EMPTY}insert(e,t){return new ht(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,pt.BLACK,null,null))}remove(e){return new ht(this.comparator,this.root.remove(e,this.comparator).copy(null,null,pt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push("".concat(t,":").concat(n)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new mt(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new mt(this.root,e,this.comparator,!1)}getReverseIterator(){return new mt(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new mt(this.root,e,this.comparator,!0)}}class mt{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class pt{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=null!=n?n:pt.RED,this.left=null!=r?r:pt.EMPTY,this.right=null!=s?s:pt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,s){return new pt(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return pt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return pt.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,pt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,pt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw D(43730,{key:this.key,value:this.value});if(this.right.isRed())throw D(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw D(27949);return e+(this.isRed()?0:1)}}pt.EMPTY=null,pt.RED=!0,pt.BLACK=!1,pt.EMPTY=new class{constructor(){this.size=0}get key(){throw D(57766)}get value(){throw D(16141)}get color(){throw D(16727)}get left(){throw D(29726)}get right(){throw D(36894)}copy(e,t,n,r,s){return this}insert(e,t,n){return new pt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ft{constructor(e){this.comparator=e,this.data=new ht(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new gt(this.data.getIterator())}getIteratorFrom(e){return new gt(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof ft))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new ft(this.comparator);return t.data=e,t}}class gt{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class xt{constructor(e){this.fields=e,e.sort(ae.comparator)}static empty(){return new xt([])}unionWith(e){let t=new ft(ae.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new xt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ee(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class yt extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class vt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new yt("Invalid base64 string: "+e):e}}(e);return new vt(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new vt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return J(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}vt.EMPTY_BYTE_STRING=new vt("");const bt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wt(e){if(M(!!e,39018),"string"==typeof e){let t=0;const n=bt.exec(e);if(M(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:jt(e.seconds),nanos:jt(e.nanos)}}function jt(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Nt(e){return"string"==typeof e?vt.fromBase64String(e):vt.fromUint8Array(e)}const kt="server_timestamp",St="__type__",Ct="__previous_value__",Et="__local_write_time__";function At(e){var t,n;return(null===(t=((null===e||void 0===e||null===(n=e.mapValue)||void 0===n?void 0:n.fields)||{})[St])||void 0===t?void 0:t.stringValue)===kt}function It(e){const t=e.mapValue.fields[Ct];return At(t)?It(t):t}function _t(e){const t=wt(e.mapValue.fields[Et].timestampValue);return new xe(t.seconds,t.nanos)}class Tt{constructor(e,t,n,r,s,a,i,l,o,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=i,this.longPollingOptions=l,this.useFetchStreams=o,this.isUsingEmulator=c}}const Dt="(default)";class Pt{constructor(e,t){this.projectId=e,this.database=t||Dt}static empty(){return new Pt("","")}get isDefaultDatabase(){return this.database===Dt}isEqual(e){return e instanceof Pt&&e.projectId===this.projectId&&e.database===this.database}}const Mt="__type__",Rt="__max__",Ot={mapValue:{fields:{__type__:{stringValue:Rt}}}},Lt="__vector__",Ft="value";function Vt(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?At(e)?4:nn(e)?9007199254740991:en(e)?10:11:D(28295,{value:e})}function zt(e,t){if(e===t)return!0;const n=Vt(e);if(n!==Vt(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return _t(e).isEqual(_t(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=wt(e.timestampValue),r=wt(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Nt(e.bytesValue).isEqual(Nt(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return jt(e.geoPointValue.latitude)===jt(t.geoPointValue.latitude)&&jt(e.geoPointValue.longitude)===jt(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return jt(e.integerValue)===jt(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=jt(e.doubleValue),r=jt(t.doubleValue);return n===r?Me(n)===Me(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return ee(e.arrayValue.values||[],t.arrayValue.values||[],zt);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(ct(n)!==ct(r))return!1;for(const s in n)if(n.hasOwnProperty(s)&&(void 0===r[s]||!zt(n[s],r[s])))return!1;return!0}(e,t);default:return D(52216,{left:e})}}function Ut(e,t){return void 0!==(e.values||[]).find(e=>zt(e,t))}function Kt(e,t){if(e===t)return 0;const n=Vt(e),r=Vt(t);if(n!==r)return J(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return J(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=jt(e.integerValue||e.doubleValue),r=jt(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Bt(e.timestampValue,t.timestampValue);case 4:return Bt(_t(e),_t(t));case 5:return Z(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Nt(e),r=Nt(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let s=0;s<n.length&&s<r.length;s++){const e=J(n[s],r[s]);if(0!==e)return e}return J(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=J(jt(e.latitude),jt(t.latitude));return 0!==n?n:J(jt(e.longitude),jt(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return qt(e.arrayValue,t.arrayValue);case 10:return function(e,t,n,r,s,a){const i=e.fields||{},l=t.fields||{},o=null===(n=i[Ft])||void 0===n?void 0:n.arrayValue,c=null===(r=l[Ft])||void 0===r?void 0:r.arrayValue,u=J((null===o||void 0===o||null===(s=o.values)||void 0===s?void 0:s.length)||0,(null===c||void 0===c||null===(a=c.values)||void 0===a?void 0:a.length)||0);return 0!==u?u:qt(o,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Ot.mapValue&&t===Ot.mapValue)return 0;if(e===Ot.mapValue)return 1;if(t===Ot.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),s=t.fields||{},a=Object.keys(s);r.sort(),a.sort();for(let i=0;i<r.length&&i<a.length;++i){const e=Z(r[i],a[i]);if(0!==e)return e;const t=Kt(n[r[i]],s[a[i]]);if(0!==t)return t}return J(r.length,a.length)}(e.mapValue,t.mapValue);default:throw D(23264,{he:n})}}function Bt(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return J(e,t);const n=wt(e),r=wt(t),s=J(n.seconds,r.seconds);return 0!==s?s:J(n.nanos,r.nanos)}function qt(e,t){const n=e.values||[],r=t.values||[];for(let s=0;s<n.length&&s<r.length;++s){const e=Kt(n[s],r[s]);if(e)return e}return J(n.length,r.length)}function Ht(e){return Gt(e)}function Gt(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=wt(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Nt(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return ie.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Gt(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const s of t)r?r=!1:n+=",",n+="".concat(s,":").concat(Gt(e.fields[s]));return n+"}"}(e.mapValue):D(61005,{value:e})}function Wt(e){switch(Vt(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=It(e);return t?16+Wt(t):16;case 5:return 2*e.stringValue.length;case 6:return Nt(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+Wt(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return ut(e.fields,(e,n)=>{t+=e.length+Wt(n)}),t}(e.mapValue);default:throw D(13486,{value:e})}}function Qt(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Jt(e){return!!e&&"integerValue"in e}function Zt(e){return!!e&&"arrayValue"in e}function Xt(e){return!!e&&"nullValue"in e}function Yt(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function $t(e){return!!e&&"mapValue"in e}function en(e){var t,n;return(null===(t=((null===e||void 0===e||null===(n=e.mapValue)||void 0===n?void 0:n.fields)||{})[Mt])||void 0===t?void 0:t.stringValue)===Lt}function tn(e){if(e.geoPointValue)return{geoPointValue:(0,a.A)({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:(0,a.A)({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return ut(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=tn(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=tn(e.arrayValue.values[n]);return t}return(0,a.A)({},e)}function nn(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Rt}class rn{constructor(e){this.value=e}static empty(){return new rn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!$t(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=tn(t)}setAll(e){let t=ae.emptyPath(),n={},r=[];e.forEach((e,s)=>{if(!t.isImmediateParentOf(s)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=s.popLast()}e?n[s.lastSegment()]=tn(e):r.push(s.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){const t=this.field(e.popLast());$t(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return zt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];$t(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){ut(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new rn(tn(this.value))}}function sn(e){const t=[];return ut(e.fields,(e,n)=>{const r=new ae([e]);if($t(n)){const e=sn(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new xt(t)}class an{constructor(e,t,n,r,s,a,i){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=s,this.data=a,this.documentState=i}static newInvalidDocument(e){return new an(e,0,ye.min(),ye.min(),ye.min(),rn.empty(),0)}static newFoundDocument(e,t,n,r){return new an(e,1,t,ye.min(),n,r,0)}static newNoDocument(e,t){return new an(e,2,t,ye.min(),ye.min(),rn.empty(),0)}static newUnknownDocument(e,t){return new an(e,3,t,ye.min(),ye.min(),rn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ye.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=rn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=rn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ye.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof an&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new an(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class ln{constructor(e,t){this.position=e,this.inclusive=t}}function on(e,t,n){let r=0;for(let s=0;s<e.position.length;s++){const a=t[s],i=e.position[s];if(r=a.field.isKeyField()?ie.comparator(ie.fromName(i.referenceValue),n.key):Kt(i,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function cn(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!zt(e.position[n],t.position[n]))return!1;return!0}class un{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function dn(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class hn{}class mn extends hn{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new wn(e,t,n):"array-contains"===t?new Sn(e,n):"in"===t?new Cn(e,n):"not-in"===t?new En(e,n):"array-contains-any"===t?new An(e,n):new mn(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new jn(e,n):new Nn(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(Kt(t,this.value)):null!==t&&Vt(this.value)===Vt(t)&&this.matchesComparison(Kt(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return D(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class pn extends hn{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new pn(e,t)}matches(e){return fn(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function fn(e){return"and"===e.op}function gn(e){return xn(e)&&fn(e)}function xn(e){for(const t of e.filters)if(t instanceof pn)return!1;return!0}function yn(e){if(e instanceof mn)return e.field.canonicalString()+e.op.toString()+Ht(e.value);if(gn(e))return e.filters.map(e=>yn(e)).join(",");{const t=e.filters.map(e=>yn(e)).join(",");return"".concat(e.op,"(").concat(t,")")}}function vn(e,t){return e instanceof mn?function(e,t){return t instanceof mn&&e.op===t.op&&e.field.isEqual(t.field)&&zt(e.value,t.value)}(e,t):e instanceof pn?function(e,t){return t instanceof pn&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&vn(n,t.filters[r]),!0)}(e,t):void D(19439)}function bn(e){return e instanceof mn?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(Ht(e.value))}(e):e instanceof pn?function(e){return e.op.toString()+" {"+e.getFilters().map(bn).join(" ,")+"}"}(e):"Filter"}class wn extends mn{constructor(e,t,n){super(e,t,n),this.key=ie.fromName(n.referenceValue)}matches(e){const t=ie.comparator(e.key,this.key);return this.matchesComparison(t)}}class jn extends mn{constructor(e,t){super(e,"in",t),this.keys=kn("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Nn extends mn{constructor(e,t){super(e,"not-in",t),this.keys=kn("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function kn(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>ie.fromName(e.referenceValue))}class Sn extends mn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Zt(t)&&Ut(t.arrayValue,this.value)}}class Cn extends mn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Ut(this.value.arrayValue,t)}}class En extends mn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ut(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!Ut(this.value.arrayValue,t)}}class An extends mn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Zt(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>Ut(this.value.arrayValue,e))}}class In{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=a,this.endAt=i,this.Te=null}}function _n(e){return new In(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Tn(e){const t=R(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>yn(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),Pe(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>Ht(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>Ht(e)).join(",")),t.Te=e}return t.Te}function Dn(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!dn(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!vn(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!cn(e.startAt,t.startAt)&&cn(e.endAt,t.endAt)}function Pn(e){return ie.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Mn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=a,this.startAt=i,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Rn(e,t,n,r,s,a,i,l){return new Mn(e,t,n,r,s,a,i,l)}function On(e){return new Mn(e)}function Ln(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Fn(e){return null!==e.collectionGroup}function Vn(e){const t=R(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const s of t.explicitOrderBy)t.Ie.push(s),e.add(s.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new ft(ae.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new un(r,n))}),e.has(ae.keyField().canonicalString())||t.Ie.push(new un(ae.keyField(),n))}return t.Ie}function zn(e){const t=R(e);return t.Ee||(t.Ee=Un(t,Vn(e))),t.Ee}function Un(e,t){if("F"===e.limitType)return _n(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new un(e.field,t)});const n=e.endAt?new ln(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new ln(e.startAt.position,e.startAt.inclusive):null;return _n(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Kn(e,t){const n=e.filters.concat([t]);return new Mn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Bn(e,t,n){return new Mn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function qn(e,t){return Dn(zn(e),zn(t))&&e.limitType===t.limitType}function Hn(e){return"".concat(Tn(zn(e)),"|lt:").concat(e.limitType)}function Gn(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>bn(e)).join(", "),"]")),Pe(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>Ht(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>Ht(e)).join(",")),"Target(".concat(t,")")}(zn(e)),"; limitType=").concat(e.limitType,")")}function Wn(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):ie.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Vn(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=on(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Vn(e),t))&&!(e.endAt&&!function(e,t,n){const r=on(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Vn(e),t))}(e,t)}function Qn(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Jn(e){return(t,n)=>{let r=!1;for(const s of Vn(e)){const e=Zn(s,t,n);if(0!==e)return e;r=r||s.field.isKeyField()}return 0}}function Zn(e,t,n){const r=e.field.isKeyField()?ie.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),s=n.data.field(e);return null!==r&&null!==s?Kt(r,s):D(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return D(19790,{direction:e.dir})}}class Xn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,s]of n)if(this.equalsFn(r,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ut(this.inner,(t,n)=>{for(const[r,s]of n)e(r,s)})}isEmpty(){return dt(this.inner)}size(){return this.innerSize}}const Yn=new ht(ie.comparator);function $n(){return Yn}const er=new ht(ie.comparator);function tr(){let e=er;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const s of n)e=e.insert(s.key,s);return e}function nr(e){let t=er;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function rr(){return ar()}function sr(){return ar()}function ar(){return new Xn(e=>e.toString(),(e,t)=>e.isEqual(t))}const ir=new ht(ie.comparator),lr=new ft(ie.comparator);function or(){let e=lr;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const s of n)e=e.add(s);return e}const cr=new ft(J);function ur(){return cr}function dr(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Me(t)?"-0":t}}function hr(e){return{integerValue:""+e}}function mr(e,t){return Re(t)?hr(t):dr(e,t)}class pr{constructor(){this._=void 0}}function fr(e,t,n){return e instanceof yr?function(e,t){const n={fields:{[St]:{stringValue:kt},[Et]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&At(t)&&(t=It(t)),t&&(n.fields[Ct]=t),{mapValue:n}}(n,t):e instanceof vr?br(e,t):e instanceof wr?jr(e,t):function(e,t){const n=xr(e,t),r=kr(n)+kr(e.Ae);return Jt(n)&&Jt(e.Ae)?hr(r):dr(e.serializer,r)}(e,t)}function gr(e,t,n){return e instanceof vr?br(e,t):e instanceof wr?jr(e,t):n}function xr(e,t){return e instanceof Nr?function(e){return Jt(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class yr extends pr{}class vr extends pr{constructor(e){super(),this.elements=e}}function br(e,t){const n=Sr(t);for(const r of e.elements)n.some(e=>zt(e,r))||n.push(r);return{arrayValue:{values:n}}}class wr extends pr{constructor(e){super(),this.elements=e}}function jr(e,t){let n=Sr(t);for(const r of e.elements)n=n.filter(e=>!zt(e,r));return{arrayValue:{values:n}}}class Nr extends pr{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function kr(e){return jt(e.integerValue||e.doubleValue)}function Sr(e){return Zt(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Cr{constructor(e,t){this.field=e,this.transform=t}}class Er{constructor(e,t){this.version=e,this.transformResults=t}}class Ar{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ar}static exists(e){return new Ar(void 0,e)}static updateTime(e){return new Ar(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ir(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class _r{}function Tr(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Ur(e.key,Ar.none()):new Or(e.key,e.data,Ar.none());{const n=e.data,r=rn.empty();let s=new ft(ae.comparator);for(let e of t.fields)if(!s.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),s=s.add(e)}return new Lr(e.key,r,new xt(s.toArray()),Ar.none())}}function Dr(e,t,n){e instanceof Or?function(e,t,n){const r=e.value.clone(),s=Vr(e.fieldTransforms,t,n.transformResults);r.setAll(s),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Lr?function(e,t,n){if(!Ir(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Vr(e.fieldTransforms,t,n.transformResults),s=t.data;s.setAll(Fr(e)),s.setAll(r),t.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Pr(e,t,n,r){return e instanceof Or?function(e,t,n,r){if(!Ir(e.precondition,t))return n;const s=e.value.clone(),a=zr(e.fieldTransforms,r,t);return s.setAll(a),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null}(e,t,n,r):e instanceof Lr?function(e,t,n,r){if(!Ir(e.precondition,t))return n;const s=zr(e.fieldTransforms,r,t),a=t.data;return a.setAll(Fr(e)),a.setAll(s),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return Ir(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Mr(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),s=xr(r.transform,e||null);null!=s&&(null===n&&(n=rn.empty()),n.set(r.field,s))}return n||null}function Rr(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&ee(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof vr&&t instanceof vr||e instanceof wr&&t instanceof wr?ee(e.elements,t.elements,zt):e instanceof Nr&&t instanceof Nr?zt(e.Ae,t.Ae):e instanceof yr&&t instanceof yr}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Or extends _r{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Lr extends _r{constructor(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Fr(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function Vr(e,t,n){const r=new Map;M(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let s=0;s<n.length;s++){const a=e[s],i=a.transform,l=t.data.field(a.field);r.set(a.field,gr(i,l,n[s]))}return r}function zr(e,t,n){const r=new Map;for(const s of e){const e=s.transform,a=n.data.field(s.field);r.set(s.field,fr(e,a,t))}return r}class Ur extends _r{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Kr extends _r{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Br{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Dr(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Pr(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Pr(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=sr();return this.mutations.forEach(r=>{const s=e.get(r.key),a=s.overlayedDocument;let i=this.applyToLocalView(a,s.mutatedFields);i=t.has(r.key)?null:i;const l=Tr(a,i);null!==l&&n.set(r.key,l),a.isValidDocument()||a.convertToNoDocument(ye.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),or())}isEqual(e){return this.batchId===e.batchId&&ee(this.mutations,e.mutations,(e,t)=>Rr(e,t))&&ee(this.baseMutations,e.baseMutations,(e,t)=>Rr(e,t))}}class qr{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){M(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=ir;const s=e.mutations;for(let a=0;a<s.length;a++)r=r.insert(s[a].key,n[a].version);return new qr(e,t,n,r)}}class Hr{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class Gr{constructor(e,t){this.count=e,this.unchangedNames=t}}var Wr,Qr;function Jr(e){switch(e){case O.OK:return D(64938);case O.CANCELLED:case O.UNKNOWN:case O.DEADLINE_EXCEEDED:case O.RESOURCE_EXHAUSTED:case O.INTERNAL:case O.UNAVAILABLE:case O.UNAUTHENTICATED:return!1;case O.INVALID_ARGUMENT:case O.NOT_FOUND:case O.ALREADY_EXISTS:case O.PERMISSION_DENIED:case O.FAILED_PRECONDITION:case O.ABORTED:case O.OUT_OF_RANGE:case O.UNIMPLEMENTED:case O.DATA_LOSS:return!0;default:return D(15467,{code:e})}}function Zr(e){if(void 0===e)return I("GRPC error has no .code"),O.UNKNOWN;switch(e){case Wr.OK:return O.OK;case Wr.CANCELLED:return O.CANCELLED;case Wr.UNKNOWN:return O.UNKNOWN;case Wr.DEADLINE_EXCEEDED:return O.DEADLINE_EXCEEDED;case Wr.RESOURCE_EXHAUSTED:return O.RESOURCE_EXHAUSTED;case Wr.INTERNAL:return O.INTERNAL;case Wr.UNAVAILABLE:return O.UNAVAILABLE;case Wr.UNAUTHENTICATED:return O.UNAUTHENTICATED;case Wr.INVALID_ARGUMENT:return O.INVALID_ARGUMENT;case Wr.NOT_FOUND:return O.NOT_FOUND;case Wr.ALREADY_EXISTS:return O.ALREADY_EXISTS;case Wr.PERMISSION_DENIED:return O.PERMISSION_DENIED;case Wr.FAILED_PRECONDITION:return O.FAILED_PRECONDITION;case Wr.ABORTED:return O.ABORTED;case Wr.OUT_OF_RANGE:return O.OUT_OF_RANGE;case Wr.UNIMPLEMENTED:return O.UNIMPLEMENTED;case Wr.DATA_LOSS:return O.DATA_LOSS;default:return D(39323,{code:e})}}(Qr=Wr||(Wr={}))[Qr.OK=0]="OK",Qr[Qr.CANCELLED=1]="CANCELLED",Qr[Qr.UNKNOWN=2]="UNKNOWN",Qr[Qr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qr[Qr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qr[Qr.NOT_FOUND=5]="NOT_FOUND",Qr[Qr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qr[Qr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qr[Qr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qr[Qr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qr[Qr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qr[Qr.ABORTED=10]="ABORTED",Qr[Qr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qr[Qr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qr[Qr.INTERNAL=13]="INTERNAL",Qr[Qr.UNAVAILABLE=14]="UNAVAILABLE",Qr[Qr.DATA_LOSS=15]="DATA_LOSS";let Xr=null;function Yr(){return new TextEncoder}const $r=new r([4294967295,4294967295],0);function es(e){const t=Yr().encode(e),n=new s;return n.update(t),new Uint8Array(n.digest())}function ts(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),s=t.getUint32(4,!0),a=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new r([n,s],0),new r([a,i],0)]}class ns{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new rs("Invalid padding: ".concat(t));if(n<0)throw new rs("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new rs("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new rs("Invalid padding when bitmap length is 0: ".concat(t));this.ge=8*e.length-t,this.pe=r.fromNumber(this.ge)}ye(e,t,n){let s=e.add(t.multiply(r.fromNumber(n)));return 1===s.compare($r)&&(s=new r([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;const t=es(e),[n,r]=ts(t);for(let s=0;s<this.hashCount;s++){const e=this.ye(n,r,s);if(!this.we(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new ns(s,r,t);return n.forEach(e=>a.insert(e)),a}insert(e){if(0===this.ge)return;const t=es(e),[n,r]=ts(t);for(let s=0;s<this.hashCount;s++){const e=this.ye(n,r,s);this.Se(e)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class rs extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class ss{constructor(e,t,n,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,as.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new ss(ye.min(),r,new ht(J),$n(),or())}}class as{constructor(e,t,n,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new as(n,t,or(),or(),or())}}class is{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class ls{constructor(e,t){this.targetId=e,this.Ce=t}}class os{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vt.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class cs{constructor(){this.ve=0,this.Fe=hs(),this.Me=vt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=or(),t=or(),n=or();return this.Fe.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:D(38017,{changeType:s})}}),new as(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=hs()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,M(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class us{constructor(e){this.Ge=e,this.ze=new Map,this.je=$n(),this.Je=ds(),this.He=ds(),this.Ye=new ht(J)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:D(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,n)=>{this.rt(n)&&t(n)})}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const a=r.target;if(Pn(a))if(0===n){const e=new ie(a.path);this.et(t,e,an.newNoDocument(e,ye.min()))}else M(1===n,20013,{expectedCount:n});else{const r=this._t(t);if(r!==n){var s;const n=this.ut(e),a=n?this.ct(n,e,r):1;if(0!==a){this.it(t);const e=2===a?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,e)}null===(s=Xr)||void 0===s||s.lt(function(e,t,n,r,s,a,i,l,o,c){const u={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},d=t.unchangedNames;return d&&(u.bloomFilter={applied:0===s,hashCount:null!==(a=null===d||void 0===d?void 0:d.hashCount)&&void 0!==a?a:0,bitmapLength:null!==(i=null===d||void 0===d||null===(l=d.bits)||void 0===l||null===(l=l.bitmap)||void 0===l?void 0:l.length)&&void 0!==i?i:0,padding:null!==(o=null===d||void 0===d||null===(c=d.bits)||void 0===c?void 0:c.padding)&&void 0!==o?o:0,mightContain:e=>{var t;return null!==(t=null===r||void 0===r?void 0:r.mightContain(e))&&void 0!==t&&t}}),u}(r,e.Ce,this.Ge.ht(),n,a))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:s=0}=t;let a,i;try{a=Nt(n).toUint8Array()}catch(e){if(e instanceof yt)return _("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{i=new ns(a,r,s)}catch(e){return _(e instanceof rs?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===i.ge?null:i}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const s=this.Ge.ht(),a="projects/".concat(s.projectId,"/databases/").concat(s.database,"/documents/").concat(n.path.canonicalString());e.mightContain(a)||(this.et(t,n,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((n,r)=>{const s=this.ot(r);if(s){if(n.current&&Pn(s.target)){const t=new ie(s.target.path);this.It(t).has(r)||this.Et(r,t)||this.et(r,t,an.newNoDocument(t,e))}n.Be&&(t.set(r,n.ke()),n.qe())}});let n=or();this.He.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.je.forEach((t,n)=>n.setReadTime(e));const r=new ss(e,t,this.Ye,this.je,n);return this.je=$n(),this.Je=ds(),this.He=ds(),this.Ye=new ht(J),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new cs,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new ft(J),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new ft(J),this.Je=this.Je.insert(e,t)),t}rt(e){const t=null!==this.ot(e);return t||A("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new cs),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ds(){return new ht(ie.comparator)}function hs(){return new ht(ie.comparator)}const ms={asc:"ASCENDING",desc:"DESCENDING"},ps={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},fs={and:"AND",or:"OR"};class gs{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function xs(e,t){return e.useProto3Json||Pe(t)?t:{value:t}}function ys(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function vs(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function bs(e,t){return ys(e,t.toTimestamp())}function ws(e){return M(!!e,49232),ye.fromTimestamp(function(e){const t=wt(e);return new xe(t.seconds,t.nanos)}(e))}function js(e,t){return Ns(e,t).canonicalString()}function Ns(e,t){const n=function(e){return new re(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function ks(e){const t=re.fromString(e);return M(qs(t),10190,{key:t.toString()}),t}function Ss(e,t){return js(e.databaseId,t.path)}function Cs(e,t){const n=ks(t);if(n.get(1)!==e.databaseId.projectId)throw new L(O.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new L(O.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new ie(_s(n))}function Es(e,t){return js(e.databaseId,t)}function As(e){const t=ks(e);return 4===t.length?re.emptyPath():_s(t)}function Is(e){return new re(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function _s(e){return M(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function Ts(e,t,n){return{name:Ss(e,t),fields:n.value.mapValue.fields}}function Ds(e,t){let n;if(t instanceof Or)n={update:Ts(e,t.key,t.value)};else if(t instanceof Ur)n={delete:Ss(e,t.key)};else if(t instanceof Lr)n={update:Ts(e,t.key,t.data),updateMask:Bs(t.fieldMask)};else{if(!(t instanceof Kr))return D(16599,{Vt:t.type});n={verify:Ss(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof yr)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof vr)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof wr)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Nr)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw D(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:bs(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:D(27497)}(e,t.precondition)),n}function Ps(e,t){return{documents:[Es(e,t.path)]}}function Ms(e,t){const n={structuredQuery:{}},r=t.path;let s;null!==t.collectionGroup?(s=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Es(e,s);const a=function(e){if(0!==e.length)return Ks(pn.create(e,"and"))}(t.filters);a&&(n.structuredQuery.where=a);const i=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:zs(e.field),direction:Ls(e.dir)}}(e))}(t.orderBy);i&&(n.structuredQuery.orderBy=i);const l=xs(e,t.limit);return null!==l&&(n.structuredQuery.limit=l),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:n,parent:s}}function Rs(e){let t=As(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){M(1===r,65062);const e=n.from[0];e.allDescendants?s=e.collectionId:t=t.child(e.collectionId)}let a=[];n.where&&(a=function(e){const t=Os(e);return t instanceof pn&&gn(t)?t.getFilters():[t]}(n.where));let i=[];n.orderBy&&(i=function(e){return e.map(e=>function(e){return new un(Us(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let l=null;n.limit&&(l=function(e){let t;return t="object"==typeof e?e.value:e,Pe(t)?null:t}(n.limit));let o=null;n.startAt&&(o=function(e){const t=!!e.before,n=e.values||[];return new ln(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new ln(n,t)}(n.endAt)),Rn(t,s,i,a,l,"F",o,c)}function Os(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Us(e.unaryFilter.field);return mn.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Us(e.unaryFilter.field);return mn.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Us(e.unaryFilter.field);return mn.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Us(e.unaryFilter.field);return mn.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return D(61313);default:return D(60726)}}(e):void 0!==e.fieldFilter?function(e){return mn.create(Us(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return D(58110);default:return D(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return pn.create(e.compositeFilter.filters.map(e=>Os(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return D(1026)}}(e.compositeFilter.op))}(e):D(30097,{filter:e})}function Ls(e){return ms[e]}function Fs(e){return ps[e]}function Vs(e){return fs[e]}function zs(e){return{fieldPath:e.canonicalString()}}function Us(e){return ae.fromServerFormat(e.fieldPath)}function Ks(e){return e instanceof mn?function(e){if("=="===e.op){if(Yt(e.value))return{unaryFilter:{field:zs(e.field),op:"IS_NAN"}};if(Xt(e.value))return{unaryFilter:{field:zs(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Yt(e.value))return{unaryFilter:{field:zs(e.field),op:"IS_NOT_NAN"}};if(Xt(e.value))return{unaryFilter:{field:zs(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zs(e.field),op:Fs(e.op),value:e.value}}}(e):e instanceof pn?function(e){const t=e.getFilters().map(e=>Ks(e));return 1===t.length?t[0]:{compositeFilter:{op:Vs(e.op),filters:t}}}(e):D(54877,{filter:e})}function Bs(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function qs(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Hs{constructor(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ye.min(),a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:ye.min(),i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:vt.EMPTY_BYTE_STRING,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=i,this.expectedCount=l}withSequenceNumber(e){return new Hs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Hs(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Hs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Hs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Gs{constructor(e){this.yt=e}}function Ws(e){const t=Rs({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Bn(t,t.limit,"L"):t}class Qs{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(jt(e.integerValue));else if("doubleValue"in e){const n=jt(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),Me(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),"string"==typeof n&&(n=wt(n)),t.xt("".concat(n.seconds||"")),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Nt(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?nn(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):en(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):D(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const r of Object.keys(n))this.Ot(r,t),this.Ct(n[r],t)}kt(e,t){var n;const r=e.fields||{};this.Ft(t,53);const s=Ft,a=(null===(n=r[s].arrayValue)||void 0===n||null===(n=n.values)||void 0===n?void 0:n.length)||0;this.Ft(t,15),t.Mt(jt(a)),this.Ot(s,t),this.Ct(r[s],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const r of n)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),ie.fromName(e).path.forEach(e=>{this.Ft(t,60),this.Ut(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Qs.Kt=new Qs;class Js{constructor(){this.Cn=new Zs}addToCollectionParentIndex(e,t){return this.Cn.add(t),Ae.resolve()}getCollectionParents(e,t){return Ae.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Ae.resolve()}deleteFieldIndex(e,t){return Ae.resolve()}deleteAllFieldIndexes(e){return Ae.resolve()}createTargetIndexes(e,t){return Ae.resolve()}getDocumentsMatchingTarget(e,t){return Ae.resolve(null)}getIndexType(e,t){return Ae.resolve(0)}getFieldIndexes(e,t){return Ae.resolve([])}getNextCollectionGroupToUpdate(e){return Ae.resolve(null)}getMinOffset(e,t){return Ae.resolve(Ne.min())}getMinOffsetFromCollectionGroup(e,t){return Ae.resolve(Ne.min())}updateCollectionGroup(e,t,n){return Ae.resolve()}updateIndexEntries(e,t){return Ae.resolve()}}class Zs{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new ft(re.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new ft(re.comparator)).toArray()}}new Uint8Array(0);const Xs={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Ys=41943040;class $s{static withCacheSize(e){return new $s(e,$s.DEFAULT_COLLECTION_PERCENTILE,$s.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}$s.DEFAULT_COLLECTION_PERCENTILE=10,$s.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,$s.DEFAULT=new $s(Ys,$s.DEFAULT_COLLECTION_PERCENTILE,$s.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),$s.DISABLED=new $s(-1,0,0);class ea{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ea(0)}static cr(){return new ea(-1)}}const ta="LruGarbageCollector",na=1048576;function ra(e,t){let[n,r]=e,[s,a]=t;const i=J(n,s);return 0===i?J(r,a):i}class sa{constructor(e){this.Ir=e,this.buffer=new ft(ra),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();ra(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class aa{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){A(ta,"Garbage collection scheduled in ".concat(e,"ms")),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){_e(e)?A(ta,"Ignoring IndexedDB error during garbage collection: ",e):await Ee(e)}await this.Vr(3e5)})}}class ia{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return Ae.resolve(Te.ce);const n=new sa(t);return this.mr.forEachTarget(e,e=>n.Ar(e.sequenceNumber)).next(()=>this.mr.pr(e,e=>n.Ar(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(A("LruGarbageCollector","Garbage collection skipped; disabled"),Ae.resolve(Xs)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(A("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(n," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),Xs):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,s,a,i,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(A("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=this.params.maximumSequenceNumbersToCollect):r=t,a=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,i=Date.now(),this.removeTargets(e,n,t))).next(t=>(s=t,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(c=Date.now(),E()<=o.$b.DEBUG&&A("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(a-u,"ms\n\tDetermined least recently used ").concat(r," in ")+(i-a)+"ms\n"+"\tRemoved ".concat(s," targets in ")+(l-i)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(c-l)+"ms\n"+"Total Duration: ".concat(c-u,"ms")),Ae.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:e})))}}function la(e,t){return new ia(e,t)}class oa{constructor(){this.changes=new Xn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,an.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Ae.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class ca{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ua{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&Pr(n.mutation,e,xt.empty(),xe.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,or()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:or();const r=rr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=tr();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=rr();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,or()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let s=$n();const a=ar(),i=ar();return t.forEach((e,t)=>{const i=n.get(t.key);r.has(t.key)&&(void 0===i||i.mutation instanceof Lr)?s=s.insert(t.key,t):void 0!==i?(a.set(t.key,i.mutation.getFieldMask()),Pr(i.mutation,t,i.mutation.getFieldMask(),xe.now())):a.set(t.key,xt.empty())}),this.recalculateAndSaveOverlays(e,s).next(e=>(e.forEach((e,t)=>a.set(e,t)),t.forEach((e,t)=>{var n;return i.set(e,new ca(t,null!==(n=a.get(e))&&void 0!==n?n:null))}),i))}recalculateAndSaveOverlays(e,t){const n=ar();let r=new ht((e,t)=>e-t),s=or();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const s of e)s.keys().forEach(e=>{const a=t.get(e);if(null===a)return;let i=n.get(e)||xt.empty();i=s.applyToLocalView(a,i),n.set(e,i);const l=(r.get(s.batchId)||or()).add(e);r=r.insert(s.batchId,l)})}).next(()=>{const a=[],i=r.getReverseIterator();for(;i.hasNext();){const r=i.getNext(),l=r.key,o=r.value,c=sr();o.forEach(e=>{if(!s.has(e)){const r=Tr(t.get(e),n.get(e));null!==r&&c.set(e,r),s=s.add(e)}}),a.push(this.documentOverlayCache.saveOverlays(e,l,c))}return Ae.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return ie.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Fn(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(s=>{const a=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-s.size):Ae.resolve(rr());let i=ve,l=s;return a.next(t=>Ae.forEach(t,(t,n)=>(i<n.largestBatchId&&(i=n.largestBatchId),s.get(t)?Ae.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{l=l.insert(t,e)}))).next(()=>this.populateOverlays(e,t,s)).next(()=>this.computeViews(e,l,t,or())).next(e=>({batchId:i,changes:nr(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ie(t)).next(e=>{let t=tr();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const s=t.collectionGroup;let a=tr();return this.indexManager.getCollectionParents(e,s).next(i=>Ae.forEach(i,i=>{const l=function(e,t){return new Mn(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,i.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,n,r).next(e=>{e.forEach((e,t)=>{a=a.insert(e,t)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,r))).next(e=>{s.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,an.newInvalidDocument(r)))});let n=tr();return e.forEach((e,r)=>{const a=s.get(e);void 0!==a&&Pr(a.mutation,r,xt.empty(),xe.now()),Wn(t,r)&&(n=n.insert(e,r))}),n})}}class da{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Ae.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:ws(e.createTime)}}(t)),Ae.resolve()}getNamedQuery(e,t){return Ae.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:Ws(e.bundledQuery),readTime:ws(e.readTime)}}(t)),Ae.resolve()}}class ha{constructor(){this.overlays=new ht(ie.comparator),this.qr=new Map}getOverlay(e,t){return Ae.resolve(this.overlays.get(t))}getOverlays(e,t){const n=rr();return Ae.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.St(e,t,r)}),Ae.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(n)),Ae.resolve()}getOverlaysForCollection(e,t,n){const r=rr(),s=t.length+1,a=new ie(t.child("")),i=this.overlays.getIteratorFrom(a);for(;i.hasNext();){const e=i.getNext().value,a=e.getKey();if(!t.isPrefixOf(a.path))break;a.path.length===s&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Ae.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let s=new ht((e,t)=>e-t);const a=this.overlays.getIterator();for(;a.hasNext();){const e=a.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=s.get(e.largestBatchId);null===t&&(t=rr(),s=s.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const i=rr(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((e,t)=>i.set(e,t)),!(i.size()>=r)););return Ae.resolve(i)}St(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Hr(t,n));let s=this.qr.get(t);void 0===s&&(s=or(),this.qr.set(t,s)),this.qr.set(t,s.add(n.key))}}class ma{constructor(){this.sessionToken=vt.EMPTY_BYTE_STRING}getSessionToken(e){return Ae.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ae.resolve()}}class pa{constructor(){this.Qr=new ft(fa.$r),this.Ur=new ft(fa.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new fa(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new fa(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){const t=new ie(new re([])),n=new fa(t,e),r=new fa(t,e+1),s=[];return this.Ur.forEachInRange([n,r],e=>{this.Gr(e),s.push(e.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ie(new re([])),n=new fa(t,e),r=new fa(t,e+1);let s=or();return this.Ur.forEachInRange([n,r],e=>{s=s.add(e.key)}),s}containsKey(e){const t=new fa(e,0),n=this.Qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class fa{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ie.comparator(e.key,t.key)||J(e.Yr,t.Yr)}static Kr(e,t){return J(e.Yr,t.Yr)||ie.comparator(e.key,t.key)}}class ga{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new ft(fa.$r)}checkEmpty(e){return Ae.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Br(s,t,n,r);this.mutationQueue.push(a);for(const i of r)this.Zr=this.Zr.add(new fa(i.key,s)),this.indexManager.addToCollectionParentIndex(e,i.key.path.popLast());return Ae.resolve(a)}lookupMutationBatch(e,t){return Ae.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),s=r<0?0:r;return Ae.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Ae.resolve(0===this.mutationQueue.length?De:this.tr-1)}getAllMutationBatches(e){return Ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new fa(t,0),r=new fa(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([n,r],e=>{const t=this.Xr(e.Yr);s.push(t)}),Ae.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new ft(J);return t.forEach(e=>{const t=new fa(e,0),r=new fa(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,r],e=>{n=n.add(e.Yr)})}),Ae.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let s=n;ie.isDocumentKey(s)||(s=s.child(""));const a=new fa(new ie(s),0);let i=new ft(J);return this.Zr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(i=i.add(e.Yr)),!0)},a),Ae.resolve(this.ti(i))}ti(e){const t=[];return e.forEach(e=>{const n=this.Xr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){M(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Zr;return Ae.forEach(t.mutations,r=>{const s=new fa(r.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new fa(t,0),r=this.Zr.firstAfterOrEqual(n);return Ae.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ae.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class xa{constructor(e){this.ri=e,this.docs=new ht(ie.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),s=r?r.size:0,a=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Ae.resolve(n?n.document.mutableCopy():an.newInvalidDocument(t))}getEntries(e,t){let n=$n();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():an.newInvalidDocument(e))}),Ae.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let s=$n();const a=t.path,i=new ie(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(i);for(;l.hasNext();){const{key:e,value:{document:i}}=l.getNext();if(!a.isPrefixOf(e.path))break;e.path.length>a.length+1||ke(je(i),n)<=0||(r.has(i.key)||Wn(t,i))&&(s=s.insert(i.key,i.mutableCopy()))}return Ae.resolve(s)}getAllFromCollectionGroup(e,t,n,r){D(9500)}ii(e,t){return Ae.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new ya(this)}getSize(e){return Ae.resolve(this.size)}}class ya extends oa{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),Ae.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class va{constructor(e){this.persistence=e,this.si=new Xn(e=>Tn(e),Dn),this.lastRemoteSnapshotVersion=ye.min(),this.highestTargetId=0,this.oi=0,this._i=new pa,this.targetCount=0,this.ai=ea.ur()}forEachTarget(e,t){return this.si.forEach((e,n)=>t(n)),Ae.resolve()}getLastRemoteSnapshotVersion(e){return Ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ae.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Ae.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),Ae.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new ea(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Ae.resolve()}updateTargetData(e,t){return this.Pr(t),Ae.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Ae.resolve()}removeTargets(e,t,n){let r=0;const s=[];return this.si.forEach((a,i)=>{i.sequenceNumber<=t&&null===n.get(i.targetId)&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,i.targetId)),r++)}),Ae.waitFor(s).next(()=>r)}getTargetCount(e){return Ae.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return Ae.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),Ae.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(t=>{s.push(r.markPotentiallyOrphaned(e,t))}),Ae.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Ae.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return Ae.resolve(n)}containsKey(e,t){return Ae.resolve(this._i.containsKey(t))}}class ba{constructor(e,t){this.ui={},this.overlays={},this.ci=new Te(0),this.li=!1,this.li=!0,this.hi=new ma,this.referenceDelegate=e(this),this.Pi=new va(this),this.indexManager=new Js,this.remoteDocumentCache=function(e){return new xa(e)}(e=>this.referenceDelegate.Ti(e)),this.serializer=new Gs(t),this.Ii=new da(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ha,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new ga(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){A("MemoryPersistence","Starting transaction:",e);const r=new wa(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ai(e,t){return Ae.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class wa extends Ce{constructor(e){super(),this.currentSequenceNumber=e}}class ja{constructor(e){this.persistence=e,this.Ri=new pa,this.Vi=null}static mi(e){return new ja(e)}get fi(){if(this.Vi)return this.Vi;throw D(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),Ae.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),Ae.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Ae.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ae.forEach(this.fi,n=>{const r=ie.fromPath(n);return this.gi(e,r).next(e=>{e||t.removeEntry(r,ye.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return Ae.or([()=>Ae.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Na{constructor(e,t){this.persistence=e,this.pi=new Xn(e=>Le(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=la(this,t)}static mi(e,t){return new Na(e,t)}Ei(){}di(e){return Ae.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}pr(e,t){return Ae.forEach(this.pi,(n,r)=>this.br(e,n,r).next(e=>e?Ae.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ii(e,r=>this.br(e,r,t).next(e=>{e||(n++,s.removeEntry(r,ye.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Ae.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),Ae.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),Ae.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Ae.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Wt(e.data.value)),t}br(e,t,n){return Ae.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.pi.get(t);return Ae.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ka{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=or(),r=or();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new ka(e,t.fromCache,n,r)}}class Sa{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Ca{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(0,c.nr)()?8:Ie((0,c.ZQ)())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const s={result:null};return this.ys(e,t).next(e=>{s.result=e}).next(()=>{if(!s.result)return this.ws(e,t,r,n).next(e=>{s.result=e})}).next(()=>{if(s.result)return;const n=new Sa;return this.Ss(e,t,n).next(r=>{if(s.result=r,this.Vs)return this.bs(e,t,n,r.size)})}).next(()=>s.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(E()<=o.$b.DEBUG&&A("QueryEngine","SDK will not create cache indexes for query:",Gn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Ae.resolve()):(E()<=o.$b.DEBUG&&A("QueryEngine","Query:",Gn(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(E()<=o.$b.DEBUG&&A("QueryEngine","The SDK decides to create cache indexes for query:",Gn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,zn(t))):Ae.resolve())}ys(e,t){if(Ln(t))return Ae.resolve(null);let n=zn(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=Bn(t,null,"F"),n=zn(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const s=or(...r);return this.ps.getDocuments(e,s).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const a=this.Ds(t,r);return this.Cs(t,a,s,n.readTime)?this.ys(e,Bn(t,null,"F")):this.vs(e,a,t,n)}))})))}ws(e,t,n,r){return Ln(t)||r.isEqual(ye.min())?Ae.resolve(null):this.ps.getDocuments(e,n).next(s=>{const a=this.Ds(t,s);return this.Cs(t,a,n,r)?Ae.resolve(null):(E()<=o.$b.DEBUG&&A("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Gn(t)),this.vs(e,a,t,we(r,ve)).next(e=>e))})}Ds(e,t){let n=new ft(Jn(e));return t.forEach((t,r)=>{Wn(e,r)&&(n=n.add(r))}),n}Cs(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,n){return E()<=o.$b.DEBUG&&A("QueryEngine","Using full collection scan to execute query:",Gn(t)),this.ps.getDocumentsMatchingQuery(e,t,Ne.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const Ea="LocalStore",Aa=3e8;class Ia{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new ht(J),this.xs=new Xn(e=>Tn(e),Dn),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ua(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function _a(e,t,n,r){return new Ia(e,t,n,r)}async function Ta(e,t){const n=R(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(s=>(r=s,n.Bs(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const s=[],a=[];let i=or();for(const e of r){s.push(e.batchId);for(const t of e.mutations)i=i.add(t.key)}for(const e of t){a.push(e.batchId);for(const t of e.mutations)i=i.add(t.key)}return n.localDocuments.getDocuments(e,i).next(e=>({Ls:e,removedBatchIds:s,addedBatchIds:a}))})})}function Da(e){const t=R(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function Pa(e,t,n){let r=or(),s=or();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=$n();return n.forEach((n,a)=>{const i=e.get(n);a.isFoundDocument()!==i.isFoundDocument()&&(s=s.add(n)),a.isNoDocument()&&a.version.isEqual(ye.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!i.isValidDocument()||a.version.compareTo(i.version)>0||0===a.version.compareTo(i.version)&&i.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):A(Ea,"Ignoring outdated watch update for ",n,". Current version:",i.version," Watch version:",a.version)}),{ks:r,qs:s}})}function Ma(e,t){const n=R(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=De),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function Ra(e,t){const n=R(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Pi.getTargetData(e,t).next(s=>s?(r=s,Ae.resolve(r)):n.Pi.allocateTargetId(e).next(s=>(r=new Hs(t,s,"TargetPurposeListen",e.currentSequenceNumber),n.Pi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Ms.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(e.targetId,e),n.xs.set(t,e.targetId)),e})}async function Oa(e,t,n){const r=R(e),s=r.Ms.get(t),a=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",a,e=>r.persistence.referenceDelegate.removeTarget(e,s))}catch(e){if(!_e(e))throw e;A(Ea,"Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.Ms=r.Ms.remove(t),r.xs.delete(s.target)}function La(e,t,n){const r=R(e);let s=ye.min(),a=or();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=R(e),s=r.xs.get(n);return void 0!==s?Ae.resolve(r.Ms.get(s)):r.Pi.getTargetData(t,n)}(r,e,zn(t)).next(t=>{if(t)return s=t.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{a=e})}).next(()=>r.Fs.getDocumentsMatchingQuery(e,t,n?s:ye.min(),n?a:or())).next(e=>(Fa(r,Qn(t),e),{documents:e,Qs:a})))}function Fa(e,t,n){let r=e.Os.get(t)||ye.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Os.set(t,r)}class Va{constructor(){this.activeTargetIds=ur()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class za{constructor(){this.Mo=new Va,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Va,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Ua{Oo(e){}shutdown(){}}const Ka="ConnectivityMonitor";class Ba{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){A(Ka,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){A(Ka,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let qa=null;function Ha(){return null===qa?qa=268435456+Math.round(2147483648*Math.random()):qa++,"0x"+qa.toString(16)}const Ga="RestConnection",Wa={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Qa{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko="projects/".concat(n,"/databases/").concat(r),this.Wo=this.databaseId.database===Dt?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}Go(e,t,n,r,s){const a=Ha(),i=this.zo(e,t.toUriEncodedString());A(Ga,"Sending RPC '".concat(e,"' ").concat(a,":"),i,n);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,r,s);const{host:o}=new URL(i),u=(0,c.zJ)(o);return this.Jo(e,i,l,n,u).then(t=>(A(Ga,"Received RPC '".concat(e,"' ").concat(a,": "),t),t),t=>{throw _(Ga,"RPC '".concat(e,"' ").concat(a," failed with error: "),t,"url: ",i,"request:",n),t})}Ho(e,t,n,r,s,a){return this.Go(e,t,n,r,s)}jo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+S,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}zo(e,t){const n=Wa[e];return"".concat(this.Uo,"/v1/").concat(t,":").concat(n)}terminate(){}}class Ja{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Za="WebChannelConnection";class Xa extends Qa{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,s){const a=Ha();return new Promise((s,i)=>{const l=new h;l.setWithCredentials(!0),l.listenOnce(p.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case f.NO_ERROR:const n=l.getResponseJson();A(Za,"XHR for RPC '".concat(e,"' ").concat(a," received:"),JSON.stringify(n)),s(n);break;case f.TIMEOUT:A(Za,"RPC '".concat(e,"' ").concat(a," timed out")),i(new L(O.DEADLINE_EXCEEDED,"Request time out"));break;case f.HTTP_ERROR:const r=l.getStatus();if(A(Za,"RPC '".concat(e,"' ").concat(a," failed with status:"),r,"response text:",l.getResponseText()),r>0){var t;let e=l.getResponseJson();Array.isArray(e)&&(e=e[0]);const n=null===(t=e)||void 0===t?void 0:t.error;if(n&&n.status&&n.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(O).indexOf(t)>=0?t:O.UNKNOWN}(n.status);i(new L(e,n.message))}else i(new L(O.UNKNOWN,"Server responded with status "+l.getStatus()))}else i(new L(O.UNAVAILABLE,"Connection failed."));break;default:D(9055,{l_:e,streamId:a,h_:l.getLastErrorCode(),P_:l.getLastError()})}}finally{A(Za,"RPC '".concat(e,"' ").concat(a," completed."))}});const o=JSON.stringify(r);A(Za,"RPC '".concat(e,"' ").concat(a," sending request:"),r),l.send(t,"POST",o,n,15)})}T_(e,t,n){const r=Ha(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=v(),i=y(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},o=this.longPollingOptions.timeoutSeconds;void 0!==o&&(l.longPollingTimeout=Math.round(1e3*o)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,n),l.encodeInitMessageHeaders=!0;const c=s.join("");A(Za,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),l);const u=a.createWebChannel(c,l);this.I_(u);let d=!1,h=!1;const p=new Ja({Yo:t=>{h?A(Za,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(d||(A(Za,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),u.open(),d=!0),A(Za,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),u.send(t))},Zo:()=>u.close()}),f=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return f(u,m.EventType.OPEN,()=>{h||(A(Za,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),p.o_())}),f(u,m.EventType.CLOSE,()=>{h||(h=!0,A(Za,"RPC '".concat(e,"' stream ").concat(r," transport closed")),p.a_(),this.E_(u))}),f(u,m.EventType.ERROR,t=>{h||(h=!0,_(Za,"RPC '".concat(e,"' stream ").concat(r," transport errored. Name:"),t.name,"Message:",t.message),p.a_(new L(O.UNAVAILABLE,"The operation could not be completed")))}),f(u,m.EventType.MESSAGE,t=>{if(!h){var n;const s=t.data[0];M(!!s,16349);const a=s,i=(null===a||void 0===a?void 0:a.error)||(null===(n=a[0])||void 0===n?void 0:n.error);if(i){A(Za,"RPC '".concat(e,"' stream ").concat(r," received error:"),i);const t=i.status;let n=function(e){const t=Wr[e];if(void 0!==t)return Zr(t)}(t),s=i.message;void 0===n&&(n=O.INTERNAL,s="Unknown error status: "+t+" with message "+i.message),h=!0,p.a_(new L(n,s)),u.close()}else A(Za,"RPC '".concat(e,"' stream ").concat(r," received:"),s),p.u_(s)}}),f(i,x.STAT_EVENT,t=>{t.stat===g.PROXY?A(Za,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===g.NOPROXY&&A(Za,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))}),setTimeout(()=>{p.__()},0),p}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function Ya(){return"undefined"!=typeof document?document:null}function $a(e){return new gs(e,!0)}class ei{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&A("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.V_," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const ti="PersistentStream";class ni{constructor(e,t,n,r,s,a,i,l){this.Mi=e,this.S_=n,this.b_=r,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=i,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new ei(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===O.RESOURCE_EXHAUSTED?(I(t.toString()),I("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===O.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.D_===t&&this.G_(n,r)},t=>{e(()=>{const e=new L(O.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(e=>{n(()=>this.z_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.F_?this.J_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return A(ti,"close with error: ".concat(e)),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(A(ti,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class ri extends ni{constructor(e,t,n,r,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,a),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:D(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],a=function(e,t){return e.useProto3Json?(M(void 0===t||"string"==typeof t,58123),vt.fromBase64String(t||"")):(M(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),vt.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),i=t.targetChange.cause,l=i&&function(e){const t=void 0===e.code?O.UNKNOWN:Zr(e.code);return new L(t,e.message||"")}(i);n=new os(r,s,a,l||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const s=Cs(e,r.document.name),a=ws(r.document.updateTime),i=r.document.createTime?ws(r.document.createTime):ye.min(),l=new rn({mapValue:{fields:r.document.fields}}),o=an.newFoundDocument(s,a,i,l),c=r.targetIds||[],u=r.removedTargetIds||[];n=new is(c,u,o.key,o)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const s=Cs(e,r.document),a=r.readTime?ws(r.readTime):ye.min(),i=an.newNoDocument(s,a),l=r.removedTargetIds||[];n=new is([],l,i.key,i)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const s=Cs(e,r.document),a=r.removedTargetIds||[];n=new is([],a,s,null)}else{if(!("filter"in t))return D(11601,{Rt:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:s}=e,a=new Gr(r,s),i=e.targetId;n=new ls(i,a)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return ye.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?ye.min():t.readTime?ws(t.readTime):ye.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=Is(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Pn(r)?{documents:Ps(e,r)}:{query:Ms(e,r).ft},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=vs(e,t.resumeToken);const r=xs(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(ye.min())>0){n.readTime=ys(e,t.snapshotVersion.toTimestamp());const r=xs(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return D(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=Is(this.serializer),t.removeTarget=e,this.q_(t)}}class si extends ni{constructor(e,t,n,r,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return M(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,M(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){M(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function(e,t){return e&&e.length>0?(M(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?ws(e.updateTime):ws(t);return n.isEqual(ye.min())&&(n=ws(t)),new Er(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=ws(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Is(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>Ds(this.serializer,e))};this.q_(t)}}class ai{}class ii extends ai{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new L(O.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[a,i]=s;return this.connection.Go(e,Ns(t,n),r,a,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new L(O.UNKNOWN,e.toString())})}Ho(e,t,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(a=>{let[i,l]=a;return this.connection.Ho(e,Ns(t,n),r,i,l,s)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new L(O.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class li{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.aa?(I(t),this.aa=!1):A("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const oi="RemoteStore";class ci{constructor(e,t,n,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(e=>{n.enqueueAndForget(async()=>{yi(this)&&(A(oi,"Restarting streams for network reachability change."),await async function(e){const t=R(e);t.Ea.add(4),await di(t),t.Ra.set("Unknown"),t.Ea.delete(4),await ui(t)}(this))})}),this.Ra=new li(n,r)}}async function ui(e){if(yi(e))for(const t of e.da)await t(!0)}async function di(e){for(const t of e.da)await t(!1)}function hi(e,t){const n=R(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),xi(n)?gi(n):Li(n).O_()&&pi(n,t))}function mi(e,t){const n=R(e),r=Li(n);n.Ia.delete(t),r.O_()&&fi(n,t),0===n.Ia.size&&(r.O_()?r.L_():yi(n)&&n.Ra.set("Unknown"))}function pi(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(ye.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Li(e).Y_(t)}function fi(e,t){e.Va.Ue(t),Li(e).Z_(t)}function gi(e){e.Va=new us({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),Li(e).start(),e.Ra.ua()}function xi(e){return yi(e)&&!Li(e).x_()&&e.Ia.size>0}function yi(e){return 0===R(e).Ea.size}function vi(e){e.Va=void 0}async function bi(e){e.Ra.set("Online")}async function wi(e){e.Ia.forEach((t,n)=>{pi(e,t)})}async function ji(e,t){vi(e),xi(e)?(e.Ra.ha(t),gi(e)):e.Ra.set("Unknown")}async function Ni(e,t,n){if(e.Ra.set("Online"),t instanceof os&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ia.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ia.delete(r),e.Va.removeTarget(r))}(e,t)}catch(n){A(oi,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await ki(e,n)}else if(t instanceof is?e.Va.Ze(t):t instanceof ls?e.Va.st(t):e.Va.tt(t),!n.isEqual(ye.min()))try{const t=await Da(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Va.Tt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const s=e.Ia.get(r);s&&e.Ia.set(r,s.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Ia.get(t);if(!r)return;e.Ia.set(t,r.withResumeToken(vt.EMPTY_BYTE_STRING,r.snapshotVersion)),fi(e,t);const s=new Hs(r.target,t,n,r.sequenceNumber);pi(e,s)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){A(oi,"Failed to raise snapshot:",t),await ki(e,t)}}async function ki(e,t,n){if(!_e(t))throw t;e.Ea.add(1),await di(e),e.Ra.set("Offline"),n||(n=()=>Da(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{A(oi,"Retrying IndexedDB access"),await n(),e.Ea.delete(1),await ui(e)})}function Si(e,t){return t().catch(n=>ki(e,n,t))}async function Ci(e){const t=R(e),n=Fi(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:De;for(;Ei(t);)try{const e=await Ma(t.localStore,r);if(null===e){0===t.Ta.length&&n.L_();break}r=e.batchId,Ai(t,e)}catch(e){await ki(t,e)}Ii(t)&&_i(t)}function Ei(e){return yi(e)&&e.Ta.length<10}function Ai(e,t){e.Ta.push(t);const n=Fi(e);n.O_()&&n.X_&&n.ea(t.mutations)}function Ii(e){return yi(e)&&!Fi(e).x_()&&e.Ta.length>0}function _i(e){Fi(e).start()}async function Ti(e){Fi(e).ra()}async function Di(e){const t=Fi(e);for(const n of e.Ta)t.ea(n.mutations)}async function Pi(e,t,n){const r=e.Ta.shift(),s=qr.from(r,t,n);await Si(e,()=>e.remoteSyncer.applySuccessfulWrite(s)),await Ci(e)}async function Mi(e,t){t&&Fi(e).X_&&await async function(e,t){if(function(e){return Jr(e)&&e!==O.ABORTED}(t.code)){const n=e.Ta.shift();Fi(e).B_(),await Si(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await Ci(e)}}(e,t),Ii(e)&&_i(e)}async function Ri(e,t){const n=R(e);n.asyncQueue.verifyOperationInProgress(),A(oi,"RemoteStore received new credentials");const r=yi(n);n.Ea.add(3),await di(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await ui(n)}async function Oi(e,t){const n=R(e);t?(n.Ea.delete(2),await ui(n)):t||(n.Ea.add(2),await di(n),n.Ra.set("Unknown"))}function Li(e){return e.ma||(e.ma=function(e,t,n){const r=R(e);return r.sa(),new ri(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:bi.bind(null,e),t_:wi.bind(null,e),r_:ji.bind(null,e),H_:Ni.bind(null,e)}),e.da.push(async t=>{t?(e.ma.B_(),xi(e)?gi(e):e.Ra.set("Unknown")):(await e.ma.stop(),vi(e))})),e.ma}function Fi(e){return e.fa||(e.fa=function(e,t,n){const r=R(e);return r.sa(),new si(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:Ti.bind(null,e),r_:Mi.bind(null,e),ta:Di.bind(null,e),na:Pi.bind(null,e)}),e.da.push(async t=>{t?(e.fa.B_(),await Ci(e)):(await e.fa.stop(),e.Ta.length>0&&(A(oi,"Stopping write stream with ".concat(e.Ta.length," pending writes")),e.Ta=[]))})),e.fa}class Vi{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new F,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,s){const a=Date.now()+n,i=new Vi(e,t,a,r,s);return i.start(n),i}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new L(O.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function zi(e,t){if(I("AsyncQueue","".concat(t,": ").concat(e)),_e(e))return new L(O.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class Ui{static emptySet(e){return new Ui(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||ie.comparator(t.key,n.key):(e,t)=>ie.comparator(e.key,t.key),this.keyedMap=tr(),this.sortedSet=new ht(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ui))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Ui;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Ki{constructor(){this.ga=new ht(ie.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?0!==e.type&&3===n.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==n.type?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.ga=this.ga.remove(t):1===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):D(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class Bi{constructor(e,t,n,r,s,a,i,l,o){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=i,this.excludesMetadataChanges=l,this.hasCachedResults=o}static fromInitialDocuments(e,t,n,r,s){const a=[];return t.forEach(e=>{a.push({type:0,doc:e})}),new Bi(e,t,Ui.emptySet(t),a,n,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&qn(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class qi{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Hi{constructor(){this.queries=Gi(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const n=R(e),r=n.queries;n.queries=Gi(),r.forEach((e,n)=>{for(const r of n.Sa)r.onError(t)})}(this,new L(O.ABORTED,"Firestore shutting down"))}}function Gi(){return new Xn(e=>Hn(e),qn)}async function Wi(e,t){const n=R(e);let r=3;const s=t.query;let a=n.queries.get(s);a?!a.ba()&&t.Da()&&(r=2):(a=new qi,r=t.Da()?0:1);try{switch(r){case 0:a.wa=await n.onListen(s,!0);break;case 1:a.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(e){const n=zi(e,"Initialization of query '".concat(Gn(t.query),"' failed"));return void t.onError(n)}n.queries.set(s,a),a.Sa.push(t),t.va(n.onlineState),a.wa&&t.Fa(a.wa)&&Xi(n)}async function Qi(e,t){const n=R(e),r=t.query;let s=3;const a=n.queries.get(r);if(a){const e=a.Sa.indexOf(t);e>=0&&(a.Sa.splice(e,1),0===a.Sa.length?s=t.Da()?0:1:!a.ba()&&t.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Ji(e,t){const n=R(e);let r=!1;for(const s of t){const e=s.query,t=n.queries.get(e);if(t){for(const e of t.Sa)e.Fa(s)&&(r=!0);t.wa=s}}r&&Xi(n)}function Zi(e,t,n){const r=R(e),s=r.queries.get(t);if(s)for(const a of s.Sa)a.onError(n);r.queries.delete(t)}function Xi(e){e.Ca.forEach(e=>{e.next()})}var Yi,$i;($i=Yi||(Yi={})).Ma="default",$i.Cache="cache";class el{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Bi(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache)return!0;if(!this.Da())return!0;const n="Offline"!==t;return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=Bi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Yi.Cache}}class tl{constructor(e){this.key=e}}class nl{constructor(e){this.key=e}}class rl{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=or(),this.mutatedKeys=or(),this.eu=Jn(e),this.tu=new Ui(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new Ki,r=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,a=r,i=!1;const l="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,o="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=Wn(this.query,t)?t:null,d=!!c&&this.mutatedKeys.has(c.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let m=!1;c&&u?c.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),m=!0):this.su(c,u)||(n.track({type:2,doc:u}),m=!0,(l&&this.eu(u,l)>0||o&&this.eu(u,o)<0)&&(i=!0)):!c&&u?(n.track({type:0,doc:u}),m=!0):c&&!u&&(n.track({type:1,doc:c}),m=!0,(l||o)&&(i=!0)),m&&(u?(a=a.add(u),s=h?s.add(e):s.delete(e)):(a=a.delete(e),s=s.delete(e)))}),null!==this.query.limit)for(;a.size>this.query.limit;){const e="F"===this.query.limitType?a.last():a.first();a=a.delete(e.key),s=s.delete(e.key),n.track({type:1,doc:e})}return{tu:a,iu:n,Cs:i,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return D(20277,{Rt:e})}};return n(e)-n(t)}(e.type,t.type)||this.eu(e.doc,t.doc)),this.ou(n),r=null!==r&&void 0!==r&&r;const i=t&&!r?this._u():[],l=0===this.Xa.size&&this.current&&!r?1:0,o=l!==this.Za;return this.Za=l,0!==a.length||o?{snapshot:new Bi(this.query,e.tu,s,a,e.mutatedKeys,0===l,o,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:i}:{au:i}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Ki,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=or(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))});const t=[];return e.forEach(e=>{this.Xa.has(e)||t.push(new nl(e))}),this.Xa.forEach(n=>{e.has(n)||t.push(new tl(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=or();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Bi.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const sl="SyncEngine";class al{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class il{constructor(e){this.key=e,this.hu=!1}}class ll{constructor(e,t,n,r,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Xn(e=>Hn(e),qn),this.Iu=new Map,this.Eu=new Set,this.du=new ht(ie.comparator),this.Au=new Map,this.Ru=new pa,this.Vu={},this.mu=new Map,this.fu=ea.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function ol(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=Il(e);let s;const a=r.Tu.get(t);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.lu()):s=await ul(r,t,n,!0),s}async function cl(e,t){const n=Il(e);await ul(n,t,!0,!1)}async function ul(e,t,n,r){const s=await Ra(e.localStore,zn(t)),a=s.targetId,i=e.sharedClientState.addLocalQueryTarget(a,n);let l;return r&&(l=await dl(e,t,a,"current"===i,s.resumeToken)),e.isPrimaryClient&&n&&hi(e.remoteStore,s),l}async function dl(e,t,n,r,s){e.pu=(t,n,r)=>async function(e,t,n,r){let s=t.view.ru(n);s.Cs&&(s=await La(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.ru(n,s)}));const a=r&&r.targetChanges.get(t.targetId),i=r&&null!=r.targetMismatches.get(t.targetId),l=t.view.applyChanges(s,e.isPrimaryClient,a,i);return Nl(e,t.targetId,l.au),l.snapshot}(e,t,n,r);const a=await La(e.localStore,t,!0),i=new rl(t,a.Qs),l=i.ru(a.documents),o=as.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,s),c=i.applyChanges(l,e.isPrimaryClient,o);Nl(e,n,c.au);const u=new al(t,n,i);return e.Tu.set(t,u),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),c.snapshot}async function hl(e,t,n){const r=R(e),s=r.Tu.get(t),a=r.Iu.get(s.targetId);if(a.length>1)return r.Iu.set(s.targetId,a.filter(e=>!qn(e,t))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Oa(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&mi(r.remoteStore,s.targetId),wl(r,s.targetId)}).catch(Ee)):(wl(r,s.targetId),await Oa(r.localStore,s.targetId,!0))}async function ml(e,t){const n=R(e),r=n.Tu.get(t),s=n.Iu.get(r.targetId);n.isPrimaryClient&&1===s.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),mi(n.remoteStore,r.targetId))}async function pl(e,t){const n=R(e);try{const e=await function(e,t){const n=R(e),r=t.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const a=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const i=[];t.targetChanges.forEach((a,l)=>{const o=s.get(l);if(!o)return;i.push(n.Pi.removeMatchingKeys(e,a.removedDocuments,l).next(()=>n.Pi.addMatchingKeys(e,a.addedDocuments,l)));let c=o.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(l)?c=c.withResumeToken(vt.EMPTY_BYTE_STRING,ye.min()).withLastLimboFreeSnapshotVersion(ye.min()):a.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(a.resumeToken,r)),s=s.insert(l,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=Aa||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(o,c,a)&&i.push(n.Pi.updateTargetData(e,c))});let l=$n(),o=or();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&i.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),i.push(Pa(e,a,t.documentUpdates).next(e=>{l=e.ks,o=e.qs})),!r.isEqual(ye.min())){const t=n.Pi.getLastRemoteSnapshotVersion(e).next(t=>n.Pi.setTargetsMetadata(e,e.currentSequenceNumber,r));i.push(t)}return Ae.waitFor(i).next(()=>a.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,l,o)).next(()=>l)}).then(e=>(n.Ms=s,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Au.get(t);r&&(M(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.hu=!0:e.modifiedDocuments.size>0?M(r.hu,14607):e.removedDocuments.size>0&&(M(r.hu,42227),r.hu=!1))}),await Cl(n,e,t)}catch(e){await Ee(e)}}function fl(e,t,n){const r=R(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Tu.forEach((n,r)=>{const s=r.view.va(t);s.snapshot&&e.push(s.snapshot)}),function(e,t){const n=R(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const s of n.Sa)s.va(t)&&(r=!0)}),r&&Xi(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function gl(e,t,n){const r=R(e);r.sharedClientState.updateQueryState(t,"rejected",n);const s=r.Au.get(t),a=s&&s.key;if(a){let e=new ht(ie.comparator);e=e.insert(a,an.newNoDocument(a,ye.min()));const n=or().add(a),s=new ss(ye.min(),new Map,new ht(J),e,n);await pl(r,s),r.du=r.du.remove(a),r.Au.delete(t),Sl(r)}else await Oa(r.localStore,t,!1).then(()=>wl(r,t,n)).catch(Ee)}async function xl(e,t){const n=R(e),r=t.batch.batchId;try{const e=await function(e,t){const n=R(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const s=n.batch,a=s.keys();let i=Ae.resolve();return a.forEach(e=>{i=i.next(()=>r.getEntry(t,e)).next(t=>{const a=n.docVersions.get(e);M(null!==a,48541),t.version.compareTo(a)<0&&(s.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),i.next(()=>e.mutationQueue.removeMutationBatch(t,s))}(n,e,t,s).next(()=>s.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=or();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);bl(n,r,null),vl(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Cl(n,e)}catch(e){await Ee(e)}}async function yl(e,t,n){const r=R(e);try{const e=await function(e,t){const n=R(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(M(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);bl(r,t,n),vl(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Cl(r,e)}catch(n){await Ee(n)}}function vl(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function bl(e,t,n){const r=R(e);let s=r.Vu[r.currentUser.toKey()];if(s){const e=s.get(t);e&&(n?e.reject(n):e.resolve(),s=s.remove(t)),r.Vu[r.currentUser.toKey()]=s}}function wl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Iu.get(t))e.Tu.delete(r),n&&e.Pu.yu(r,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(t=>{e.Ru.containsKey(t)||jl(e,t)})}function jl(e,t){e.Eu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(mi(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),Sl(e))}function Nl(e,t,n){for(const r of n)r instanceof tl?(e.Ru.addReference(r.key,t),kl(e,r)):r instanceof nl?(A(sl,"Document no longer in limbo: "+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||jl(e,r.key)):D(19791,{wu:r})}function kl(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Eu.has(r)||(A(sl,"New document in limbo: "+n),e.Eu.add(r),Sl(e))}function Sl(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const n=new ie(re.fromString(t)),r=e.fu.next();e.Au.set(r,new il(n)),e.du=e.du.insert(n,r),hi(e.remoteStore,new Hs(zn(On(n.path)),r,"TargetPurposeLimboResolution",Te.ce))}}async function Cl(e,t,n){const r=R(e),s=[],a=[],i=[];r.Tu.isEmpty()||(r.Tu.forEach((e,l)=>{i.push(r.pu(l,t,n).then(e=>{if((e||n)&&r.isPrimaryClient){var t;const s=e?!e.fromCache:null===n||void 0===n||null===(t=n.targetChanges.get(l.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(l.targetId,s?"current":"not-current")}if(e){s.push(e);const t=ka.As(l.targetId,e);a.push(t)}}))}),await Promise.all(i),r.Pu.H_(s),await async function(e,t){const n=R(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>Ae.forEach(t,t=>Ae.forEach(t.Es,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>Ae.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!_e(e))throw e;A(Ea,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ms.get(e),r=t.snapshotVersion,s=t.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(e,s)}}}(r.localStore,a))}async function El(e,t){const n=R(e);if(!n.currentUser.isEqual(t)){A(sl,"User change. New user:",t.toKey());const e=await Ta(n.localStore,t);n.currentUser=t,function(e,t){e.mu.forEach(e=>{e.forEach(e=>{e.reject(new L(O.CANCELLED,t))})}),e.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Cl(n,e.Ls)}}function Al(e,t){const n=R(e),r=n.Au.get(t);if(r&&r.hu)return or().add(r.key);{let e=or();const r=n.Iu.get(t);if(!r)return e;for(const t of r){const r=n.Tu.get(t);e=e.unionWith(r.view.nu)}return e}}function Il(e){const t=R(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=pl.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Al.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=gl.bind(null,t),t.Pu.H_=Ji.bind(null,t.eventManager),t.Pu.yu=Zi.bind(null,t.eventManager),t}function _l(e){const t=R(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=xl.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=yl.bind(null,t),t}class Tl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=$a(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return _a(this.persistence,new Ca,e.initialUser,this.serializer)}Cu(e){return new ba(ja.mi,this.serializer)}Du(e){return new za}async terminate(){var e,t;null!==(e=this.gcScheduler)&&void 0!==e&&e.stop(),null!==(t=this.indexBackfillerScheduler)&&void 0!==t&&t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Tl.provider={build:()=>new Tl};class Dl extends Tl{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){M(this.persistence.referenceDelegate instanceof Na,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new aa(n,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?$s.withCacheSize(this.cacheSizeBytes):$s.DEFAULT;return new ba(e=>Na.mi(e,t),this.serializer)}}class Pl{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>fl(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=El.bind(null,this.syncEngine),await Oi(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Hi}createDatastore(e){const t=$a(e.databaseInfo.databaseId),n=function(e){return new Xa(e)}(e.databaseInfo);return function(e,t,n,r){return new ii(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,s){return new ci(e,t,n,r,s)}(this.localStore,this.datastore,e.asyncQueue,e=>fl(this.syncEngine,e,0),Ba.v()?new Ba:new Ua)}createSyncEngine(e,t){return function(e,t,n,r,s,a,i){const l=new ll(e,t,n,r,s,a);return i&&(l.gu=!0),l}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=R(e);A(oi,"RemoteStore shutting down."),t.Ea.add(5),await di(t),t.Aa.shutdown(),t.Ra.set("Unknown")}(this.remoteStore),null!==(e=this.datastore)&&void 0!==e&&e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}Pl.provider={build:()=>new Pl};class Ml{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):I("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}const Rl="FirestoreClient";class Ol{constructor(e,t,n,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=k.UNAUTHENTICATED,this.clientId=Q.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async e=>{A(Rl,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(A(Rl,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new F;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=zi(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Ll(e,t){e.asyncQueue.verifyOperationInProgress(),A(Rl,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await Ta(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function Fl(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Vl(e);A(Rl,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>Ri(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>Ri(t.remoteStore,n)),e._onlineComponents=t}async function Vl(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){A(Rl,"Using user provided OfflineComponentProvider");try{await Ll(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===O.FAILED_PRECONDITION||e.code===O.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;_("Error using user provided cache. Falling back to memory cache: "+n),await Ll(e,new Tl)}}else A(Rl,"Using default OfflineComponentProvider"),await Ll(e,new Dl(void 0));return e._offlineComponents}async function zl(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(A(Rl,"Using user provided OnlineComponentProvider"),await Fl(e,e._uninitializedComponentsProvider._online)):(A(Rl,"Using default OnlineComponentProvider"),await Fl(e,new Pl))),e._onlineComponents}function Ul(e){return zl(e).then(e=>e.syncEngine)}async function Kl(e){const t=await zl(e),n=t.eventManager;return n.onListen=ol.bind(null,t.syncEngine),n.onUnlisten=hl.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=cl.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=ml.bind(null,t.syncEngine),n}function Bl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new F;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,s){const a=new Ml({next:l=>{a.Nu(),t.enqueueAndForget(()=>Qi(e,i));const o=l.docs.has(n);!o&&l.fromCache?s.reject(new L(O.UNAVAILABLE,"Failed to get document because the client is offline.")):o&&l.fromCache&&r&&"server"===r.source?s.reject(new L(O.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(l)},error:e=>s.reject(e)}),i=new el(On(n.path),a,{includeMetadataChanges:!0,qa:!0});return Wi(e,i)}(await Kl(e),e.asyncQueue,t,n,r)),r.promise}function ql(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new F;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,s){const a=new Ml({next:n=>{a.Nu(),t.enqueueAndForget(()=>Qi(e,i)),n.fromCache&&"server"===r.source?s.reject(new L(O.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):s.resolve(n)},error:e=>s.reject(e)}),i=new el(n,a,{includeMetadataChanges:!0,qa:!0});return Wi(e,i)}(await Kl(e),e.asyncQueue,t,n,r)),r.promise}function Hl(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Gl=new Map,Wl="firestore.googleapis.com",Ql=!0;class Jl{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new L(O.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Wl,this.ssl=Ql}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:Ql;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=Ys;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<na)throw new L(O.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new L(O.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Hl(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new L(O.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new L(O.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new L(O.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Zl{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Jl({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new L(O.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new L(O.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Jl(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new z;switch(e.type){case"firstParty":return new q(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new L(O.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Gl.get(e);t&&(A("ComponentProvider","Removing Datastore"),Gl.delete(e),t.terminate())}(this),Promise.resolve()}}class Xl{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Xl(this.firestore,e,this._query)}}class Yl{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $l(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Yl(this.firestore,e,this._key)}toJSON(){return{type:Yl._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(pe(t,Yl._jsonSchema))return new Yl(e,n||null,new ie(re.fromString(t.referencePath)))}}Yl._jsonSchemaVersion="firestore/documentReference/1.0",Yl._jsonSchema={type:me("string",Yl._jsonSchemaVersion),referencePath:me("string")};class $l extends Xl{constructor(e,t,n){super(e,t,On(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Yl(this.firestore,null,new ie(e))}withConverter(e){return new $l(this.firestore,e,this._path)}}function eo(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];if(e=(0,c.Ku)(e),le("collection","path",t),e instanceof Zl){const n=re.fromString(t,...r);return ce(n),new $l(e,null,n)}{if(!(e instanceof Yl||e instanceof $l))throw new L(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(re.fromString(t,...r));return ce(n),new $l(e.firestore,null,n)}}function to(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];if(e=(0,c.Ku)(e),1===arguments.length&&(t=Q.newId()),le("doc","path",t),e instanceof Zl){const n=re.fromString(t,...r);return oe(n),new Yl(e,null,new ie(n))}{if(!(e instanceof Yl||e instanceof $l))throw new L(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(re.fromString(t,...r));return oe(n),new Yl(e.firestore,e instanceof $l?e.converter:null,new ie(n))}}const no="AsyncQueue";class ro{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new ei(this,"async_queue_retry"),this._c=()=>{const e=Ya();e&&A(no,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=Ya();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Ya();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new F;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!_e(e))throw e;A(no,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,I("INTERNAL UNHANDLED ERROR: ",so(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Vi.createAndSchedule(this,e,t,n,e=>this.hc(e));return this.tc.push(r),r}uc(){this.nc&&D(47125,{Pc:so(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do{e=this.ac,await e}while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function so(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}function ao(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class io extends Zl{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new ro,this._persistenceKey=(null===r||void 0===r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ro(e),this._firestoreClient=void 0,await e}}}function lo(e,t){const n="object"==typeof e?e:(0,i.Sx)(),r="string"==typeof e?e:t||Dt,s=(0,i.j6)(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const e=(0,c.yU)("firestore");e&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=he(e,Zl);const s=(0,c.zJ)(t),i=e._getSettings(),l=(0,a.A)((0,a.A)({},i),{},{emulatorOptions:e._getEmulatorOptions()}),o="".concat(t,":").concat(n);s&&((0,c.gE)("https://".concat(o)),(0,c.P1)("Firestore",!0)),i.host!==Wl&&i.host!==o&&_("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u=(0,a.A)((0,a.A)({},i),{},{host:o,ssl:s,emulatorOptions:r});if(!(0,c.bD)(u,l)&&(e._setSettings(u),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=k.MOCK_USER;else{var d;t=(0,c.Fy)(r.mockUserToken,null===(d=e._app)||void 0===d?void 0:d.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new L(O.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new k(s)}e._authCredentials=new U(new V(t,n))}}(s,...e)}return s}function oo(e){if(e._terminated)throw new L(O.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||co(e),e._firestoreClient}function co(e){var t,n,r;const s=e._freezeSettings(),a=function(e,t,n,r){return new Tt(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Hl(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,s);e._componentsProvider||null!==(n=s.localCache)&&void 0!==n&&n._offlineComponentProvider&&null!==(r=s.localCache)&&void 0!==r&&r._onlineComponentProvider&&(e._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),e._firestoreClient=new Ol(e._authCredentials,e._appCheckCredentials,e._queue,a,e._componentsProvider&&function(e){const t=null===e||void 0===e?void 0:e._online.build();return{_offline:null===e||void 0===e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class uo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new uo(vt.fromBase64String(e))}catch(e){throw new L(O.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new uo(vt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:uo._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(pe(e,uo._jsonSchema))return uo.fromBase64String(e.bytes)}}uo._jsonSchemaVersion="firestore/bytes/1.0",uo._jsonSchema={type:me("string",uo._jsonSchemaVersion),bytes:me("string")};class ho{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new L(O.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ae(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class mo{constructor(e){this._methodName=e}}class po{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new L(O.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new L(O.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return J(this._lat,e._lat)||J(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:po._jsonSchemaVersion}}static fromJSON(e){if(pe(e,po._jsonSchema))return new po(e.latitude,e.longitude)}}po._jsonSchemaVersion="firestore/geoPoint/1.0",po._jsonSchema={type:me("string",po._jsonSchemaVersion),latitude:me("number"),longitude:me("number")};class fo{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:fo._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(pe(e,fo._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new fo(e.vectorValues);throw new L(O.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}fo._jsonSchemaVersion="firestore/vectorValue/1.0",fo._jsonSchema={type:me("string",fo._jsonSchemaVersion),vectorValues:me("object")};const go=/^__.*__$/;class xo{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Lr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Or(e,this.data,t,this.fieldTransforms)}}class yo{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Lr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function vo(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw D(40011,{Ac:e})}}class bo{constructor(e,t,n,r,s,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===s&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new bo((0,a.A)((0,a.A)({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Oo(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(vo(this.Ac)&&go.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class wo{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||$a(e)}Cc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new bo({Ac:e,methodName:t,Dc:n,path:ae.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function jo(e){const t=e._freezeSettings(),n=$a(e._databaseId);return new wo(e._databaseId,!!t.ignoreUndefinedProperties,n)}function No(e,t,n,r,s){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const i=e.Cc(a.merge||a.mergeFields?2:0,t,n,s);Do("Data must be an object, but it was:",i,r);const l=_o(r,i);let o,c;if(a.merge)o=new xt(i.fieldMask),c=i.fieldTransforms;else if(a.mergeFields){const e=[];for(const r of a.mergeFields){const s=Po(t,r,n);if(!i.contains(s))throw new L(O.INVALID_ARGUMENT,"Field '".concat(s,"' is specified in your field mask but missing from your input data."));Lo(e,s)||e.push(s)}o=new xt(e),c=i.fieldTransforms.filter(e=>o.covers(e.field))}else o=null,c=i.fieldTransforms;return new xo(new rn(l),o,c)}class ko extends mo{_toFieldTransform(e){if(2!==e.Ac)throw 1===e.Ac?e.Sc("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Sc("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ko}}class So extends mo{_toFieldTransform(e){return new Cr(e.path,new yr)}isEqual(e){return e instanceof So}}function Co(e,t,n,r){const s=e.Cc(1,t,n);Do("Data must be an object, but it was:",s,r);const a=[],i=rn.empty();ut(r,(e,r)=>{const l=Ro(t,e,n);r=(0,c.Ku)(r);const o=s.yc(l);if(r instanceof ko)a.push(l);else{const e=Io(r,o);null!=e&&(a.push(l),i.set(l,e))}});const l=new xt(a);return new yo(i,l,s.fieldTransforms)}function Eo(e,t,n,r,s,a){const i=e.Cc(1,t,n),l=[Po(t,r,n)],o=[s];if(a.length%2!=0)throw new L(O.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let c=0;c<a.length;c+=2)l.push(Po(t,a[c])),o.push(a[c+1]);const u=[],d=rn.empty();for(let m=l.length-1;m>=0;--m)if(!Lo(u,l[m])){const e=l[m];let t=o[m];t=(0,c.Ku)(t);const n=i.yc(e);if(t instanceof ko)u.push(e);else{const r=Io(t,n);null!=r&&(u.push(e),d.set(e,r))}}const h=new xt(u);return new yo(d,h,i.fieldTransforms)}function Ao(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Io(n,e.Cc(r?4:3,t))}function Io(e,t){if(To(e=(0,c.Ku)(e)))return Do("Unsupported field value:",t,e),_o(e,t);if(e instanceof mo)return function(e,t){if(!vo(t.Ac))throw t.Sc("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Sc("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&4!==t.Ac)throw t.Sc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const s of e){let e=Io(s,t.wc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=(0,c.Ku)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return mr(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=xe.fromDate(e);return{timestampValue:ys(t.serializer,n)}}if(e instanceof xe){const n=new xe(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:ys(t.serializer,n)}}if(e instanceof po)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof uo)return{bytesValue:vs(t.serializer,e._byteString)};if(e instanceof Yl){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Sc("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:js(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof fo)return function(e,t){return{mapValue:{fields:{[Mt]:{stringValue:Lt},[Ft]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Sc("VectorValues must only contain numeric values.");return dr(t.serializer,e)})}}}}}}(e,t);throw t.Sc("Unsupported field value: ".concat(de(e)))}(e,t)}function _o(e,t){const n={};return dt(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ut(e,(e,r)=>{const s=Io(r,t.mc(e));null!=s&&(n[e]=s)}),{mapValue:{fields:n}}}function To(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof xe||e instanceof po||e instanceof uo||e instanceof Yl||e instanceof mo||e instanceof fo)}function Do(e,t,n){if(!To(n)||!ue(n)){const r=de(n);throw"an object"===r?t.Sc(e+" a custom object"):t.Sc(e+" "+r)}}function Po(e,t,n){if((t=(0,c.Ku)(t))instanceof ho)return t._internalPath;if("string"==typeof t)return Ro(e,t);throw Oo("Field path arguments must be of type string or ",e,!1,void 0,n)}const Mo=new RegExp("[~\\*/\\[\\]]");function Ro(e,t,n){if(t.search(Mo)>=0)throw Oo("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new ho(...t.split("."))._internalPath}catch(r){throw Oo("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function Oo(e,t,n,r,s){const a=r&&!r.isEmpty(),i=void 0!==s;let l="Function ".concat(t,"() called with invalid data");n&&(l+=" (via `toFirestore()`)"),l+=". ";let o="";return(a||i)&&(o+=" (found",a&&(o+=" in field ".concat(r)),i&&(o+=" in document ".concat(s)),o+=")"),new L(O.INVALID_ARGUMENT,l+e+o)}function Lo(e,t){return e.some(e=>e.isEqual(t))}class Fo{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Yl(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Vo(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(zo("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Vo extends Fo{data(){return super.data()}}function zo(e,t){return"string"==typeof t?Ro(e,t):t instanceof ho?t._internalPath:t._delegate._internalPath}function Uo(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new L(O.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ko{}class Bo extends Ko{}function qo(e,t){let n=[];for(var r=arguments.length,s=new Array(r>2?r-2:0),a=2;a<r;a++)s[a-2]=arguments[a];t instanceof Ko&&n.push(t),n=n.concat(s),function(e){const t=e.filter(e=>e instanceof Wo).length,n=e.filter(e=>e instanceof Ho).length;if(t>1||t>0&&n>0)throw new L(O.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)e=i._apply(e);return e}class Ho extends Bo{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Ho(e,t,n)}_apply(e){const t=this._parse(e);return Yo(e._query,t),new Xl(e.firestore,e.converter,Kn(e._query,t))}_parse(e){const t=jo(e.firestore),n=function(e,t,n,r,s,a,i){let l;if(s.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new L(O.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){Xo(i,a);const t=[];for(const n of i)t.push(Zo(r,e,n));l={arrayValue:{values:t}}}else l=Zo(r,e,i)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||Xo(i,a),l=Ao(n,t,i,"in"===a||"not-in"===a);return mn.create(s,a,l)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function Go(e,t,n){const r=t,s=zo("where",e);return Ho._create(s,r,n)}class Wo extends Ko{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Wo(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:pn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const s of r)Yo(n,s),n=Kn(n,s)}(e._query,t),new Xl(e.firestore,e.converter,Kn(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Qo extends Bo{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Qo(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new L(O.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new L(O.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new un(t,n)}(e._query,this._field,this._direction);return new Xl(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Mn(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function Jo(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=zo("orderBy",e);return Qo._create(n,t)}function Zo(e,t,n){if("string"==typeof(n=(0,c.Ku)(n))){if(""===n)throw new L(O.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Fn(t)&&-1!==n.indexOf("/"))throw new L(O.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child(re.fromString(n));if(!ie.isDocumentKey(r))throw new L(O.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Qt(e,new ie(r))}if(n instanceof Yl)return Qt(e,n._key);throw new L(O.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(de(n),"."))}function Xo(e,t){if(!Array.isArray(e)||0===e.length)throw new L(O.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function Yo(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new L(O.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new L(O.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class $o{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Vt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return jt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Nt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw D(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return ut(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t;const n=null===(t=e.fields)||void 0===t||null===(t=t[Ft].arrayValue)||void 0===t||null===(t=t.values)||void 0===t?void 0:t.map(e=>jt(e.doubleValue));return new fo(n)}convertGeoPoint(e){return new po(jt(e.latitude),jt(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=It(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(_t(e));default:return null}}convertTimestamp(e){const t=wt(e);return new xe(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=re.fromString(e);M(qs(n),9688,{name:e});const r=new Pt(n.get(1),n.get(3)),s=new ie(n.popFirst(5));return r.isEqual(t)||I("Document ".concat(s," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),s}}function ec(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class tc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class nc extends Fo{constructor(e,t,n,r,s,a){super(e,t,n,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new rc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(zo("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new L(O.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=nc._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}nc._jsonSchemaVersion="firestore/documentSnapshot/1.0",nc._jsonSchema={type:me("string",nc._jsonSchemaVersion),bundleSource:me("string","DocumentSnapshot"),bundleName:me("string"),bundle:me("string")};class rc extends nc{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class sc{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new tc(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new rc(this._firestore,this._userDataWriter,n.key,n,new tc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new L(O.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new rc(e._firestore,e._userDataWriter,n.doc.key,n.doc,new tc(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new rc(e._firestore,e._userDataWriter,t.doc.key,t.doc,new tc(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let s=-1,a=-1;return 0!==t.type&&(s=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),a=n.indexOf(t.doc.key)),{type:ac(t.type),doc:r,oldIndex:s,newIndex:a}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new L(O.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=sc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Q.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function ac(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return D(61501,{type:e})}}function ic(e){e=he(e,Yl);const t=he(e.firestore,io);return Bl(oo(t),e._key).then(n=>fc(t,e,n))}sc._jsonSchemaVersion="firestore/querySnapshot/1.0",sc._jsonSchema={type:me("string",sc._jsonSchemaVersion),bundleSource:me("string","QuerySnapshot"),bundleName:me("string"),bundle:me("string")};class lc extends $o{constructor(e){super(),this.firestore=e}convertBytes(e){return new uo(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Yl(this.firestore,null,t)}}function oc(e){e=he(e,Xl);const t=he(e.firestore,io),n=oo(t),r=new lc(t);return Uo(e._query),ql(n,e._query).then(n=>new sc(t,r,e,n))}function cc(e,t,n){e=he(e,Yl);const r=he(e.firestore,io),s=ec(e.converter,t,n);return pc(r,[No(jo(r),"setDoc",e._key,s,null!==e.converter,n).toMutation(e._key,Ar.none())])}function uc(e,t,n){e=he(e,Yl);const r=he(e.firestore,io),s=jo(r);let a;for(var i=arguments.length,l=new Array(i>3?i-3:0),o=3;o<i;o++)l[o-3]=arguments[o];return a="string"==typeof(t=(0,c.Ku)(t))||t instanceof ho?Eo(s,"updateDoc",e._key,t,n,l):Co(s,"updateDoc",e._key,t),pc(r,[a.toMutation(e._key,Ar.exists(!0))])}function dc(e){return pc(he(e.firestore,io),[new Ur(e._key,Ar.none())])}function hc(e,t){const n=he(e.firestore,io),r=to(e),s=ec(e.converter,t);return pc(n,[No(jo(e.firestore),"addDoc",r._key,s,null!==e.converter,{}).toMutation(r._key,Ar.exists(!1))]).then(()=>r)}function mc(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=(0,c.Ku)(e);let s={includeMetadataChanges:!1,source:"default"},a=0;"object"!=typeof n[a]||ao(n[a])||(s=n[a++]);const i={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(ao(n[a])){var l,o,u;const e=n[a];n[a]=null===(l=e.next)||void 0===l?void 0:l.bind(e),n[a+1]=null===(o=e.error)||void 0===o?void 0:o.bind(e),n[a+2]=null===(u=e.complete)||void 0===u?void 0:u.bind(e)}let d,h,m;if(e instanceof Yl)h=he(e.firestore,io),m=On(e._key.path),d={next:t=>{n[a]&&n[a](fc(h,e,t))},error:n[a+1],complete:n[a+2]};else{const t=he(e,Xl);h=he(t.firestore,io),m=t._query;const r=new lc(h);d={next:e=>{n[a]&&n[a](new sc(h,r,t,e))},error:n[a+1],complete:n[a+2]},Uo(e._query)}return function(e,t,n,r){const s=new Ml(r),a=new el(t,s,n);return e.asyncQueue.enqueueAndForget(async()=>Wi(await Kl(e),a)),()=>{s.Nu(),e.asyncQueue.enqueueAndForget(async()=>Qi(await Kl(e),a))}}(oo(h),m,i,d)}function pc(e,t){return function(e,t){const n=new F;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=_l(e);try{const e=await function(e,t){const n=R(e),r=xe.now(),s=t.reduce((e,t)=>e.add(t.key),or());let a,i;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let l=$n(),o=or();return n.Ns.getEntries(e,s).next(e=>{l=e,l.forEach((e,t)=>{t.isValidDocument()||(o=o.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,l)).next(s=>{a=s;const i=[];for(const e of t){const t=Mr(e,a.get(e.key).overlayedDocument);null!=t&&i.push(new Lr(e.key,t,sn(t.value.mapValue),Ar.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,i,t)}).next(t=>{i=t;const r=t.applyToLocalDocumentSet(a,o);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:i.batchId,changes:nr(a)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Vu[e.currentUser.toKey()];r||(r=new ht(J)),r=r.insert(t,n),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,n),await Cl(r,e.changes),await Ci(r.remoteStore)}catch(e){const t=zi(e,"Failed to persist write");n.reject(t)}}(await Ul(e),t,n)),n.promise}(oo(e),t)}function fc(e,t,n){const r=n.docs.get(t._key),s=new lc(e);return new nc(e,s,t._key,r,new tc(n.hasPendingWrites,n.fromCache),t.converter)}function gc(){return new So("serverTimestamp")}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){S=e}(i.MF),(0,i.om)(new l.uA("firestore",(e,n)=>{let{instanceIdentifier:r,options:s}=n;const i=e.getProvider("app").getImmediate(),l=new io(new K(e.getProvider("auth-internal")),new G(i,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new L(O.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Pt(e.options.projectId,t)}(i,r),i);return s=(0,a.A)({useFetchStreams:t},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),(0,i.KO)(j,N,e),(0,i.KO)(j,N,"esm2020")}()},730:(e,t,n)=>{var r=n(43),s=n(853);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,l={};function o(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(l[e]=t,e=0;e<t.length;e++)i.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},p={};function f(e,t,n,r,s,a,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new f(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new f(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new f(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new f(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new f(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new f(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)});var x=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function v(e,t,n,r){var s=g.hasOwnProperty(t)?g[t]:null;(null!==s?0!==s.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,s,r)&&(n=null),r||null===s?function(e){return!!d.call(p,e)||!d.call(m,e)&&(h.test(e)?p[e]=!0:(m[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=null===n?3!==s.type&&"":n:(t=s.attributeName,r=s.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(s=s.type)||4===s&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(x,y);g[t]=new f(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(x,y);g[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(x,y);g[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)});var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),j=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),E=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),_=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function R(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=M&&e[M]||e["@@iterator"])?e:null}var O,L=Object.assign;function F(e){if(void 0===O)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);O=t&&t[1]||""}return"\n"+O+e}var V=!1;function z(e,t){if(!e||V)return"";V=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var s=c.stack.split("\n"),a=r.stack.split("\n"),i=s.length-1,l=a.length-1;1<=i&&0<=l&&s[i]!==a[l];)l--;for(;1<=i&&0<=l;i--,l--)if(s[i]!==a[l]){if(1!==i||1!==l)do{if(i--,0>--l||s[i]!==a[l]){var o="\n"+s[i].replace(" at new "," at ");return e.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",e.displayName)),o}}while(1<=i&&0<=l);break}}}finally{V=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function U(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function K(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case N:return"Fragment";case j:return"Portal";case S:return"Profiler";case k:return"StrictMode";case I:return"Suspense";case _:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case A:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:K(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return K(e(t))}catch(n){}}return null}function B(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return K(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var s=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function W(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function J(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Z(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=q(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&v(e,"checked",t,!1)}function Y(e,t){X(e,t);var n=q(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+q(n),t=null,s=0;s<e.length;s++){if(e[s].value===n)return e[s].selected=!0,void(r&&(e[s].defaultSelected=!0));null!==t||e[s].disabled||(t=e[s])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function se(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:q(n)}}function ae(e,t){var n=q(t.value),r=q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function le(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function oe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?le(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var me={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||me.hasOwnProperty(e)&&me[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),s=fe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}Object.keys(me).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),me[t]=me[e]})});var xe=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(xe[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function ve(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var je=null,Ne=null,ke=null;function Se(e){if(e=vs(e)){if("function"!==typeof je)throw Error(a(280));var t=e.stateNode;t&&(t=ws(t),je(e.stateNode,e.type,t))}}function Ce(e){Ne?ke?ke.push(e):ke=[e]:Ne=e}function Ee(){if(Ne){var e=Ne,t=ke;if(ke=Ne=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Ae(e,t){return e(t)}function Ie(){}var _e=!1;function Te(e,t,n){if(_e)return e(t,n);_e=!0;try{return Ae(e,t,n)}finally{_e=!1,(null!==Ne||null!==ke)&&(Ie(),Ee())}}function De(e,t){var n=e.stateNode;if(null===n)return null;var r=ws(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Pe=!1;if(u)try{var Me={};Object.defineProperty(Me,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",Me,Me),window.removeEventListener("test",Me,Me)}catch(ue){Pe=!1}function Re(e,t,n,r,s,a,i,l,o){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Oe=!1,Le=null,Fe=!1,Ve=null,ze={onError:function(e){Oe=!0,Le=e}};function Ue(e,t,n,r,s,a,i,l,o){Oe=!1,Le=null,Re.apply(ze,arguments)}function Ke(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Be(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(Ke(e)!==e)throw Error(a(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ke(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(null===s)break;var i=s.alternate;if(null===i){if(null!==(r=s.return)){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return qe(s),e;if(i===r)return qe(s),t;i=i.sibling}throw Error(a(188))}if(n.return!==r.return)n=s,r=i;else{for(var l=!1,o=s.child;o;){if(o===n){l=!0,n=s,r=i;break}if(o===r){l=!0,r=s,n=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===n){l=!0,n=i,r=s;break}if(o===r){l=!0,r=i,n=s;break}o=o.sibling}if(!l)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var We=s.unstable_scheduleCallback,Qe=s.unstable_cancelCallback,Je=s.unstable_shouldYield,Ze=s.unstable_requestPaint,Xe=s.unstable_now,Ye=s.unstable_getCurrentPriorityLevel,$e=s.unstable_ImmediatePriority,et=s.unstable_UserBlockingPriority,tt=s.unstable_NormalPriority,nt=s.unstable_LowPriority,rt=s.unstable_IdlePriority,st=null,at=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(lt(e)/ot|0)|0},lt=Math.log,ot=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,s=e.suspendedLanes,a=e.pingedLanes,i=268435455&n;if(0!==i){var l=i&~s;0!==l?r=dt(l):0!==(a&=i)&&(r=dt(a))}else 0!==(i=n&~s)?r=dt(i):0!==a&&(r=dt(a));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&s)&&((s=r&-r)>=(a=t&-t)||16===s&&0!==(4194240&a)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)s=1<<(n=31-it(t)),r|=e[n],t&=~s;return r}function mt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function xt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-it(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var vt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,jt,Nt,kt,St,Ct=!1,Et=[],At=null,It=null,_t=null,Tt=new Map,Dt=new Map,Pt=[],Mt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rt(e,t){switch(e){case"focusin":case"focusout":At=null;break;case"dragenter":case"dragleave":It=null;break;case"mouseover":case"mouseout":_t=null;break;case"pointerover":case"pointerout":Tt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Ot(e,t,n,r,s,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[s]},null!==t&&(null!==(t=vs(t))&&jt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==s&&-1===t.indexOf(s)&&t.push(s),e)}function Lt(e){var t=ys(e.target);if(null!==t){var n=Ke(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Be(n)))return e.blockedOn=t,void St(e.priority,function(){Nt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Jt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=vs(n))&&jt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function Vt(e,t,n){Ft(e)&&n.delete(t)}function zt(){Ct=!1,null!==At&&Ft(At)&&(At=null),null!==It&&Ft(It)&&(It=null),null!==_t&&Ft(_t)&&(_t=null),Tt.forEach(Vt),Dt.forEach(Vt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,zt)))}function Kt(e){function t(t){return Ut(t,e)}if(0<Et.length){Ut(Et[0],e);for(var n=1;n<Et.length;n++){var r=Et[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==At&&Ut(At,e),null!==It&&Ut(It,e),null!==_t&&Ut(_t,e),Tt.forEach(t),Dt.forEach(t),n=0;n<Pt.length;n++)(r=Pt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Pt.length&&null===(n=Pt[0]).blockedOn;)Lt(n),null===n.blockedOn&&Pt.shift()}var Bt=b.ReactCurrentBatchConfig,qt=!0;function Ht(e,t,n,r){var s=vt,a=Bt.transition;Bt.transition=null;try{vt=1,Wt(e,t,n,r)}finally{vt=s,Bt.transition=a}}function Gt(e,t,n,r){var s=vt,a=Bt.transition;Bt.transition=null;try{vt=4,Wt(e,t,n,r)}finally{vt=s,Bt.transition=a}}function Wt(e,t,n,r){if(qt){var s=Jt(e,t,n,r);if(null===s)qr(e,t,r,Qt,n),Rt(e,r);else if(function(e,t,n,r,s){switch(t){case"focusin":return At=Ot(At,e,t,n,r,s),!0;case"dragenter":return It=Ot(It,e,t,n,r,s),!0;case"mouseover":return _t=Ot(_t,e,t,n,r,s),!0;case"pointerover":var a=s.pointerId;return Tt.set(a,Ot(Tt.get(a)||null,e,t,n,r,s)),!0;case"gotpointercapture":return a=s.pointerId,Dt.set(a,Ot(Dt.get(a)||null,e,t,n,r,s)),!0}return!1}(s,e,t,n,r))r.stopPropagation();else if(Rt(e,r),4&t&&-1<Mt.indexOf(e)){for(;null!==s;){var a=vs(s);if(null!==a&&wt(a),null===(a=Jt(e,t,n,r))&&qr(e,t,r,Qt,n),a===s)break;s=a}null!==s&&r.stopPropagation()}else qr(e,t,r,null,n)}}var Qt=null;function Jt(e,t,n,r){if(Qt=null,null!==(e=ys(e=we(r))))if(null===(t=Ke(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Be(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Zt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ye()){case $e:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Xt=null,Yt=null,$t=null;function en(){if($t)return $t;var e,t,n=Yt,r=n.length,s="value"in Xt?Xt.value:Xt.textContent,a=s.length;for(e=0;e<r&&n[e]===s[e];e++);var i=r-e;for(t=1;t<=i&&n[r-t]===s[a-t];t++);return $t=s.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,s,a){for(var i in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(s):s[i]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,ln,on,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),dn=L({},cn,{view:0,detail:0}),hn=sn(dn),mn=L({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==on&&(on&&"mousemove"===e.type?(an=e.screenX-on.screenX,ln=e.screenY-on.screenY):ln=an=0,on=e),an)},movementY:function(e){return"movementY"in e?e.movementY:ln}}),pn=sn(mn),fn=sn(L({},mn,{dataTransfer:0})),gn=sn(L({},dn,{relatedTarget:0})),xn=sn(L({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=L({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vn=sn(yn),bn=sn(L({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Nn[e])&&!!t[e]}function Sn(){return kn}var Cn=L({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?jn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),En=sn(Cn),An=sn(L({},mn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),In=sn(L({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sn})),_n=sn(L({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Tn=L({},mn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=sn(Tn),Pn=[9,13,27,32],Mn=u&&"CompositionEvent"in window,Rn=null;u&&"documentMode"in document&&(Rn=document.documentMode);var On=u&&"TextEvent"in window&&!Rn,Ln=u&&(!Mn||Rn&&8<Rn&&11>=Rn),Fn=String.fromCharCode(32),Vn=!1;function zn(e,t){switch(e){case"keyup":return-1!==Pn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Kn=!1;var Bn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Bn[e.type]:"textarea"===t}function Hn(e,t,n,r){Ce(r),0<(t=Gr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gn=null,Wn=null;function Qn(e){Fr(e,0)}function Jn(e){if(W(bs(e)))return e}function Zn(e,t){if("change"===e)return t}var Xn=!1;if(u){var Yn;if(u){var $n="oninput"in document;if(!$n){var er=document.createElement("div");er.setAttribute("oninput","return;"),$n="function"===typeof er.oninput}Yn=$n}else Yn=!1;Xn=Yn&&(!document.documentMode||9<document.documentMode)}function tr(){Gn&&(Gn.detachEvent("onpropertychange",nr),Wn=Gn=null)}function nr(e){if("value"===e.propertyName&&Jn(Wn)){var t=[];Hn(t,Wn,e,we(e)),Te(Qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Wn=n,(Gn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function sr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jn(Wn)}function ar(e,t){if("click"===e)return Jn(t)}function ir(e,t){if("input"===e||"change"===e)return Jn(t)}var lr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function or(e,t){if(lr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!d.call(t,s)||!lr(e[s],t[s]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function mr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&mr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var s=n.textContent.length,a=Math.min(r.start,s);r=void 0===r.end?a:Math.min(r.end,s),!e.extend&&a>r&&(s=r,r=a,a=s),s=ur(n,a);var i=ur(n,r);s&&i&&(1!==e.rangeCount||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(s.node,s.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,xr=null,yr=null,vr=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;vr||null==gr||gr!==Q(r)||("selectionStart"in(r=gr)&&mr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&or(yr,r)||(yr=r,0<(r=Gr(xr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var jr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Nr={},kr={};function Sr(e){if(Nr[e])return Nr[e];if(!jr[e])return e;var t,n=jr[e];for(t in n)if(n.hasOwnProperty(t)&&t in kr)return Nr[e]=n[t];return e}u&&(kr=document.createElement("div").style,"AnimationEvent"in window||(delete jr.animationend.animation,delete jr.animationiteration.animation,delete jr.animationstart.animation),"TransitionEvent"in window||delete jr.transitionend.transition);var Cr=Sr("animationend"),Er=Sr("animationiteration"),Ar=Sr("animationstart"),Ir=Sr("transitionend"),_r=new Map,Tr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dr(e,t){_r.set(e,t),o(t,[e])}for(var Pr=0;Pr<Tr.length;Pr++){var Mr=Tr[Pr];Dr(Mr.toLowerCase(),"on"+(Mr[0].toUpperCase()+Mr.slice(1)))}Dr(Cr,"onAnimationEnd"),Dr(Er,"onAnimationIteration"),Dr(Ar,"onAnimationStart"),Dr("dblclick","onDoubleClick"),Dr("focusin","onFocus"),Dr("focusout","onBlur"),Dr(Ir,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Or=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rr));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,s,i,l,o,c){if(Ue.apply(this,arguments),Oe){if(!Oe)throw Error(a(198));var u=Le;Oe=!1,Le=null,Fe||(Fe=!0,Ve=u)}}(r,t,void 0,e),e.currentTarget=null}function Fr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var i=r.length-1;0<=i;i--){var l=r[i],o=l.instance,c=l.currentTarget;if(l=l.listener,o!==a&&s.isPropagationStopped())break e;Lr(s,l,c),a=o}else for(i=0;i<r.length;i++){if(o=(l=r[i]).instance,c=l.currentTarget,l=l.listener,o!==a&&s.isPropagationStopped())break e;Lr(s,l,c),a=o}}}if(Fe)throw e=Ve,Fe=!1,Ve=null,e}function Vr(e,t){var n=t[fs];void 0===n&&(n=t[fs]=new Set);var r=e+"__bubble";n.has(r)||(Br(t,e,2,!1),n.add(r))}function zr(e,t,n){var r=0;t&&(r|=4),Br(n,e,r,t)}var Ur="_reactListening"+Math.random().toString(36).slice(2);function Kr(e){if(!e[Ur]){e[Ur]=!0,i.forEach(function(t){"selectionchange"!==t&&(Or.has(t)||zr(t,!1,e),zr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ur]||(t[Ur]=!0,zr("selectionchange",!1,t))}}function Br(e,t,n,r){switch(Zt(t)){case 1:var s=Ht;break;case 4:s=Gt;break;default:s=Wt}n=s.bind(null,t,n,e),s=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(s=!0),r?void 0!==s?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):void 0!==s?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function qr(e,t,n,r,s){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var i=r.tag;if(3===i||4===i){var l=r.stateNode.containerInfo;if(l===s||8===l.nodeType&&l.parentNode===s)break;if(4===i)for(i=r.return;null!==i;){var o=i.tag;if((3===o||4===o)&&((o=i.stateNode.containerInfo)===s||8===o.nodeType&&o.parentNode===s))return;i=i.return}for(;null!==l;){if(null===(i=ys(l)))return;if(5===(o=i.tag)||6===o){r=a=i;continue e}l=l.parentNode}}r=r.return}Te(function(){var r=a,s=we(n),i=[];e:{var l=_r.get(e);if(void 0!==l){var o=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":o=En;break;case"focusin":c="focus",o=gn;break;case"focusout":c="blur",o=gn;break;case"beforeblur":case"afterblur":o=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":o=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":o=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":o=In;break;case Cr:case Er:case Ar:o=xn;break;case Ir:o=_n;break;case"scroll":o=hn;break;case"wheel":o=Dn;break;case"copy":case"cut":case"paste":o=vn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":o=An}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==l?l+"Capture":null:l;u=[];for(var m,p=r;null!==p;){var f=(m=p).stateNode;if(5===m.tag&&null!==f&&(m=f,null!==h&&(null!=(f=De(p,h))&&u.push(Hr(p,f,m)))),d)break;p=p.return}0<u.length&&(l=new o(l,c,null,n,s),i.push({event:l,listeners:u}))}}if(0===(7&t)){if(o="mouseout"===e||"pointerout"===e,(!(l="mouseover"===e||"pointerover"===e)||n===be||!(c=n.relatedTarget||n.fromElement)||!ys(c)&&!c[ps])&&(o||l)&&(l=s.window===s?s:(l=s.ownerDocument)?l.defaultView||l.parentWindow:window,o?(o=r,null!==(c=(c=n.relatedTarget||n.toElement)?ys(c):null)&&(c!==(d=Ke(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(o=null,c=r),o!==c)){if(u=pn,f="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=An,f="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==o?l:bs(o),m=null==c?l:bs(c),(l=new u(f,p+"leave",o,n,s)).target=d,l.relatedTarget=m,f=null,ys(s)===r&&((u=new u(h,p+"enter",c,n,s)).target=m,u.relatedTarget=d,f=u),d=f,o&&c)e:{for(h=c,p=0,m=u=o;m;m=Wr(m))p++;for(m=0,f=h;f;f=Wr(f))m++;for(;0<p-m;)u=Wr(u),p--;for(;0<m-p;)h=Wr(h),m--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=Wr(u),h=Wr(h)}u=null}else u=null;null!==o&&Qr(i,l,o,u,!1),null!==c&&null!==d&&Qr(i,d,c,u,!0)}if("select"===(o=(l=r?bs(r):window).nodeName&&l.nodeName.toLowerCase())||"input"===o&&"file"===l.type)var g=Zn;else if(qn(l))if(Xn)g=ir;else{g=sr;var x=rr}else(o=l.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===l.type||"radio"===l.type)&&(g=ar);switch(g&&(g=g(e,r))?Hn(i,g,n,s):(x&&x(e,l,r),"focusout"===e&&(x=l._wrapperState)&&x.controlled&&"number"===l.type&&ee(l,"number",l.value)),x=r?bs(r):window,e){case"focusin":(qn(x)||"true"===x.contentEditable)&&(gr=x,xr=r,yr=null);break;case"focusout":yr=xr=gr=null;break;case"mousedown":vr=!0;break;case"contextmenu":case"mouseup":case"dragend":vr=!1,br(i,n,s);break;case"selectionchange":if(fr)break;case"keydown":case"keyup":br(i,n,s)}var y;if(Mn)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Kn?zn(e,n)&&(v="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(v="onCompositionStart");v&&(Ln&&"ko"!==n.locale&&(Kn||"onCompositionStart"!==v?"onCompositionEnd"===v&&Kn&&(y=en()):(Yt="value"in(Xt=s)?Xt.value:Xt.textContent,Kn=!0)),0<(x=Gr(r,v)).length&&(v=new bn(v,e,null,n,s),i.push({event:v,listeners:x}),y?v.data=y:null!==(y=Un(n))&&(v.data=y))),(y=On?function(e,t){switch(e){case"compositionend":return Un(t);case"keypress":return 32!==t.which?null:(Vn=!0,Fn);case"textInput":return(e=t.data)===Fn&&Vn?null:e;default:return null}}(e,n):function(e,t){if(Kn)return"compositionend"===e||!Mn&&zn(e,t)?(e=en(),$t=Yt=Xt=null,Kn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Gr(r,"onBeforeInput")).length&&(s=new bn("onBeforeInput","beforeinput",null,n,s),i.push({event:s,listeners:r}),s.data=y))}Fr(i,t)})}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gr(e,t){for(var n=t+"Capture",r=[];null!==e;){var s=e,a=s.stateNode;5===s.tag&&null!==a&&(s=a,null!=(a=De(e,n))&&r.unshift(Hr(e,a,s)),null!=(a=De(e,t))&&r.push(Hr(e,a,s))),e=e.return}return r}function Wr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,s){for(var a=t._reactName,i=[];null!==n&&n!==r;){var l=n,o=l.alternate,c=l.stateNode;if(null!==o&&o===r)break;5===l.tag&&null!==c&&(l=c,s?null!=(o=De(n,a))&&i.unshift(Hr(n,o,l)):s||null!=(o=De(n,a))&&i.push(Hr(n,o,l))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var Jr=/\r\n?/g,Zr=/\u0000|\uFFFD/g;function Xr(e){return("string"===typeof e?e:""+e).replace(Jr,"\n").replace(Zr,"")}function Yr(e,t,n){if(t=Xr(t),Xr(e)!==t&&n)throw Error(a(425))}function $r(){}var es=null,ts=null;function ns(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var rs="function"===typeof setTimeout?setTimeout:void 0,ss="function"===typeof clearTimeout?clearTimeout:void 0,as="function"===typeof Promise?Promise:void 0,is="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof as?function(e){return as.resolve(null).then(e).catch(ls)}:rs;function ls(e){setTimeout(function(){throw e})}function os(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&8===s.nodeType)if("/$"===(n=s.data)){if(0===r)return e.removeChild(s),void Kt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=s}while(n);Kt(t)}function cs(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function us(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ds=Math.random().toString(36).slice(2),hs="__reactFiber$"+ds,ms="__reactProps$"+ds,ps="__reactContainer$"+ds,fs="__reactEvents$"+ds,gs="__reactListeners$"+ds,xs="__reactHandles$"+ds;function ys(e){var t=e[hs];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ps]||n[hs]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=us(e);null!==e;){if(n=e[hs])return n;e=us(e)}return t}n=(e=n).parentNode}return null}function vs(e){return!(e=e[hs]||e[ps])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function bs(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function ws(e){return e[ms]||null}var js=[],Ns=-1;function ks(e){return{current:e}}function Ss(e){0>Ns||(e.current=js[Ns],js[Ns]=null,Ns--)}function Cs(e,t){Ns++,js[Ns]=e.current,e.current=t}var Es={},As=ks(Es),Is=ks(!1),_s=Es;function Ts(e,t){var n=e.type.contextTypes;if(!n)return Es;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s,a={};for(s in n)a[s]=t[s];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ds(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ps(){Ss(Is),Ss(As)}function Ms(e,t,n){if(As.current!==Es)throw Error(a(168));Cs(As,t),Cs(Is,n)}function Rs(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var s in r=r.getChildContext())if(!(s in t))throw Error(a(108,B(e)||"Unknown",s));return L({},n,r)}function Os(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Es,_s=As.current,Cs(As,e),Cs(Is,Is.current),!0}function Ls(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Rs(e,t,_s),r.__reactInternalMemoizedMergedChildContext=e,Ss(Is),Ss(As),Cs(As,e)):Ss(Is),Cs(Is,n)}var Fs=null,Vs=!1,zs=!1;function Us(e){null===Fs?Fs=[e]:Fs.push(e)}function Ks(){if(!zs&&null!==Fs){zs=!0;var e=0,t=vt;try{var n=Fs;for(vt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Fs=null,Vs=!1}catch(s){throw null!==Fs&&(Fs=Fs.slice(e+1)),We($e,Ks),s}finally{vt=t,zs=!1}}return null}var Bs=[],qs=0,Hs=null,Gs=0,Ws=[],Qs=0,Js=null,Zs=1,Xs="";function Ys(e,t){Bs[qs++]=Gs,Bs[qs++]=Hs,Hs=e,Gs=t}function $s(e,t,n){Ws[Qs++]=Zs,Ws[Qs++]=Xs,Ws[Qs++]=Js,Js=e;var r=Zs;e=Xs;var s=32-it(r)-1;r&=~(1<<s),n+=1;var a=32-it(t)+s;if(30<a){var i=s-s%5;a=(r&(1<<i)-1).toString(32),r>>=i,s-=i,Zs=1<<32-it(t)+s|n<<s|r,Xs=a+e}else Zs=1<<a|n<<s|r,Xs=e}function ea(e){null!==e.return&&(Ys(e,1),$s(e,1,0))}function ta(e){for(;e===Hs;)Hs=Bs[--qs],Bs[qs]=null,Gs=Bs[--qs],Bs[qs]=null;for(;e===Js;)Js=Ws[--Qs],Ws[Qs]=null,Xs=Ws[--Qs],Ws[Qs]=null,Zs=Ws[--Qs],Ws[Qs]=null}var na=null,ra=null,sa=!1,aa=null;function ia(e,t){var n=Tc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function la(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,ra=cs(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,ra=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Js?{id:Zs,overflow:Xs}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Tc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,na=e,ra=null,!0);default:return!1}}function oa(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ca(e){if(sa){var t=ra;if(t){var n=t;if(!la(e,t)){if(oa(e))throw Error(a(418));t=cs(n.nextSibling);var r=na;t&&la(e,t)?ia(r,n):(e.flags=-4097&e.flags|2,sa=!1,na=e)}}else{if(oa(e))throw Error(a(418));e.flags=-4097&e.flags|2,sa=!1,na=e}}}function ua(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function da(e){if(e!==na)return!1;if(!sa)return ua(e),sa=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ns(e.type,e.memoizedProps)),t&&(t=ra)){if(oa(e))throw ha(),Error(a(418));for(;t;)ia(e,t),t=cs(t.nextSibling)}if(ua(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ra=cs(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ra=null}}else ra=na?cs(e.stateNode.nextSibling):null;return!0}function ha(){for(var e=ra;e;)e=cs(e.nextSibling)}function ma(){ra=na=null,sa=!1}function pa(e){null===aa?aa=[e]:aa.push(e)}var fa=b.ReactCurrentBatchConfig;function ga(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var s=r,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=s.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function xa(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ya(e){return(0,e._init)(e._payload)}function va(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function s(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function l(t){return e&&null===t.alternate&&(t.flags|=2),t}function o(e,t,n,r){return null===t||6!==t.tag?((t=Lc(n,e.mode,r)).return=e,t):((t=s(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===N?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===D&&ya(a)===t.type)?((r=s(t,n.props)).ref=ga(e,t,n),r.return=e,r):((r=Mc(n.type,n.key,n.props,null,e.mode,r)).ref=ga(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,r)).return=e,t):((t=s(t,n.children||[])).return=e,t)}function d(e,t,n,r,a){return null===t||7!==t.tag?((t=Rc(n,e.mode,r,a)).return=e,t):((t=s(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Mc(t.type,t.key,t.props,null,e.mode,n)).ref=ga(e,null,t),n.return=e,n;case j:return(t=Fc(t,e.mode,n)).return=e,t;case D:return h(e,(0,t._init)(t._payload),n)}if(te(t)||R(t))return(t=Rc(t,e.mode,n,null)).return=e,t;xa(e,t)}return null}function m(e,t,n,r){var s=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==s?null:o(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===s?c(e,t,n,r):null;case j:return n.key===s?u(e,t,n,r):null;case D:return m(e,t,(s=n._init)(n._payload),r)}if(te(n)||R(n))return null!==s?null:d(e,t,n,r,null);xa(e,n)}return null}function p(e,t,n,r,s){if("string"===typeof r&&""!==r||"number"===typeof r)return o(t,e=e.get(n)||null,""+r,s);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,s);case j:return u(t,e=e.get(null===r.key?n:r.key)||null,r,s);case D:return p(e,t,n,(0,r._init)(r._payload),s)}if(te(r)||R(r))return d(t,e=e.get(n)||null,r,s,null);xa(t,r)}return null}function f(s,a,l,o){for(var c=null,u=null,d=a,f=a=0,g=null;null!==d&&f<l.length;f++){d.index>f?(g=d,d=null):g=d.sibling;var x=m(s,d,l[f],o);if(null===x){null===d&&(d=g);break}e&&d&&null===x.alternate&&t(s,d),a=i(x,a,f),null===u?c=x:u.sibling=x,u=x,d=g}if(f===l.length)return n(s,d),sa&&Ys(s,f),c;if(null===d){for(;f<l.length;f++)null!==(d=h(s,l[f],o))&&(a=i(d,a,f),null===u?c=d:u.sibling=d,u=d);return sa&&Ys(s,f),c}for(d=r(s,d);f<l.length;f++)null!==(g=p(d,s,f,l[f],o))&&(e&&null!==g.alternate&&d.delete(null===g.key?f:g.key),a=i(g,a,f),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(s,e)}),sa&&Ys(s,f),c}function g(s,l,o,c){var u=R(o);if("function"!==typeof u)throw Error(a(150));if(null==(o=u.call(o)))throw Error(a(151));for(var d=u=null,f=l,g=l=0,x=null,y=o.next();null!==f&&!y.done;g++,y=o.next()){f.index>g?(x=f,f=null):x=f.sibling;var v=m(s,f,y.value,c);if(null===v){null===f&&(f=x);break}e&&f&&null===v.alternate&&t(s,f),l=i(v,l,g),null===d?u=v:d.sibling=v,d=v,f=x}if(y.done)return n(s,f),sa&&Ys(s,g),u;if(null===f){for(;!y.done;g++,y=o.next())null!==(y=h(s,y.value,c))&&(l=i(y,l,g),null===d?u=y:d.sibling=y,d=y);return sa&&Ys(s,g),u}for(f=r(s,f);!y.done;g++,y=o.next())null!==(y=p(f,s,g,y.value,c))&&(e&&null!==y.alternate&&f.delete(null===y.key?g:y.key),l=i(y,l,g),null===d?u=y:d.sibling=y,d=y);return e&&f.forEach(function(e){return t(s,e)}),sa&&Ys(s,g),u}return function e(r,a,i,o){if("object"===typeof i&&null!==i&&i.type===N&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case w:e:{for(var c=i.key,u=a;null!==u;){if(u.key===c){if((c=i.type)===N){if(7===u.tag){n(r,u.sibling),(a=s(u,i.props.children)).return=r,r=a;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&ya(c)===u.type){n(r,u.sibling),(a=s(u,i.props)).ref=ga(r,u,i),a.return=r,r=a;break e}n(r,u);break}t(r,u),u=u.sibling}i.type===N?((a=Rc(i.props.children,r.mode,o,i.key)).return=r,r=a):((o=Mc(i.type,i.key,i.props,null,r.mode,o)).ref=ga(r,a,i),o.return=r,r=o)}return l(r);case j:e:{for(u=i.key;null!==a;){if(a.key===u){if(4===a.tag&&a.stateNode.containerInfo===i.containerInfo&&a.stateNode.implementation===i.implementation){n(r,a.sibling),(a=s(a,i.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=Fc(i,r.mode,o)).return=r,r=a}return l(r);case D:return e(r,a,(u=i._init)(i._payload),o)}if(te(i))return f(r,a,i,o);if(R(i))return g(r,a,i,o);xa(r,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==a&&6===a.tag?(n(r,a.sibling),(a=s(a,i)).return=r,r=a):(n(r,a),(a=Lc(i,r.mode,o)).return=r,r=a),l(r)):n(r,a)}}var ba=va(!0),wa=va(!1),ja=ks(null),Na=null,ka=null,Sa=null;function Ca(){Sa=ka=Na=null}function Ea(e){var t=ja.current;Ss(ja),e._currentValue=t}function Aa(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ia(e,t){Na=e,Sa=ka=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(yl=!0),e.firstContext=null)}function _a(e){var t=e._currentValue;if(Sa!==e)if(e={context:e,memoizedValue:t,next:null},null===ka){if(null===Na)throw Error(a(308));ka=e,Na.dependencies={lanes:0,firstContext:e}}else ka=ka.next=e;return t}var Ta=null;function Da(e){null===Ta?Ta=[e]:Ta.push(e)}function Pa(e,t,n,r){var s=t.interleaved;return null===s?(n.next=n,Da(t)):(n.next=s.next,s.next=n),t.interleaved=n,Ma(e,r)}function Ma(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ra=!1;function Oa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function La(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Va(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Ao)){var s=r.pending;return null===s?t.next=t:(t.next=s.next,s.next=t),r.pending=t,Ma(e,n)}return null===(s=r.interleaved)?(t.next=t,Da(r)):(t.next=s.next,s.next=t),r.interleaved=t,Ma(e,n)}function za(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Ua(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var s=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?s=a=i:a=a.next=i,n=n.next}while(null!==n);null===a?s=a=t:a=a.next=t}else s=a=t;return n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ka(e,t,n,r){var s=e.updateQueue;Ra=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,l=s.shared.pending;if(null!==l){s.shared.pending=null;var o=l,c=o.next;o.next=null,null===i?a=c:i.next=c,i=o;var u=e.alternate;null!==u&&((l=(u=u.updateQueue).lastBaseUpdate)!==i&&(null===l?u.firstBaseUpdate=c:l.next=c,u.lastBaseUpdate=o))}if(null!==a){var d=s.baseState;for(i=0,u=c=o=null,l=a;;){var h=l.lane,m=l.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var p=e,f=l;switch(h=t,m=n,f.tag){case 1:if("function"===typeof(p=f.payload)){d=p.call(m,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=f.payload)?p.call(m,d,h):p)||void 0===h)break e;d=L({},d,h);break e;case 2:Ra=!0}}null!==l.callback&&0!==l.lane&&(e.flags|=64,null===(h=s.effects)?s.effects=[l]:h.push(l))}else m={eventTime:m,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===u?(c=u=m,o=d):u=u.next=m,i|=h;if(null===(l=l.next)){if(null===(l=s.shared.pending))break;l=(h=l).next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}if(null===u&&(o=d),s.baseState=o,s.firstBaseUpdate=c,s.lastBaseUpdate=u,null!==(t=s.shared.interleaved)){s=t;do{i|=s.lane,s=s.next}while(s!==t)}else null===a&&(s.shared.lanes=0);Oo|=i,e.lanes=i,e.memoizedState=d}}function Ba(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(null!==s){if(r.callback=null,r=n,"function"!==typeof s)throw Error(a(191,s));s.call(r)}}}var qa={},Ha=ks(qa),Ga=ks(qa),Wa=ks(qa);function Qa(e){if(e===qa)throw Error(a(174));return e}function Ja(e,t){switch(Cs(Wa,t),Cs(Ga,e),Cs(Ha,qa),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:oe(null,"");break;default:t=oe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ss(Ha),Cs(Ha,t)}function Za(){Ss(Ha),Ss(Ga),Ss(Wa)}function Xa(e){Qa(Wa.current);var t=Qa(Ha.current),n=oe(t,e.type);t!==n&&(Cs(Ga,e),Cs(Ha,n))}function Ya(e){Ga.current===e&&(Ss(Ha),Ss(Ga))}var $a=ks(0);function ei(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ti=[];function ni(){for(var e=0;e<ti.length;e++)ti[e]._workInProgressVersionPrimary=null;ti.length=0}var ri=b.ReactCurrentDispatcher,si=b.ReactCurrentBatchConfig,ai=0,ii=null,li=null,oi=null,ci=!1,ui=!1,di=0,hi=0;function mi(){throw Error(a(321))}function pi(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!lr(e[n],t[n]))return!1;return!0}function fi(e,t,n,r,s,i){if(ai=i,ii=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ri.current=null===e||null===e.memoizedState?Yi:$i,e=n(r,s),ui){i=0;do{if(ui=!1,di=0,25<=i)throw Error(a(301));i+=1,oi=li=null,t.updateQueue=null,ri.current=el,e=n(r,s)}while(ui)}if(ri.current=Xi,t=null!==li&&null!==li.next,ai=0,oi=li=ii=null,ci=!1,t)throw Error(a(300));return e}function gi(){var e=0!==di;return di=0,e}function xi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===oi?ii.memoizedState=oi=e:oi=oi.next=e,oi}function yi(){if(null===li){var e=ii.alternate;e=null!==e?e.memoizedState:null}else e=li.next;var t=null===oi?ii.memoizedState:oi.next;if(null!==t)oi=t,li=e;else{if(null===e)throw Error(a(310));e={memoizedState:(li=e).memoizedState,baseState:li.baseState,baseQueue:li.baseQueue,queue:li.queue,next:null},null===oi?ii.memoizedState=oi=e:oi=oi.next=e}return oi}function vi(e,t){return"function"===typeof t?t(e):t}function bi(e){var t=yi(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=li,s=r.baseQueue,i=n.pending;if(null!==i){if(null!==s){var l=s.next;s.next=i.next,i.next=l}r.baseQueue=s=i,n.pending=null}if(null!==s){i=s.next,r=r.baseState;var o=l=null,c=null,u=i;do{var d=u.lane;if((ai&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(o=c=h,l=r):c=c.next=h,ii.lanes|=d,Oo|=d}u=u.next}while(null!==u&&u!==i);null===c?l=r:c.next=o,lr(r,t.memoizedState)||(yl=!0),t.memoizedState=r,t.baseState=l,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){s=e;do{i=s.lane,ii.lanes|=i,Oo|=i,s=s.next}while(s!==e)}else null===s&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function wi(e){var t=yi(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(null!==s){n.pending=null;var l=s=s.next;do{i=e(i,l.action),l=l.next}while(l!==s);lr(i,t.memoizedState)||(yl=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function ji(){}function Ni(e,t){var n=ii,r=yi(),s=t(),i=!lr(r.memoizedState,s);if(i&&(r.memoizedState=s,yl=!0),r=r.queue,Ri(Ci.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||null!==oi&&1&oi.memoizedState.tag){if(n.flags|=2048,_i(9,Si.bind(null,n,r,s,t),void 0,null),null===Io)throw Error(a(349));0!==(30&ai)||ki(n,t,s)}return s}function ki(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Si(e,t,n,r){t.value=n,t.getSnapshot=r,Ei(t)&&Ai(e)}function Ci(e,t,n){return n(function(){Ei(t)&&Ai(e)})}function Ei(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!lr(e,n)}catch(r){return!0}}function Ai(e){var t=Ma(e,1);null!==t&&nc(t,e,1,-1)}function Ii(e){var t=xi();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vi,lastRenderedState:e},t.queue=e,e=e.dispatch=Wi.bind(null,ii,e),[t.memoizedState,e]}function _i(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ti(){return yi().memoizedState}function Di(e,t,n,r){var s=xi();ii.flags|=e,s.memoizedState=_i(1|t,n,void 0,void 0===r?null:r)}function Pi(e,t,n,r){var s=yi();r=void 0===r?null:r;var a=void 0;if(null!==li){var i=li.memoizedState;if(a=i.destroy,null!==r&&pi(r,i.deps))return void(s.memoizedState=_i(t,n,a,r))}ii.flags|=e,s.memoizedState=_i(1|t,n,a,r)}function Mi(e,t){return Di(8390656,8,e,t)}function Ri(e,t){return Pi(2048,8,e,t)}function Oi(e,t){return Pi(4,2,e,t)}function Li(e,t){return Pi(4,4,e,t)}function Fi(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Vi(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Pi(4,4,Fi.bind(null,t,e),n)}function zi(){}function Ui(e,t){var n=yi();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&pi(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ki(e,t){var n=yi();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&pi(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Bi(e,t,n){return 0===(21&ai)?(e.baseState&&(e.baseState=!1,yl=!0),e.memoizedState=n):(lr(n,t)||(n=ft(),ii.lanes|=n,Oo|=n,e.baseState=!0),t)}function qi(e,t){var n=vt;vt=0!==n&&4>n?n:4,e(!0);var r=si.transition;si.transition={};try{e(!1),t()}finally{vt=n,si.transition=r}}function Hi(){return yi().memoizedState}function Gi(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qi(e))Ji(t,n);else if(null!==(n=Pa(e,t,n,r))){nc(n,e,r,ec()),Zi(n,t,r)}}function Wi(e,t,n){var r=tc(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qi(e))Ji(t,s);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var i=t.lastRenderedState,l=a(i,n);if(s.hasEagerState=!0,s.eagerState=l,lr(l,i)){var o=t.interleaved;return null===o?(s.next=s,Da(t)):(s.next=o.next,o.next=s),void(t.interleaved=s)}}catch(c){}null!==(n=Pa(e,t,s,r))&&(nc(n,e,r,s=ec()),Zi(n,t,r))}}function Qi(e){var t=e.alternate;return e===ii||null!==t&&t===ii}function Ji(e,t){ui=ci=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Zi(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Xi={readContext:_a,useCallback:mi,useContext:mi,useEffect:mi,useImperativeHandle:mi,useInsertionEffect:mi,useLayoutEffect:mi,useMemo:mi,useReducer:mi,useRef:mi,useState:mi,useDebugValue:mi,useDeferredValue:mi,useTransition:mi,useMutableSource:mi,useSyncExternalStore:mi,useId:mi,unstable_isNewReconciler:!1},Yi={readContext:_a,useCallback:function(e,t){return xi().memoizedState=[e,void 0===t?null:t],e},useContext:_a,useEffect:Mi,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Di(4194308,4,Fi.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Di(4194308,4,e,t)},useInsertionEffect:function(e,t){return Di(4,2,e,t)},useMemo:function(e,t){var n=xi();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=xi();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Gi.bind(null,ii,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},xi().memoizedState=e},useState:Ii,useDebugValue:zi,useDeferredValue:function(e){return xi().memoizedState=e},useTransition:function(){var e=Ii(!1),t=e[0];return e=qi.bind(null,e[1]),xi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ii,s=xi();if(sa){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Io)throw Error(a(349));0!==(30&ai)||ki(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Mi(Ci.bind(null,r,i,e),[e]),r.flags|=2048,_i(9,Si.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=xi(),t=Io.identifierPrefix;if(sa){var n=Xs;t=":"+t+"R"+(n=(Zs&~(1<<32-it(Zs)-1)).toString(32)+n),0<(n=di++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=hi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},$i={readContext:_a,useCallback:Ui,useContext:_a,useEffect:Ri,useImperativeHandle:Vi,useInsertionEffect:Oi,useLayoutEffect:Li,useMemo:Ki,useReducer:bi,useRef:Ti,useState:function(){return bi(vi)},useDebugValue:zi,useDeferredValue:function(e){return Bi(yi(),li.memoizedState,e)},useTransition:function(){return[bi(vi)[0],yi().memoizedState]},useMutableSource:ji,useSyncExternalStore:Ni,useId:Hi,unstable_isNewReconciler:!1},el={readContext:_a,useCallback:Ui,useContext:_a,useEffect:Ri,useImperativeHandle:Vi,useInsertionEffect:Oi,useLayoutEffect:Li,useMemo:Ki,useReducer:wi,useRef:Ti,useState:function(){return wi(vi)},useDebugValue:zi,useDeferredValue:function(e){var t=yi();return null===li?t.memoizedState=e:Bi(t,li.memoizedState,e)},useTransition:function(){return[wi(vi)[0],yi().memoizedState]},useMutableSource:ji,useSyncExternalStore:Ni,useId:Hi,unstable_isNewReconciler:!1};function tl(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function nl(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var rl={isMounted:function(e){return!!(e=e._reactInternals)&&Ke(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),s=tc(e),a=Fa(r,s);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Va(e,a,s))&&(nc(t,e,s,r),za(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),s=tc(e),a=Fa(r,s);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Va(e,a,s))&&(nc(t,e,s,r),za(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),s=Fa(n,r);s.tag=2,void 0!==t&&null!==t&&(s.callback=t),null!==(t=Va(e,s,r))&&(nc(t,e,r,n),za(t,e,r))}};function sl(e,t,n,r,s,a,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,i):!t.prototype||!t.prototype.isPureReactComponent||(!or(n,r)||!or(s,a))}function al(e,t,n){var r=!1,s=Es,a=t.contextType;return"object"===typeof a&&null!==a?a=_a(a):(s=Ds(t)?_s:As.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ts(e,s):Es),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=rl,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function il(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&rl.enqueueReplaceState(t,t.state,null)}function ll(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Oa(e);var a=t.contextType;"object"===typeof a&&null!==a?s.context=_a(a):(a=Ds(t)?_s:As.current,s.context=Ts(e,a)),s.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(nl(e,t,a,n),s.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(t=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),t!==s.state&&rl.enqueueReplaceState(s,s.state,null),Ka(e,n,s,r),s.state=e.memoizedState),"function"===typeof s.componentDidMount&&(e.flags|=4194308)}function ol(e,t){try{var n="",r=t;do{n+=U(r),r=r.return}while(r);var s=n}catch(a){s="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:s,digest:null}}function cl(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ul(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var dl="function"===typeof WeakMap?WeakMap:Map;function hl(e,t,n){(n=Fa(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){qo||(qo=!0,Ho=r),ul(0,t)},n}function ml(e,t,n){(n=Fa(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){ul(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){ul(0,t),"function"!==typeof r&&(null===Go?Go=new Set([this]):Go.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function pl(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new dl;var s=new Set;r.set(t,s)}else void 0===(s=r.get(t))&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Sc.bind(null,e,t,n),t.then(e,e))}function fl(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function gl(e,t,n,r,s){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fa(-1,1)).tag=2,Va(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=s,e)}var xl=b.ReactCurrentOwner,yl=!1;function vl(e,t,n,r){t.child=null===e?wa(t,null,n,r):ba(t,e.child,n,r)}function bl(e,t,n,r,s){n=n.render;var a=t.ref;return Ia(t,s),r=fi(e,t,n,r,a,s),n=gi(),null===e||yl?(sa&&n&&ea(t),t.flags|=1,vl(e,t,r,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Bl(e,t,s))}function wl(e,t,n,r,s){if(null===e){var a=n.type;return"function"!==typeof a||Dc(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Mc(n.type,null,r,t,t.mode,s)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,jl(e,t,a,r,s))}if(a=e.child,0===(e.lanes&s)){var i=a.memoizedProps;if((n=null!==(n=n.compare)?n:or)(i,r)&&e.ref===t.ref)return Bl(e,t,s)}return t.flags|=1,(e=Pc(a,r)).ref=t.ref,e.return=t,t.child=e}function jl(e,t,n,r,s){if(null!==e){var a=e.memoizedProps;if(or(a,r)&&e.ref===t.ref){if(yl=!1,t.pendingProps=r=a,0===(e.lanes&s))return t.lanes=e.lanes,Bl(e,t,s);0!==(131072&e.flags)&&(yl=!0)}}return Sl(e,t,n,r,s)}function Nl(e,t,n){var r=t.pendingProps,s=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Cs(Po,Do),Do|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Cs(Po,Do),Do|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Cs(Po,Do),Do|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Cs(Po,Do),Do|=r;return vl(e,t,s,n),t.child}function kl(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Sl(e,t,n,r,s){var a=Ds(n)?_s:As.current;return a=Ts(t,a),Ia(t,s),n=fi(e,t,n,r,a,s),r=gi(),null===e||yl?(sa&&r&&ea(t),t.flags|=1,vl(e,t,n,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Bl(e,t,s))}function Cl(e,t,n,r,s){if(Ds(n)){var a=!0;Os(t)}else a=!1;if(Ia(t,s),null===t.stateNode)Kl(e,t),al(t,n,r),ll(t,n,r,s),r=!0;else if(null===e){var i=t.stateNode,l=t.memoizedProps;i.props=l;var o=i.context,c=n.contextType;"object"===typeof c&&null!==c?c=_a(c):c=Ts(t,c=Ds(n)?_s:As.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof i.getSnapshotBeforeUpdate;d||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(l!==r||o!==c)&&il(t,i,r,c),Ra=!1;var h=t.memoizedState;i.state=h,Ka(t,r,i,s),o=t.memoizedState,l!==r||h!==o||Is.current||Ra?("function"===typeof u&&(nl(t,n,u,r),o=t.memoizedState),(l=Ra||sl(t,n,l,r,h,o,c))?(d||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=o),i.props=r,i.state=o,i.context=c,r=l):("function"===typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,La(e,t),l=t.memoizedProps,c=t.type===t.elementType?l:tl(t.type,l),i.props=c,d=t.pendingProps,h=i.context,"object"===typeof(o=n.contextType)&&null!==o?o=_a(o):o=Ts(t,o=Ds(n)?_s:As.current);var m=n.getDerivedStateFromProps;(u="function"===typeof m||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(l!==d||h!==o)&&il(t,i,r,o),Ra=!1,h=t.memoizedState,i.state=h,Ka(t,r,i,s);var p=t.memoizedState;l!==d||h!==p||Is.current||Ra?("function"===typeof m&&(nl(t,n,m,r),p=t.memoizedState),(c=Ra||sl(t,n,c,r,h,p,o)||!1)?(u||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(r,p,o),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,p,o)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),i.props=r,i.state=p,i.context=o,r=c):("function"!==typeof i.componentDidUpdate||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return El(e,t,n,r,a,s)}function El(e,t,n,r,s,a){kl(e,t);var i=0!==(128&t.flags);if(!r&&!i)return s&&Ls(t,n,!1),Bl(e,t,a);r=t.stateNode,xl.current=t;var l=i&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&i?(t.child=ba(t,e.child,null,a),t.child=ba(t,null,l,a)):vl(e,t,l,a),t.memoizedState=r.state,s&&Ls(t,n,!0),t.child}function Al(e){var t=e.stateNode;t.pendingContext?Ms(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ms(0,t.context,!1),Ja(e,t.containerInfo)}function Il(e,t,n,r,s){return ma(),pa(s),t.flags|=256,vl(e,t,n,r),t.child}var _l,Tl,Dl,Pl,Ml={dehydrated:null,treeContext:null,retryLane:0};function Rl(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ol(e,t,n){var r,s=t.pendingProps,i=$a.current,l=!1,o=0!==(128&t.flags);if((r=o)||(r=(null===e||null!==e.memoizedState)&&0!==(2&i)),r?(l=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Cs($a,1&i),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(o=s.children,e=s.fallback,l?(s=t.mode,l=t.child,o={mode:"hidden",children:o},0===(1&s)&&null!==l?(l.childLanes=0,l.pendingProps=o):l=Oc(o,s,0,null),e=Rc(e,s,n,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=Rl(n),t.memoizedState=Ml,e):Ll(t,o));if(null!==(i=e.memoizedState)&&null!==(r=i.dehydrated))return function(e,t,n,r,s,i,l){if(n)return 256&t.flags?(t.flags&=-257,Fl(e,t,l,r=cl(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=Oc({mode:"visible",children:r.children},s,0,null),(i=Rc(i,s,l,null)).flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,0!==(1&t.mode)&&ba(t,e.child,null,l),t.child.memoizedState=Rl(l),t.memoizedState=Ml,i);if(0===(1&t.mode))return Fl(e,t,l,null);if("$!"===s.data){if(r=s.nextSibling&&s.nextSibling.dataset)var o=r.dgst;return r=o,Fl(e,t,l,r=cl(i=Error(a(419)),r,void 0))}if(o=0!==(l&e.childLanes),yl||o){if(null!==(r=Io)){switch(l&-l){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(s=0!==(s&(r.suspendedLanes|l))?0:s)&&s!==i.retryLane&&(i.retryLane=s,Ma(e,s),nc(r,e,s,-1))}return fc(),Fl(e,t,l,r=cl(Error(a(421))))}return"$?"===s.data?(t.flags|=128,t.child=e.child,t=Ec.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,ra=cs(s.nextSibling),na=t,sa=!0,aa=null,null!==e&&(Ws[Qs++]=Zs,Ws[Qs++]=Xs,Ws[Qs++]=Js,Zs=e.id,Xs=e.overflow,Js=t),t=Ll(t,r.children),t.flags|=4096,t)}(e,t,o,s,r,i,n);if(l){l=s.fallback,o=t.mode,r=(i=e.child).sibling;var c={mode:"hidden",children:s.children};return 0===(1&o)&&t.child!==i?((s=t.child).childLanes=0,s.pendingProps=c,t.deletions=null):(s=Pc(i,c)).subtreeFlags=14680064&i.subtreeFlags,null!==r?l=Pc(r,l):(l=Rc(l,o,n,null)).flags|=2,l.return=t,s.return=t,s.sibling=l,t.child=s,s=l,l=t.child,o=null===(o=e.child.memoizedState)?Rl(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},l.memoizedState=o,l.childLanes=e.childLanes&~n,t.memoizedState=Ml,s}return e=(l=e.child).sibling,s=Pc(l,{mode:"visible",children:s.children}),0===(1&t.mode)&&(s.lanes=n),s.return=t,s.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function Ll(e,t){return(t=Oc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Fl(e,t,n,r){return null!==r&&pa(r),ba(t,e.child,null,n),(e=Ll(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Vl(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Aa(e.return,t,n)}function zl(e,t,n,r,s){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=s)}function Ul(e,t,n){var r=t.pendingProps,s=r.revealOrder,a=r.tail;if(vl(e,t,r.children,n),0!==(2&(r=$a.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Vl(e,n,t);else if(19===e.tag)Vl(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Cs($a,r),0===(1&t.mode))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;null!==n;)null!==(e=n.alternate)&&null===ei(e)&&(s=n),n=n.sibling;null===(n=s)?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),zl(t,!1,s,n,a);break;case"backwards":for(n=null,s=t.child,t.child=null;null!==s;){if(null!==(e=s.alternate)&&null===ei(e)){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}zl(t,!0,n,null,a);break;case"together":zl(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Kl(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Bl(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Oo|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Pc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function ql(e,t){if(!sa)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Hl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;null!==s;)n|=s.lanes|s.childLanes,r|=14680064&s.subtreeFlags,r|=14680064&s.flags,s.return=e,s=s.sibling;else for(s=e.child;null!==s;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Gl(e,t,n){var r=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hl(t),null;case 1:case 17:return Ds(t.type)&&Ps(),Hl(t),null;case 3:return r=t.stateNode,Za(),Ss(Is),Ss(As),ni(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(da(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(ic(aa),aa=null))),Tl(e,t),Hl(t),null;case 5:Ya(t);var s=Qa(Wa.current);if(n=t.type,null!==e&&null!=t.stateNode)Dl(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return Hl(t),null}if(e=Qa(Ha.current),da(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[hs]=t,r[ms]=i,e=0!==(1&t.mode),n){case"dialog":Vr("cancel",r),Vr("close",r);break;case"iframe":case"object":case"embed":Vr("load",r);break;case"video":case"audio":for(s=0;s<Rr.length;s++)Vr(Rr[s],r);break;case"source":Vr("error",r);break;case"img":case"image":case"link":Vr("error",r),Vr("load",r);break;case"details":Vr("toggle",r);break;case"input":Z(r,i),Vr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Vr("invalid",r);break;case"textarea":se(r,i),Vr("invalid",r)}for(var o in ye(n,i),s=null,i)if(i.hasOwnProperty(o)){var c=i[o];"children"===o?"string"===typeof c?r.textContent!==c&&(!0!==i.suppressHydrationWarning&&Yr(r.textContent,c,e),s=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Yr(r.textContent,c,e),s=["children",""+c]):l.hasOwnProperty(o)&&null!=c&&"onScroll"===o&&Vr("scroll",r)}switch(n){case"input":G(r),$(r,i,!0);break;case"textarea":G(r),ie(r);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(r.onclick=$r)}r=s,t.updateQueue=r,null!==r&&(t.flags|=4)}else{o=9===s.nodeType?s:s.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=le(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=o.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),"select"===n&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[hs]=t,e[ms]=r,_l(e,t,!1,!1),t.stateNode=e;e:{switch(o=ve(n,r),n){case"dialog":Vr("cancel",e),Vr("close",e),s=r;break;case"iframe":case"object":case"embed":Vr("load",e),s=r;break;case"video":case"audio":for(s=0;s<Rr.length;s++)Vr(Rr[s],e);s=r;break;case"source":Vr("error",e),s=r;break;case"img":case"image":case"link":Vr("error",e),Vr("load",e),s=r;break;case"details":Vr("toggle",e),s=r;break;case"input":Z(e,r),s=J(e,r),Vr("invalid",e);break;case"option":default:s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=L({},r,{value:void 0}),Vr("invalid",e);break;case"textarea":se(e,r),s=re(e,r),Vr("invalid",e)}for(i in ye(n,s),c=s)if(c.hasOwnProperty(i)){var u=c[i];"style"===i?ge(e,u):"dangerouslySetInnerHTML"===i?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===i?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(l.hasOwnProperty(i)?null!=u&&"onScroll"===i&&Vr("scroll",e):null!=u&&v(e,i,u,o))}switch(n){case"input":G(e),$(e,r,!1);break;case"textarea":G(e),ie(e);break;case"option":null!=r.value&&e.setAttribute("value",""+q(r.value));break;case"select":e.multiple=!!r.multiple,null!=(i=r.value)?ne(e,!!r.multiple,i,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof s.onClick&&(e.onclick=$r)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Hl(t),null;case 6:if(e&&null!=t.stateNode)Pl(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(n=Qa(Wa.current),Qa(Ha.current),da(t)){if(r=t.stateNode,n=t.memoizedProps,r[hs]=t,(i=r.nodeValue!==n)&&null!==(e=na))switch(e.tag){case 3:Yr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Yr(r.nodeValue,n,0!==(1&e.mode))}i&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hs]=t,t.stateNode=r}return Hl(t),null;case 13:if(Ss($a),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(sa&&null!==ra&&0!==(1&t.mode)&&0===(128&t.flags))ha(),ma(),t.flags|=98560,i=!1;else if(i=da(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(a(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(a(317));i[hs]=t}else ma(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Hl(t),i=!1}else null!==aa&&(ic(aa),aa=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&$a.current)?0===Mo&&(Mo=3):fc())),null!==t.updateQueue&&(t.flags|=4),Hl(t),null);case 4:return Za(),Tl(e,t),null===e&&Kr(t.stateNode.containerInfo),Hl(t),null;case 10:return Ea(t.type._context),Hl(t),null;case 19:if(Ss($a),null===(i=t.memoizedState))return Hl(t),null;if(r=0!==(128&t.flags),null===(o=i.rendering))if(r)ql(i,!1);else{if(0!==Mo||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=ei(e))){for(t.flags|=128,ql(i,!1),null!==(r=o.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(i=n).flags&=14680066,null===(o=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Cs($a,1&$a.current|2),t.child}e=e.sibling}null!==i.tail&&Xe()>Ko&&(t.flags|=128,r=!0,ql(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ei(o))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),ql(i,!0),null===i.tail&&"hidden"===i.tailMode&&!o.alternate&&!sa)return Hl(t),null}else 2*Xe()-i.renderingStartTime>Ko&&1073741824!==n&&(t.flags|=128,r=!0,ql(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(null!==(n=i.last)?n.sibling=o:t.child=o,i.last=o)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Xe(),t.sibling=null,n=$a.current,Cs($a,r?1&n|2:1&n),t):(Hl(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Do)&&(Hl(t),6&t.subtreeFlags&&(t.flags|=8192)):Hl(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Wl(e,t){switch(ta(t),t.tag){case 1:return Ds(t.type)&&Ps(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Za(),Ss(Is),Ss(As),ni(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Ya(t),null;case 13:if(Ss($a),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));ma()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ss($a),null;case 4:return Za(),null;case 10:return Ea(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}_l=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Tl=function(){},Dl=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Qa(Ha.current);var a,i=null;switch(n){case"input":s=J(e,s),r=J(e,r),i=[];break;case"select":s=L({},s,{value:void 0}),r=L({},r,{value:void 0}),i=[];break;case"textarea":s=re(e,s),r=re(e,r),i=[];break;default:"function"!==typeof s.onClick&&"function"===typeof r.onClick&&(e.onclick=$r)}for(u in ye(n,r),n=null,s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&null!=s[u])if("style"===u){var o=s[u];for(a in o)o.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(l.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(o=null!=s?s[u]:void 0,r.hasOwnProperty(u)&&c!==o&&(null!=c||null!=o))if("style"===u)if(o){for(a in o)!o.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&o[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,o=o?o.__html:void 0,null!=c&&o!==c&&(i=i||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(i=i||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(l.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Vr("scroll",e),i||o===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(t.updateQueue=u)&&(t.flags|=4)}},Pl=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ql=!1,Jl=!1,Zl="function"===typeof WeakSet?WeakSet:Set,Xl=null;function Yl(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){kc(e,t,r)}else n.current=null}function $l(e,t,n){try{n()}catch(r){kc(e,t,r)}}var eo=!1;function to(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var s=r=r.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,void 0!==a&&$l(t,n,a)}s=s.next}while(s!==r)}}function no(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ro(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function so(e){var t=e.alternate;null!==t&&(e.alternate=null,so(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hs],delete t[ms],delete t[fs],delete t[gs],delete t[xs])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ao(e){return 5===e.tag||3===e.tag||4===e.tag}function io(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ao(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function lo(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$r));else if(4!==r&&null!==(e=e.child))for(lo(e,t,n),e=e.sibling;null!==e;)lo(e,t,n),e=e.sibling}function oo(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(oo(e,t,n),e=e.sibling;null!==e;)oo(e,t,n),e=e.sibling}var co=null,uo=!1;function ho(e,t,n){for(n=n.child;null!==n;)mo(e,t,n),n=n.sibling}function mo(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(st,n)}catch(l){}switch(n.tag){case 5:Jl||Yl(n,t);case 6:var r=co,s=uo;co=null,ho(e,t,n),uo=s,null!==(co=r)&&(uo?(e=co,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):co.removeChild(n.stateNode));break;case 18:null!==co&&(uo?(e=co,n=n.stateNode,8===e.nodeType?os(e.parentNode,n):1===e.nodeType&&os(e,n),Kt(e)):os(co,n.stateNode));break;case 4:r=co,s=uo,co=n.stateNode.containerInfo,uo=!0,ho(e,t,n),co=r,uo=s;break;case 0:case 11:case 14:case 15:if(!Jl&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){s=r=r.next;do{var a=s,i=a.destroy;a=a.tag,void 0!==i&&(0!==(2&a)||0!==(4&a))&&$l(n,t,i),s=s.next}while(s!==r)}ho(e,t,n);break;case 1:if(!Jl&&(Yl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){kc(n,t,l)}ho(e,t,n);break;case 21:ho(e,t,n);break;case 22:1&n.mode?(Jl=(r=Jl)||null!==n.memoizedState,ho(e,t,n),Jl=r):ho(e,t,n);break;default:ho(e,t,n)}}function po(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Zl),t.forEach(function(t){var r=Ac.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function fo(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,l=t,o=l;e:for(;null!==o;){switch(o.tag){case 5:co=o.stateNode,uo=!1;break e;case 3:case 4:co=o.stateNode.containerInfo,uo=!0;break e}o=o.return}if(null===co)throw Error(a(160));mo(i,l,s),co=null,uo=!1;var c=s.alternate;null!==c&&(c.return=null),s.return=null}catch(u){kc(s,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)go(t,e),t=t.sibling}function go(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fo(t,e),xo(e),4&r){try{to(3,e,e.return),no(3,e)}catch(g){kc(e,e.return,g)}try{to(5,e,e.return)}catch(g){kc(e,e.return,g)}}break;case 1:fo(t,e),xo(e),512&r&&null!==n&&Yl(n,n.return);break;case 5:if(fo(t,e),xo(e),512&r&&null!==n&&Yl(n,n.return),32&e.flags){var s=e.stateNode;try{he(s,"")}catch(g){kc(e,e.return,g)}}if(4&r&&null!=(s=e.stateNode)){var i=e.memoizedProps,l=null!==n?n.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===o&&"radio"===i.type&&null!=i.name&&X(s,i),ve(o,l);var u=ve(o,i);for(l=0;l<c.length;l+=2){var d=c[l],h=c[l+1];"style"===d?ge(s,h):"dangerouslySetInnerHTML"===d?de(s,h):"children"===d?he(s,h):v(s,d,h,u)}switch(o){case"input":Y(s,i);break;case"textarea":ae(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;null!=p?ne(s,!!i.multiple,p,!1):m!==!!i.multiple&&(null!=i.defaultValue?ne(s,!!i.multiple,i.defaultValue,!0):ne(s,!!i.multiple,i.multiple?[]:"",!1))}s[ms]=i}catch(g){kc(e,e.return,g)}}break;case 6:if(fo(t,e),xo(e),4&r){if(null===e.stateNode)throw Error(a(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(g){kc(e,e.return,g)}}break;case 3:if(fo(t,e),xo(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Kt(t.containerInfo)}catch(g){kc(e,e.return,g)}break;case 4:default:fo(t,e),xo(e);break;case 13:fo(t,e),xo(e),8192&(s=e.child).flags&&(i=null!==s.memoizedState,s.stateNode.isHidden=i,!i||null!==s.alternate&&null!==s.alternate.memoizedState||(Uo=Xe())),4&r&&po(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Jl=(u=Jl)||d,fo(t,e),Jl=u):fo(t,e),xo(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Xl=e,d=e.child;null!==d;){for(h=Xl=d;null!==Xl;){switch(p=(m=Xl).child,m.tag){case 0:case 11:case 14:case 15:to(4,m,m.return);break;case 1:Yl(m,m.return);var f=m.stateNode;if("function"===typeof f.componentWillUnmount){r=m,n=m.return;try{t=r,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(g){kc(r,n,g)}}break;case 5:Yl(m,m.return);break;case 22:if(null!==m.memoizedState){wo(h);continue}}null!==p?(p.return=m,Xl=p):wo(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{s=h.stateNode,u?"function"===typeof(i=s.style).setProperty?i.setProperty("display","none","important"):i.display="none":(o=h.stateNode,l=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,o.style.display=fe("display",l))}catch(g){kc(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){kc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:fo(t,e),xo(e),4&r&&po(e);case 21:}}function xo(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ao(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var s=r.stateNode;32&r.flags&&(he(s,""),r.flags&=-33),oo(e,io(e),s);break;case 3:case 4:var i=r.stateNode.containerInfo;lo(e,io(e),i);break;default:throw Error(a(161))}}catch(l){kc(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yo(e,t,n){Xl=e,vo(e,t,n)}function vo(e,t,n){for(var r=0!==(1&e.mode);null!==Xl;){var s=Xl,a=s.child;if(22===s.tag&&r){var i=null!==s.memoizedState||Ql;if(!i){var l=s.alternate,o=null!==l&&null!==l.memoizedState||Jl;l=Ql;var c=Jl;if(Ql=i,(Jl=o)&&!c)for(Xl=s;null!==Xl;)o=(i=Xl).child,22===i.tag&&null!==i.memoizedState?jo(s):null!==o?(o.return=i,Xl=o):jo(s);for(;null!==a;)Xl=a,vo(a,t,n),a=a.sibling;Xl=s,Ql=l,Jl=c}bo(e)}else 0!==(8772&s.subtreeFlags)&&null!==a?(a.return=s,Xl=a):bo(e)}}function bo(e){for(;null!==Xl;){var t=Xl;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Jl||no(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Jl)if(null===n)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:tl(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Ba(t,i,r);break;case 3:var l=t.updateQueue;if(null!==l){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ba(t,l,n)}break;case 5:var o=t.stateNode;if(null===n&&4&t.flags){n=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Kt(h)}}}break;default:throw Error(a(163))}Jl||512&t.flags&&ro(t)}catch(m){kc(t,t.return,m)}}if(t===e){Xl=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xl=n;break}Xl=t.return}}function wo(e){for(;null!==Xl;){var t=Xl;if(t===e){Xl=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xl=n;break}Xl=t.return}}function jo(e){for(;null!==Xl;){var t=Xl;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{no(4,t)}catch(o){kc(t,n,o)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var s=t.return;try{r.componentDidMount()}catch(o){kc(t,s,o)}}var a=t.return;try{ro(t)}catch(o){kc(t,a,o)}break;case 5:var i=t.return;try{ro(t)}catch(o){kc(t,i,o)}}}catch(o){kc(t,t.return,o)}if(t===e){Xl=null;break}var l=t.sibling;if(null!==l){l.return=t.return,Xl=l;break}Xl=t.return}}var No,ko=Math.ceil,So=b.ReactCurrentDispatcher,Co=b.ReactCurrentOwner,Eo=b.ReactCurrentBatchConfig,Ao=0,Io=null,_o=null,To=0,Do=0,Po=ks(0),Mo=0,Ro=null,Oo=0,Lo=0,Fo=0,Vo=null,zo=null,Uo=0,Ko=1/0,Bo=null,qo=!1,Ho=null,Go=null,Wo=!1,Qo=null,Jo=0,Zo=0,Xo=null,Yo=-1,$o=0;function ec(){return 0!==(6&Ao)?Xe():-1!==Yo?Yo:Yo=Xe()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Ao)&&0!==To?To&-To:null!==fa.transition?(0===$o&&($o=ft()),$o):0!==(e=vt)?e:e=void 0===(e=window.event)?16:Zt(e.type)}function nc(e,t,n,r){if(50<Zo)throw Zo=0,Xo=null,Error(a(185));xt(e,n,r),0!==(2&Ao)&&e===Io||(e===Io&&(0===(2&Ao)&&(Lo|=n),4===Mo&&lc(e,To)),rc(e,r),1===n&&0===Ao&&0===(1&t.mode)&&(Ko=Xe()+500,Vs&&Ks()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-it(a),l=1<<i,o=s[i];-1===o?0!==(l&n)&&0===(l&r)||(s[i]=mt(l,t)):o<=t&&(e.expiredLanes|=l),a&=~l}}(e,t);var r=ht(e,e===Io?To:0);if(0===r)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){Vs=!0,Us(e)}(oc.bind(null,e)):Us(oc.bind(null,e)),is(function(){0===(6&Ao)&&Ks()}),n=null;else{switch(bt(r)){case 1:n=$e;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Ic(n,sc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sc(e,t){if(Yo=-1,$o=0,0!==(6&Ao))throw Error(a(327));var n=e.callbackNode;if(jc()&&e.callbackNode!==n)return null;var r=ht(e,e===Io?To:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var s=Ao;Ao|=2;var i=pc();for(Io===e&&To===t||(Bo=null,Ko=Xe()+500,hc(e,t));;)try{yc();break}catch(o){mc(e,o)}Ca(),So.current=i,Ao=s,null!==_o?t=0:(Io=null,To=0,t=Mo)}if(0!==t){if(2===t&&(0!==(s=pt(e))&&(r=s,t=ac(e,s))),1===t)throw n=Ro,hc(e,0),lc(e,r),rc(e,Xe()),n;if(6===t)lc(e,r);else{if(s=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var s=n[r],a=s.getSnapshot;s=s.value;try{if(!lr(a(),s))return!1}catch(l){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(s)&&(2===(t=gc(e,r))&&(0!==(i=pt(e))&&(r=i,t=ac(e,i))),1===t))throw n=Ro,hc(e,0),lc(e,r),rc(e,Xe()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:wc(e,zo,Bo);break;case 3:if(lc(e,r),(130023424&r)===r&&10<(t=Uo+500-Xe())){if(0!==ht(e,0))break;if(((s=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=rs(wc.bind(null,e,zo,Bo),t);break}wc(e,zo,Bo);break;case 4:if(lc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,s=-1;0<r;){var l=31-it(r);i=1<<l,(l=t[l])>s&&(s=l),r&=~i}if(r=s,10<(r=(120>(r=Xe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ko(r/1960))-r)){e.timeoutHandle=rs(wc.bind(null,e,zo,Bo),r);break}wc(e,zo,Bo);break;default:throw Error(a(329))}}}return rc(e,Xe()),e.callbackNode===n?sc.bind(null,e):null}function ac(e,t){var n=Vo;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=zo,zo=n,null!==t&&ic(t)),e}function ic(e){null===zo?zo=e:zo.push.apply(zo,e)}function lc(e,t){for(t&=~Fo,t&=~Lo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-it(t),r=1<<n;e[n]=-1,t&=~r}}function oc(e){if(0!==(6&Ao))throw Error(a(327));jc();var t=ht(e,0);if(0===(1&t))return rc(e,Xe()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=ac(e,r))}if(1===n)throw n=Ro,hc(e,0),lc(e,t),rc(e,Xe()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,zo,Bo),rc(e,Xe()),null}function cc(e,t){var n=Ao;Ao|=1;try{return e(t)}finally{0===(Ao=n)&&(Ko=Xe()+500,Vs&&Ks())}}function uc(e){null!==Qo&&0===Qo.tag&&0===(6&Ao)&&jc();var t=Ao;Ao|=1;var n=Eo.transition,r=vt;try{if(Eo.transition=null,vt=1,e)return e()}finally{vt=r,Eo.transition=n,0===(6&(Ao=t))&&Ks()}}function dc(){Do=Po.current,Ss(Po)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ss(n)),null!==_o)for(n=_o.return;null!==n;){var r=n;switch(ta(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ps();break;case 3:Za(),Ss(Is),Ss(As),ni();break;case 5:Ya(r);break;case 4:Za();break;case 13:case 19:Ss($a);break;case 10:Ea(r.type._context);break;case 22:case 23:dc()}n=n.return}if(Io=e,_o=e=Pc(e.current,null),To=Do=t,Mo=0,Ro=null,Fo=Lo=Oo=0,zo=Vo=null,null!==Ta){for(t=0;t<Ta.length;t++)if(null!==(r=(n=Ta[t]).interleaved)){n.interleaved=null;var s=r.next,a=n.pending;if(null!==a){var i=a.next;a.next=s,r.next=i}n.pending=r}Ta=null}return e}function mc(e,t){for(;;){var n=_o;try{if(Ca(),ri.current=Xi,ci){for(var r=ii.memoizedState;null!==r;){var s=r.queue;null!==s&&(s.pending=null),r=r.next}ci=!1}if(ai=0,oi=li=ii=null,ui=!1,di=0,Co.current=null,null===n||null===n.return){Mo=1,Ro=t,_o=null;break}e:{var i=e,l=n.return,o=n,c=t;if(t=To,o.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=o,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=fl(l);if(null!==p){p.flags&=-257,gl(p,l,o,0,t),1&p.mode&&pl(i,u,t),c=u;var f=(t=p).updateQueue;if(null===f){var g=new Set;g.add(c),t.updateQueue=g}else f.add(c);break e}if(0===(1&t)){pl(i,u,t),fc();break e}c=Error(a(426))}else if(sa&&1&o.mode){var x=fl(l);if(null!==x){0===(65536&x.flags)&&(x.flags|=256),gl(x,l,o,0,t),pa(ol(c,o));break e}}i=c=ol(c,o),4!==Mo&&(Mo=2),null===Vo?Vo=[i]:Vo.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,Ua(i,hl(0,c,t));break e;case 1:o=c;var y=i.type,v=i.stateNode;if(0===(128&i.flags)&&("function"===typeof y.getDerivedStateFromError||null!==v&&"function"===typeof v.componentDidCatch&&(null===Go||!Go.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t,Ua(i,ml(i,o,t));break e}}i=i.return}while(null!==i)}bc(n)}catch(b){t=b,_o===n&&null!==n&&(_o=n=n.return);continue}break}}function pc(){var e=So.current;return So.current=Xi,null===e?Xi:e}function fc(){0!==Mo&&3!==Mo&&2!==Mo||(Mo=4),null===Io||0===(268435455&Oo)&&0===(268435455&Lo)||lc(Io,To)}function gc(e,t){var n=Ao;Ao|=2;var r=pc();for(Io===e&&To===t||(Bo=null,hc(e,t));;)try{xc();break}catch(s){mc(e,s)}if(Ca(),Ao=n,So.current=r,null!==_o)throw Error(a(261));return Io=null,To=0,Mo}function xc(){for(;null!==_o;)vc(_o)}function yc(){for(;null!==_o&&!Je();)vc(_o)}function vc(e){var t=No(e.alternate,e,Do);e.memoizedProps=e.pendingProps,null===t?bc(e):_o=t,Co.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Gl(n,t,Do)))return void(_o=n)}else{if(null!==(n=Wl(n,t)))return n.flags&=32767,void(_o=n);if(null===e)return Mo=6,void(_o=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(_o=t);_o=t=e}while(null!==t);0===Mo&&(Mo=5)}function wc(e,t,n){var r=vt,s=Eo.transition;try{Eo.transition=null,vt=1,function(e,t,n,r){do{jc()}while(null!==Qo);if(0!==(6&Ao))throw Error(a(327));n=e.finishedWork;var s=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-it(n),a=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~a}}(e,i),e===Io&&(_o=Io=null,To=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Wo||(Wo=!0,Ic(tt,function(){return jc(),null})),i=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||i){i=Eo.transition,Eo.transition=null;var l=vt;vt=1;var o=Ao;Ao|=4,Co.current=null,function(e,t){if(es=qt,mr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(w){n=null;break e}var l=0,o=-1,c=-1,u=0,d=0,h=e,m=null;t:for(;;){for(var p;h!==n||0!==s&&3!==h.nodeType||(o=l+s),h!==i||0!==r&&3!==h.nodeType||(c=l+r),3===h.nodeType&&(l+=h.nodeValue.length),null!==(p=h.firstChild);)m=h,h=p;for(;;){if(h===e)break t;if(m===n&&++u===s&&(o=l),m===i&&++d===r&&(c=l),null!==(p=h.nextSibling))break;m=(h=m).parentNode}h=p}n=-1===o||-1===c?null:{start:o,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ts={focusedElem:e,selectionRange:n},qt=!1,Xl=t;null!==Xl;)if(e=(t=Xl).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xl=e;else for(;null!==Xl;){t=Xl;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var g=f.memoizedProps,x=f.memoizedState,y=t.stateNode,v=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:tl(t.type,g),x);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(a(163))}}catch(w){kc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Xl=e;break}Xl=t.return}f=eo,eo=!1}(e,n),go(n,e),pr(ts),qt=!!es,ts=es=null,e.current=n,yo(n,e,s),Ze(),Ao=o,vt=l,Eo.transition=i}else e.current=n;if(Wo&&(Wo=!1,Qo=e,Jo=s),i=e.pendingLanes,0===i&&(Go=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(st,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Xe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(qo)throw qo=!1,e=Ho,Ho=null,e;0!==(1&Jo)&&0!==e.tag&&jc(),i=e.pendingLanes,0!==(1&i)?e===Xo?Zo++:(Zo=0,Xo=e):Zo=0,Ks()}(e,t,n,r)}finally{Eo.transition=s,vt=r}return null}function jc(){if(null!==Qo){var e=bt(Jo),t=Eo.transition,n=vt;try{if(Eo.transition=null,vt=16>e?16:e,null===Qo)var r=!1;else{if(e=Qo,Qo=null,Jo=0,0!==(6&Ao))throw Error(a(331));var s=Ao;for(Ao|=4,Xl=e.current;null!==Xl;){var i=Xl,l=i.child;if(0!==(16&Xl.flags)){var o=i.deletions;if(null!==o){for(var c=0;c<o.length;c++){var u=o[c];for(Xl=u;null!==Xl;){var d=Xl;switch(d.tag){case 0:case 11:case 15:to(8,d,i)}var h=d.child;if(null!==h)h.return=d,Xl=h;else for(;null!==Xl;){var m=(d=Xl).sibling,p=d.return;if(so(d),d===u){Xl=null;break}if(null!==m){m.return=p,Xl=m;break}Xl=p}}}var f=i.alternate;if(null!==f){var g=f.child;if(null!==g){f.child=null;do{var x=g.sibling;g.sibling=null,g=x}while(null!==g)}}Xl=i}}if(0!==(2064&i.subtreeFlags)&&null!==l)l.return=i,Xl=l;else e:for(;null!==Xl;){if(0!==(2048&(i=Xl).flags))switch(i.tag){case 0:case 11:case 15:to(9,i,i.return)}var y=i.sibling;if(null!==y){y.return=i.return,Xl=y;break e}Xl=i.return}}var v=e.current;for(Xl=v;null!==Xl;){var b=(l=Xl).child;if(0!==(2064&l.subtreeFlags)&&null!==b)b.return=l,Xl=b;else e:for(l=v;null!==Xl;){if(0!==(2048&(o=Xl).flags))try{switch(o.tag){case 0:case 11:case 15:no(9,o)}}catch(j){kc(o,o.return,j)}if(o===l){Xl=null;break e}var w=o.sibling;if(null!==w){w.return=o.return,Xl=w;break e}Xl=o.return}}if(Ao=s,Ks(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(st,e)}catch(j){}r=!0}return r}finally{vt=n,Eo.transition=t}}return!1}function Nc(e,t,n){e=Va(e,t=hl(0,t=ol(n,t),1),1),t=ec(),null!==e&&(xt(e,1,t),rc(e,t))}function kc(e,t,n){if(3===e.tag)Nc(e,e,n);else for(;null!==t;){if(3===t.tag){Nc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Go||!Go.has(r))){t=Va(t,e=ml(t,e=ol(n,e),1),1),e=ec(),null!==t&&(xt(t,1,e),rc(t,e));break}}t=t.return}}function Sc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Io===e&&(To&n)===n&&(4===Mo||3===Mo&&(130023424&To)===To&&500>Xe()-Uo?hc(e,0):Fo|=n),rc(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Ma(e,t))&&(xt(e,t,n),rc(e,n))}function Ec(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cc(e,n)}function Ac(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;null!==s&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Cc(e,n)}function Ic(e,t){return We(e,t)}function _c(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tc(e,t,n,r){return new _c(e,t,n,r)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var n=e.alternate;return null===n?((n=Tc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Mc(e,t,n,r,s,i){var l=2;if(r=e,"function"===typeof e)Dc(e)&&(l=1);else if("string"===typeof e)l=5;else e:switch(e){case N:return Rc(n.children,s,i,t);case k:l=8,s|=8;break;case S:return(e=Tc(12,n,t,2|s)).elementType=S,e.lanes=i,e;case I:return(e=Tc(13,n,t,s)).elementType=I,e.lanes=i,e;case _:return(e=Tc(19,n,t,s)).elementType=_,e.lanes=i,e;case P:return Oc(n,s,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:l=10;break e;case E:l=9;break e;case A:l=11;break e;case T:l=14;break e;case D:l=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Tc(l,n,t,s)).elementType=e,t.type=r,t.lanes=i,t}function Rc(e,t,n,r){return(e=Tc(7,e,r,t)).lanes=n,e}function Oc(e,t,n,r){return(e=Tc(22,e,r,t)).elementType=P,e.lanes=n,e.stateNode={isHidden:!1},e}function Lc(e,t,n){return(e=Tc(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Tc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Vc(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,r,s,a,i,l,o){return e=new Vc(e,t,n,l,o),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Tc(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oa(a),e}function Uc(e){if(!e)return Es;e:{if(Ke(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ds(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Ds(n))return Rs(e,n,t)}return t}function Kc(e,t,n,r,s,a,i,l,o){return(e=zc(n,r,!0,e,0,a,0,l,o)).context=Uc(null),n=e.current,(a=Fa(r=ec(),s=tc(n))).callback=void 0!==t&&null!==t?t:null,Va(n,a,s),e.current.lanes=s,xt(e,s,r),rc(e,r),e}function Bc(e,t,n,r){var s=t.current,a=ec(),i=tc(s);return n=Uc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fa(a,i)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Va(s,t,i))&&(nc(e,s,i,a),za(e,s,i)),i}function qc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Gc(e,t){Hc(e,t),(e=e.alternate)&&Hc(e,t)}No=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Is.current)yl=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return yl=!1,function(e,t,n){switch(t.tag){case 3:Al(t),ma();break;case 5:Xa(t);break;case 1:Ds(t.type)&&Os(t);break;case 4:Ja(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Cs(ja,r._currentValue),r._currentValue=s;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Cs($a,1&$a.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ol(e,t,n):(Cs($a,1&$a.current),null!==(e=Bl(e,t,n))?e.sibling:null);Cs($a,1&$a.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Ul(e,t,n);t.flags|=128}if(null!==(s=t.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),Cs($a,$a.current),r)break;return null;case 22:case 23:return t.lanes=0,Nl(e,t,n)}return Bl(e,t,n)}(e,t,n);yl=0!==(131072&e.flags)}else yl=!1,sa&&0!==(1048576&t.flags)&&$s(t,Gs,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Kl(e,t),e=t.pendingProps;var s=Ts(t,As.current);Ia(t,n),s=fi(null,t,r,e,s,n);var i=gi();return t.flags|=1,"object"===typeof s&&null!==s&&"function"===typeof s.render&&void 0===s.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ds(r)?(i=!0,Os(t)):i=!1,t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,Oa(t),s.updater=rl,t.stateNode=s,s._reactInternals=t,ll(t,r,e,n),t=El(null,t,r,!0,i,n)):(t.tag=0,sa&&i&&ea(t),vl(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Kl(e,t),e=t.pendingProps,r=(s=r._init)(r._payload),t.type=r,s=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===A)return 11;if(e===T)return 14}return 2}(r),e=tl(r,e),s){case 0:t=Sl(null,t,r,e,n);break e;case 1:t=Cl(null,t,r,e,n);break e;case 11:t=bl(null,t,r,e,n);break e;case 14:t=wl(null,t,r,tl(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,Sl(e,t,r,s=t.elementType===r?s:tl(r,s),n);case 1:return r=t.type,s=t.pendingProps,Cl(e,t,r,s=t.elementType===r?s:tl(r,s),n);case 3:e:{if(Al(t),null===e)throw Error(a(387));r=t.pendingProps,s=(i=t.memoizedState).element,La(e,t),Ka(t,r,null,n);var l=t.memoizedState;if(r=l.element,i.isDehydrated){if(i={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Il(e,t,r,n,s=ol(Error(a(423)),t));break e}if(r!==s){t=Il(e,t,r,n,s=ol(Error(a(424)),t));break e}for(ra=cs(t.stateNode.containerInfo.firstChild),na=t,sa=!0,aa=null,n=wa(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ma(),r===s){t=Bl(e,t,n);break e}vl(e,t,r,n)}t=t.child}return t;case 5:return Xa(t),null===e&&ca(t),r=t.type,s=t.pendingProps,i=null!==e?e.memoizedProps:null,l=s.children,ns(r,s)?l=null:null!==i&&ns(r,i)&&(t.flags|=32),kl(e,t),vl(e,t,l,n),t.child;case 6:return null===e&&ca(t),null;case 13:return Ol(e,t,n);case 4:return Ja(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=ba(t,null,r,n):vl(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,bl(e,t,r,s=t.elementType===r?s:tl(r,s),n);case 7:return vl(e,t,t.pendingProps,n),t.child;case 8:case 12:return vl(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,l=s.value,Cs(ja,r._currentValue),r._currentValue=l,null!==i)if(lr(i.value,l)){if(i.children===s.children&&!Is.current){t=Bl(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var o=i.dependencies;if(null!==o){l=i.child;for(var c=o.firstContext;null!==c;){if(c.context===r){if(1===i.tag){(c=Fa(-1,n&-n)).tag=2;var u=i.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,null!==(c=i.alternate)&&(c.lanes|=n),Aa(i.return,n,t),o.lanes|=n;break}c=c.next}}else if(10===i.tag)l=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(l=i.return))throw Error(a(341));l.lanes|=n,null!==(o=l.alternate)&&(o.lanes|=n),Aa(l,n,t),l=i.sibling}else l=i.child;if(null!==l)l.return=i;else for(l=i;null!==l;){if(l===t){l=null;break}if(null!==(i=l.sibling)){i.return=l.return,l=i;break}l=l.return}i=l}vl(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Ia(t,n),r=r(s=_a(s)),t.flags|=1,vl(e,t,r,n),t.child;case 14:return s=tl(r=t.type,t.pendingProps),wl(e,t,r,s=tl(r.type,s),n);case 15:return jl(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:tl(r,s),Kl(e,t),t.tag=1,Ds(r)?(e=!0,Os(t)):e=!1,Ia(t,n),al(t,r,s),ll(t,r,s,n),El(null,t,r,!0,e,n);case 19:return Ul(e,t,n);case 22:return Nl(e,t,n)}throw Error(a(156,t.tag))};var Wc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Jc(e){this._internalRoot=e}function Zc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Yc(){}function $c(e,t,n,r,s){var a=n._reactRootContainer;if(a){var i=a;if("function"===typeof s){var l=s;s=function(){var e=qc(i);l.call(e)}}Bc(t,i,e,s)}else i=function(e,t,n,r,s){if(s){if("function"===typeof r){var a=r;r=function(){var e=qc(i);a.call(e)}}var i=Kc(t,r,e,0,null,!1,0,"",Yc);return e._reactRootContainer=i,e[ps]=i.current,Kr(8===e.nodeType?e.parentNode:e),uc(),i}for(;s=e.lastChild;)e.removeChild(s);if("function"===typeof r){var l=r;r=function(){var e=qc(o);l.call(e)}}var o=zc(e,0,!1,null,0,!1,0,"",Yc);return e._reactRootContainer=o,e[ps]=o.current,Kr(8===e.nodeType?e.parentNode:e),uc(function(){Bc(t,o,n,r)}),o}(n,t,e,s,r);return qc(i)}Jc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Bc(e,t,null,null)},Jc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc(function(){Bc(null,e,null,null)}),t[ps]=null}},Jc.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Pt.length&&0!==t&&t<Pt[n].priority;n++);Pt.splice(n,0,e),0===n&&Lt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),rc(t,Xe()),0===(6&Ao)&&(Ko=Xe()+500,Ks()))}break;case 13:uc(function(){var t=Ma(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),Gc(e,1)}},jt=function(e){if(13===e.tag){var t=Ma(e,134217728);if(null!==t)nc(t,e,134217728,ec());Gc(e,134217728)}},Nt=function(e){if(13===e.tag){var t=tc(e),n=Ma(e,t);if(null!==n)nc(n,e,t,ec());Gc(e,t)}},kt=function(){return vt},St=function(e,t){var n=vt;try{return vt=e,t()}finally{vt=n}},je=function(e,t,n){switch(t){case"input":if(Y(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=ws(r);if(!s)throw Error(a(90));W(r),Y(r,s)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ae=cc,Ie=uc;var eu={usingClientEntryPoint:!1,Events:[vs,bs,ws,Ce,Ee,cc]},tu={findFiberByHostInstance:ys,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{st=ru.inject(nu),at=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Zc(t))throw Error(a(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:j,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Zc(e))throw Error(a(299));var n=!1,r="",s=Wc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(s=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,r,s),e[ps]=t.current,Kr(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Xc(t))throw Error(a(200));return $c(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Zc(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,s=!1,i="",l=Wc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(s=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(l=n.onRecoverableError)),t=Kc(t,null,e,1,null!=n?n:null,s,0,i,l),e[ps]=t.current,Kr(e),r)for(e=0;e<r.length;e++)s=(s=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Jc(t)},t.render=function(e,t,n){if(!Xc(t))throw Error(a(200));return $c(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(a(40));return!!e._reactRootContainer&&(uc(function(){$c(null,null,e,!1,function(){e._reactRootContainer=null,e[ps]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xc(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return $c(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},737:(e,t,n)=>{n.d(t,{FirebaseService:()=>p,LM:()=>x,Oh:()=>v,TR:()=>y,VF:()=>f,Yl:()=>w,kW:()=>b,m6:()=>g});var r=n(555),s=n(667),a=n(958);const i=e=>e?e.toString().replace(/\//g,"-SLASH-").replace(/\./g,"-DOT-").replace(/#/g,"-HASH-").replace(/\[/g,"-LBRACKET-").replace(/\]/g,"-RBRACKET-").replace(/\$/g,"-DOLLAR-"):e,l="materials",o="customers",c="bookings",u="projects",d="calculation-settings",h="service-catalog",m="offers";class p{static async addDocument(e,t){try{const n=i(t.id||t.materialID||t.customerID),l=(0,r.A)((0,r.A)({},t),{},{createdAt:(0,s.O5)(),updatedAt:(0,s.O5)()}),o=t.id||t.materialID||t.customerID;if(o&&(l.originalId=o),n)return await(0,s.BN)((0,s.H9)(a.db,e,n),l),(0,r.A)({id:n},l);{const t=await(0,s.gS)((0,s.rJ)(a.db,e),l);return(0,r.A)({id:t.id},l)}}catch(n){throw console.error("Error adding document to ".concat(e,":"),n),n}}static async getDocument(e,t){try{const n=i(t),l=(0,s.H9)(a.db,e,n),o=await(0,s.x7)(l);return o.exists()?(0,r.A)({id:o.id},o.data()):(console.log("No document found with ID: ".concat(t)),null)}catch(n){throw console.error("Error getting document ".concat(t," from ").concat(e,":"),n),n}}static async getDocuments(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"createdAt";try{const n=(0,s.P)((0,s.rJ)(a.db,e),(0,s.My)(t,"desc"));return(await(0,s.GG)(n)).docs.map(e=>(0,r.A)({id:e.id},e.data()))}catch(n){throw console.error("Error getting documents from ".concat(e,":"),n),n}}static subscribeToCollection(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"createdAt";try{const i=(0,s.P)((0,s.rJ)(a.db,e),(0,s.My)(n,"desc"));return(0,s.aQ)(i,e=>{const n=e.docs.map(e=>(0,r.A)({id:e.id},e.data()));t(n)})}catch(i){throw console.error("Error subscribing to ".concat(e,":"),i),i}}static async updateDocument(e,t,n){try{if(!t)throw new Error("Document ID is required for updating ".concat(e));const l=i(t),o=(0,s.H9)(a.db,e,l);await(0,s.mZ)(o,(0,r.A)((0,r.A)({},n),{},{updatedAt:(0,s.O5)()}))}catch(l){throw console.error("Error updating document in ".concat(e,":"),l),l}}static async deleteDocument(e,t){try{const n=i(t);console.log("Deleting document: ".concat(e,"/").concat(n)),await(0,s.kd)((0,s.H9)(a.db,e,n))}catch(n){throw console.error("Error deleting document from ".concat(e,":"),n),n}}static async queryDocuments(e,t,n,i){try{const l=(0,s.P)((0,s.rJ)(a.db,e),(0,s._M)(t,n,i));return(await(0,s.GG)(l)).docs.map(e=>(0,r.A)({id:e.id},e.data()))}catch(l){throw console.error("Error querying documents from ".concat(e,":"),l),l}}}class f{static async getAllMaterials(){return p.getDocuments(l,"materialID")}static async getDocument(e){return p.getDocument(l,e)}static async addMaterial(e){return p.addDocument(l,e)}static async updateMaterial(e,t){return p.updateDocument(l,e,t)}static async deleteMaterial(e){return p.deleteDocument(l,e)}static subscribeToMaterials(e){return p.subscribeToCollection(l,e,"materialID")}}class g{static async getAllCustomers(){return p.getDocuments(o,"firmennameKundenname")}static async addCustomer(e){return p.addDocument(o,e)}static async updateCustomer(e,t){return p.updateDocument(o,e,t)}static async deleteCustomer(e){return p.deleteDocument(o,e)}static subscribeToCustomers(e){return p.subscribeToCollection(o,e,"firmennameKundenname")}}class x{static async getAllBookings(){return p.getDocuments(c,"date")}static async addBooking(e){return p.addDocument(c,(0,r.A)((0,r.A)({},e),{},{date:(new Date).toISOString(),timestamp:(0,s.O5)()}))}static async updateBooking(e,t){return p.updateDocument(c,e,t)}static async deleteBooking(e){return p.deleteDocument(c,e)}static subscribeToBookings(e){return p.subscribeToCollection(c,e,"date")}static async getBookingsByCustomer(e){return p.queryDocuments(c,"customerID","==",e)}}class y{static async addProject(e){return p.addDocument(u,(0,r.A)((0,r.A)({},e),{},{createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}))}static async updateProject(e,t){return p.updateDocument(u,e,(0,r.A)((0,r.A)({},t),{},{updatedAt:(new Date).toISOString()}))}static async deleteProject(e){return p.deleteDocument(u,e)}static subscribeToProjects(e){return p.subscribeToCollection(u,e,"createdAt")}static async getProjectsByCustomer(e){return p.queryDocuments(u,"customerID","==",e)}static async getDocument(e){return p.getDocument(u,e)}}class v{static async getSettings(){try{return await p.getDocument(d,"default")}catch(e){return console.error("Error getting calculation settings:",e),null}}static async saveSettings(e){try{return await this.getSettings()?await p.updateDocument(d,"default",e):await(0,s.BN)((0,s.H9)(a.db,d,"default"),(0,r.A)((0,r.A)({},e),{},{createdAt:(0,s.O5)(),updatedAt:(0,s.O5)()})),{success:!0}}catch(t){throw console.error("Error saving calculation settings:",t),t}}static subscribeToSettings(e){const t=(0,s.H9)(a.db,d,"default");return(0,s.aQ)(t,t=>{t.exists()?e((0,r.A)({id:t.id},t.data())):e(null)})}}class b{static async getAllServices(){return p.getDocuments(h,"sortOrder")}static async getService(e){return p.getDocument(h,e)}static async addService(e){return p.addDocument(h,e)}static async updateService(e,t){return p.updateDocument(h,e,t)}static async deleteService(e){return p.deleteDocument(h,e)}static subscribeToServices(e){try{const t=(0,s.P)((0,s.rJ)(a.db,h),(0,s.My)("category","asc"),(0,s.My)("sortOrder","asc"));return(0,s.aQ)(t,t=>{const n=t.docs.map(e=>(0,r.A)({id:e.id},e.data()));e(n)})}catch(t){return console.error("Error subscribing to services:",t),p.subscribeToCollection(h,e,"createdAt")}}static async getServicesByCategory(e){return p.queryDocuments(h,"category","==",e)}}class w{static async getAllOffers(){return p.getDocuments(m,"createdAt")}static async getOffer(e){return p.getDocument(m,e)}static async addOffer(e){return p.addDocument(m,e)}static async updateOffer(e,t){return p.updateDocument(m,e,t)}static async deleteOffer(e){return p.deleteDocument(m,e)}static subscribeToOffers(e){return p.subscribeToCollection(m,e,"createdAt")}static async getOffersByCustomer(e){return p.queryDocuments(m,"customerID","==",e)}static async getOffersByProject(e){return p.queryDocuments(m,"projectID","==",e)}static async getOffersByStatus(e){return p.queryDocuments(m,"status","==",e)}static async getNextOfferNumber(){try{const e=(new Date).getFullYear(),t=(await this.getAllOffers()).filter(t=>{var n,r;return(null===(n=t.offerNumber)||void 0===n||null===(r=n.match(/\d{4}/))||void 0===r?void 0:r[0])===String(e)});let n=0;t.forEach(e=>{var t;const r=null===(t=e.offerNumber)||void 0===t?void 0:t.match(/(\d+)$/);if(r){const e=parseInt(r[1],10);e>n&&(n=e)}});const r=String(n+1).padStart(4,"0");return"ANG-".concat(e,"-").concat(r)}catch(e){console.error("Error generating offer number:",e);const t=Date.now();return"ANG-".concat((new Date).getFullYear(),"-").concat(t)}}}},776:(e,t,n)=>{n.d(t,{cY:()=>f,FA:()=>M,g:()=>P,u:()=>o,Uj:()=>l,Fy:()=>y,tD:()=>K,bD:()=>L,hp:()=>U,T9:()=>m,Tj:()=>d,yU:()=>h,XA:()=>p,mS:()=>c,Ku:()=>H,ZQ:()=>j,sr:()=>C,zJ:()=>g,c1:()=>S,Im:()=>O,lT:()=>A,zW:()=>T,jZ:()=>N,lV:()=>E,nr:()=>I,Ov:()=>_,gE:()=>x,Am:()=>V,I9:()=>z,P1:()=>w,eX:()=>D});var r=n(555);const s=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=63&s|128):55296===(64512&s)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&e.charCodeAt(++r)),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=63&s|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=63&s|128)}return t},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<e.length;s+=3){const t=e[s],a=s+1<e.length,i=a?e[s+1]:0,l=s+2<e.length,o=l?e[s+2]:0,c=t>>2,u=(3&t)<<4|i>>4;let d=(15&i)<<2|o>>6,h=63&o;l||(h=64,a||(d=64)),r.push(n[c],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(s(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const s=e[n++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const a=e[n++];t[r++]=String.fromCharCode((31&s)<<6|63&a)}else if(s>239&&s<365){const a=((7&s)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{const a=e[n++],i=e[n++];t[r++]=String.fromCharCode((15&s)<<12|(63&a)<<6|63&i)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<e.length;){const t=n[e.charAt(s++)],a=s<e.length?n[e.charAt(s)]:0;++s;const l=s<e.length?n[e.charAt(s)]:64;++s;const o=s<e.length?n[e.charAt(s)]:64;if(++s,null==t||null==a||null==l||null==o)throw new i;const c=t<<2|a>>4;if(r.push(c),64!==l){const e=a<<4&240|l>>2;if(r.push(e),64!==o){const e=l<<6&192|o;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class i extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const l=function(e){return function(e){const t=s(e);return a.encodeByteArray(t,!0)}(e).replace(/\./g,"")},o=function(e){try{return a.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function c(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const u=()=>{try{return c().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&o(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},d=e=>{var t;return null===(t=u())||void 0===t||null===(t=t.emulatorHosts)||void 0===t?void 0:t[e]},h=e=>{const t=d(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},m=()=>{var e;return null===(e=u())||void 0===e?void 0:e.config},p=e=>{var t;return null===(t=u())||void 0===t?void 0:t["_".concat(e)]};class f{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function g(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(t){return!1}}async function x(e){return(await fetch(e,{credentials:"include"})).ok}function y(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",s=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=(0,r.A)({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},e);return[l(JSON.stringify({alg:"none",type:"JWT"})),l(JSON.stringify(i)),""].join(".")}const v={};let b=!1;function w(e,t){if("undefined"===typeof window||"undefined"===typeof document||!g(window.location.host)||v[e]===t||v[e]||b)return;function n(e){return"__firebase__banner__".concat(e)}v[e]=t;const r="__firebase__banner",s=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(v))v[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function a(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{b=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function i(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),i=document.getElementById(t)||document.createElement("span"),l=n("learnmore"),o=document.getElementById(l)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(o,l);const n=a();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,c),t.append(u,i,o,n),document.body.appendChild(t)}s?(i.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',i.innerText="Preview backend running in this workspace."),i.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",i):i()}function j(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function N(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(j())}function k(){var e;const t=null===(e=u())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}function S(){return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function C(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function E(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function A(){const e=j();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function I(){return!k()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _(){return!k()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function T(){try{return"object"===typeof indexedDB}catch(e){return!1}}function D(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var e;t((null===(e=s.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}class P extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,P.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,M.prototype.create)}}class M{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],s=r?function(e,t){return e.replace(R,(e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error",a="".concat(this.serviceName,": ").concat(s," (").concat(n,").");return new P(n,a,t)}}const R=/\{\$([^}]+)}/g;function O(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function L(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const s of n){if(!r.includes(s))return!1;const n=e[s],a=t[s];if(F(n)&&F(a)){if(!L(n,a))return!1}else if(n!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function F(e){return null!==e&&"object"===typeof e}function V(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function z(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function U(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function K(e,t){const n=new B(e,t);return n.subscribe.bind(n)}class B{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=q),void 0===r.error&&(r.error=q),void 0===r.complete&&(r.complete=q);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),s}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function q(){}function H(e){return e&&e._delegate?e._delegate:e}},853:(e,t,n)=>{e.exports=n(234)},889:(e,t,n)=>{n.d(t,{Uz:()=>C,Qg:()=>E});var r=n(232),s=n(776),a=n(606);const i="type.googleapis.com/google.protobuf.Int64Value",l="type.googleapis.com/google.protobuf.UInt64Value";function o(e,t){const n={};for(const r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function c(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"===typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(e=>c(e));if("function"===typeof e||"object"===typeof e)return o(e,e=>c(e));throw new Error("Data cannot be encoded in JSON: "+e)}function u(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case i:case l:{const t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(e=>u(e)):"function"===typeof e||"object"===typeof e?o(e,e=>u(e)):e}const d="functions",h={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class m extends s.g{constructor(e,t,n){super("".concat(d,"/").concat(e),t||""),this.details=n,Object.setPrototypeOf(this,m.prototype)}}function p(e,t){let n,r=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),s=r;try{const e=t&&t.error;if(e){const t=e.status;if("string"===typeof t){if(!h[t])return new m("internal","internal");r=h[t],s=t}const a=e.message;"string"===typeof a&&(s=a),n=e.details,void 0!==n&&(n=u(n))}}catch(a){}return"ok"===r?null:new m(r,s,n)}class f{constructor(e,t,n,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,(0,r.xZ)(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||t.get().then(e=>this.auth=e,()=>{}),this.messaging||n.get().then(e=>this.messaging=e,()=>{}),this.appCheck||null===s||void 0===s||s.get().then(e=>this.appCheck=e,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return null===e||void 0===e?void 0:e.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(e){return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){return{authToken:await this.getAuthToken(),messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken(e)}}}const g="us-central1",x=/^data: (.*?)(?:\n|$)/;class y{constructor(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:g,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){return fetch(...arguments)};this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new f(e,t,n,r),this.cancelAllRequests=new Promise(e=>{this.deleteService=()=>Promise.resolve(e())});try{const e=new URL(s);this.customDomain=e.origin+("/"===e.pathname?"":e.pathname),this.region=g}catch(i){this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;if(null!==this.emulatorOrigin){const n=this.emulatorOrigin;return"".concat(n,"/").concat(t,"/").concat(this.region,"/").concat(e)}return null!==this.customDomain?"".concat(this.customDomain,"/").concat(e):"https://".concat(this.region,"-").concat(t,".cloudfunctions.net/").concat(e)}}function v(e,t,n){const r=r=>function(e,t,n,r){const s=e._url(t);return j(e,s,n,r)}(e,t,r,n||{});return r.stream=(n,r)=>function(e,t,n,r){const s=e._url(t);return N(e,s,n,r||{})}(e,t,n,r),r}async function b(e,t,n,r){let s;n["Content-Type"]="application/json";try{s=await r(e,{method:"POST",body:JSON.stringify(t),headers:n})}catch(i){return{status:0,json:null}}let a=null;try{a=await s.json()}catch(i){}return{status:s.status,json:a}}async function w(e,t){const n={},r=await e.contextProvider.getContext(t.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),null!==r.appCheckToken&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}async function j(e,t,n,r){const s={data:n=c(n)},a=await w(e,r),i=function(e){let t=null;return{promise:new Promise((n,r)=>{t=setTimeout(()=>{r(new m("deadline-exceeded","deadline-exceeded"))},e)}),cancel:()=>{t&&clearTimeout(t)}}}(r.timeout||7e4),l=await Promise.race([b(t,s,a,e.fetchImpl),i.promise,e.cancelAllRequests]);if(i.cancel(),!l)throw new m("cancelled","Firebase Functions instance was deleted.");const o=p(l.status,l.json);if(o)throw o;if(!l.json)throw new m("internal","Response is not valid JSON object.");let d=l.json.data;if("undefined"===typeof d&&(d=l.json.result),"undefined"===typeof d)throw new m("internal","Response is missing data field.");return{data:u(d)}}async function N(e,t,n,r){var s;const a={data:n=c(n)},i=await w(e,r);let l,o,d;i["Content-Type"]="application/json",i.Accept="text/event-stream";try{l=await e.fetchImpl(t,{method:"POST",body:JSON.stringify(a),headers:i,signal:null===r||void 0===r?void 0:r.signal})}catch(g){if(g instanceof Error&&"AbortError"===g.name){const e=new m("cancelled","Request was cancelled.");return{data:Promise.reject(e),stream:{[Symbol.asyncIterator]:()=>({next:()=>Promise.reject(e)})}}}const e=p(0,null);return{data:Promise.reject(e),stream:{[Symbol.asyncIterator]:()=>({next:()=>Promise.reject(e)})}}}const h=new Promise((e,t)=>{o=e,d=t});null===r||void 0===r||null===(s=r.signal)||void 0===s||s.addEventListener("abort",()=>{const e=new m("cancelled","Request was cancelled.");d(e)});const f=function(e,t,n,r){const s=(e,r)=>{const s=e.match(x);if(!s)return;const a=s[1];try{const e=JSON.parse(a);if("result"in e)return void t(u(e.result));if("message"in e)return void r.enqueue(u(e.message));if("error"in e){const t=p(0,e);return r.error(t),void n(t)}}catch(i){if(i instanceof m)return r.error(i),void n(i)}},a=new TextDecoder;return new ReadableStream({start(t){let i="";return l();async function l(){if(null!==r&&void 0!==r&&r.aborted){const e=new m("cancelled","Request was cancelled");return t.error(e),n(e),Promise.resolve()}try{const{value:o,done:c}=await e.read();if(c)return i.trim()&&s(i.trim(),t),void t.close();if(null!==r&&void 0!==r&&r.aborted){const r=new m("cancelled","Request was cancelled");return t.error(r),n(r),void await e.cancel()}i+=a.decode(o,{stream:!0});const u=i.split("\n");i=u.pop()||"";for(const e of u)e.trim()&&s(e.trim(),t);return l()}catch(o){const e=o instanceof m?o:p(0,null);t.error(e),n(e)}}},cancel:()=>e.cancel()})}(l.body.getReader(),o,d,null===r||void 0===r?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const e=f.getReader();return{async next(){const{value:t,done:n}=await e.read();return{value:t,done:n}},return:async()=>(await e.cancel(),{done:!0,value:void 0})}}},data:h}}const k="@firebase/functions",S="0.13.0";function C(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.Sx)(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g;const n=(0,r.j6)((0,s.Ku)(e),d).getImmediate({identifier:t}),a=(0,s.yU)("functions");return a&&function(e,t,n){!function(e,t,n){const r=(0,s.zJ)(t);e.emulatorOrigin="http".concat(r?"s":"","://").concat(t,":").concat(n),r&&((0,s.gE)(e.emulatorOrigin),(0,s.P1)("Functions",!0))}((0,s.Ku)(e),t,n)}(n,...a),n}function E(e,t,n){return v((0,s.Ku)(e),t,n)}var A;(0,r.om)(new a.uA(d,(e,t)=>{let{instanceIdentifier:n}=t;const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),a=e.getProvider("messaging-internal"),i=e.getProvider("app-check-internal");return new y(r,s,a,i,n)},"PUBLIC").setMultipleInstances(!0)),(0,r.KO)(k,S,A),(0,r.KO)(k,S,"esm2020")},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},958:(e,t,n)=>{n.d(t,{db:()=>l,C:()=>o});var r=n(232);(0,r.KO)("firebase","12.1.0","app");var s=n(667),a=n(889);const i=(0,r.Wp)({apiKey:"AIzaSyCY7Ft5BvH7fdNHH6yG9C3MQgylR05aM6k",authDomain:"lager-d3a17.firebaseapp.com",projectId:"lager-d3a17",storageBucket:"lager-d3a17.firebasestorage.app",messagingSenderId:"332063299881",appId:"1:332063299881:web:d7aa8304b71785ec70ff38"}),l=(0,s.aU)(i),o=(0,a.Uz)(i)},965:(e,t,n)=>{n.d(t,{$b:()=>s,Vy:()=>c});const r=[];var s;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(s||(s={}));const a={debug:s.DEBUG,verbose:s.VERBOSE,info:s.INFO,warn:s.WARN,error:s.ERROR,silent:s.SILENT},i=s.INFO,l={[s.DEBUG]:"log",[s.VERBOSE]:"log",[s.INFO]:"info",[s.WARN]:"warn",[s.ERROR]:"error"},o=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=l[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var s=arguments.length,a=new Array(s>2?s-2:0),i=2;i<s;i++)a[i-2]=arguments[i];console[r]("[".concat(n,"]  ").concat(e.name,":"),...a)};class c{constructor(e){this.name=e,this._logLevel=i,this._logHandler=o,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in s))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?a[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,s.DEBUG,...t),this._logHandler(this,s.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,s.VERBOSE,...t),this._logHandler(this,s.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,s.INFO,...t),this._logHandler(this,s.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,s.WARN,...t),this._logHandler(this,s.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,s.ERROR,...t),this._logHandler(this,s.ERROR,...t)}}}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,s){if(1&s&&(r=this(r)),8&s)return r;if("object"===typeof r&&r){if(4&s&&r.__esModule)return r;if(16&s&&"function"===typeof r.then)return r}var a=Object.create(null);n.r(a);var i={};e=e||[null,t({}),t([]),t(t)];for(var l=2&s&&r;("object"==typeof l||"function"==typeof l)&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach(e=>i[e]=()=>r[e]);return i.default=()=>r,n.d(a,i),a}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r,s=n(43),a=n.t(s,2),i=n(391),l=n(950),o=n.t(l,2);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(r||(r={}));const u="popstate";function d(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function h(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function m(e,t){return{usr:e.state,key:e.key,idx:t}}function p(e,t,n,r){return void 0===n&&(n=null),c({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?g(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function f(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function g(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function x(e,t,n,s){void 0===s&&(s={});let{window:a=document.defaultView,v5Compat:i=!1}=s,l=a.history,o=r.Pop,h=null,g=x();function x(){return(l.state||{idx:null}).idx}function y(){o=r.Pop;let e=x(),t=null==e?null:e-g;g=e,h&&h({action:o,location:b.location,delta:t})}function v(e){let t="null"!==a.location.origin?a.location.origin:a.location.href,n="string"===typeof e?e:f(e);return n=n.replace(/ $/,"%20"),d(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,l.replaceState(c({},l.state,{idx:g}),""));let b={get action(){return o},get location(){return e(a,l)},listen(e){if(h)throw new Error("A history only accepts one active listener");return a.addEventListener(u,y),h=e,()=>{a.removeEventListener(u,y),h=null}},createHref:e=>t(a,e),createURL:v,encodeLocation(e){let t=v(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o=r.Push;let s=p(b.location,e,t);n&&n(s,e),g=x()+1;let c=m(s,g),u=b.createHref(s);try{l.pushState(c,"",u)}catch(d){if(d instanceof DOMException&&"DataCloneError"===d.name)throw d;a.location.assign(u)}i&&h&&h({action:o,location:b.location,delta:1})},replace:function(e,t){o=r.Replace;let s=p(b.location,e,t);n&&n(s,e),g=x();let a=m(s,g),c=b.createHref(s);l.replaceState(a,"",c),i&&h&&h({action:o,location:b.location,delta:0})},go:e=>l.go(e)};return b}var y;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(y||(y={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function v(e,t,n){return void 0===n&&(n="/"),b(e,t,n,!1)}function b(e,t,n,r){let s=M(("string"===typeof t?g(t):t).pathname||"/",n);if(null==s)return null;let a=w(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(a);let i=null;for(let l=0;null==i&&l<a.length;++l){let e=P(s);i=T(a[l],e,r)}return i}function w(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let s=(e,s,a)=>{let i={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:s,route:e};i.relativePath.startsWith("/")&&(d(i.relativePath.startsWith(r),'Absolute route path "'+i.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),i.relativePath=i.relativePath.slice(r.length));let l=V([r,i.relativePath]),o=n.concat(i);e.children&&e.children.length>0&&(d(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+l+'".'),w(e.children,t,o,l)),(null!=e.path||e.index)&&t.push({path:l,score:_(l,e.index),routesMeta:o})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of j(e.path))s(e,t,r);else s(e,t)}),t}function j(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,s=n.endsWith("?"),a=n.replace(/\?$/,"");if(0===r.length)return s?[a,""]:[a];let i=j(r.join("/")),l=[];return l.push(...i.map(e=>""===e?a:[a,e].join("/"))),s&&l.push(...i),l.map(t=>e.startsWith("/")&&""===t?"/":t)}const N=/^:[\w-]+$/,k=3,S=2,C=1,E=10,A=-2,I=e=>"*"===e;function _(e,t){let n=e.split("/"),r=n.length;return n.some(I)&&(r+=A),t&&(r+=S),n.filter(e=>!I(e)).reduce((e,t)=>e+(N.test(t)?k:""===t?C:E),r)}function T(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,s={},a="/",i=[];for(let l=0;l<r.length;++l){let e=r[l],o=l===r.length-1,c="/"===a?t:t.slice(a.length)||"/",u=D({path:e.relativePath,caseSensitive:e.caseSensitive,end:o},c),d=e.route;if(!u&&o&&n&&!r[r.length-1].route.index&&(u=D({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(s,u.params),i.push({params:s,pathname:V([a,u.pathname]),pathnameBase:z(V([a,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(a=V([a,u.pathnameBase]))}return i}function D(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);h("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(r.push({paramName:"*"}),s+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":""!==e&&"/"!==e&&(s+="(?:(?=\\/|$))");let a=new RegExp(s,t?void 0:"i");return[a,r]}(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((e,t,n)=>{let{paramName:r,isOptional:s}=t;if("*"===r){let e=l[n]||"";i=a.slice(0,a.length-e.length).replace(/(.)\/+$/,"$1")}const o=l[n];return e[r]=s&&!o?void 0:(o||"").replace(/%2F/g,"/"),e},{}),pathname:a,pathnameBase:i,pattern:e}}function P(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return h(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function M(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function R(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function O(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function L(e,t){let n=O(e);return t?n.map((e,t)=>t===n.length-1?e.pathname:e.pathnameBase):n.map(e=>e.pathnameBase)}function F(e,t,n,r){let s;void 0===r&&(r=!1),"string"===typeof e?s=g(e):(s=c({},e),d(!s.pathname||!s.pathname.includes("?"),R("?","pathname","search",s)),d(!s.pathname||!s.pathname.includes("#"),R("#","pathname","hash",s)),d(!s.search||!s.search.includes("#"),R("#","search","hash",s)));let a,i=""===e||""===s.pathname,l=i?"/":s.pathname;if(null==l)a=n;else{let e=t.length-1;if(!r&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;s.pathname=t.join("/")}a=e>=0?t[e]:"/"}let o=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:s=""}="string"===typeof e?g(e):e,a=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:a,search:U(r),hash:K(s)}}(s,a),u=l&&"/"!==l&&l.endsWith("/"),h=(i||"."===l)&&n.endsWith("/");return o.pathname.endsWith("/")||!u&&!h||(o.pathname+="/"),o}const V=e=>e.join("/").replace(/\/\/+/g,"/"),z=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),U=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",K=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function B(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const q=["post","put","patch","delete"],H=(new Set(q),["get",...q]);new Set(H),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function G(){return G=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},G.apply(this,arguments)}const W=s.createContext(null);const Q=s.createContext(null);const J=s.createContext(null);const Z=s.createContext(null);const X=s.createContext({outlet:null,matches:[],isDataRoute:!1});const Y=s.createContext(null);function $(){return null!=s.useContext(Z)}function ee(){return $()||d(!1),s.useContext(Z).location}function te(e){s.useContext(J).static||s.useLayoutEffect(e)}function ne(){let{isDataRoute:e}=s.useContext(X);return e?function(){let{router:e}=he(ue.UseNavigateStable),t=pe(de.UseNavigateStable),n=s.useRef(!1);return te(()=>{n.current=!0}),s.useCallback(function(r,s){void 0===s&&(s={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,G({fromRouteId:t},s)))},[e,t])}():function(){$()||d(!1);let e=s.useContext(W),{basename:t,future:n,navigator:r}=s.useContext(J),{matches:a}=s.useContext(X),{pathname:i}=ee(),l=JSON.stringify(L(a,n.v7_relativeSplatPath)),o=s.useRef(!1);return te(()=>{o.current=!0}),s.useCallback(function(n,s){if(void 0===s&&(s={}),!o.current)return;if("number"===typeof n)return void r.go(n);let a=F(n,JSON.parse(l),i,"path"===s.relative);null==e&&"/"!==t&&(a.pathname="/"===a.pathname?t:V([t,a.pathname])),(s.replace?r.replace:r.push)(a,s.state,s)},[t,r,l,i,e])}()}function re(e,t){let{relative:n}=void 0===t?{}:t,{future:r}=s.useContext(J),{matches:a}=s.useContext(X),{pathname:i}=ee(),l=JSON.stringify(L(a,r.v7_relativeSplatPath));return s.useMemo(()=>F(e,JSON.parse(l),i,"path"===n),[e,l,i,n])}function se(e,t,n,a){$()||d(!1);let{navigator:i}=s.useContext(J),{matches:l}=s.useContext(X),o=l[l.length-1],c=o?o.params:{},u=(o&&o.pathname,o?o.pathnameBase:"/");o&&o.route;let h,m=ee();if(t){var p;let e="string"===typeof t?g(t):t;"/"===u||(null==(p=e.pathname)?void 0:p.startsWith(u))||d(!1),h=e}else h=m;let f=h.pathname||"/",x=f;if("/"!==u){let e=u.replace(/^\//,"").split("/");x="/"+f.replace(/^\//,"").split("/").slice(e.length).join("/")}let y=v(e,{pathname:x});let b=ce(y&&y.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:V([u,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?u:V([u,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),l,n,a);return t&&b?s.createElement(Z.Provider,{value:{location:G({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:r.Pop}},b):b}function ae(){let e=function(){var e;let t=s.useContext(Y),n=me(de.UseRouteError),r=pe(de.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[r]}(),t=B(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r};return s.createElement(s.Fragment,null,s.createElement("h2",null,"Unexpected Application Error!"),s.createElement("h3",{style:{fontStyle:"italic"}},t),n?s.createElement("pre",{style:a},n):null,null)}const ie=s.createElement(ae,null);class le extends s.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?s.createElement(X.Provider,{value:this.props.routeContext},s.createElement(Y.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function oe(e){let{routeContext:t,match:n,children:r}=e,a=s.useContext(W);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),s.createElement(X.Provider,{value:t},r)}function ce(e,t,n,r){var a;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var i;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(i=r)&&i.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let l=e,o=null==(a=n)?void 0:a.errors;if(null!=o){let e=l.findIndex(e=>e.route.id&&void 0!==(null==o?void 0:o[e.route.id]));e>=0||d(!1),l=l.slice(0,Math.min(l.length,e+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let s=0;s<l.length;s++){let e=l[s];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(u=s),e.route.id){let{loaderData:t,errors:r}=n,s=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||s){c=!0,l=u>=0?l.slice(0,u+1):[l[0]];break}}}return l.reduceRight((e,r,a)=>{let i,d=!1,h=null,m=null;var p;n&&(i=o&&r.route.id?o[r.route.id]:void 0,h=r.route.errorElement||ie,c&&(u<0&&0===a?(p="route-fallback",!1||fe[p]||(fe[p]=!0),d=!0,m=null):u===a&&(d=!0,m=r.route.hydrateFallbackElement||null)));let f=t.concat(l.slice(0,a+1)),g=()=>{let t;return t=i?h:d?m:r.route.Component?s.createElement(r.route.Component,null):r.route.element?r.route.element:e,s.createElement(oe,{match:r,routeContext:{outlet:e,matches:f,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===a)?s.createElement(le,{location:n.location,revalidation:n.revalidation,component:h,error:i,children:g(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):g()},null)}var ue=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ue||{}),de=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(de||{});function he(e){let t=s.useContext(W);return t||d(!1),t}function me(e){let t=s.useContext(Q);return t||d(!1),t}function pe(e){let t=function(){let e=s.useContext(X);return e||d(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||d(!1),n.route.id}const fe={};function ge(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}a.startTransition;function xe(e){let{to:t,replace:n,state:r,relative:a}=e;$()||d(!1);let{future:i,static:l}=s.useContext(J),{matches:o}=s.useContext(X),{pathname:c}=ee(),u=ne(),h=F(t,L(o,i.v7_relativeSplatPath),c,"path"===a),m=JSON.stringify(h);return s.useEffect(()=>u(JSON.parse(m),{replace:n,state:r,relative:a}),[u,m,a,n,r]),null}function ye(e){d(!1)}function ve(e){let{basename:t="/",children:n=null,location:a,navigationType:i=r.Pop,navigator:l,static:o=!1,future:c}=e;$()&&d(!1);let u=t.replace(/^\/*/,"/"),h=s.useMemo(()=>({basename:u,navigator:l,static:o,future:G({v7_relativeSplatPath:!1},c)}),[u,c,l,o]);"string"===typeof a&&(a=g(a));let{pathname:m="/",search:p="",hash:f="",state:x=null,key:y="default"}=a,v=s.useMemo(()=>{let e=M(m,u);return null==e?null:{location:{pathname:e,search:p,hash:f,state:x,key:y},navigationType:i}},[u,m,p,f,x,y,i]);return null==v?null:s.createElement(J.Provider,{value:h},s.createElement(Z.Provider,{children:n,value:v}))}function be(e){let{children:t,location:n}=e;return se(we(t),n)}new Promise(()=>{});s.Component;function we(e,t){void 0===t&&(t=[]);let n=[];return s.Children.forEach(e,(e,r)=>{if(!s.isValidElement(e))return;let a=[...t,r];if(e.type===s.Fragment)return void n.push.apply(n,we(e.props.children,a));e.type!==ye&&d(!1),e.props.index&&e.props.children&&d(!1);let i={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=we(e.props.children,a)),n.push(i)}),n}function je(){return je=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},je.apply(this,arguments)}function Ne(e,t){if(null==e)return{};var n,r,s={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const ke=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Se=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"];try{window.__reactRouterVersion="6"}catch(Ao){}const Ce=s.createContext({isTransitioning:!1});new Map;const Ee=a.startTransition;o.flushSync,a.useId;function Ae(e){let{basename:t,children:n,future:r,window:a}=e,i=s.useRef();var l;null==i.current&&(i.current=(void 0===(l={window:a,v5Compat:!0})&&(l={}),x(function(e,t){let{pathname:n,search:r,hash:s}=e.location;return p("",{pathname:n,search:r,hash:s},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:f(t)},null,l)));let o=i.current,[c,u]=s.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},h=s.useCallback(e=>{d&&Ee?Ee(()=>u(e)):u(e)},[u,d]);return s.useLayoutEffect(()=>o.listen(h),[o,h]),s.useEffect(()=>ge(r),[r]),s.createElement(ve,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:o,future:r})}const Ie="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,_e=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Te=s.forwardRef(function(e,t){let n,{onClick:r,relative:a,reloadDocument:i,replace:l,state:o,target:c,to:u,preventScrollReset:h,viewTransition:m}=e,p=Ne(e,ke),{basename:g}=s.useContext(J),x=!1;if("string"===typeof u&&_e.test(u)&&(n=u,Ie))try{let e=new URL(window.location.href),t=u.startsWith("//")?new URL(e.protocol+u):new URL(u),n=M(t.pathname,g);t.origin===e.origin&&null!=n?u=n+t.search+t.hash:x=!0}catch(Ao){}let y=function(e,t){let{relative:n}=void 0===t?{}:t;$()||d(!1);let{basename:r,navigator:a}=s.useContext(J),{hash:i,pathname:l,search:o}=re(e,{relative:n}),c=l;return"/"!==r&&(c="/"===l?r:V([r,l])),a.createHref({pathname:c,search:o,hash:i})}(u,{relative:a}),v=function(e,t){let{target:n,replace:r,state:a,preventScrollReset:i,relative:l,viewTransition:o}=void 0===t?{}:t,c=ne(),u=ee(),d=re(e,{relative:l});return s.useCallback(t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==r?r:f(u)===f(d);c(e,{replace:n,state:a,preventScrollReset:i,relative:l,viewTransition:o})}},[u,c,d,r,a,n,e,i,l,o])}(u,{replace:l,state:o,target:c,preventScrollReset:h,relative:a,viewTransition:m});return s.createElement("a",je({},p,{href:n||y,onClick:x||i?r:function(e){r&&r(e),e.defaultPrevented||v(e)},ref:t,target:c}))});const De=s.forwardRef(function(e,t){let{"aria-current":n="page",caseSensitive:r=!1,className:a="",end:i=!1,style:l,to:o,viewTransition:c,children:u}=e,h=Ne(e,Se),m=re(o,{relative:h.relative}),p=ee(),f=s.useContext(Q),{navigator:g,basename:x}=s.useContext(J),y=null!=f&&function(e,t){void 0===t&&(t={});let n=s.useContext(Ce);null==n&&d(!1);let{basename:r}=Re(Pe.useViewTransitionState),a=re(e,{relative:t.relative});if(!n.isTransitioning)return!1;let i=M(n.currentLocation.pathname,r)||n.currentLocation.pathname,l=M(n.nextLocation.pathname,r)||n.nextLocation.pathname;return null!=D(a.pathname,l)||null!=D(a.pathname,i)}(m)&&!0===c,v=g.encodeLocation?g.encodeLocation(m).pathname:m.pathname,b=p.pathname,w=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;r||(b=b.toLowerCase(),w=w?w.toLowerCase():null,v=v.toLowerCase()),w&&x&&(w=M(w,x)||w);const j="/"!==v&&v.endsWith("/")?v.length-1:v.length;let N,k=b===v||!i&&b.startsWith(v)&&"/"===b.charAt(j),S=null!=w&&(w===v||!i&&w.startsWith(v)&&"/"===w.charAt(v.length)),C={isActive:k,isPending:S,isTransitioning:y},E=k?n:void 0;N="function"===typeof a?a(C):[a,k?"active":null,S?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let A="function"===typeof l?l(C):l;return s.createElement(Te,je({},h,{"aria-current":E,className:N,ref:t,style:A,to:o,viewTransition:c}),"function"===typeof u?u(C):u)});var Pe,Me;function Re(e){let t=s.useContext(W);return t||d(!1),t}(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Pe||(Pe={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Me||(Me={}));function Oe(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var Le=n(555),Fe=n(232),Ve=n(776),ze=n(965),Ue=n(606);const Ke=["providerId"],Be=["uid","auth","stsTokenManager"],qe=["providerId","signInMethod"];function He(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Ge=He,We=new Ve.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Qe=new ze.Vy("@firebase/auth");function Je(e){if(Qe.logLevel<=ze.$b.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Qe.error("Auth (".concat(Fe.MF,"): ").concat(e),...n)}}function Ze(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw et(e,...n)}function Xe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return et(e,...n)}function Ye(e,t,n){const r=(0,Le.A)((0,Le.A)({},Ge()),{},{[t]:n});return new Ve.FA("auth","Firebase",r).create(t,{appName:e.name})}function $e(e){return Ye(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function et(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return We.create(e,...n)}function tt(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];throw et(t,...r)}}function nt(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Je(t),new Error(t)}function rt(e,t){e||nt(t)}function st(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function at(){return"http:"===it()||"https:"===it()}function it(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class lt{constructor(e,t){this.shortDelay=e,this.longDelay=t,rt(t>e,"Short delay should be less than long delay!"),this.isMobile=(0,Ve.jZ)()||(0,Ve.lV)()}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(at()||(0,Ve.sr)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function ot(e,t){rt(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class ct{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void nt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void nt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void nt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const ut={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},dt=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],ht=new lt(3e4,6e4);function mt(e,t){return e.tenantId&&!t.tenantId?(0,Le.A)((0,Le.A)({},t),{},{tenantId:e.tenantId}):t}async function pt(e,t,n,r){return ft(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let s={},a={};r&&("GET"===t?a=r:s={body:JSON.stringify(r)});const i=(0,Ve.Am)((0,Le.A)({key:e.config.apiKey},a)).slice(1),l=await e._getAdditionalHeaders();l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode);const o=(0,Le.A)({method:t,headers:l},s);return(0,Ve.c1)()||(o.referrerPolicy="no-referrer"),e.emulatorConfig&&(0,Ve.zJ)(e.emulatorConfig.host)&&(o.credentials="include"),ct.fetch()(await xt(e,e.config.apiHost,n,i),o)})}async function ft(e,t,n){e._canInitEmulator=!1;const r=(0,Le.A)((0,Le.A)({},ut),t);try{const t=new vt(e),s=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw bt(e,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const t=s.ok?a.errorMessage:a.error.message,[n,i]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw bt(e,"credential-already-in-use",a);if("EMAIL_EXISTS"===n)throw bt(e,"email-already-in-use",a);if("USER_DISABLED"===n)throw bt(e,"user-disabled",a);const l=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(i)throw Ye(e,l,i);Ze(e,l)}}catch(Ao){if(Ao instanceof Ve.g)throw Ao;Ze(e,"network-request-failed",{message:String(Ao)})}}async function gt(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const a=await pt(e,t,n,r,s);return"mfaPendingCredential"in a&&Ze(e,"multi-factor-auth-required",{_serverResponse:a}),a}async function xt(e,t,n,r){const s="".concat(t).concat(n,"?").concat(r),a=e,i=a.config.emulator?ot(e.config,s):"".concat(e.config.apiScheme,"://").concat(s);if(dt.includes(n)&&(await a._persistenceManagerAvailable,"COOKIE"===a._getPersistenceType())){return a._getPersistence()._getFinalTarget(i).toString()}return i}function yt(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class vt{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(Xe(this.auth,"network-request-failed")),ht.get())})}}function bt(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Xe(e,t,r);return s.customData._tokenResponse=n,s}function wt(e){return void 0!==e&&void 0!==e.enterprise}class jt{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return yt(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Nt(e,t){return pt(e,"GET","/v2/recaptchaConfig",mt(e,t))}async function kt(e,t){return pt(e,"POST","/v1/accounts:lookup",t)}function St(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(Ao){}}function Ct(e){return 1e3*Number(e)}function Et(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Je("JWT malformed, contained fewer than 3 sections"),null;try{const e=(0,Ve.u)(n);return e?JSON.parse(e):(Je("Failed to decode base64 JWT payload"),null)}catch(Ao){return Je("Caught error parsing JWT payload as JSON",null===Ao||void 0===Ao?void 0:Ao.toString()),null}}function At(e){const t=Et(e);return tt(t,"internal-error"),tt("undefined"!==typeof t.exp,"internal-error"),tt("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function It(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(Ao){throw Ao instanceof Ve.g&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(Ao)&&e.auth.currentUser===e&&await e.auth.signOut(),Ao}}class _t{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{var t;this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(Ao){return void((null===Ao||void 0===Ao?void 0:Ao.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class Tt{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=St(this.lastLoginAt),this.creationTime=St(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Dt(e){var t;const n=e.auth,r=await e.getIdToken(),s=await It(e,kt(n,{idToken:r}));tt(null===s||void 0===s?void 0:s.users.length,n,"internal-error");const a=s.users[0];e._notifyReloadListener(a);const i=null!==(t=a.providerUserInfo)&&void 0!==t&&t.length?Pt(a.providerUserInfo):[],l=(o=e.providerData,c=i,[...o.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var o,c;const u=e.isAnonymous,d=!(e.email&&a.passwordHash)&&!(null!==l&&void 0!==l&&l.length),h=!!u&&d,m={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new Tt(a.createdAt,a.lastLoginAt),isAnonymous:h};Object.assign(e,m)}function Pt(e){return e.map(e=>{let{providerId:t}=e,n=Oe(e,Ke);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class Mt{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){tt(e.idToken,"internal-error"),tt("undefined"!==typeof e.idToken,"internal-error"),tt("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):At(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){tt(0!==e.length,"internal-error");const t=At(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(tt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:s}=await async function(e,t){const n=await ft(e,{},async()=>{const n=(0,Ve.Am)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:s}=e.config,a=await xt(e,r,"/v1/token","key=".concat(s)),i=await e._getAdditionalHeaders();i["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:i,body:n};return e.emulatorConfig&&(0,Ve.zJ)(e.emulatorConfig.host)&&(l.credentials="include"),ct.fetch()(a,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:s}=t,a=new Mt;return n&&(tt("string"===typeof n,"internal-error",{appName:e}),a.refreshToken=n),r&&(tt("string"===typeof r,"internal-error",{appName:e}),a.accessToken=r),s&&(tt("number"===typeof s,"internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Mt,this.toJSON())}_performRefresh(){return nt("not implemented")}}function Rt(e,t){tt("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class Ot{constructor(e){let{uid:t,auth:n,stsTokenManager:r}=e,s=Oe(e,Be);this.providerId="firebase",this.proactiveRefresh=new _t(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Tt(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await It(this,this.stsTokenManager.getToken(this.auth,e));return tt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(0,Ve.Ku)(e),r=await n.getIdToken(t),s=Et(r);tt(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const a="object"===typeof s.firebase?s.firebase:void 0,i=null===a||void 0===a?void 0:a.sign_in_provider;return{claims:s,token:r,authTime:St(Ct(s.auth_time)),issuedAtTime:St(Ct(s.iat)),expirationTime:St(Ct(s.exp)),signInProvider:i||null,signInSecondFactor:(null===a||void 0===a?void 0:a.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=(0,Ve.Ku)(e);await Dt(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(tt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>(0,Le.A)({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ot((0,Le.A)((0,Le.A)({},this),{},{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){tt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Dt(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,Fe.xZ)(this.auth.app))return Promise.reject($e(this.auth));const e=await this.getIdToken();return await It(this,async function(e,t){return pt(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return(0,Le.A)((0,Le.A)({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>(0,Le.A)({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{},{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,s,a,i,l,o,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(s=t.phoneNumber)&&void 0!==s?s:void 0,m=null!==(a=t.photoURL)&&void 0!==a?a:void 0,p=null!==(i=t.tenantId)&&void 0!==i?i:void 0,f=null!==(l=t._redirectEventId)&&void 0!==l?l:void 0,g=null!==(o=t.createdAt)&&void 0!==o?o:void 0,x=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:y,emailVerified:v,isAnonymous:b,providerData:w,stsTokenManager:j}=t;tt(y&&j,e,"internal-error");const N=Mt.fromJSON(this.name,j);tt("string"===typeof y,e,"internal-error"),Rt(u,e.name),Rt(d,e.name),tt("boolean"===typeof v,e,"internal-error"),tt("boolean"===typeof b,e,"internal-error"),Rt(h,e.name),Rt(m,e.name),Rt(p,e.name),Rt(f,e.name),Rt(g,e.name),Rt(x,e.name);const k=new Ot({uid:y,auth:e,email:d,emailVerified:v,displayName:u,isAnonymous:b,photoURL:m,phoneNumber:h,tenantId:p,stsTokenManager:N,createdAt:g,lastLoginAt:x});return w&&Array.isArray(w)&&(k.providerData=w.map(e=>(0,Le.A)({},e))),f&&(k._redirectEventId=f),k}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new Mt;r.updateFromServerResponse(t);const s=new Ot({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Dt(s),s}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];tt(void 0!==r.localId,"internal-error");const s=void 0!==r.providerUserInfo?Pt(r.providerUserInfo):[],a=!(r.email&&r.passwordHash)&&!(null!==s&&void 0!==s&&s.length),i=new Mt;i.updateFromIdToken(n);const l=new Ot({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:a}),o={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Tt(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null!==s&&void 0!==s&&s.length)};return Object.assign(l,o),l}}const Lt=new Map;function Ft(e){rt(e instanceof Function,"Expected a class definition");let t=Lt.get(e);return t?(rt(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Lt.set(e,t),t)}class Vt{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Vt.type="NONE";const zt=Vt;function Ut(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class Kt{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:s}=this.auth;this.fullUserKey=Ut(this.userKey,r.apiKey,s),this.fullPersistenceKey=Ut("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await kt(this.auth,{idToken:e}).catch(()=>{});return t?Ot._fromGetAccountInfoResponse(this.auth,t,e):null}return Ot._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new Kt(Ft(zt),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let s=r[0]||Ft(zt);const a=Ut(n,e.config.apiKey,e.name);let i=null;for(const c of t)try{const t=await c._get(a);if(t){let n;if("string"===typeof t){const r=await kt(e,{idToken:t}).catch(()=>{});if(!r)break;n=await Ot._fromGetAccountInfoResponse(e,r,t)}else n=Ot._fromJSON(e,t);c!==s&&(i=n),s=c;break}}catch(o){}const l=r.filter(e=>e._shouldAllowMigration);return s._shouldAllowMigration&&l.length?(s=l[0],i&&await s._set(a,i.toJSON()),await Promise.all(t.map(async e=>{if(e!==s)try{await e._remove(a)}catch(t){}})),new Kt(s,e,n)):new Kt(s,e,n)}}function Bt(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Wt(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(qt(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Jt(t))return"Blackberry";if(Zt(t))return"Webos";if(Ht(t))return"Safari";if((t.includes("chrome/")||Gt(t))&&!t.includes("edge/"))return"Chrome";if(Qt(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function qt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,Ve.ZQ)();return/firefox\//i.test(e)}function Ht(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,Ve.ZQ)()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Gt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,Ve.ZQ)();return/crios\//i.test(e)}function Wt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,Ve.ZQ)();return/iemobile/i.test(e)}function Qt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,Ve.ZQ)();return/android/i.test(e)}function Jt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,Ve.ZQ)();return/blackberry/i.test(e)}function Zt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,Ve.ZQ)();return/webos/i.test(e)}function Xt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,Ve.ZQ)();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Yt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,Ve.ZQ)();return Xt(e)||Qt(e)||Zt(e)||Jt(e)||/windows phone/i.test(e)||Wt(e)}function $t(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Bt((0,Ve.ZQ)());break;case"Worker":t="".concat(Bt((0,Ve.ZQ)()),"-").concat(e);break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(Fe.MF,"/").concat(r)}class en{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(Ao){r(Ao)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(Ao){t.reverse();for(const r of t)try{r()}catch(n){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===Ao||void 0===Ao?void 0:Ao.message})}}}class tn{constructor(e){var t,n,r,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=a.minPasswordLength)&&void 0!==t?t:6,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),void 0!==a.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),void 0!==a.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),void 0!==a.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),void 0!==a.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(n=null===(r=e.allowedNonAlphanumericCharacters)||void 0===r?void 0:r.join(""))&&void 0!==n?n:"",this.forceUpgradeOnSignin=null!==(s=e.forceUpgradeOnSignin)&&void 0!==s&&s,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,s,a,i;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=null===(t=l.meetsMinPasswordLength)||void 0===t||t),l.isValid&&(l.isValid=null===(n=l.meetsMaxPasswordLength)||void 0===n||n),l.isValid&&(l.isValid=null===(r=l.containsLowercaseLetter)||void 0===r||r),l.isValid&&(l.isValid=null===(s=l.containsUppercaseLetter)||void 0===s||s),l.isValid&&(l.isValid=null===(a=l.containsNumericCharacter)||void 0===a||a),l.isValid&&(l.isValid=null===(i=l.containsNonAlphanumericCharacter)||void 0===i||i),l}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class nn{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new sn(this),this.idTokenSubscription=new sn(this),this.beforeStateQueue=new en(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=We,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ft(t)),this._initializationPromise=this.queue(async()=>{var n,r,s;if(!this._deleted&&(this.persistenceManager=await Kt.create(this,e),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null!==(r=this._popupRedirectResolver)&&void 0!==r&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(Ao){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(s=this.currentUser)||void 0===s?void 0:s.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await kt(this,{idToken:e}),n=await Ot._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if((0,Fe.xZ)(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,r=!1;if(e&&this.config.authDomain){var s,a;await this.getOrInitRedirectPersistenceManager();const t=null===(s=this.redirectUser)||void 0===s?void 0:s._redirectEventId,i=null===(a=n)||void 0===a?void 0:a._redirectEventId,l=await this.tryRedirectSignIn(e);t&&t!==i||null===l||void 0===l||!l.user||(n=l.user,r=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(n)}catch(Ao){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(Ao))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return tt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(Ao){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Dt(e)}catch(Ao){if((null===Ao||void 0===Ao?void 0:Ao.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if((0,Fe.xZ)(this.app))return Promise.reject($e(this));const t=e?(0,Ve.Ku)(e):null;return t&&tt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&tt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(0,Fe.xZ)(this.app)?Promise.reject($e(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return(0,Fe.xZ)(this.app)?Promise.reject($e(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ft(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return pt(e,"GET","/v2/passwordPolicy",mt(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new tn(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ve.FA("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return pt(e,"POST","/v2/accounts:revokeToken",mt(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ft(e)||this._popupRedirectResolver;tt(t,this,"argument-error"),this.redirectPersistenceManager=await Kt.create(this,[Ft(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const s="function"===typeof t?t:t.next.bind(t);let a=!1;const i=this._isInitialized?Promise.resolve():this._initializationPromise;if(tt(i,this,"internal-error"),i.then(()=>{a||s(this.currentUser)}),"function"===typeof t){const s=e.addObserver(t,n,r);return()=>{a=!0,s()}}{const n=e.addObserver(t);return()=>{a=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return tt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=$t(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if((0,Fe.xZ)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return null!==t&&void 0!==t&&t.error&&function(e){if(Qe.logLevel<=ze.$b.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Qe.warn("Auth (".concat(Fe.MF,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function rn(e){return(0,Ve.Ku)(e)}class sn{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,Ve.tD)(e=>this.observer=e)}get next(){return tt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let an={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ln(e){return an.loadJS(e)}function on(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class cn{constructor(){this.enterprise=new un}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class un{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const dn="NO_RECAPTCHA";class hn{constructor(e){this.type="recaptcha-enterprise",this.auth=rn(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const s=window.grecaptcha;wt(s)?s.enterprise.ready(()=>{s.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(dn)})}):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new cn).execute("siteKey",{action:"verify"})}return new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{Nt(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new jt(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(s=>{if(!t&&wt(window.grecaptcha))n(s,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=an.recaptchaEnterpriseScript;0!==t.length&&(t+=s),ln(t).then(()=>{n(s,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function mn(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const a=new hn(e);let i;if(s)i=dn;else try{i=await a.verify(n)}catch(o){i=await a.verify(n,!0)}const l=(0,Le.A)({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in l){const e=l.phoneEnrollmentInfo.phoneNumber,t=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:i,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const e=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:i,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:i}):Object.assign(l,{captchaResponse:i}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function pn(e,t,n,r,s){if("EMAIL_PASSWORD_PROVIDER"===s){var a;if(null!==(a=e._getRecaptchaConfig())&&void 0!==a&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await mn(e,t,n,"getOobCode"===n);return r(e,s)}return r(e,t).catch(async s=>{if(s.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const s=await mn(e,t,n,"getOobCode"===n);return r(e,s)}return Promise.reject(s)})}if("PHONE_PROVIDER"===s){var i;if(null!==(i=e._getRecaptchaConfig())&&void 0!==i&&i.isProviderEnabled("PHONE_PROVIDER")){const s=await mn(e,t,n);return r(e,s).catch(async s=>{var a;if("AUDIT"===(null===(a=e._getRecaptchaConfig())||void 0===a?void 0:a.getProviderEnforcementState("PHONE_PROVIDER"))&&(s.code==="auth/".concat("missing-recaptcha-token")||s.code==="auth/".concat("invalid-app-credential"))){console.log("Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ".concat(n," flow."));const s=await mn(e,t,n,!1,!0);return r(e,s)}return Promise.reject(s)})}{const s=await mn(e,t,n,!1,!0);return r(e,s)}}return Promise.reject(s+" provider is not supported.")}async function fn(e){const t=rn(e),n=await Nt(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new jt(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new hn(t).verify()}}function gn(e,t,n){const r=rn(e);tt(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const s=!(null===n||void 0===n||!n.disableWarnings),a=xn(t),{host:i,port:l}=function(e){const t=xn(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const e=s[1];return{host:e,port:yn(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:yn(t)}}}(t),o=null===l?"":":".concat(l),c={url:"".concat(a,"//").concat(i).concat(o,"/")},u=Object.freeze({host:i,port:l,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator)return tt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void tt((0,Ve.bD)(c,r.config.emulator)&&(0,Ve.bD)(u,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,(0,Ve.zJ)(i)?((0,Ve.gE)("".concat(a,"//").concat(i).concat(o)),(0,Ve.P1)("Auth",!0)):s||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function xn(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function yn(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class vn{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return nt("not implemented")}_getIdTokenResponse(e){return nt("not implemented")}_linkToIdToken(e,t){return nt("not implemented")}_getReauthenticationResolver(e){return nt("not implemented")}}async function bn(e,t){return pt(e,"POST","/v1/accounts:signUp",t)}async function wn(e,t){return gt(e,"POST","/v1/accounts:signInWithPassword",mt(e,t))}async function jn(e,t){return pt(e,"POST","/v1/accounts:sendOobCode",mt(e,t))}async function Nn(e,t){return jn(e,t)}class kn extends vn{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new kn(e,t,"password")}static _fromEmailAndCode(e,t){return new kn(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if(null!==t&&void 0!==t&&t.email&&null!==t&&void 0!==t&&t.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return pn(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",wn,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return gt(e,"POST","/v1/accounts:signInWithEmailLink",mt(e,t))}(e,{email:this._email,oobCode:this._password});default:Ze(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return pn(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",bn,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return gt(e,"POST","/v1/accounts:signInWithEmailLink",mt(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Ze(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Sn(e,t){return gt(e,"POST","/v1/accounts:signInWithIdp",mt(e,t))}class Cn extends vn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Cn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ze("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,s=Oe(t,qe);if(!n||!r)return null;const a=new Cn(n,r);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){return Sn(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Sn(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Sn(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,Ve.Am)(t)}return e}}async function En(e,t){return pt(e,"POST","/v1/accounts:sendVerificationCode",mt(e,t))}const An={USER_NOT_FOUND:"user-not-found"};class In extends vn{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new In({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new In({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return gt(e,"POST","/v1/accounts:signInWithPhoneNumber",mt(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await gt(e,"POST","/v1/accounts:signInWithPhoneNumber",mt(e,t));if(n.temporaryProof)throw bt(e,"account-exists-with-different-credential",n);return n}(e,(0,Le.A)({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return gt(e,"POST","/v1/accounts:signInWithPhoneNumber",mt(e,(0,Le.A)((0,Le.A)({},t),{},{operation:"REAUTH"})),An)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:s}=e;return n||t||r||s?new In({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:s}):null}}class _n{constructor(e){var t,n,r,s,a,i;const l=(0,Ve.I9)((0,Ve.hp)(e)),o=null!==(t=l.apiKey)&&void 0!==t?t:null,c=null!==(n=l.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=l.mode)&&void 0!==r?r:null);tt(o&&c&&u,"argument-error"),this.apiKey=o,this.operation=u,this.code=c,this.continueUrl=null!==(s=l.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(a=l.lang)&&void 0!==a?a:null,this.tenantId=null!==(i=l.tenantId)&&void 0!==i?i:null}static parseLink(e){const t=function(e){const t=(0,Ve.I9)((0,Ve.hp)(e)).link,n=t?(0,Ve.I9)((0,Ve.hp)(t)).deep_link_id:null,r=(0,Ve.I9)((0,Ve.hp)(e)).deep_link_id;return(r?(0,Ve.I9)((0,Ve.hp)(r)).link:null)||r||n||t||e}(e);try{return new _n(t)}catch(n){return null}}}class Tn{constructor(){this.providerId=Tn.PROVIDER_ID}static credential(e,t){return kn._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=_n.parseLink(t);return tt(n,"argument-error"),kn._fromEmailAndCode(e,n.code,n.tenantId)}}Tn.PROVIDER_ID="password",Tn.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Tn.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Dn{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Pn extends Dn{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Mn extends Pn{constructor(){super("facebook.com")}static credential(e){return Cn._fromParams({providerId:Mn.PROVIDER_ID,signInMethod:Mn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Mn.credentialFromTaggedObject(e)}static credentialFromError(e){return Mn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Mn.credential(t.oauthAccessToken)}catch(n){return null}}}Mn.FACEBOOK_SIGN_IN_METHOD="facebook.com",Mn.PROVIDER_ID="facebook.com";class Rn extends Pn{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Cn._fromParams({providerId:Rn.PROVIDER_ID,signInMethod:Rn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Rn.credentialFromTaggedObject(e)}static credentialFromError(e){return Rn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return Rn.credential(n,r)}catch(s){return null}}}Rn.GOOGLE_SIGN_IN_METHOD="google.com",Rn.PROVIDER_ID="google.com";class On extends Pn{constructor(){super("github.com")}static credential(e){return Cn._fromParams({providerId:On.PROVIDER_ID,signInMethod:On.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return On.credentialFromTaggedObject(e)}static credentialFromError(e){return On.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return On.credential(t.oauthAccessToken)}catch(n){return null}}}On.GITHUB_SIGN_IN_METHOD="github.com",On.PROVIDER_ID="github.com";class Ln extends Pn{constructor(){super("twitter.com")}static credential(e,t){return Cn._fromParams({providerId:Ln.PROVIDER_ID,signInMethod:Ln.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ln.credentialFromTaggedObject(e)}static credentialFromError(e){return Ln.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return Ln.credential(n,r)}catch(s){return null}}}Ln.TWITTER_SIGN_IN_METHOD="twitter.com",Ln.PROVIDER_ID="twitter.com";class Fn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=await Ot._fromIdTokenResponse(e,n,r),a=Vn(n);return new Fn({user:s,providerId:a,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Vn(n);return new Fn({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Vn(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class zn extends Ve.g{constructor(e,t,n,r){var s;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,zn.prototype),this.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new zn(e,t,n,r)}}function Un(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw zn._fromErrorAndOperation(e,n,t,r);throw n})}async function Kn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await It(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Fn._forOperation(e,"link",r)}async function Bn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if((0,Fe.xZ)(r.app))return Promise.reject($e(r));const s="reauthenticate";try{const a=await It(e,Un(r,s,t,e),n);tt(a.idToken,r,"internal-error");const i=Et(a.idToken);tt(i,r,"internal-error");const{sub:l}=i;return tt(e.uid===l,r,"user-mismatch"),Fn._forOperation(e,s,a)}catch(Ao){throw(null===Ao||void 0===Ao?void 0:Ao.code)==="auth/".concat("user-not-found")&&Ze(r,"user-mismatch"),Ao}}async function qn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,Fe.xZ)(e.app))return Promise.reject($e(e));const r="signIn",s=await Un(e,r,t),a=await Fn._fromIdTokenResponse(e,r,s);return n||await e._updateCurrentUser(a.user),a}async function Hn(e,t){return qn(rn(e),t)}function Gn(e,t,n){var r;tt((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),tt("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),tt("undefined"===typeof n.linkDomain||n.linkDomain.length>0,e,"invalid-hosting-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.linkDomain=n.linkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(tt(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(tt(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function Wn(e){const t=rn(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}function Qn(e,t){return pt(e,"POST","/v2/accounts/mfaEnrollment:start",mt(e,t))}new WeakMap;const Jn="__sak";class Zn{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Jn,"1"),this.storage.removeItem(Jn),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Xn extends Zn{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Yt(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},s=this.storage.getItem(n);(0,Ve.lT)()&&10===document.documentMode&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Xn.type="LOCAL";const Yn=Xn;function $n(e){var t,n;const r=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),s=RegExp("".concat(r,"=([^;]+)"));return null!==(t=null===(n=document.cookie.match(s))||void 0===n?void 0:n[1])&&void 0!==t?t:null}function er(e){const t="http:"===window.location.protocol;return"".concat(t?"__dev_":"__HOST-","FIREBASE_").concat(e.split(":")[3])}class tr{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL("".concat(window.location.origin,"/__cookies__"));return t.searchParams.set("finalTarget",e),t}async _isAvailable(){var e;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(e=navigator.cookieEnabled)||void 0===e||e))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=er(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return null===e||void 0===e?void 0:e.value}return $n(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=er(e);document.cookie="".concat(t,"=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High"),await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,t){if(!this._isAvailable())return;const n=er(e);if(window.cookieStore){const e=e=>{const r=e.changed.find(e=>e.name===n);r&&t(r.value);e.deleted.find(e=>e.name===n)&&t(null)},r=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,r),window.cookieStore.addEventListener("change",e)}let r=$n(n);const s=setInterval(()=>{const e=$n(n);e!==r&&(t(e),r=e)},1e3);this.listenerUnsubscribes.set(t,()=>clearInterval(s))}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}tr.type="COOKIE";class nr extends Zn{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}nr.type="SESSION";const rr=nr;class sr{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new sr(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:s}=t.data,a=this.handlersMap[r];if(null===a||void 0===a||!a.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const i=Array.from(a).map(async e=>e(t.origin,s)),l=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(i);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:l})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function ar(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}sr.receivers=[];class ir{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,a;return new Promise((i,l)=>{const o=ar("",20);r.port1.start();const c=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===o)switch(t.data.status){case"ack":clearTimeout(c),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),i(t.data.response);break;default:clearTimeout(c),clearTimeout(s),l(new Error("invalid_response"))}}},this.handlers.add(a),r.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:o,data:t},[r.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function lr(){return window}function or(){return"undefined"!==typeof lr().WorkerGlobalScope&&"function"===typeof lr().importScripts}const cr="firebaseLocalStorageDb",ur="firebaseLocalStorage",dr="fbase_key";class hr{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function mr(e,t){return e.transaction([ur],t?"readwrite":"readonly").objectStore(ur)}function pr(){const e=indexedDB.open(cr,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(ur,{keyPath:dr})}catch(Ao){n(Ao)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(ur)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(cr);return new hr(e).toPromise()}(),t(await pr()))})})}async function fr(e,t,n){const r=mr(e,!0).put({[dr]:t,value:n});return new hr(r).toPromise()}function gr(e,t){const n=mr(e,!0).delete(t);return new hr(n).toPromise()}class xr{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await pr()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(Ao){if(t++>3)throw Ao;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return or()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=sr._getInstance(or()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){var e;if(null===(e=navigator)||void 0===e||!e.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new ir(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&null!==(e=n[0])&&void 0!==e&&e.fulfilled&&null!==(t=n[0])&&void 0!==t&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=navigator)||void 0===e||null===(e=e.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await pr();return await fr(e,Jn,"1"),await gr(e,Jn),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>fr(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=mr(e,!1).get(t),r=await new hr(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>gr(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=mr(e,!1).getAll();return new hr(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:s}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}xr.type="LOCAL";const yr=xr;function vr(e,t){return pt(e,"POST","/v2/accounts/mfaSignIn:start",mt(e,t))}on("rcb"),new lt(3e4,6e4);const br="recaptcha";async function wr(e,t,n){if(!e._getRecaptchaConfig())try{await fn(e)}catch(s){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let s;if(s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){tt("enroll"===t.type,e,"internal-error");const r={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},a=pn(e,r,"mfaSmsEnrollment",async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===dn){tt((null===n||void 0===n?void 0:n.type)===br,e,"argument-error");return Qn(e,await jr(e,t,n))}return Qn(e,t)},"PHONE_PROVIDER");return(await a.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{var r;tt("signin"===t.type,e,"internal-error");const a=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;tt(a,e,"missing-multi-factor-info");const i={mfaPendingCredential:t.credential,mfaEnrollmentId:a,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},l=pn(e,i,"mfaSmsSignIn",async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===dn){tt((null===n||void 0===n?void 0:n.type)===br,e,"argument-error");return vr(e,await jr(e,t,n))}return vr(e,t)},"PHONE_PROVIDER");return(await l.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"},r=pn(e,t,"sendVerificationCode",async(e,t)=>{if(t.captchaResponse===dn){tt((null===n||void 0===n?void 0:n.type)===br,e,"argument-error");return En(e,await jr(e,t,n))}return En(e,t)},"PHONE_PROVIDER");return(await r.catch(e=>Promise.reject(e))).sessionInfo}}finally{null===n||void 0===n||n._reset()}}async function jr(e,t,n){tt(n.type===br,e,"argument-error");const r=await n.verify();tt("string"===typeof r,e,"argument-error");const s=(0,Le.A)({},t);if("phoneEnrollmentInfo"in s){const e=s.phoneEnrollmentInfo.phoneNumber,t=s.phoneEnrollmentInfo.captchaResponse,n=s.phoneEnrollmentInfo.clientType,a=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:a}}),s}if("phoneSignInInfo"in s){const e=s.phoneSignInInfo.captchaResponse,t=s.phoneSignInInfo.clientType,n=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),s}return Object.assign(s,{recaptchaToken:r}),s}class Nr{constructor(e){this.providerId=Nr.PROVIDER_ID,this.auth=rn(e)}verifyPhoneNumber(e,t){return wr(this.auth,e,(0,Ve.Ku)(t))}static credential(e,t){return In._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Nr.credentialFromTaggedObject(t)}static credentialFromError(e){return Nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?In._fromTokenResponse(n,r):null}}function kr(e,t){return t?Ft(t):(tt(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Nr.PROVIDER_ID="phone",Nr.PHONE_SIGN_IN_METHOD="phone";class Sr extends vn{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Sn(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Sn(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Sn(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Cr(e){return qn(e.auth,new Sr(e),e.bypassAuthState)}function Er(e){const{auth:t,user:n}=e;return tt(n,t,"internal-error"),Bn(n,new Sr(e),e.bypassAuthState)}async function Ar(e){const{auth:t,user:n}=e;return tt(n,t,"internal-error"),Kn(n,new Sr(e),e.bypassAuthState)}class Ir{constructor(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(Ao){this.reject(Ao)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:s,error:a,type:i}=e;if(a)return void this.reject(a);const l={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(i)(l))}catch(Ao){this.reject(Ao)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Cr;case"linkViaPopup":case"linkViaRedirect":return Ar;case"reauthViaPopup":case"reauthViaRedirect":return Er;default:Ze(this.auth,"internal-error")}}resolve(e){rt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){rt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const _r=new lt(2e3,1e4);class Tr extends Ir{constructor(e,t,n,r,s){super(e,t,r,s),this.provider=n,this.authWindow=null,this.pollId=null,Tr.currentPopupAction&&Tr.currentPopupAction.cancel(),Tr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return tt(e,this.auth,"internal-error"),e}async onExecution(){rt(1===this.filter.length,"Popup operations only handle one event");const e=ar();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(Xe(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Xe(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Tr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t;null!==(t=this.authWindow)&&void 0!==t&&null!==(t=t.window)&&void 0!==t&&t.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Xe(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,_r.get())};e()}}Tr.currentPopupAction=null;const Dr=new Map;class Pr extends Ir{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=Dr.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=Or(t),r=Rr(e);if(!await r._isAvailable())return!1;const s="true"===await r._get(n);return await r._remove(n),s}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(Ao){e=()=>Promise.reject(Ao)}Dr.set(this.auth._key(),e)}return this.bypassAuthState||Dr.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Mr(e,t){Dr.set(e._key(),t)}function Rr(e){return Ft(e._redirectPersistence)}function Or(e){return Ut("pendingRedirect",e.config.apiKey,e.name)}async function Lr(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,Fe.xZ)(e.app))return Promise.reject($e(e));const r=rn(e),s=kr(r,t),a=new Pr(r,s,n),i=await a.execute();return i&&!n&&(delete i.user._redirectEventId,await r._persistUserIfCurrent(i.user),await r._setRedirectUser(null,t)),i}class Fr{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return zr(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!zr(e)){var n;const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Xe(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Vr(e))}saveEventToCache(e){this.cachedEventUids.add(Vr(e)),this.lastProcessedEventTime=Date.now()}}function Vr(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function zr(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const Ur=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Kr=/^https?/;async function Br(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return pt(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(qr(r))return}catch(n){}Ze(e,"unauthorized-domain")}function qr(e){const t=st(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const s=new URL(e);return""===s.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&s.hostname===r}if(!Kr.test(n))return!1;if(Ur.test(e))return r===e;const s=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const Hr=new lt(3e4,6e4);function Gr(){const e=lr().___jsl;if(null!==e&&void 0!==e&&e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function Wr(e){return new Promise((t,n)=>{var r,s;function a(){Gr(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Gr(),n(Xe(e,"network-request-failed"))},timeout:Hr.get()})}if(null!==(r=lr().gapi)&&void 0!==r&&null!==(r=r.iframes)&&void 0!==r&&r.Iframe)t(gapi.iframes.getContext());else{if(null===(s=lr().gapi)||void 0===s||!s.load){const t=on("iframefcb");return lr()[t]=()=>{gapi.load?a():n(Xe(e,"network-request-failed"))},ln("".concat(an.gapiScript,"?onload=").concat(t)).catch(e=>n(e))}a()}}).catch(e=>{throw Qr=null,e})}let Qr=null;const Jr=new lt(5e3,15e3),Zr={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Xr=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Yr(e){const t=e.config;tt(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?ot(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:Fe.MF},s=Xr.get(e.config.apiHost);s&&(r.eid=s);const a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat((0,Ve.Am)(r).slice(1))}async function $r(e){const t=await function(e){return Qr=Qr||Wr(e),Qr}(e),n=lr().gapi;return tt(n,e,"internal-error"),t.open({where:document.body,url:Yr(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Zr,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const s=Xe(e,"network-request-failed"),a=lr().setTimeout(()=>{r(s)},Jr.get());function i(){lr().clearTimeout(a),n(t)}t.ping(i).then(i,()=>{r(s)})}))}const es={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class ts{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(Ao){}}}function ns(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const a=Math.max((window.screen.availHeight-s)/2,0).toString(),i=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const o=(0,Le.A)((0,Le.A)({},es),{},{width:r.toString(),height:s.toString(),top:a,left:i}),c=(0,Ve.ZQ)().toLowerCase();n&&(l=Gt(c)?"_blank":n),qt(c)&&(t=t||"http://localhost",o.scrollbars="yes");const u=Object.entries(o).reduce((e,t)=>{let[n,r]=t;return"".concat(e).concat(n,"=").concat(r,",")},"");if(function(){var e;return Xt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,Ve.ZQ)())&&!(null===(e=window.navigator)||void 0===e||!e.standalone)}(c)&&"_self"!==l)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",l),new ts(null);const d=window.open(t||"",l,u);tt(d,e,"popup-blocked");try{d.focus()}catch(Ao){}return new ts(d)}const rs="__/auth/handler",ss="emulator/auth/handler",as=encodeURIComponent("fac");async function is(e,t,n,r,s,a){tt(e.config.authDomain,e,"auth-domain-config-required"),tt(e.config.apiKey,e,"invalid-api-key");const i={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Fe.MF,eventId:s};if(t instanceof Dn){t.setDefaultLanguage(e.languageCode),i.providerId=t.providerId||"",(0,Ve.Im)(t.getCustomParameters())||(i.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))i[e]=t}if(t instanceof Pn){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(i.scopes=e.join(","))}e.tenantId&&(i.tid=e.tenantId);const l=i;for(const u of Object.keys(l))void 0===l[u]&&delete l[u];const o=await e._getAppCheckToken(),c=o?"#".concat(as,"=").concat(encodeURIComponent(o)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(rs);return ot(t,ss)}(e),"?").concat((0,Ve.Am)(l).slice(1)).concat(c)}const ls="webStorageSupport";const os=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=rr,this._completeRedirectFn=Lr,this._overrideRedirectResult=Mr}async _openPopup(e,t,n,r){var s;rt(null===(s=this.eventManagers[e._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()");return ns(e,await is(e,t,n,st(),r),ar())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){lr().location.href=e}(await is(e,t,n,st(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(rt(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await $r(e),n=new Fr(e);return t.register("authEvent",t=>{tt(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ls,{type:ls},n=>{var r;const s=null===n||void 0===n||null===(r=n[0])||void 0===r?void 0:r[ls];void 0!==s&&t(!!s),Ze(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Br(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Yt()||Ht()||Xt()}};var cs="@firebase/auth",us="1.11.0";class ds{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){tt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const hs=(0,Ve.XA)("authIdTokenMaxAge")||300;let ms=null;function ps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,Fe.Sx)();const t=(0,Fe.j6)(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=(0,Fe.j6)(e,"auth");if(n.isInitialized()){const e=n.getImmediate(),r=n.getOptions();if((0,Ve.bD)(r,null!==t&&void 0!==t?t:{}))return e;Ze(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:os,persistence:[yr,Yn,rr]}),r=(0,Ve.XA)("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(s=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>hs)return;const r=null===t||void 0===t?void 0:t.token;ms!==r&&(ms=r,await fetch(s,{method:r?"POST":"DELETE",headers:r?{Authorization:"Bearer ".concat(r)}:{}}))});!function(e,t,n){(0,Ve.Ku)(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e,t,n,r){(0,Ve.Ku)(e).onIdTokenChanged(t,n,r)}(n,e=>t(e))}}var s;const a=(0,Ve.Tj)("auth");return a&&gn(n,"http://".concat(a)),n}var fs;an={loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=Xe("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(e=null===(t=document.getElementsByTagName("head"))||void 0===t?void 0:t[0])&&void 0!==e?e:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},fs="Browser",(0,Fe.om)(new Ue.uA("auth",(e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:i,authDomain:l}=r.options;tt(i&&!i.includes(":"),"invalid-api-key",{appName:r.name});const o={apiKey:i,authDomain:l,clientPlatform:fs,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:$t(fs)},c=new nn(r,s,a,o);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ft);null!==t&&void 0!==t&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),(0,Fe.om)(new Ue.uA("auth-internal",e=>(e=>new ds(e))(rn(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,Fe.KO)(cs,us,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(fs)),(0,Fe.KO)(cs,us,"esm2020");var gs=n(579);const xs=(0,s.createContext)(),ys=()=>{const e=(0,s.useContext)(xs);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},vs=e=>{let{children:t}=e;const[n,r]=(0,s.useState)(null),[a,i]=(0,s.useState)(!0),[l,o]=(0,s.useState)(null),c=ps();(0,s.useEffect)(()=>{const e=function(e,t,n,r){return(0,Ve.Ku)(e).onAuthStateChanged(t,n,r)}(c,e=>{r(e),i(!1)});return e},[c]);const u={user:n,login:async(e,t)=>{try{o(null),i(!0);const n=await function(e,t,n){return(0,Fe.xZ)(e.app)?Promise.reject($e(e)):Hn((0,Ve.Ku)(e),Tn.credential(t,n)).catch(async t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&Wn(e),t})}(c,e,t);return n.user}catch(l){throw o(l.message),l}finally{i(!1)}},logout:async()=>{try{o(null),await function(e){return(0,Ve.Ku)(e).signOut()}(c)}catch(l){throw o(l.message),l}},resetPassword:async e=>{try{o(null),await async function(e,t,n){const r=rn(e),s={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};n&&Gn(r,s,n),await pn(r,s,"getOobCode",Nn,"EMAIL_PASSWORD_PROVIDER")}(c,e)}catch(l){throw o(l.message),l}},loading:a,error:l,clearError:()=>{o(null)}};return(0,gs.jsx)(xs.Provider,{value:u,children:t})};var bs=n(889),ws=n(958);const js=(0,s.createContext)(),Ns=e=>{let{children:t}=e;const{user:n}=ys(),[r,a]=(0,s.useState)(null),[i,l]=(0,s.useState)([]),[o,c]=(0,s.useState)(!0);(0,s.useEffect)(()=>{n?u():(a(null),l([]),c(!1))},[n]);const u=async()=>{try{c(!0);const e=(await n.getIdTokenResult(!0)).claims;e.role&&e.permissions?(a(e.role),l(e.permissions||[])):(a("monteur"),l(["materials","vde","bookings"]))}catch(e){console.error("Fehler beim Laden der User-Rolle:",e),a("monteur"),l(["materials","vde","bookings"])}finally{c(!1)}},d=e=>i.includes(e),h=()=>"admin"===r,m={userRole:r,permissions:i,loading:o,hasPermission:d,isAdmin:h,isProjektleiter:()=>"projektleiter"===r||"admin"===r,isMonteur:()=>"monteur"===r,canAccessModule:e=>d(e),assignUserRole:async(e,t)=>{if(!h())throw new Error("Nur Admins k\xf6nnen Rollen setzen");try{const n=(0,bs.Qg)(ws.C,"setUserRole");return(await n({uid:e,role:t})).data}catch(n){throw console.error("Fehler beim Setzen der Rolle:",n),n}},setupFirstAdmin:async()=>{try{const e=(0,bs.Qg)(ws.C,"setupFirstAdmin"),t=await e();return await u(),t.data}catch(e){throw console.error("Fehler beim Einrichten des ersten Admins:",e),e}},loadUserRole:u};return(0,gs.jsx)(js.Provider,{value:m,children:t})};var ks=n(737);const Ss=(0,s.createContext)(),Cs=()=>{const e=(0,s.useContext)(Ss);if(!e)throw new Error("useMaterials must be used within a MaterialProvider");return e},Es=e=>{let{children:t}=e;const[n,r]=(0,s.useState)([]),[a,i]=(0,s.useState)(!0),[l,o]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e;return(async()=>{try{i(!0),e=ks.VF.subscribeToMaterials(e=>{r(e),i(!1)})}catch(t){console.error("Error setting up materials listener:",t),o(t.message),i(!1)}})(),()=>{e&&e()}},[]);const c=async(e,t)=>{try{const r=n.find(t=>t.id===e);if(!r)return;const s=r.stock+t,a=s<0?"Nachbestellen":0===s?"Nicht verf\xfcgbar":s<=r.heatStock?"Niedrig":"Auf Lager";await ks.VF.updateMaterial(e,(0,Le.A)((0,Le.A)({},r),{},{stock:s,stockState:a}))}catch(r){console.error("Error updating stock:",r),o(r.message)}},u={materials:n,loading:a,error:l,addMaterial:async e=>{try{i(!0),await ks.VF.addMaterial(e)}catch(t){console.error("Error adding material:",t),o(t.message)}finally{i(!1)}},updateMaterial:async e=>{try{i(!0),await ks.VF.updateMaterial(e.id,e)}catch(t){console.error("Error updating material:",t),o(t.message)}finally{i(!1)}},deleteMaterial:async e=>{try{i(!0),await ks.VF.deleteMaterial(e)}catch(t){console.error("Error deleting material:",t),o(t.message)}finally{i(!1)}},updateStock:c,updateMaterialStock:c};return(0,gs.jsx)(Ss.Provider,{value:u,children:t})};var As={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Is=["color","size","strokeWidth","absoluteStrokeWidth","children"];var _s=(e,t)=>{const n=(0,s.forwardRef)((n,r)=>{let{color:a="currentColor",size:i=24,strokeWidth:l=2,absoluteStrokeWidth:o,children:c}=n,u=Oe(n,Is);return(0,s.createElement)("svg",(0,Le.A)((0,Le.A)({ref:r},As),{},{width:i,height:i,stroke:a,strokeWidth:o?24*Number(l)/Number(i):l,className:"lucide lucide-".concat((d=e,d.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()))},u),[...t.map(e=>{let[t,n]=e;return(0,s.createElement)(t,n)}),...(Array.isArray(c)?c:[c])||[]]);var d});return n.displayName="".concat(e),n};const Ts=_s("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),Ds=_s("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Ps=_s("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Ms=_s("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Rs=(0,s.createContext)(),Os=()=>{const e=(0,s.useContext)(Rs);if(!e)throw new Error("useNotification must be used within a NotificationProvider");return e},Ls=e=>{let{children:t}=e;const[n,r]=(0,s.useState)([]),a=e=>{r(t=>t.filter(t=>t.id!==e))},i=e=>{switch(e){case"success":return(0,gs.jsx)(Ts,{className:"h-5 w-5"});case"error":case"warning":return(0,gs.jsx)(Ds,{className:"h-5 w-5"});default:return(0,gs.jsx)(Ps,{className:"h-5 w-5"})}},l=e=>{switch(e){case"success":return"bg-green-500 text-white";case"error":return"bg-red-500 text-white";case"warning":return"bg-yellow-500 text-white";case"info":return"bg-blue-500 text-white";default:return"bg-gray-500 text-white"}},o={notifications:n,showNotification:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;const s=Date.now(),i={id:s,message:e,type:t,timestamp:new Date};return r(e=>[...e,i]),n>0&&setTimeout(()=>{a(s)},n),s},removeNotification:a,clearAllNotifications:()=>{r([])}};return(0,gs.jsxs)(Rs.Provider,{value:o,children:[t,(0,gs.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:n.map(e=>(0,gs.jsxs)("div",{className:"flex items-center p-4 rounded-lg shadow-lg max-w-md ".concat(l(e.type)," fade-in"),children:[(0,gs.jsx)("div",{className:"flex-shrink-0 mr-3",children:i(e.type)}),(0,gs.jsx)("div",{className:"flex-1",children:(0,gs.jsx)("p",{className:"text-sm font-medium",children:e.message})}),(0,gs.jsx)("button",{onClick:()=>a(e.id),className:"flex-shrink-0 ml-3 text-white hover:text-gray-200",children:(0,gs.jsx)(Ms,{className:"h-4 w-4"})})]},e.id))})]})},Fs=(0,s.createContext)(),Vs=()=>{const e=(0,s.useContext)(Fs);if(!e)throw new Error("useCustomers must be used within a CustomerProvider");return e},zs=e=>{let{children:t}=e;const[n,r]=(0,s.useState)([]),[a,i]=(0,s.useState)(!0),[l,o]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e;return(async()=>{try{i(!0),e=ks.m6.subscribeToCustomers(e=>{r(e),i(!1)})}catch(t){console.error("Error setting up customers listener:",t),o(t.message),i(!1)}})(),()=>{e&&e()}},[]);const[c,u]=(0,s.useState)([]),d={customers:n,loading:a,error:l,addCustomer:async e=>{try{i(!0),await ks.m6.addCustomer(e)}catch(t){console.error("Error adding customer:",t),o(t.message)}finally{i(!1)}},updateCustomer:async(e,t)=>{try{i(!0),await ks.m6.updateCustomer(e,t)}catch(n){console.error("Error updating customer:",n),o(n.message)}finally{i(!1)}},deleteCustomer:async e=>{try{i(!0),await ks.m6.deleteCustomer(e)}catch(t){console.error("Error deleting customer:",t),o(t.message)}finally{i(!1)}},getCustomerById:e=>n.find(t=>t.id===e),addProject:(e,t)=>{r(n=>n.map(n=>n.id===e?(0,Le.A)((0,Le.A)({},n),{},{projects:[...n.projects,(0,Le.A)((0,Le.A)({id:Date.now().toString()},t),{},{createdAt:new Date})],lastActivity:new Date}):n))},updateProject:(e,t,n)=>{r(r=>r.map(r=>r.id===e?(0,Le.A)((0,Le.A)({},r),{},{projects:r.projects.map(e=>e.id===t?(0,Le.A)((0,Le.A)({},e),n):e),lastActivity:new Date}):r))},deleteProject:(e,t)=>{r(n=>n.map(n=>n.id===e?(0,Le.A)((0,Le.A)({},n),{},{projects:n.projects.filter(e=>e.id!==t),lastActivity:new Date}):n))},addProjectToCustomer:(e,t)=>{r(n=>n.map(n=>n.id===e?(0,Le.A)((0,Le.A)({},n),{},{projects:[...n.projects,(0,Le.A)((0,Le.A)({},t),{},{id:"project-".concat(Date.now())})],lastActivity:new Date}):n))},updateCustomerProject:(e,t,n)=>{r(r=>r.map(r=>r.id===e?(0,Le.A)((0,Le.A)({},r),{},{projects:r.projects.map(e=>e.id===t?(0,Le.A)((0,Le.A)({},n),{},{id:t}):e),lastActivity:new Date}):r))},deleteCustomerProject:(e,t)=>{r(n=>n.map(n=>n.id===e?(0,Le.A)((0,Le.A)({},n),{},{projects:n.projects.filter(e=>e.id!==t),lastActivity:new Date}):n))}};return(0,gs.jsx)(Fs.Provider,{value:d,children:t})},Us=(0,s.createContext)(),Ks=()=>{const e=(0,s.useContext)(Us);if(!e)throw new Error("useProjects must be used within a ProjectProvider");return e},Bs=e=>{let{children:t}=e;const[n,r]=(0,s.useState)([]),[a,i]=(0,s.useState)(!0),[l,o]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e;return(async()=>{try{i(!0),e=ks.TR.subscribeToProjects(e=>{r(e),i(!1)})}catch(t){console.error("Error setting up projects listener:",t),o(t.message),i(!1)}})(),()=>{e&&e()}},[]);const c={projects:n,loading:a,error:l,addProject:async e=>{try{i(!0);const t=(0,Le.A)((0,Le.A)({},e),{},{id:e.id||"project-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),createdAt:new Date,updatedAt:new Date,status:e.status||"Aktiv"});return await ks.TR.addProject(t)}catch(t){throw console.error("Error adding project:",t),o(t.message),t}finally{i(!1)}},updateProject:async(e,t)=>{try{i(!0),await ks.TR.updateProject(e,(0,Le.A)((0,Le.A)({},t),{},{updatedAt:new Date}))}catch(n){throw console.error("Error updating project:",n),o(n.message),n}finally{i(!1)}},deleteProject:async e=>{try{i(!0),await ks.TR.deleteProject(e)}catch(t){throw console.error("Error deleting project:",t),o(t.message),t}finally{i(!1)}},getProjectsByCustomer:e=>n.filter(t=>t.customerID===e),getActiveProjects:()=>n.filter(e=>"Aktiv"===e.status),getProjectById:e=>n.find(t=>t.id===e)};return(0,gs.jsx)(Us.Provider,{value:c,children:t})},qs=(0,s.createContext)(),Hs=()=>{const e=(0,s.useContext)(qs);if(!e)throw new Error("useBookings must be used within a BookingProvider");return e},Gs=e=>{let{children:t}=e;const[n,r]=(0,s.useState)([]),[a,i]=(0,s.useState)(!0),[l,o]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e;return(async()=>{try{i(!0),e=ks.LM.subscribeToBookings(e=>{r(e),i(!1)})}catch(t){console.error("Error setting up bookings listener:",t),o(t.message),i(!1)}})(),()=>{e&&e()}},[]);const c={bookings:n,loading:a,error:l,addBooking:async e=>{try{i(!0),await ks.LM.addBooking(e)}catch(t){console.error("Error adding booking:",t),o(t.message)}finally{i(!1)}},deleteBooking:async e=>{try{i(!0),await ks.LM.deleteBooking(e)}catch(t){console.error("Error deleting booking:",t),o(t.message)}finally{i(!1)}},undoBooking:async e=>{const t=n.find(t=>t.id===e);if(t)try{for(const e of t.materials){const n=await ks.VF.getDocument(e.materialID);if(n){const r="Eingang"===t.type?-e.quantity:e.quantity,s=n.stock+r,a=s<0?"Nachbestellen":0===s?"Nicht verf\xfcgbar":s<=n.heatStock?"Niedrig":"Auf Lager";await ks.VF.updateMaterial(e.materialID,(0,Le.A)((0,Le.A)({},n),{},{stock:s,stockState:a}))}}return await ks.LM.deleteBooking(e),{success:!0,message:"Buchung erfolgreich r\xfcckg\xe4ngig gemacht"}}catch(r){throw console.error("Error undoing booking:",r),o(r.message),r}},getBookingsByCustomer:e=>n.filter(t=>t.customerID===e),getBookingsByDateRange:(e,t)=>n.filter(n=>{const r=new Date(n.timestamp);return r>=e&&r<=t}),getBookingStatistics:()=>{const e=new Date,t=new Date(e.getTime()-6048e5),r=new Date(e.getTime()-2592e6);return{total:n.length,eingaenge:n.filter(e=>"Eingang"===e.type).length,ausgaenge:n.filter(e=>"Ausgang"===e.type).length,heute:n.filter(t=>new Date(t.timestamp).toDateString()===e.toDateString()).length,dieseWoche:n.filter(e=>new Date(e.timestamp)>=t).length,dieserMonat:n.filter(e=>new Date(e.timestamp)>=r).length,storniert:n.filter(e=>"Storniert"===e.status).length,rueckbuchungen:n.filter(e=>"R\xfcckbuchung"===e.status).length}}};return(0,gs.jsx)(qs.Provider,{value:c,children:t})},Ws=(0,s.createContext)(),Qs=()=>{const e=(0,s.useContext)(Ws);if(!e)throw new Error("useCalculation must be used within a CalculationProvider");return e},Js={hourlyRates:{meister:{rate:72,label:"Meister"},geselle:{rate:58,label:"Geselle"},helfer:{rate:42,label:"Helfer/Azubi"}},margins:{materialMarkup:15,profitMargin:15,riskMargin:5,discountBuffer:3},tax:{defaultRate:19,reducedRate:7},offerDefaults:{validityDays:30,paymentTerms:"14 Tage netto",deliveryTerms:"Nach Vereinbarung",numberPrefix:"ANG",numberFormat:"ANG-{YEAR}-{NUMBER}"}},Zs=e=>{let{children:t}=e;const[n,r]=(0,s.useState)(Js),[a,i]=(0,s.useState)(!0),[l,o]=(0,s.useState)(null),[c,u]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e;return(async()=>{try{i(!0),e=ks.Oh.subscribeToSettings(e=>{r(e?t=>(0,Le.A)((0,Le.A)((0,Le.A)({},Js),e),{},{hourlyRates:(0,Le.A)((0,Le.A)({},Js.hourlyRates),e.hourlyRates),margins:(0,Le.A)((0,Le.A)({},Js.margins),e.margins),tax:(0,Le.A)((0,Le.A)({},Js.tax),e.tax),offerDefaults:(0,Le.A)((0,Le.A)({},Js.offerDefaults),e.offerDefaults)}):Js),i(!1)})}catch(t){console.error("Error setting up calculation settings listener:",t),o(t.message),r(Js),i(!1)}})(),()=>{e&&e()}},[]);const d=(0,s.useCallback)(async e=>{try{return u(!0),await ks.Oh.saveSettings(e),{success:!0}}catch(t){return console.error("Error saving calculation settings:",t),o(t.message),{success:!1,error:t.message}}finally{u(!1)}},[]),h=(0,s.useCallback)(async(e,t)=>{const r=(0,Le.A)({},n),s=e.split(".");let a=r;for(let n=0;n<s.length-1;n++)a=a[s[n]];return a[s[s.length-1]]=t,d(r)},[n,d]),m=(0,s.useCallback)(e=>{var t;return(null===(t=n.hourlyRates[e])||void 0===t?void 0:t.rate)||0},[n.hourlyRates]),p=(0,s.useCallback)(e=>e*(1+n.margins.materialMarkup/100),[n.margins.materialMarkup]),f=(0,s.useCallback)((e,t)=>t/60*m(e),[m]),g=(0,s.useCallback)((e,t)=>(e+t)*(1+n.margins.profitMargin/100+n.margins.riskMargin/100),[n.margins]),x=(0,s.useCallback)((e,t,n)=>{let r=0,s=0;e.forEach(e=>{const t=n.find(t=>t.id===e.materialID),a=(null===t||void 0===t?void 0:t.purchasePrice)||(null===t||void 0===t?void 0:t.price)||0,i=e.quantity||1;r+=a*i,s+=p(a)*i});let a=0;t.forEach(e=>{a+=f(e.role,e.minutes)});const i=s+a,l=g(s,a);return{materialCostEK:r,materialCostVK:s,laborCost:a,subtotal:i,unitPriceNet:l,lastCalculated:(new Date).toISOString()}},[p,f,g]),y=(0,s.useCallback)(function(e){return e*((arguments.length>1&&void 0!==arguments[1]&&arguments[1]?n.tax.reducedRate:n.tax.defaultRate)/100)},[n.tax]),v=(0,s.useCallback)(function(e){return e+y(e,arguments.length>1&&void 0!==arguments[1]&&arguments[1])},[y]),b=(0,s.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const r=e.reduce((e,t)=>e+(t.totalNet||0),0),s=r*(t/100),a=r-s,i=y(a),l=a+i;return{subtotalNet:r,discountPercent:t,discountAmount:s,netTotal:a,taxRate:n.tax.defaultRate,taxAmount:i,grossTotal:l}},[y,n.tax.defaultRate]),w=(0,s.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;const t=n.offerDefaults.validityDays,r=new Date(e);return r.setDate(r.getDate()+t),r.toISOString().split("T")[0]},[n.offerDefaults.validityDays]),j={settings:n,loading:a,error:l,saving:c,saveSettings:d,updateSetting:h,getHourlyRate:m,calculateMaterialPrice:p,calculateLaborCost:f,calculateUnitPrice:g,calculateServicePosition:x,calculateTax:y,calculateGross:v,calculateOfferTotals:b,calculateValidUntil:w,DEFAULT_SETTINGS:Js};return(0,gs.jsx)(Ws.Provider,{value:j,children:t})},Xs=["id","createdAt","updatedAt"],Ys=(0,s.createContext)(),$s=()=>{const e=(0,s.useContext)(Ys);if(!e)throw new Error("useServiceCatalog must be used within a ServiceCatalogProvider");return e},ea=[{id:"pv-montage",label:"PV-Montage",icon:"Sun"},{id:"elektroinstallation",label:"Elektroinstallation",icon:"Zap"},{id:"speicher",label:"Speichersysteme",icon:"Battery"},{id:"wallbox",label:"Wallbox/E-Mobilit\xe4t",icon:"Car"},{id:"planung",label:"Planung & Dokumentation",icon:"FileText"},{id:"geruest",label:"Ger\xfcst & Logistik",icon:"Truck"},{id:"sonstiges",label:"Sonstiges",icon:"MoreHorizontal"}],ta=[{id:"Stk",label:"St\xfcck"},{id:"kWp",label:"kWp"},{id:"m",label:"Meter"},{id:"m\xb2",label:"Quadratmeter"},{id:"Std",label:"Stunde"},{id:"Pausch",label:"Pauschal"}],na=e=>{let{children:t}=e;const[n,r]=(0,s.useState)([]),[a,i]=(0,s.useState)(!0),[l,o]=(0,s.useState)(null),{calculateServicePosition:c,settings:u}=Qs(),{materials:d}=Cs();(0,s.useEffect)(()=>{let e;return(async()=>{try{i(!0),e=ks.kW.subscribeToServices(e=>{r(e||[]),i(!1)})}catch(t){console.error("Error setting up services listener:",t),o(t.message),i(!1)}})(),()=>{e&&e()}},[]);const h=(0,s.useCallback)(async e=>{try{i(!0);const t=c(e.materials||[],e.labor||[],d),n=(0,Le.A)((0,Le.A)({},e),{},{calculatedPrices:t,isActive:!1!==e.isActive,sortOrder:e.sortOrder||999});return await ks.kW.addService(n),{success:!0}}catch(t){return console.error("Error adding service:",t),o(t.message),{success:!1,error:t.message}}finally{i(!1)}},[c,d]),m=(0,s.useCallback)(async(e,t)=>{try{i(!0);const n=c(t.materials||[],t.labor||[],d),r=(0,Le.A)((0,Le.A)({},t),{},{calculatedPrices:n});return await ks.kW.updateService(e,r),{success:!0}}catch(n){return console.error("Error updating service:",n),o(n.message),{success:!1,error:n.message}}finally{i(!1)}},[c,d]),p=(0,s.useCallback)(async e=>{try{return i(!0),await ks.kW.deleteService(e),{success:!0}}catch(t){return console.error("Error deleting service:",t),o(t.message),{success:!1,error:t.message}}finally{i(!1)}},[]),f=(0,s.useCallback)(async e=>{try{const t=n.find(t=>t.id===e);if(!t)throw new Error("Service not found");const{id:r,createdAt:s,updatedAt:a}=t,i=Oe(t,Xs),l=(0,Le.A)((0,Le.A)({},i),{},{name:"".concat(i.name," (Kopie)"),shortText:"".concat(i.shortText," (Kopie)")});return h(l)}catch(t){return console.error("Error duplicating service:",t),o(t.message),{success:!1,error:t.message}}},[n,h]),g=(0,s.useCallback)(async()=>{try{i(!0);for(const e of n){const t=c(e.materials||[],e.labor||[],d);await ks.kW.updateService(e.id,(0,Le.A)((0,Le.A)({},e),{},{calculatedPrices:t}))}return{success:!0}}catch(e){return console.error("Error recalculating prices:",e),o(e.message),{success:!1,error:e.message}}finally{i(!1)}},[n,c,d]),x=(0,s.useCallback)(()=>{const e={};return ea.forEach(t=>{e[t.id]=n.filter(e=>e.category===t.id&&!1!==e.isActive)}),e},[n]),y=(0,s.useCallback)(e=>n.find(t=>t.id===e),[n]),v=n.filter(e=>!1!==e.isActive),b={services:n,activeServices:v,loading:a,error:l,addService:h,updateService:m,deleteService:p,duplicateService:f,recalculateAllPrices:g,getServicesByCategory:x,getServiceById:y,SERVICE_CATEGORIES:ea,SERVICE_UNITS:ta};return(0,gs.jsx)(Ys.Provider,{value:b,children:t})},ra=["id","offerNumber","createdAt","updatedAt","history","version","status"],sa=(0,s.createContext)(),aa=()=>{const e=(0,s.useContext)(sa);if(!e)throw new Error("useOffers must be used within an OfferProvider");return e},ia={DRAFT:"draft",SENT:"sent",ACCEPTED:"accepted",REJECTED:"rejected",EXPIRED:"expired"},la={draft:{label:"Entwurf",color:"gray",icon:"Edit"},sent:{label:"Gesendet",color:"blue",icon:"Send"},accepted:{label:"Angenommen",color:"green",icon:"CheckCircle"},rejected:{label:"Abgelehnt",color:"red",icon:"XCircle"},expired:{label:"Abgelaufen",color:"orange",icon:"Clock"}},oa=e=>{let{children:t}=e;const[n,r]=(0,s.useState)([]),[a,i]=(0,s.useState)(!0),[l,o]=(0,s.useState)(null),{calculateOfferTotals:c,calculateValidUntil:u,settings:d}=Qs(),{user:h}=ys();(0,s.useEffect)(()=>{let e;return(async()=>{try{i(!0),e=ks.Yl.subscribeToOffers(e=>{r(e||[]),i(!1)})}catch(t){console.error("Error setting up offers listener:",t),o(t.message),i(!1)}})(),()=>{e&&e()}},[]);const m=(0,s.useCallback)(async e=>{try{i(!0);const t=await ks.Yl.getNextOfferNumber(),n=c(e.items||[],e.discountPercent||0),r=e.validUntil||u(),s=(0,Le.A)((0,Le.A)({},e),{},{offerNumber:t,status:ia.DRAFT,totals:n,conditions:{validUntil:r,paymentTerms:e.paymentTerms||d.offerDefaults.paymentTerms,deliveryTerms:e.deliveryTerms||d.offerDefaults.deliveryTerms,notes:e.notes||""},version:1,history:[{version:1,createdAt:(new Date).toISOString(),createdBy:(null===h||void 0===h?void 0:h.uid)||"system",changes:"Erstellt"}],createdBy:(null===h||void 0===h?void 0:h.uid)||"system"});return{success:!0,offerId:(await ks.Yl.addOffer(s)).id,offerNumber:t}}catch(t){return console.error("Error creating offer:",t),o(t.message),{success:!1,error:t.message}}finally{i(!1)}},[c,u,d,h]),p=(0,s.useCallback)(async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Aktualisiert";try{var s;i(!0);const a=n.find(t=>t.id===e);if(!a)throw new Error("Angebot nicht gefunden");const l=c(t.items||[],(null===(s=t.totals)||void 0===s?void 0:s.discountPercent)||0),o=(a.version||1)+1,u=[...a.history||[],{version:o,createdAt:(new Date).toISOString(),createdBy:(null===h||void 0===h?void 0:h.uid)||"system",changes:r}],d=(0,Le.A)((0,Le.A)({},t),{},{totals:l,version:o,history:u});return await ks.Yl.updateOffer(e,d),{success:!0}}catch(a){return console.error("Error updating offer:",a),o(a.message),{success:!1,error:a.message}}finally{i(!1)}},[n,c,h]),f=(0,s.useCallback)(async e=>{try{return i(!0),await ks.Yl.deleteOffer(e),{success:!0}}catch(t){return console.error("Error deleting offer:",t),o(t.message),{success:!1,error:t.message}}finally{i(!1)}},[]),g=(0,s.useCallback)(async e=>{try{var t;const r=n.find(t=>t.id===e);if(!r)throw new Error("Angebot nicht gefunden");const{id:s,offerNumber:a,createdAt:i,updatedAt:l,history:o,version:c,status:u}=r,d=Oe(r,ra);return m((0,Le.A)((0,Le.A)({},d),{},{notes:"Kopie von ".concat(a,"\n").concat((null===(t=d.conditions)||void 0===t?void 0:t.notes)||"")}))}catch(r){return console.error("Error duplicating offer:",r),o(r.message),{success:!1,error:r.message}}},[n,m]),x=(0,s.useCallback)(async(e,t)=>{try{var r;const s=n.find(t=>t.id===e);if(!s)throw new Error("Angebot nicht gefunden");const a={status:t};return t===ia.SENT?a.sentAt=(new Date).toISOString():t===ia.ACCEPTED?a.acceptedAt=(new Date).toISOString():t===ia.REJECTED&&(a.rejectedAt=(new Date).toISOString()),await ks.Yl.updateOffer(e,(0,Le.A)((0,Le.A)((0,Le.A)({},s),a),{},{history:[...s.history||[],{version:s.version||1,createdAt:(new Date).toISOString(),createdBy:(null===h||void 0===h?void 0:h.uid)||"system",changes:"Status ge\xe4ndert: ".concat(null===(r=la[t])||void 0===r?void 0:r.label)}]})),{success:!0}}catch(s){return console.error("Error updating offer status:",s),o(s.message),{success:!1,error:s.message}}},[n,h]),y=(0,s.useCallback)((e,t)=>{const n=[...e.items||[]],r=n.length+1,s=(0,Le.A)((0,Le.A)({},t),{},{id:"item-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),position:r,totalNet:(t.quantity||1)*(t.unitPriceNet||0)*(1-(t.discount||0)/100)});return n.push(s),n},[]),v=(0,s.useCallback)((e,t,n)=>(e.items||[]).map(e=>{if(e.id===t){const t=(0,Le.A)((0,Le.A)({},e),n);return t.totalNet=(t.quantity||1)*(t.unitPriceNet||0)*(1-(t.discount||0)/100),t}return e}),[]),b=(0,s.useCallback)((e,t)=>(e.items||[]).filter(e=>e.id!==t).map((e,t)=>(0,Le.A)((0,Le.A)({},e),{},{position:t+1})),[]),w=(0,s.useCallback)((e,t,n)=>{const r=[...e.items||[]],[s]=r.splice(t,1);return r.splice(n,0,s),r.map((e,t)=>(0,Le.A)((0,Le.A)({},e),{},{position:t+1}))},[]),j=(0,s.useCallback)(e=>n.filter(t=>t.customerID===e),[n]),N=(0,s.useCallback)(e=>n.filter(t=>t.projectID===e),[n]),k=(0,s.useCallback)(e=>n.filter(t=>t.status===e),[n]),S=(0,s.useCallback)(e=>n.find(t=>t.id===e),[n]),C=(0,s.useCallback)(async()=>{const e=(new Date).toISOString().split("T")[0];for(const r of n){var t;r.status===ia.SENT&&null!==(t=r.conditions)&&void 0!==t&&t.validUntil&&r.conditions.validUntil<e&&await x(r.id,ia.EXPIRED)}},[n,x]),E=(0,s.useCallback)(()=>{const e={total:n.length,byStatus:{},totalValue:0,acceptedValue:0};return Object.keys(ia).forEach(t=>{e.byStatus[ia[t]]=n.filter(e=>e.status===ia[t]).length}),n.forEach(t=>{var n,r;(e.totalValue+=(null===(n=t.totals)||void 0===n?void 0:n.grossTotal)||0,t.status===ia.ACCEPTED)&&(e.acceptedValue+=(null===(r=t.totals)||void 0===r?void 0:r.grossTotal)||0)}),e},[n]),A={offers:n,loading:a,error:l,createOffer:m,updateOffer:p,deleteOffer:f,duplicateOffer:g,updateOfferStatus:x,addOfferItem:y,updateOfferItem:v,removeOfferItem:b,reorderOfferItems:w,getOffersByCustomer:j,getOffersByProject:N,getOffersByStatus:k,getOfferById:S,checkExpiredOffers:C,getStatistics:E,OFFER_STATUS:ia,OFFER_STATUS_LABELS:la};return(0,gs.jsx)(sa.Provider,{value:A,children:t})},ca=_s("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),ua=_s("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),da=_s("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),ha=_s("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ma=_s("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),pa=()=>{const[e,t]=(0,s.useState)(""),[n,r]=(0,s.useState)(""),[a,i]=(0,s.useState)(!1),[l,o]=(0,s.useState)(""),[c,u]=(0,s.useState)(!1),[d,h]=(0,s.useState)(""),{login:m,resetPassword:p,loading:f,error:g,clearError:x}=ys(),y=async e=>{e.preventDefault(),x(),h("");try{await p(l),h("Password-Reset E-Mail wurde gesendet!"),u(!1),o("")}catch(g){console.error("Reset error:",g)}};return c?(0,gs.jsx)("div",{className:"min-h-dvh flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,gs.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Passwort zur\xfccksetzen"}),(0,gs.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Geben Sie Ihre E-Mail-Adresse ein"})]}),(0,gs.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:y,children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{htmlFor:"reset-email",className:"sr-only",children:"E-Mail-Adresse"}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,gs.jsx)(ca,{className:"h-5 w-5 text-gray-400"})}),(0,gs.jsx)("input",{id:"reset-email",name:"email",type:"email",required:!0,value:l,onChange:e=>o(e.target.value),className:"appearance-none rounded-md relative block w-full px-3 py-2 pl-10 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"E-Mail-Adresse"})]})]}),g&&(0,gs.jsxs)("div",{className:"flex items-center space-x-2 text-red-600 text-sm",children:[(0,gs.jsx)(Ds,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:g})]}),d&&(0,gs.jsx)("div",{className:"text-green-600 text-sm text-center",children:d}),(0,gs.jsxs)("div",{className:"flex space-x-4",children:[(0,gs.jsx)("button",{type:"submit",disabled:f,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:f?"Wird gesendet...":"E-Mail senden"}),(0,gs.jsx)("button",{type:"button",onClick:()=>u(!1),className:"group relative w-full flex justify-center py-2 px-4 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Abbrechen"})]})]})]})}):(0,gs.jsx)("div",{className:"min-h-dvh flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,gs.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Anmelden"}),(0,gs.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"PV-Konfigurator System"})]}),(0,gs.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:async t=>{t.preventDefault(),x(),h("");try{await m(e,n)}catch(g){console.error("Auth error:",g)}},children:[(0,gs.jsxs)("div",{className:"space-y-4",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{htmlFor:"email-address",className:"sr-only",children:"E-Mail-Adresse"}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,gs.jsx)(ca,{className:"h-5 w-5 text-gray-400"})}),(0,gs.jsx)("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,value:e,onChange:e=>t(e.target.value),className:"appearance-none rounded-md relative block w-full px-3 py-2 pl-10 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"E-Mail-Adresse"})]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{htmlFor:"password",className:"sr-only",children:"Passwort"}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,gs.jsx)(ua,{className:"h-5 w-5 text-gray-400"})}),(0,gs.jsx)("input",{id:"password",name:"password",type:a?"text":"password",autoComplete:"current-password",required:!0,value:n,onChange:e=>r(e.target.value),className:"appearance-none rounded-md relative block w-full px-3 py-2 pl-10 pr-10 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Passwort"}),(0,gs.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,gs.jsx)("button",{type:"button",onClick:()=>i(!a),className:"text-gray-400 hover:text-gray-600",children:a?(0,gs.jsx)(da,{className:"h-5 w-5"}):(0,gs.jsx)(ha,{className:"h-5 w-5"})})})]})]})]}),g&&(0,gs.jsxs)("div",{className:"flex items-center space-x-2 text-red-600 text-sm",children:[(0,gs.jsx)(Ds,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:g})]}),d&&(0,gs.jsx)("div",{className:"text-green-600 text-sm text-center",children:d}),(0,gs.jsx)("div",{children:(0,gs.jsxs)("button",{type:"submit",disabled:f,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[(0,gs.jsx)("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:(0,gs.jsx)(ma,{className:"h-5 w-5 text-blue-500 group-hover:text-blue-400"})}),f?"Wird verarbeitet...":"Anmelden"]})}),(0,gs.jsx)("div",{className:"flex items-center justify-center",children:(0,gs.jsx)("button",{type:"button",onClick:()=>u(!0),className:"text-blue-600 hover:text-blue-500 text-sm",children:"Passwort vergessen?"})})]})]})})},fa=e=>{let{children:t}=e;const{user:n,loading:r}=ys();return r?(0,gs.jsx)("div",{className:"min-h-dvh flex items-center justify-center bg-gray-50",children:(0,gs.jsxs)("div",{className:"text-center",children:[(0,gs.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,gs.jsx)("p",{className:"mt-4 text-gray-600",children:"Wird geladen..."})]})}):n?t:(0,gs.jsx)(pa,{})},ga=_s("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),xa=_s("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),ya=_s("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),va=_s("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),ba=_s("Package",[["path",{d:"M16.5 9.4 7.55 4.24",key:"10qotr"}],["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]),wa=_s("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),ja=_s("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Na=_s("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),ka=_s("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),Sa=_s("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),Ca=_s("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),Ea=_s("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Aa=_s("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Ia=_s("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),_a=e=>{let{isOpen:t,onClose:n,title:r,children:s,footerButtons:a,maxWidth:i="max-w-4xl",icon:l}=e;return t?(0,gs.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 !m-0 !top-0",children:(0,gs.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full ".concat(i," max-h-[90vh] flex flex-col"),children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 flex-shrink-0",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-3",children:[l&&(0,gs.jsx)(l,{className:"h-6 w-6 text-primary-600"}),(0,gs.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:r})]}),(0,gs.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,gs.jsx)(Ms,{className:"h-5 w-5"})})]}),(0,gs.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:s}),a&&(0,gs.jsx)("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50 flex-shrink-0",children:a})]})}):null},Ta=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")},Da=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return 0===Number(e)?"Nicht verf\xfcgbar":"bestellt"===n?"Bestellt":Number(e)<=Number(t)?"Niedrig":"Auf Lager"},Pa=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return 0===Number(e)?"text-red-600 bg-red-50":"bestellt"===n?"text-blue-600 bg-blue-50":Number(e)<=Number(t)?"text-orange-600 bg-orange-50":"text-green-600 bg-green-50"},Ma=e=>{if(null===e||void 0===e||""===e)return null;const t=Number(e);return Number.isNaN(t)?null:"".concat(t.toFixed(2)," \u20ac")},Ra=e=>"".concat(e," ist erforderlich"),Oa=e=>{let{isOpen:t,onClose:n,mode:r="view",material:a,onSave:i,onEdit:l,onDelete:o}=e;const c="view"===r,u="edit"===r,d="create"===r,{showNotification:h}=(null===Os||void 0===Os?void 0:Os())||{showNotification:()=>{}},{categories:m,specsByCategoryKey:p,loadingMeta:f,reload:g}=(e=>{const[t,n]=(0,s.useState)(!1),[r,a]=(0,s.useState)([]),[i,l]=(0,s.useState)({}),o=(0,s.useCallback)(async()=>{try{n(!0);const e=await ks.FirebaseService.getDocuments("categories"),t=await ks.FirebaseService.getDocuments("specifications");a(e||[]);const r={};(t||[]).forEach(e=>{const t=e.categoryId;t&&(r[t]||(r[t]=[]),r[t].push(e))}),l(r)}finally{n(!1)}},[]);return(0,s.useEffect)(()=>{e&&o()},[e,o]),{categories:r,specsByCategoryKey:i,loadingMeta:t,reload:o}})(t),x={materialID:"",description:"",categoryId:"",type:"",manufacturer:"",stock:"",heatStock:"",unit:"St\xfcck",itemsPerUnit:"",orderQuantity:"",price:"",link:"",image:"",ean:"",excludeFromAutoOrder:!1,specifications:{}},[y,v]=(0,s.useState)(x),[b,w]=(0,s.useState)({}),[j,N]=(0,s.useState)(!1),[k,S]=(0,s.useState)("");(0,s.useEffect)(()=>{var e,n,r,s,i,l,o,h;t&&(w({}),c||v(a&&(u||d)?{materialID:a.materialID||"",description:a.description||"",categoryId:a.categoryId||"",type:a.type||"",manufacturer:a.manufacturer||"",stock:null!==(e=a.stock)&&void 0!==e?e:"",heatStock:null!==(n=a.heatStock)&&void 0!==n?n:"",unit:a.unit||"St\xfcck",itemsPerUnit:null!==(r=a.itemsPerUnit)&&void 0!==r?r:"",orderQuantity:null!==(s=a.orderQuantity)&&void 0!==s?s:"",price:null!==(i=a.price)&&void 0!==i?i:"",link:null!==(l=a.link)&&void 0!==l?l:"",image:null!==(o=a.image)&&void 0!==o?o:"",ean:null!==(h=a.ean)&&void 0!==h?h:"",excludeFromAutoOrder:!!a.excludeFromAutoOrder,specifications:a.specifications||{}}:x))},[t,u,d,c,a]);const C=(0,s.useMemo)(()=>{const e=c?null===a||void 0===a?void 0:a.categoryId:y.categoryId;return((e,t)=>e.find(e=>e.id===t))(m,e)},[m,y.categoryId,c,null===a||void 0===a?void 0:a.categoryId]),E=(0,s.useMemo)(()=>((e,t)=>t&&(e[t.id]||e[t.name])||[])(p,C),[p,C]);(0,s.useEffect)(()=>{if(c)return;const e=(e=>{let{manufacturer:t,type:n,categoryName:r}=e;const s=(t||"").trim(),a=(n||"").trim(),i=(r||"").trim();return s||a||i?s&&a&&i?"".concat(s," ").concat(a," (").concat(i,")"):s&&a?"".concat(s," ").concat(a):a&&i?"".concat(a," (").concat(i,")"):s&&i?"".concat(s," (").concat(i,")"):s||a||i:""})({manufacturer:y.manufacturer,type:y.type,categoryName:null===C||void 0===C?void 0:C.name});v(t=>(0,Le.A)((0,Le.A)({},t),{},{description:e}))},[c,y.manufacturer,y.type,null===C||void 0===C?void 0:C.name]);const A=e=>{const{name:t,type:n,value:r,checked:s}=e.target,a="checkbox"===n?!!s:r;v(e=>(0,Le.A)((0,Le.A)({},e),{},{[t]:a})),b[t]&&""!==String(a).trim()&&w(e=>{const n=(0,Le.A)({},e);return delete n[t],n})},I=async()=>{const e=(k||"").trim();if(e)try{const t={name:e,createdAt:new Date},n=await ks.FirebaseService.addDocument("categories",t);await g(),v(e=>(0,Le.A)((0,Le.A)({},e),{},{categoryId:n.id})),N(!1),S(""),null===h||void 0===h||h("Kategorie erfolgreich hinzugef\xfcgt","success")}catch(Ao){console.error("Fehler beim Hinzuf\xfcgen der Kategorie:",Ao),null===h||void 0===h||h("Fehler beim Hinzuf\xfcgen der Kategorie","error")}},_=async()=>{var e;const t=(()=>{const e={};return y.categoryId&&String(y.categoryId).trim()||(e.categoryId=Ra("Kategorie")),y.type&&String(y.type).trim()||(e.type=Ra("Typ")),d&&(""===y.stock||null===y.stock||void 0===y.stock?e.stock="Startbestand ist erforderlich":Number(y.stock)<0&&(e.stock="Startbestand kann nicht negativ sein")),""===y.heatStock||null===y.heatStock||void 0===y.heatStock?e.heatStock="Meldebestand ist erforderlich":Number(y.heatStock)<0&&(e.heatStock="Meldebestand kann nicht negativ sein"),(""===y.itemsPerUnit||null===y.itemsPerUnit||void 0===y.itemsPerUnit||Number(y.itemsPerUnit)<=0)&&(e.itemsPerUnit="St\xfcck pro Einheit ist erforderlich und muss gr\xf6\xdfer als 0 sein"),(""===y.orderQuantity||null===y.orderQuantity||void 0===y.orderQuantity||Number(y.orderQuantity)<=0)&&(e.orderQuantity="Bestellmenge ist erforderlich und muss gr\xf6\xdfer als 0 sein"),E.forEach(t=>{var n;if(!1===t.required)return;const r=null===(n=y.specifications)||void 0===n?void 0:n[t.id];r&&""!==String(r).trim()||(e["spec_".concat(t.id)]="".concat(t.label||t.name," ist erforderlich"))}),w(e),e})();if(Object.keys(t).length>0)return;let r=y.materialID;if(d&&!r)try{r=(e=>{const t=/^MAT-(\d+)$/,n=(e||[]).reduce((e,n)=>{const r=null===n||void 0===n?void 0:n.materialID;if("string"!==typeof r)return e;const s=r.match(t);if(!s)return e;const a=parseInt(s[1],10);return Number.isFinite(a)&&a>e?a:e},0);return"MAT-".concat(String(n+1).padStart(3,"0"))})(await ks.VF.getAllMaterials())}catch(l){console.error("Fehler beim Generieren der Material-ID, Fallback:",l),r="MAT-".concat(Date.now())}const s=(0,Le.A)((0,Le.A)({},y),{},{materialID:r,stock:d?parseInt(y.stock,10)||0:null!==(e=null===a||void 0===a?void 0:a.stock)&&void 0!==e?e:0,heatStock:parseInt(y.heatStock,10)||0,itemsPerUnit:parseInt(y.itemsPerUnit,10)||1,orderQuantity:parseInt(y.orderQuantity,10)||0,price:""===y.price?"":Number(y.price),updatedAt:new Date},d?{createdAt:new Date}:{});null===i||void 0===i||i(s),d&&(v(x),w({})),null===n||void 0===n||n()};if(!t)return null;const T=(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsxs)("button",{onClick:()=>null===l||void 0===l?void 0:l(a),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center space-x-2",children:[(0,gs.jsx)(Ca,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"Bearbeiten"})]}),(0,gs.jsxs)("button",{onClick:()=>null===o||void 0===o?void 0:o(null===a||void 0===a?void 0:a.id),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 flex items-center space-x-2",children:[(0,gs.jsx)(Ea,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"L\xf6schen"})]})]}),D=(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Abbrechen"}),(0,gs.jsxs)("button",{type:"submit",form:"material-form",className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center space-x-2",children:[(0,gs.jsx)(Aa,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:u?"Aktualisieren":"Hinzuf\xfcgen"})]})]}),P=c?"".concat((null===a||void 0===a?void 0:a.materialID)||""," - ").concat((null===a||void 0===a?void 0:a.description)||"").trim():u?"Material bearbeiten":"Material hinzuf\xfcgen";if(c){var M,R,O,L;const e=(null===C||void 0===C?void 0:C.name)||"Unbekannt",r=E,s=a||{};return(0,gs.jsxs)(_a,{isOpen:t,onClose:n,title:P,icon:ba,footerButtons:T,children:[(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,gs.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,gs.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-3 uppercase tracking-wide",children:"Grunddaten"}),(0,gs.jsxs)("div",{className:"space-y-3",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-xs text-gray-500 block",children:"Material-ID"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-900",children:s.materialID})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-xs text-gray-500 block",children:"Kategorie"}),(0,gs.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 text-primary-800",children:e})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-xs text-gray-500 block",children:"Hersteller"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-900",children:s.manufacturer||"-"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-xs text-gray-500 block",children:"Typ"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-900",children:s.type||"-"})]}),s.ean?(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-xs text-gray-500 block",children:"EAN"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-900 font-mono",children:s.ean})]}):null]})]}),(0,gs.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,gs.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-3 uppercase tracking-wide",children:"Bestand & Status"}),(0,gs.jsxs)("div",{className:"space-y-3",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-xs text-gray-500 block",children:"Aktueller Bestand"}),(0,gs.jsx)("span",{className:"text-lg font-bold text-gray-900",children:null!==(M=s.stock)&&void 0!==M?M:0})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-xs text-gray-500 block",children:"Meldebestand"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-900",children:null!==(R=s.heatStock)&&void 0!==R?R:0})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-xs text-gray-500 block",children:"Status"}),(0,gs.jsx)("span",{className:Ta("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",Pa(s.stock,s.heatStock,s.orderStatus)),children:Da(s.stock,s.heatStock,s.orderStatus)})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-xs text-gray-500 block",children:"Automatische Nachbestellung"}),(0,gs.jsx)("div",{className:"flex items-center space-x-2",children:s.excludeFromAutoOrder?(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsx)(Ia,{className:"h-4 w-4 text-amber-500"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-amber-600",children:"Ausgeschlossen"})]}):(0,gs.jsx)("span",{className:"text-sm font-medium text-green-600",children:"Aktiviert"})}),s.excludeFromAutoOrder&&(0,gs.jsx)("p",{className:"text-xs text-amber-600 mt-1",children:"Manuelle Bestellung erforderlich"})]})]})]}),(0,gs.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,gs.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-3 uppercase tracking-wide",children:"Bestellinformationen"}),(0,gs.jsxs)("div",{className:"space-y-3",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-xs text-gray-500 block",children:"St\xfcck pro Einheit"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-900",children:null!==(O=s.itemsPerUnit)&&void 0!==O?O:0})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-xs text-gray-500 block",children:"Bestellmenge"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-900",children:null!==(L=s.orderQuantity)&&void 0!==L?L:0})]}),void 0!==s.price&&""!==s.price?(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-xs text-gray-500 block",children:"Preis pro Einheit"}),(0,gs.jsx)("span",{className:"text-lg font-bold text-green-600",children:Ma(s.price)})]}):null]})]}),s.link?(0,gs.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,gs.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-3 uppercase tracking-wide",children:"Produktlink"}),(0,gs.jsxs)("a",{href:s.link,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-primary-600 hover:text-primary-800 space-x-2 text-sm font-medium",children:[(0,gs.jsx)(ka,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"Produktlink \xf6ffnen"})]})]}):null]}),(0,gs.jsx)("div",{className:"mt-6",children:(0,gs.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[(0,gs.jsxs)("h3",{className:"text-sm font-semibold text-gray-900 mb-4 uppercase tracking-wide flex items-center",children:[(0,gs.jsx)(ba,{className:"h-4 w-4 mr-2"}),"Kategorie-Spezifikationen"]}),f?(0,gs.jsx)("div",{className:"text-center py-6",children:(0,gs.jsx)("div",{className:"text-sm text-gray-500",children:"Lade Spezifikationen..."})}):0===r.length?(0,gs.jsx)("div",{className:"text-center py-6",children:(0,gs.jsx)("div",{className:"text-sm text-gray-500",children:"Keine Spezifikationen f\xfcr diese Kategorie definiert."})}):(0,gs.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map(e=>{var t;const n=(null===a||void 0===a||null===(t=a.specifications)||void 0===t?void 0:t[e.id])||"";return(0,gs.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,gs.jsxs)("span",{className:"text-xs text-gray-500 block mb-1",children:[e.label||e.name,e.unit?" (".concat(e.unit,")"):""]}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-900",children:n||"-"})]},e.id)})})]})})]})}return(0,gs.jsx)(_a,{isOpen:t,onClose:n,title:P,icon:ba,footerButtons:D,children:(0,gs.jsxs)("form",{id:"material-form",onSubmit:e=>{e.preventDefault(),_()},className:"space-y-6",children:[(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,gs.jsxs)("div",{className:"space-y-4",children:[(0,gs.jsx)("h3",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:"Grunddaten"}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Material-ID *"}),(0,gs.jsx)("input",{type:"text",name:"materialID",value:y.materialID,readOnly:!0,placeholder:"Wird automatisch generiert",className:"w-full px-3 py-2 border rounded-lg bg-gray-100 text-gray-700 cursor-not-allowed"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Beschreibung *"}),(0,gs.jsx)("input",{type:"text",name:"description",value:y.description,readOnly:!0,placeholder:"Wird automatisch generiert",className:"w-full px-3 py-2 border rounded-lg bg-gray-100 text-gray-700 cursor-not-allowed"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kategorie *"}),j?(0,gs.jsxs)("div",{className:"flex space-x-2",children:[(0,gs.jsx)("input",{type:"text",value:k,onChange:e=>S(e.target.value),placeholder:"Neue Kategorie eingeben...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",onKeyDown:e=>"Enter"===e.key&&(e.preventDefault(),I())}),(0,gs.jsx)("button",{type:"button",onClick:I,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Hinzuf\xfcgen"}),(0,gs.jsx)("button",{type:"button",onClick:()=>{N(!1),S("")},className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:"Abbrechen"})]}):(0,gs.jsxs)("select",{value:y.categoryId,onChange:e=>{var t;"NEW_CATEGORY"!==(t=e.target.value)?(v(e=>(0,Le.A)((0,Le.A)({},e),{},{categoryId:t,specifications:{}})),b.categoryId&&t&&w(e=>{const t=(0,Le.A)({},e);return delete t.categoryId,t})):N(!0)},className:Ta("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",b.categoryId?"border-red-500":"border-gray-300"),children:[(0,gs.jsx)("option",{value:"",children:"Kategorie w\xe4hlen..."}),m.slice().sort((e,t)=>e.name.localeCompare(t.name)).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.name},e.id)),0===m.length&&(0,gs.jsx)("option",{value:"",disabled:!0,children:"Keine Kategorien verf\xfcgbar \u2013 Bitte in Einstellungen erstellen"}),(0,gs.jsx)("option",{value:"NEW_CATEGORY",children:"Neue Kategorie hinzuf\xfcgen"})]}),b.categoryId&&(0,gs.jsxs)("p",{className:"text-red-500 text-sm mt-1 flex items-center",children:[(0,gs.jsx)(Ds,{className:"h-4 w-4 mr-1"}),b.categoryId]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Typ *"}),(0,gs.jsx)("input",{type:"text",name:"type",value:y.type,onChange:A,className:Ta("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",b.type?"border-red-500":"border-gray-300"),placeholder:"Produkttyp"}),b.type&&(0,gs.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[(0,gs.jsx)(Ds,{className:"h-4 w-4 mr-1"}),b.type]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hersteller"}),(0,gs.jsx)("input",{type:"text",name:"manufacturer",value:y.manufacturer,onChange:A,placeholder:"Optional \u2013 leer lassen f\xfcr generische Materialien",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent border-gray-300"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Link"}),(0,gs.jsx)("input",{type:"url",name:"link",value:y.link,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"https://..."})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"EAN"}),(0,gs.jsx)("input",{type:"text",name:"ean",value:y.ean,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Optional"})]})]}),(0,gs.jsxs)("div",{className:"space-y-4",children:[(0,gs.jsx)("h3",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:"Bestandsdaten"}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:u?"Aktueller Bestand":"Startbestand *"}),(0,gs.jsx)("input",{type:"number",name:"stock",value:y.stock,onChange:A,min:"0",disabled:u,readOnly:u,className:Ta("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",b.stock?"border-red-500":"border-gray-300",u?"bg-gray-100 cursor-not-allowed":"")}),u&&(0,gs.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Bestand kann nur \xfcber Ein-/Ausbuchungen ge\xe4ndert werden"}),b.stock&&(0,gs.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[(0,gs.jsx)(Ds,{className:"h-4 w-4 mr-1"}),b.stock]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Meldebestand *"}),(0,gs.jsx)("input",{type:"number",name:"heatStock",value:y.heatStock,onChange:A,min:"0",className:Ta("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",b.heatStock?"border-red-500":"border-gray-300")}),b.heatStock&&(0,gs.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[(0,gs.jsx)(Ds,{className:"h-4 w-4 mr-1"}),b.heatStock]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"St\xfcck pro Einheit *"}),(0,gs.jsx)("input",{type:"number",name:"itemsPerUnit",value:y.itemsPerUnit,onChange:A,min:"1",className:Ta("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",b.itemsPerUnit?"border-red-500":"border-gray-300")}),b.itemsPerUnit&&(0,gs.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[(0,gs.jsx)(Ds,{className:"h-4 w-4 mr-1"}),b.itemsPerUnit]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bestellmenge *"}),(0,gs.jsx)("input",{type:"number",name:"orderQuantity",value:y.orderQuantity,onChange:A,min:"1",className:Ta("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",b.orderQuantity?"border-red-500":"border-gray-300")}),b.orderQuantity&&(0,gs.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[(0,gs.jsx)(Ds,{className:"h-4 w-4 mr-1"}),b.orderQuantity]})]}),(0,gs.jsxs)("div",{className:"col-span-2",children:[(0,gs.jsxs)("div",{className:"flex items-center",children:[(0,gs.jsx)("input",{type:"checkbox",id:"excludeFromAutoOrder",name:"excludeFromAutoOrder",checked:!!y.excludeFromAutoOrder,onChange:A,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),(0,gs.jsx)("label",{htmlFor:"excludeFromAutoOrder",className:"ml-2 block text-sm text-gray-700",children:"Von automatischer Nachbestellung ausschlie\xdfen"})]}),(0,gs.jsx)("p",{className:"text-xs text-gray-500 mt-1 ml-6",children:"Aktivieren Sie diese Option f\xfcr teure Materialien wie Wechselrichter, die nur bei Anzahlung bestellt werden sollen"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preis pro Einheit (\u20ac)"}),(0,gs.jsx)("input",{type:"number",name:"price",value:y.price,onChange:A,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"0.00"}),(0,gs.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Optional \u2013 Preis pro ",y.unit||"Einheit"]})]})]})]}),E.length>0&&(0,gs.jsxs)("div",{className:"space-y-4",children:[(0,gs.jsxs)("h3",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:["Spezifikationen f\xfcr ",(null===C||void 0===C?void 0:C.name)||"Kategorie"]}),(0,gs.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:E.map(e=>{var t;const n="spec_".concat(e.id),r=(null===(t=y.specifications)||void 0===t?void 0:t[e.id])||"";return(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.label||e.name," ",e.unit?"(".concat(e.unit,")"):""," *"]}),(0,gs.jsx)("input",{type:e.type||"text",value:r,onChange:t=>((e,t)=>{v(n=>(0,Le.A)((0,Le.A)({},n),{},{specifications:(0,Le.A)((0,Le.A)({},n.specifications),{},{[e]:t})}));const n="spec_".concat(e);b[n]&&""!==String(t).trim()&&w(e=>{const t=(0,Le.A)({},e);return delete t[n],t})})(e.id,t.target.value),className:Ta("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",b[n]?"border-red-500":"border-gray-300")}),b[n]&&(0,gs.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[(0,gs.jsx)(Ds,{className:"h-4 w-4 mr-1"}),b[n]]})]},e.id)})})]})]})})},La=Oa,Fa=e=>{let{isOpen:t,onClose:n,material:r,onSave:s}=e;return(0,gs.jsx)(Oa,{isOpen:t,onClose:n,mode:r?"edit":"create",material:r,onSave:s})},Va=_s("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),za=_s("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),Ua="Lagerbuchung",Ka=e=>{let{isOpen:t,onClose:r,type:a="Ausgang"}=e;const{materials:i,updateMaterialStock:l}=Cs(),{customers:o}=Vs(),{projects:c,getProjectsByCustomer:u}=Ks(),{showNotification:d}=Os(),{addBooking:h}=Hs(),[m,p]=(0,s.useState)(""),[f,g]=(0,s.useState)(""),[x,y]=(0,s.useState)([]),[v,b]=(0,s.useState)([]),[w,j]=(0,s.useState)(""),[N,k]=(0,s.useState)({}),S=i.filter(e=>e.description.toLowerCase().includes(w.toLowerCase())||e.materialID.toLowerCase().includes(w.toLowerCase()));(0,s.useEffect)(()=>{if(m){const e=u(m);y(e),g("")}else y([]),g("")},[m,u]);const C=e=>{b(t=>t.filter(t=>t.materialId!==e))},E=(e,t)=>{t<=0?C(e):b(n=>n.map(n=>n.materialId===e?(0,Le.A)((0,Le.A)({},n),{},{quantity:t}):n))};if(!t)return null;const A=(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Abbrechen"}),(0,gs.jsxs)("button",{type:"submit",form:"booking-form",className:"px-4 py-2 text-white rounded-lg flex items-center space-x-2 ".concat("Eingang"===a?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"),children:[(0,gs.jsx)(Aa,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"Eingang"===a?"Einbuchen":"Ausbuchen"})]})]});return(0,gs.jsx)(_a,{isOpen:t,onClose:r,title:"Material ".concat("Eingang"===a?"einbuchen":"ausbuchen"),icon:ba,footerButtons:A,maxWidth:"max-w-4xl",children:(0,gs.jsxs)("form",{id:"booking-form",onSubmit:async e=>{if(e.preventDefault(),!(()=>{const e={};return m||(e.customer="Bitte w\xe4hlen Sie einen Kunden aus"),f||m===Ua||(e.project="Bitte w\xe4hlen Sie ein Projekt aus"),0===v.length&&(e.materials="Bitte w\xe4hlen Sie mindestens ein Material aus"),"Ausgang"===a&&v.forEach((t,n)=>{const r=i.find(e=>e.id===t.materialId);r&&t.quantity>r.stock&&(e["quantity_".concat(n)]="Nicht gen\xfcgend Lagerbestand (verf\xfcgbar: ".concat(r.stock,")"))}),k(e),0===Object.keys(e).length})())return;const t=[];try{for(const e of v){const r="Eingang"===a?e.quantity:-e.quantity;if(await l(e.materialId,r),t.push({materialId:e.materialId,stockChange:r}),"Eingang"===a){const t=i.find(t=>t.id===e.materialId);if(t&&"bestellt"===t.orderStatus)try{const{FirebaseService:t}=await Promise.resolve().then(n.bind(n,737));await t.updateDocument("materials",e.materialId,{orderStatus:null,orderDate:null,orderedQuantity:0,updatedAt:new Date})}catch(y){console.error("Fehler beim Zur\xfccksetzen des Bestellstatus:",y)}}}}catch(y){console.error("Fehler bei Buchung, f\xfchre Rollback durch:",y);for(const e of t)try{await l(e.materialId,-e.stockChange)}catch(w){console.error("Rollback fehlgeschlagen f\xfcr Material:",e.materialId,w)}return void d("Buchung fehlgeschlagen. \xc4nderungen wurden r\xfcckg\xe4ngig gemacht.","error")}const s=o.find(e=>e.customerID===m),u=c.find(e=>e.id===f),x={id:"".concat(a,"-").concat(f,"-").concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),customerID:m,customerName:(null===s||void 0===s?void 0:s.firmennameKundenname)||(m===Ua?"Wareneingang":m),projectID:f,projectName:(null===u||void 0===u?void 0:u.name)||"",type:a,timestamp:new Date,materials:v.map(e=>{const t=i.find(t=>t.id===e.materialId),n=(null===t||void 0===t?void 0:t.price)||0,r=n*e.quantity;return{materialID:null===t||void 0===t?void 0:t.materialID,quantity:e.quantity,description:null===t||void 0===t?void 0:t.description,priceAtBooking:n,totalCost:r}}),notes:"".concat(a," \xfcber Lagermanagement-System f\xfcr Projekt: ").concat((null===u||void 0===u?void 0:u.name)||"")};h(x),d("".concat(a," erfolgreich gebucht: ").concat(v.length," Material").concat(1!==v.length?"ien":""),"success"),p(""),g(""),b([]),j(""),k({}),r()},className:"space-y-6",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Eingang"===a?"Lieferant / Quelle":"Kunde"," *"]}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)(ma,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,gs.jsxs)("select",{value:m,onChange:e=>p(e.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ".concat(N.customer?"border-red-300":"border-gray-300"),children:[(0,gs.jsx)("option",{value:"",children:"Eingang"===a?"Lieferant ausw\xe4hlen...":"Kunde ausw\xe4hlen..."}),"Eingang"===a&&(0,gs.jsx)("option",{value:Ua,children:"Wareneingang (Lager)"}),o.map(e=>(0,gs.jsx)("option",{value:e.customerID,children:e.firmennameKundenname},e.id))]})]}),N.customer&&(0,gs.jsx)("p",{className:"mt-1 text-sm text-red-600",children:N.customer})]}),m&&x.length>0&&(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Projekt *"}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)(Va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,gs.jsxs)("select",{value:f,onChange:e=>g(e.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ".concat(N.project?"border-red-300":"border-gray-300"),children:[(0,gs.jsx)("option",{value:"",children:"Projekt ausw\xe4hlen..."}),x.map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," (",e.status,")"]},e.id))]})]}),N.project&&(0,gs.jsx)("p",{className:"mt-1 text-sm text-red-600",children:N.project})]}),m&&m!==Ua&&0===x.length&&(0,gs.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,gs.jsx)("div",{className:"flex",children:(0,gs.jsx)("div",{className:"text-yellow-800",children:(0,gs.jsx)("p",{className:"text-sm",children:"F\xfcr diesen Kunden sind noch keine Projekte angelegt. Bitte erstellen Sie zuerst ein Projekt in der Projektverwaltung."})})})}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Material hinzuf\xfcgen"}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,gs.jsx)("input",{type:"text",value:w,onChange:e=>j(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Material suchen..."})]})]}),w&&(0,gs.jsx)("div",{className:"border border-gray-200 rounded-lg max-h-40 overflow-y-auto",children:S.map(e=>(0,gs.jsxs)("div",{className:"flex items-center justify-between p-3 hover:bg-gray-50 border-b border-gray-100 last:border-b-0",children:[(0,gs.jsxs)("div",{className:"flex-1",children:[(0,gs.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.description}),(0,gs.jsxs)("div",{className:"text-xs text-gray-500",children:[e.materialID," | Lager: ",e.stock," ",e.unit]})]}),(0,gs.jsx)("button",{type:"button",onClick:()=>{return t=e.id,void(v.find(e=>e.materialId===t)||b(e=>[...e,{materialId:t,quantity:1}]));var t},disabled:v.find(t=>t.materialId===e.id),className:"p-1 text-primary-600 hover:text-primary-700 disabled:text-gray-400",children:(0,gs.jsx)(ya,{className:"h-4 w-4"})})]},e.id))}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ausgew\xe4hlte Materialien *"}),0===v.length?(0,gs.jsx)("div",{className:"border border-gray-200 rounded-lg p-4 text-center text-gray-500",children:"Keine Materialien ausgew\xe4hlt"}):(0,gs.jsx)("div",{className:"border border-gray-200 rounded-lg divide-y divide-gray-200",children:v.map((e,t)=>{const n=i.find(t=>t.id===e.materialId);return(0,gs.jsxs)("div",{className:"p-4",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{className:"flex-1",children:[(0,gs.jsx)("div",{className:"text-sm font-medium text-gray-900",children:null===n||void 0===n?void 0:n.description}),(0,gs.jsxs)("div",{className:"text-xs text-gray-500",children:[null===n||void 0===n?void 0:n.materialID," | Verf\xfcgbar: ",null===n||void 0===n?void 0:n.stock," ",(null===n||void 0===n?void 0:n.unit)||"St\xfcck"]})]}),(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)("button",{type:"button",onClick:()=>E(e.materialId,e.quantity-1),className:"p-1 text-gray-400 hover:text-gray-600",children:(0,gs.jsx)(za,{className:"h-4 w-4"})}),(0,gs.jsx)("input",{type:"number",value:e.quantity,onChange:t=>E(e.materialId,parseInt(t.target.value)||0),className:"w-16 px-2 py-1 text-center border rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent ".concat(N["quantity_".concat(t)]?"border-red-300":"border-gray-300"),min:"1"}),(0,gs.jsx)("button",{type:"button",onClick:()=>E(e.materialId,e.quantity+1),className:"p-1 text-gray-400 hover:text-gray-600",children:(0,gs.jsx)(ya,{className:"h-4 w-4"})}),(0,gs.jsx)("button",{type:"button",onClick:()=>C(e.materialId),className:"p-1 text-red-400 hover:text-red-600",children:(0,gs.jsx)(Ms,{className:"h-4 w-4"})})]})]}),N["quantity_".concat(t)]&&(0,gs.jsx)("p",{className:"mt-1 text-sm text-red-600",children:N["quantity_".concat(t)]})]},e.materialId)})}),N.materials&&(0,gs.jsx)("p",{className:"mt-1 text-sm text-red-600",children:N.materials})]})]})})},Ba=()=>{const{materials:e,addMaterial:t,updateMaterial:n,deleteMaterial:r,updateStock:a}=Cs(),{showNotification:i}=Os(),[l,o]=(0,s.useState)(""),[c,u]=(0,s.useState)("alle"),[d,h]=(0,s.useState)(!1),[m,p]=(0,s.useState)(!1),[f,g]=(0,s.useState)(null),[x,y]=(0,s.useState)(null),[v,b]=(0,s.useState)(!1),[w,j]=(0,s.useState)("Ausgang"),[N,k]=(0,s.useState)(!1),[S,C]=(0,s.useState)({material:!0,category:!0,manufacturer:!0,stock:!0,price:!0,status:!0,ean:!1,link:!1,orderQuantity:!1,unit:!1,itemsPerUnit:!1,type:!1}),[E,A]=(0,s.useState)({key:null,direction:"asc"}),[I,_]=(0,s.useState)({category:"alle",status:"alle",manufacturer:"alle"}),[T,D]=(0,s.useState)(!1),[P,M]=(0,s.useState)(null),[R,O]=(0,s.useState)(null),[L,F]=(0,s.useState)(!1),[V,z]=(0,s.useState)(!0),[U,K]=(0,s.useState)(null),[B,q]=(0,s.useState)(""),[H,G]=(0,s.useState)([]);(0,s.useEffect)(()=>{(async()=>{try{const e=await ks.FirebaseService.getDocuments("categories");G([{id:"alle",name:"alle"},...e])}catch(e){console.error("Fehler beim Laden der Kategorien:",e)}})()},[]);const W=(e,t,n)=>e<0?"Nachbestellen (".concat(Math.abs(e),")"):0===e?"Nicht verf\xfcgbar":"bestellt"===n?"Bestellt":e<=t?"Niedrig":"Auf Lager",Q=e.filter(e=>{var t;const n=""===l||e.materialID.toLowerCase().includes(l.toLowerCase())||e.description.toLowerCase().includes(l.toLowerCase())||e.manufacturer.toLowerCase().includes(l.toLowerCase()),r="alle"===c||e.categoryId&&(null===(t=H.find(t=>t.id===e.categoryId))||void 0===t?void 0:t.name)===c,s=Object.entries(I).every(t=>{let[n,r]=t;if("alle"===r)return!0;switch(n){case"category":var s;return(null===(s=H.find(t=>t.id===e.categoryId))||void 0===s?void 0:s.name)===r;case"status":return W(e.stock,e.heatStock,e.orderStatus)===r;case"manufacturer":return e.manufacturer===r;default:return!0}});return n&&r&&s}).sort((e,t)=>{if(!E.key)return 0;let n=e[E.key],r=t[E.key];return"stock"===E.key?(n=parseInt(n)||0,r=parseInt(r)||0):"price"===E.key&&(n=parseFloat(n)||0,r=parseFloat(r)||0),n<r?"asc"===E.direction?-1:1:n>r?"asc"===E.direction?1:-1:0}),J=e=>{j(e),b(!0)},Z=async e=>{try{const t=(await ks.FirebaseService.getDocuments("user-preferences")).find(e=>"materialColumns"===e.type),n={type:"materialColumns",columns:e,updatedAt:new Date};t?await ks.FirebaseService.updateDocument("user-preferences",t.id,n):await ks.FirebaseService.addDocument("user-preferences",(0,Le.A)((0,Le.A)({},n),{},{createdAt:new Date}))}catch(t){console.error("Fehler beim Speichern der Spalteneinstellungen:",t),i("Fehler beim Speichern der Spalteneinstellungen","error")}},X=["alle",...new Set(e.map(e=>e.category))],Y=["alle",...new Set(e.map(e=>e.manufacturer))],$=(e,t)=>{_(n=>(0,Le.A)((0,Le.A)({},n),{},{[e]:t}))},ee=e=>{let t="asc";E.key===e&&"asc"===E.direction&&(t="desc"),A({key:e,direction:t})},te=e=>{g(e),p(!0),y(null),F(!1)},ne=e=>{window.confirm("Material wirklich l\xf6schen?")&&(r(e),i("Material erfolgreich gel\xf6scht","success")),y(null)};s.useEffect(()=>{(async()=>{try{z(!0);const e=(await ks.FirebaseService.getDocuments("user-preferences")).find(e=>"materialColumns"===e.type);e&&e.columns&&C(e.columns)}catch(e){console.error("Fehler beim Laden der Spalteneinstellungen:",e)}finally{z(!1)}})()},[]),s.useEffect(()=>{const e=e=>{N&&!e.target.closest(".column-settings-container")&&k(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[N]);const re=async t=>{try{const r=String(B||"").trim();if(""===r)return K(null),void q("");const s=parseFloat(r.replace(",","."));if(isNaN(s)||s<0)return void i("Bitte geben Sie einen g\xfcltigen Preis ein","error");const a=e.find(e=>e.id===t);if(!a)return void i("Material nicht gefunden","error");{const e=(0,Le.A)((0,Le.A)({},a),{},{price:s});console.log("Updating material with:",e),await n(e),i("Preis erfolgreich aktualisiert","success")}K(null),q("")}catch(r){console.error("Fehler beim Speichern des Preises:",r),i("Fehler beim Aktualisieren des Preises","error")}};return(0,gs.jsxs)("div",{className:"h-full flex flex-col space-y-6",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Materialverwaltung"}),(0,gs.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:"Verwalten Sie Ihre PV-Materialien und Best\xe4nde"})]}),(0,gs.jsx)("div",{className:"flex space-x-3",children:(0,gs.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,gs.jsxs)("button",{onClick:()=>J("Eingang"),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center space-x-2",children:[(0,gs.jsx)(ga,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"Einbuchen"})]}),(0,gs.jsxs)("button",{onClick:()=>J("Ausgang"),className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 flex items-center space-x-2",children:[(0,gs.jsx)(xa,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"Ausbuchen"})]}),(0,gs.jsxs)("button",{onClick:()=>p(!0),className:"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 flex items-center space-x-2",children:[(0,gs.jsx)(ya,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"Material hinzuf\xfcgen"})]})]})})]}),(0,gs.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,gs.jsxs)("div",{className:"flex-1 relative",children:[(0,gs.jsx)(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,gs.jsx)("input",{type:"text",placeholder:"Material suchen (ID, Beschreibung, Hersteller)...",value:l,onChange:e=>o(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})}),(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Gesamt Materialien"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.length})]}),(0,gs.jsx)(ba,{className:"h-8 w-8 text-primary-600"})]})}),(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Auf Lager"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-green-600",children:e.filter(e=>e.stock>e.heatStock&&"bestellt"!==e.orderStatus).length})]}),(0,gs.jsx)(wa,{className:"h-8 w-8 text-green-600"})]})}),(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Niedrig"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:e.filter(e=>e.stock>0&&e.stock<=e.heatStock&&"bestellt"!==e.orderStatus).length})]}),(0,gs.jsx)(wa,{className:"h-8 w-8 text-orange-600"})]})}),(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Bestellt"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:e.filter(e=>"bestellt"===e.orderStatus).length})]}),(0,gs.jsx)(wa,{className:"h-8 w-8 text-blue-600"})]})}),(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Nicht verf\xfcgbar"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-red-600",children:e.filter(e=>0===e.stock).length})]}),(0,gs.jsx)(wa,{className:"h-8 w-8 text-red-600"})]})})]}),(0,gs.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden flex-1 flex flex-col",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 flex-shrink-0",children:[(0,gs.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Materialliste"}),(0,gs.jsxs)("div",{className:"relative column-settings-container",children:[(0,gs.jsx)("button",{onClick:()=>k(!N),className:"text-gray-400 hover:text-gray-600 p-2 rounded-lg hover:bg-gray-100",title:"Spalten anpassen",children:(0,gs.jsx)(ja,{className:"h-5 w-5"})}),N&&(0,gs.jsx)("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-md shadow-lg z-20 border border-gray-200",children:(0,gs.jsxs)("div",{className:"p-4",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,gs.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:"Spalten anzeigen"}),V&&(0,gs.jsx)("div",{className:"text-xs text-gray-500",children:"L\xe4dt..."})]}),(0,gs.jsx)("div",{className:"space-y-2",children:[{key:"material",label:"Material",required:!0},{key:"category",label:"Kategorie",required:!1},{key:"manufacturer",label:"Hersteller",required:!1},{key:"stock",label:"Bestand",required:!0},{key:"price",label:"Preis",required:!1},{key:"status",label:"Status",required:!1},{key:"ean",label:"EAN",required:!1},{key:"link",label:"Link",required:!1},{key:"orderQuantity",label:"Bestellmenge",required:!1},{key:"itemsPerUnit",label:"St\xfcck pro Einheit",required:!1},{key:"type",label:"Typ",required:!1}].map(e=>(0,gs.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,gs.jsx)("input",{type:"checkbox",checked:S[e.key],onChange:()=>!e.required&&(async e=>{const t=(0,Le.A)((0,Le.A)({},S),{},{[e]:!S[e]});C(t),await Z(t)})(e.key),disabled:e.required||V,className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),(0,gs.jsxs)("span",{className:"text-sm ".concat(e.required?"text-gray-400":"text-gray-700"),children:[e.label,e.required&&" (erforderlich)"]})]},e.key))}),(0,gs.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,gs.jsx)("p",{className:"text-xs text-gray-500",children:"\ud83d\udcbe Einstellungen werden automatisch in Firebase gespeichert"})})]})})]})]}),(0,gs.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,gs.jsxs)("div",{className:"h-full overflow-auto",children:[(0,gs.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,gs.jsx)("thead",{className:"bg-gray-50 sticky top-0 z-10",children:(0,gs.jsxs)("tr",{children:[S.material&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Material"}),S.category&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,gs.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,gs.jsx)("span",{children:"Kategorie"}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)("button",{onClick:()=>M("category"===P?null:"category"),className:"text-gray-400 hover:text-gray-600 p-1",children:(0,gs.jsx)(Na,{className:"h-3 w-3"})}),"category"===P&&(0,gs.jsx)("div",{className:"absolute left-0 mt-1 w-48 bg-white rounded-md shadow-lg z-30 border border-gray-200",children:(0,gs.jsx)("div",{className:"p-2",children:(0,gs.jsx)("select",{value:I.category,onChange:e=>$("category",e.target.value),className:"w-full rounded-md border-gray-300 text-sm focus:border-primary-500 focus:ring-primary-500",children:X.map(e=>(0,gs.jsx)("option",{value:e,children:e},e))})})})]})]})}),S.manufacturer&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,gs.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,gs.jsx)("span",{children:"Hersteller"}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)("button",{onClick:()=>M("manufacturer"===P?null:"manufacturer"),className:"text-gray-400 hover:text-gray-600 p-1",children:(0,gs.jsx)(Na,{className:"h-3 w-3"})}),"manufacturer"===P&&(0,gs.jsx)("div",{className:"absolute left-0 mt-1 w-48 bg-white rounded-md shadow-lg z-30 border border-gray-200",children:(0,gs.jsx)("div",{className:"p-2",children:(0,gs.jsx)("select",{value:I.manufacturer,onChange:e=>$("manufacturer",e.target.value),className:"w-full rounded-md border-gray-300 text-sm focus:border-primary-500 focus:ring-primary-500",children:Y.map(e=>(0,gs.jsx)("option",{value:e,children:e},e))})})})]})]})}),S.stock&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-50",onClick:()=>ee("stock"),children:(0,gs.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,gs.jsx)("span",{children:"Bestand"}),(0,gs.jsx)("div",{className:"relative",children:"stock"===E.key?(0,gs.jsx)("span",{className:"text-gray-400 hover:text-gray-600 text-lg font-bold",children:"asc"===E.direction?"\u2191":"\u2193"}):(0,gs.jsx)(Na,{className:"h-3 w-3 text-gray-400 hover:text-gray-600"})})]})}),S.price&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-50",onClick:()=>ee("price"),children:(0,gs.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,gs.jsx)("span",{children:"Preis"}),(0,gs.jsx)("div",{className:"relative",children:"price"===E.key?(0,gs.jsx)("span",{className:"text-gray-400 hover:text-gray-600 text-lg font-bold",children:"asc"===E.direction?"\u2191":"\u2193"}):(0,gs.jsx)(Na,{className:"h-3 w-3 text-gray-400 hover:text-gray-600"})})]})}),S.ean&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"EAN"}),S.orderQuantity&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-50",onClick:()=>ee("orderQuantity"),children:(0,gs.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,gs.jsx)("span",{children:"Bestellmenge"}),(0,gs.jsx)("div",{className:"relative",children:"orderQuantity"===E.key?(0,gs.jsx)("span",{className:"text-gray-400 hover:text-gray-600 text-lg font-bold",children:"asc"===E.direction?"\u2191":"\u2193"}):(0,gs.jsx)(Na,{className:"h-3 w-3 text-gray-400 hover:text-gray-600"})})]})}),S.itemsPerUnit&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-50",onClick:()=>ee("itemsPerUnit"),children:(0,gs.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,gs.jsx)("span",{children:"St\xfcck pro Einheit"}),(0,gs.jsx)("div",{className:"relative",children:"itemsPerUnit"===E.key?(0,gs.jsx)("span",{className:"text-gray-400 hover:text-gray-600 text-lg font-bold",children:"asc"===E.direction?"\u2191":"\u2193"}):(0,gs.jsx)(Na,{className:"h-3 w-3 text-gray-400 hover:text-gray-600"})})]})}),S.type&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Typ"}),S.link&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Link"}),S.status&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,gs.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,gs.jsx)("span",{children:"Status"}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)("button",{onClick:()=>M("status"===P?null:"status"),className:"text-gray-400 hover:text-gray-600 p-1",children:(0,gs.jsx)(Na,{className:"h-3 w-3"})}),"status"===P&&(0,gs.jsx)("div",{className:"absolute left-0 mt-1 w-48 bg-white rounded-md shadow-lg z-30 border border-gray-200",children:(0,gs.jsx)("div",{className:"p-2",children:(0,gs.jsx)("select",{value:I.status,onChange:e=>$("status",e.target.value),className:"w-full rounded-md border-gray-300 text-sm focus:border-primary-500 focus:ring-primary-500",children:["alle","Auf Lager","Niedrig","Nicht verf\xfcgbar"].map(e=>(0,gs.jsx)("option",{value:e,children:e},e))})})})]})]})}),(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aktionen"})]})}),(0,gs.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:Q.map(e=>{var t,n,r,s,a;return(0,gs.jsxs)("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>(e=>{O(e),F(!0)})(e),children:[S.material&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsxs)("div",{className:"p-2",children:[(0,gs.jsxs)("div",{className:"text-sm font-medium text-gray-900 flex items-center",children:[e.description,!S.link&&e.link&&(0,gs.jsx)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-primary-600 hover:text-primary-800",onClick:e=>e.stopPropagation(),children:(0,gs.jsx)(ka,{className:"h-4 w-4"})})]}),(0,gs.jsx)("div",{className:"text-sm text-gray-500",children:e.materialID})]})}),S.category&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 text-primary-800",children:(null===(t=H.find(t=>t.id===e.categoryId))||void 0===t?void 0:t.name)||"Unbekannt"})}),S.manufacturer&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.manufacturer}),S.stock&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.stock})}),S.price&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",onClick:e=>e.stopPropagation(),children:U===e.id?(0,gs.jsx)("div",{className:"relative z-50",children:(0,gs.jsx)("input",{type:"text",value:B,onChange:e=>q(e.target.value),onKeyDown:t=>{"Enter"===t.key?re(e.id):"Escape"===t.key&&(K(null),q(""))},onBlur:()=>re(e.id),className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent relative z-50",placeholder:"0,00",autoFocus:!0})}):(0,gs.jsx)("div",{className:"cursor-pointer hover:bg-blue-50 hover:border hover:border-blue-200 px-2 py-1 rounded transition-all duration-200",onClick:t=>{var n,r;t.stopPropagation(),n=e.id,r=e.price,console.log("Editing price for material ID:",n,"Current price:",r),K(n),q(String(r||""))},title:"Klicken zum Bearbeiten",children:(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-900 hover:text-blue-700",children:(a=e.price,(null===a||void 0===a||""===a?"":"".concat(Number(a).toFixed(2).replace(".",",")))||"Preis hinzuf\xfcgen")})})}),S.ean&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-mono",children:e.ean||"-"}),S.orderQuantity&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.orderQuantity||0}),S.itemsPerUnit&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.itemsPerUnit||0}),S.type&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.type||"-"}),S.link&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.link?(0,gs.jsxs)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:text-primary-800 flex items-center space-x-1",children:[(0,gs.jsx)(ka,{className:"h-4 w-4"}),(0,gs.jsx)("span",{className:"text-sm",children:"Link"})]}):(0,gs.jsx)("span",{className:"text-sm text-gray-400",children:"-"})}),S.status&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat((n=e.stock,r=e.heatStock,s=e.orderStatus,n<0?"text-red-700 bg-red-100":0===n?"text-red-600 bg-red-50":"bestellt"===s?"text-blue-600 bg-blue-50":n<=r?"text-orange-600 bg-orange-50":"text-green-600 bg-green-50")),children:W(e.stock,e.heatStock,e.orderStatus)})}),(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,gs.jsxs)("div",{className:"relative",onClick:e=>e.stopPropagation(),children:[(0,gs.jsx)("button",{onClick:t=>{t.stopPropagation(),y(x===e.id?null:e.id)},className:"text-gray-400 hover:text-gray-600",children:(0,gs.jsx)(Sa,{className:"h-4 w-4"})}),x===e.id&&(0,gs.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-10 border border-gray-200",children:(0,gs.jsxs)("div",{className:"py-1",children:[(0,gs.jsxs)("button",{onClick:t=>{t.stopPropagation(),te(e)},className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left",children:[(0,gs.jsx)(Ca,{className:"h-4 w-4 mr-2"}),"Bearbeiten"]}),(0,gs.jsxs)("button",{onClick:t=>{t.stopPropagation(),ne(e.id)},className:"flex items-center px-4 py-2 text-sm text-red-700 hover:bg-red-50 w-full text-left",children:[(0,gs.jsx)(Ea,{className:"h-4 w-4 mr-2"}),"L\xf6schen"]})]})})]})})]},e.id)})})]}),0===Q.length&&(0,gs.jsxs)("div",{className:"text-center py-12",children:[(0,gs.jsx)(ba,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,gs.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Keine Materialien gefunden"}),(0,gs.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:l||"alle"!==c?"Versuchen Sie andere Suchbegriffe oder Filter.":"Beginnen Sie mit dem Hinzuf\xfcgen Ihres ersten Materials."})]})]})})]}),(0,gs.jsx)(Fa,{isOpen:m,onClose:()=>{p(!1),g(null)},material:f,onSave:e=>{if(f){const t=(0,Le.A)((0,Le.A)({},e),{},{id:f.id});n(t),i("Material erfolgreich aktualisiert","success")}else t(e),i("Material erfolgreich hinzugef\xfcgt","success")}}),(0,gs.jsx)(La,{isOpen:L,onClose:()=>{F(!1),O(null)},material:R,onEdit:te,onDelete:ne}),(0,gs.jsx)(Ka,{isOpen:v,onClose:()=>{b(!1)},type:w})]})},qa=_s("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),Ha=_s("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Ga=_s("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),Wa=()=>{const{materials:e,updateMaterial:t}=Cs(),{showNotification:n}=Os(),[r,a]=(0,s.useState)([]),[i,l]=(0,s.useState)(!1),[o,c]=(0,s.useState)(!1),[u,d]=(0,s.useState)(""),[h,m]=(0,s.useState)(null),[p,f]=(0,s.useState)("");(0,s.useEffect)(()=>{const t=[];e.forEach(e=>{const n="bestellt"===e.orderStatus,r=e.orderedQuantity||0,s=e.stock<0,a=s?Math.abs(e.stock):0,i=n&&s?a-r:0;n&&t.push((0,Le.A)((0,Le.A)({},e),{},{_displayType:"ordered",_displayQuantity:r})),n&&i>0&&t.push((0,Le.A)((0,Le.A)({},e),{},{_displayType:"additional",_displayQuantity:i,_isAdditionalOrder:!0})),!n&&s&&t.push((0,Le.A)((0,Le.A)({},e),{},{_displayType:"needed",_displayQuantity:e.excludeFromAutoOrder?a:e.orderQuantity||a})),!n&&!s&&e.stock<=(e.heatStock||0)&&e.stock>0&&!e.excludeFromAutoOrder&&t.push((0,Le.A)((0,Le.A)({},e),{},{_displayType:"low",_displayQuantity:e.orderQuantity||0}))}),a(t)},[e]);const g=async r=>{try{const s=String(p||"").trim();if(""===s)return m(null),void f("");const a=parseInt(s,10);if(isNaN(a)||a<0)return void n("Bitte geben Sie eine g\xfcltige Menge ein","error");const i=e.find(e=>e.id===r);if(!i)return void n("Material nicht gefunden","error");await t((0,Le.A)((0,Le.A)({},i),{},{orderQuantity:a})),n("Bestellmenge erfolgreich aktualisiert","success"),m(null),f("")}catch(s){console.error("Fehler beim Speichern der Bestellmenge:",s),n("Fehler beim Aktualisieren der Bestellmenge","error")}},x=async function(t){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;l(!0);try{const a=e.find(e=>e.id===t);if(r){const e=((null===a||void 0===a?void 0:a.orderedQuantity)||0)+s;await ks.FirebaseService.updateDocument("materials",t,{orderedQuantity:e,orderDate:new Date,updatedAt:new Date}),n("+".concat(s," St\xfcck nachbestellt (gesamt: ").concat(e,")"),"success")}else{const e=null!==a&&void 0!==a&&a.excludeFromAutoOrder?Math.abs((null===a||void 0===a?void 0:a.stock)||0):(null===a||void 0===a?void 0:a.orderQuantity)||0;await ks.FirebaseService.updateDocument("materials",t,{orderStatus:"bestellt",orderDate:new Date,orderedQuantity:e,updatedAt:new Date}),n("".concat(e," St\xfcck als bestellt markiert"),"success")}}catch(a){console.error("Fehler beim Markieren als bestellt:",a),n("Fehler beim Aktualisieren","error")}finally{l(!1)}},y=e=>{switch(e._displayType){case"ordered":return"bg-blue-100 text-blue-800";case"additional":case"needed":return"bg-red-100 text-red-800";case"low":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},v=e=>{switch(e._displayType){case"ordered":return"Bestellt (".concat(e._displayQuantity,")");case"additional":case"needed":return"Nachbestellen (".concat(e._displayQuantity,")");case"low":return"Niedrig";default:return"Auf Lager"}},b=async t=>{l(!0);try{const r=e.find(e=>e.id===t),s=null!==r&&void 0!==r&&r.excludeFromAutoOrder?Math.abs((null===r||void 0===r?void 0:r.stock)||0):(null===r||void 0===r?void 0:r.orderQuantity)||0;await ks.FirebaseService.updateDocument("materials",t,{orderStatus:"bestellt",orderDate:new Date,orderedQuantity:s,updatedAt:new Date}),n("Material zur Bestellung hinzugef\xfcgt (".concat(s," St\xfcck)"),"success"),c(!1),d("")}catch(r){console.error("Fehler beim Hinzuf\xfcgen zur Bestellung:",r),n("Fehler beim Hinzuf\xfcgen zur Bestellung","error")}finally{l(!1)}},w=e.filter(e=>"bestellt"!==e.orderStatus&&(""===u||e.materialID.toLowerCase().includes(u.toLowerCase())||e.description.toLowerCase().includes(u.toLowerCase())||e.manufacturer.toLowerCase().includes(u.toLowerCase()))),j=e.filter(e=>e.stock<=(e.heatStock||0)&&e.stock>0&&"bestellt"!==e.orderStatus&&!e.excludeFromAutoOrder).length,N=e.filter(e=>"bestellt"===e.orderStatus).length,k=e.filter(e=>e.stock<=(e.heatStock||0)&&e.stock>0&&e.excludeFromAutoOrder&&"bestellt"!==e.orderStatus).length,S=e.filter(e=>e.stock<=(e.heatStock||0)&&e.stock>0&&e.excludeFromAutoOrder&&"bestellt"!==e.orderStatus);return(0,gs.jsxs)("div",{className:"space-y-6",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Bestellmanagement"}),(0,gs.jsx)("p",{className:"text-gray-600",children:"Materialien bestellen und Bestellstatus verwalten"})]}),(0,gs.jsxs)("div",{className:"flex space-x-3",children:[(0,gs.jsxs)("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center space-x-2",children:[(0,gs.jsx)(ya,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"Material hinzuf\xfcgen"})]}),(0,gs.jsxs)("button",{onClick:async()=>{const t=e.filter(e=>"bestellt"!==e.orderStatus&&(e.stock<0||e.stock<=(e.heatStock||0)&&e.stock>0&&!e.excludeFromAutoOrder));if(0!==t.length){l(!0);try{const e=t.map(e=>{const t=e.excludeFromAutoOrder?Math.abs(e.stock||0):e.orderQuantity||0;return ks.FirebaseService.updateDocument("materials",e.id,{orderStatus:"bestellt",orderDate:new Date,orderedQuantity:t,updatedAt:new Date})});await Promise.all(e),n("".concat(t.length," Materialien als bestellt markiert"),"success")}catch(r){console.error("Fehler beim Massenbestellung:",r),n("Fehler bei der Massenbestellung","error")}finally{l(!1)}}else n("Keine Materialien zu bestellen","info")},disabled:i||0===j,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[(0,gs.jsx)(qa,{className:"h-4 w-4"}),(0,gs.jsxs)("span",{children:["Alle niedrigen bestellen (",j,")"]})]})]})]}),(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Zu bestellen"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:j})]}),(0,gs.jsx)(wa,{className:"h-8 w-8 text-orange-600"})]})}),(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Bestellt"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:N})]}),(0,gs.jsx)(Ha,{className:"h-8 w-8 text-blue-600"})]})}),(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Ausgeschlossen"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-amber-600",children:k})]}),(0,gs.jsx)(Ia,{className:"h-8 w-8 text-amber-600"})]})}),(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Gesamt Bestellliste"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]}),(0,gs.jsx)(ba,{className:"h-8 w-8 text-gray-600"})]})})]}),(0,gs.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,gs.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,gs.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Bestellliste"})}),0===r.length?(0,gs.jsxs)("div",{className:"p-8 text-center text-gray-500",children:[(0,gs.jsx)(ba,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,gs.jsx)("p",{children:"Keine Materialien in der Bestellliste"})]}):(0,gs.jsx)("div",{className:"overflow-x-auto",children:(0,gs.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,gs.jsx)("thead",{className:"bg-gray-50",children:(0,gs.jsxs)("tr",{children:[(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Material"}),(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bestand"}),(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Meldebestand"}),(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bestellmenge"}),(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Link"}),(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aktionen"})]})}),(0,gs.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(e=>(0,gs.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsxs)("div",{children:[(0,gs.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.description}),(0,gs.jsx)("div",{className:"text-sm text-gray-500",children:e.materialID})]})}),(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsx)("div",{className:"text-sm text-gray-900",children:e.stock})}),(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsx)("div",{className:"text-sm text-gray-900",children:e.heatStock})}),(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",onClick:e=>e.stopPropagation(),children:h===e.id?(0,gs.jsx)("div",{className:"relative z-50",children:(0,gs.jsx)("input",{type:"number",value:p,onChange:e=>f(e.target.value),onKeyDown:t=>{"Enter"===t.key?g(e.id):"Escape"===t.key&&(m(null),f(""))},onBlur:()=>g(e.id),className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"0",min:"0",autoFocus:!0})}):(0,gs.jsx)("div",{className:"cursor-pointer hover:bg-blue-50 hover:border hover:border-blue-200 px-2 py-1 rounded transition-all duration-200",onClick:t=>{var n,r;t.stopPropagation(),n=e.id,r=e.orderQuantity,m(n),f(String(r||""))},title:"Klicken zum Bearbeiten der Bestellmenge",children:(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-900 hover:text-blue-700",children:e._displayQuantity})})}),(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(y(e)),children:v(e)})}),(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.link?(0,gs.jsx)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:text-primary-800",onClick:e=>e.stopPropagation(),children:(0,gs.jsx)(ka,{className:"h-5 w-5"})}):(0,gs.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:"ordered"===e._displayType?(0,gs.jsxs)("button",{onClick:()=>(async e=>{l(!0);try{await ks.FirebaseService.updateDocument("materials",e,{orderStatus:null,orderDate:null,orderedQuantity:null,updatedAt:new Date}),n("Bestellung storniert","success")}catch(t){console.error("Fehler beim Stornieren:",t),n("Fehler beim Stornieren","error")}finally{l(!1)}})(e.id),disabled:i,className:"text-red-600 hover:text-red-900 disabled:opacity-50 flex items-center space-x-1",children:[(0,gs.jsx)(Ms,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"Stornieren"})]}):"additional"===e._displayType?(0,gs.jsxs)("button",{onClick:()=>x(e.id,!0,e._displayQuantity),disabled:i,className:"text-blue-600 hover:text-blue-900 disabled:opacity-50 flex items-center space-x-1",children:[(0,gs.jsx)(Ga,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"Nachbestellen"})]}):(0,gs.jsxs)("button",{onClick:()=>x(e.id),disabled:i,className:"text-blue-600 hover:text-blue-900 disabled:opacity-50 flex items-center space-x-1",children:[(0,gs.jsx)(Ga,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"Bestellen"})]})})]},e.id))})]})})]}),S.length>0&&(0,gs.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,gs.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 bg-amber-50",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)(Ia,{className:"h-5 w-5 text-amber-600"}),(0,gs.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Von automatischer Nachbestellung ausgeschlossen"})]}),(0,gs.jsx)("p",{className:"text-sm text-amber-700 mt-1",children:"Diese Materialien haben niedrigen Bestand, werden aber nicht automatisch nachbestellt"})]}),(0,gs.jsx)("div",{className:"overflow-x-auto",children:(0,gs.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,gs.jsx)("thead",{className:"bg-gray-50",children:(0,gs.jsxs)("tr",{children:[(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Material"}),(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bestand"}),(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Meldebestand"}),(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Preis"}),(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Link"}),(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aktionen"})]})}),(0,gs.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:S.map(e=>(0,gs.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsxs)("div",{children:[(0,gs.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.description}),(0,gs.jsx)("div",{className:"text-sm text-gray-500",children:e.materialID})]})}),(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsx)("div",{className:"text-sm text-red-600 font-medium",children:e.stock})}),(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsx)("div",{className:"text-sm text-gray-900",children:e.heatStock})}),(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsx)("div",{className:"text-sm text-gray-900",children:e.price?"".concat(e.price," \u20ac"):"Nicht angegeben"})}),(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.link?(0,gs.jsx)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:text-primary-800",onClick:e=>e.stopPropagation(),children:(0,gs.jsx)(ka,{className:"h-5 w-5"})}):(0,gs.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,gs.jsxs)("button",{onClick:()=>b(e.id),disabled:i,className:"text-blue-600 hover:text-blue-900 disabled:opacity-50 flex items-center space-x-1",children:[(0,gs.jsx)(qa,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"Manuell bestellen"})]})})]},e.id))})]})})]}),o&&(0,gs.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 !m-0 !top-0",children:(0,gs.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[80vh] overflow-y-auto",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,gs.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Material zur Bestellung hinzuf\xfcgen"}),(0,gs.jsx)("button",{onClick:()=>{c(!1),d("")},className:"text-gray-400 hover:text-gray-600",children:(0,gs.jsx)(Ms,{className:"h-6 w-6"})})]}),(0,gs.jsx)("div",{className:"mb-4",children:(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,gs.jsx)("input",{type:"text",placeholder:"Material suchen (ID, Beschreibung, Hersteller)...",value:u,onChange:e=>d(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})}),(0,gs.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:0===w.length?(0,gs.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,gs.jsx)(ba,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,gs.jsx)("p",{children:"Keine verf\xfcgbaren Materialien gefunden"})]}):w.map(e=>(0,gs.jsxs)("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[(0,gs.jsxs)("div",{className:"flex-1",children:[(0,gs.jsx)("div",{className:"font-medium text-gray-900",children:e.materialID}),(0,gs.jsx)("div",{className:"text-sm text-gray-500",children:e.description}),(0,gs.jsxs)("div",{className:"text-xs text-gray-400",children:[e.manufacturer," \u2022 Bestand: ",e.stock]})]}),(0,gs.jsx)("button",{onClick:()=>b(e.id),disabled:i,className:"px-3 py-1 bg-primary-600 text-white rounded hover:bg-primary-700 disabled:opacity-50 text-sm",children:"Hinzuf\xfcgen"})]},e.id))})]})})]})},Qa=_s("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Ja=_s("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Za=_s("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Xa=_s("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),Ya=_s("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),$a=_s("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]),ei=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")},ti=e=>{if(null===e||void 0===e||""===e)return"0,00 \u20ac";const t=Number(e);return Number.isNaN(t)?"0,00 \u20ac":"".concat(t.toFixed(2).replace(".",",")," \u20ac")},ni=e=>{if(!e)return null;try{let t;if(e instanceof Date)t=e;else if("string"===typeof e||"number"===typeof e)t=new Date(e);else{if(!e.seconds)return"Ung\xfcltiges Datum";t=new Date(1e3*e.seconds)}return isNaN(t.getTime())?"Ung\xfcltiges Datum":t.toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"})}catch(t){return"Ung\xfcltiges Datum"}},ri=e=>{let{street:t,houseNumber:n,postalCode:r,city:s}=e;const a=(t||"").trim(),i=(n||"").trim(),l=(r||"").trim(),o=(s||"").trim();return a||i||l||o?"".concat(a," ").concat(i,", ").concat(l," ").concat(o).replace(/\s+,/g,",").replace(/\s{2,}/g," ").trim():""},si=e=>{var t,n,r,s;let{value:a,onChange:i,onCancel:l,onSubmit:o,submitLabel:c="Hinzuf\xfcgen"}=e;const u=a||{name:"",email:"",phone:"",position:"",notes:""},d=!(null!==(t=u.name)&&void 0!==t&&t.trim())||!(null!==(n=u.position)&&void 0!==n&&n.trim())||!(null!==(r=u.email)&&void 0!==r&&r.trim())||!(null!==(s=u.phone)&&void 0!==s&&s.trim());return(0,gs.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border",children:[(0,gs.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Aktualisieren"===c?"Kontakt bearbeiten":"Neuen Kontakt hinzuf\xfcgen"}),(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),(0,gs.jsx)("input",{type:"text",value:u.name,onChange:e=>i((0,Le.A)((0,Le.A)({},u),{},{name:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Vor- und Nachname"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Position *"}),(0,gs.jsx)("input",{type:"text",value:u.position,onChange:e=>i((0,Le.A)((0,Le.A)({},u),{},{position:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"z.B. Gesch\xe4ftsf\xfchrer, Projektleiter"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"E-Mail *"}),(0,gs.jsx)("input",{type:"email",value:u.email,onChange:e=>i((0,Le.A)((0,Le.A)({},u),{},{email:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"kontakt@beispiel.de"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefon *"}),(0,gs.jsx)("input",{type:"tel",value:u.phone,onChange:e=>i((0,Le.A)((0,Le.A)({},u),{},{phone:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"+49 123 456789"})]}),(0,gs.jsxs)("div",{className:"md:col-span-2",children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notizen"}),(0,gs.jsx)("textarea",{value:u.notes,onChange:e=>i((0,Le.A)((0,Le.A)({},u),{},{notes:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:2,placeholder:"Zus\xe4tzliche Informationen..."})]})]}),(0,gs.jsxs)("div",{className:"flex justify-end space-x-3 mt-4",children:[(0,gs.jsx)("button",{type:"button",onClick:l,className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300",children:"Abbrechen"}),(0,gs.jsx)("button",{type:"button",onClick:o,disabled:d,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:c})]})]})},ai=e=>{let{contacts:t,onEditClick:n,onDeleteClick:r}=e;return t&&0!==t.length?(0,gs.jsx)("div",{className:"space-y-3",children:t.map(e=>(0,gs.jsxs)("div",{className:"bg-white border rounded-lg p-4",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)(ma,{className:"h-4 w-4 text-blue-500"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.name}),e.position&&(0,gs.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded-full text-xs",children:e.position})]}),(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)("button",{onClick:()=>null===n||void 0===n?void 0:n(e),className:"p-1 text-gray-400 hover:text-blue-600",children:(0,gs.jsx)(Ca,{className:"h-4 w-4"})}),(0,gs.jsx)("button",{onClick:()=>null===r||void 0===r?void 0:r(e.id),className:"p-1 text-gray-400 hover:text-red-600",children:(0,gs.jsx)(Ea,{className:"h-4 w-4"})})]})]}),(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[e.email&&(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)(ca,{className:"h-3 w-3 text-gray-400"}),(0,gs.jsx)("span",{className:"text-gray-600",children:e.email})]}),e.phone&&(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)(Xa,{className:"h-3 w-3 text-gray-400"}),(0,gs.jsx)("span",{className:"text-gray-600",children:e.phone})]})]}),e.notes&&(0,gs.jsx)("p",{className:"text-sm text-gray-600 mt-2 italic",children:e.notes})]},e.id))}):(0,gs.jsxs)("div",{className:"text-center py-8",children:[(0,gs.jsx)(Za,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,gs.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Keine Ansprechpartner"}),(0,gs.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"F\xfcgen Sie Ansprechpartner mit Kontaktdaten hinzu."})]})},ii=e=>{let{isOpen:t,onClose:n,mode:r="view",customer:a,onEdit:i,onDelete:l,onProjectClick:o}=e;const c="view"===r,u="edit"===r,d="create"===r,{getProjectsByCustomer:h}=Ks(),{customers:m,addCustomer:p,updateCustomer:f}=Vs(),{showNotification:g}=Os(),{bookings:x=[]}=Hs(),[y,v]=(0,s.useState)([]),[b,w]=(0,s.useState)(!1),[j,N]=(0,s.useState)(null),[k,S]=(0,s.useState)({name:"",email:"",phone:"",position:"",notes:""}),[C,E]=(0,s.useState)(0),[A,I]=(0,s.useState)(!1),[_,T]=(0,s.useState)(null),[D,P]=(0,s.useState)({customerID:"",firmennameKundenname:"",street:"",houseNumber:"",postalCode:"",city:"",notes:""}),[M,R]=(0,s.useState)({});(0,s.useEffect)(()=>{t&&(v((null===a||void 0===a?void 0:a.contacts)||[]),d?P({customerID:"",firmennameKundenname:"",street:"",houseNumber:"",postalCode:"",city:"",notes:""}):u&&a&&P({customerID:a.customerID||"",firmennameKundenname:a.firmennameKundenname||"",street:a.street||"",houseNumber:a.houseNumber||"",postalCode:a.postalCode||"",city:a.city||"",notes:a.notes||""}),R({}),w(!1),N(null),S({name:"",email:"",phone:"",position:"",notes:""}),T(null))},[t,d,u,a]);const O=e=>{N(e),S({name:e.name||"",email:e.email||"",phone:e.phone||"",position:e.position||"",notes:e.notes||""})},L=e=>{if(c){const t=y.find(t=>t.id===e);T({contactId:e,contactName:(null===t||void 0===t?void 0:t.name)||"Unbekannter Kontakt"})}else v(t=>t.filter(t=>t.id!==e))},F=async()=>{if(!_)return;const e=y.filter(e=>e.id!==_.contactId);try{if(c&&a){const t=a.id||a.customerID;await f(t,(0,Le.A)((0,Le.A)({},a),{},{contacts:e})),g("Kontakt erfolgreich gel\xf6scht","success")}v(e)}catch(t){console.error("Error deleting contact:",t),g("Fehler beim L\xf6schen des Kontakts","error")}finally{T(null)}},V=async()=>{if(k.name.trim()&&k.position.trim()&&k.email.trim()&&k.phone.trim())if(j){const t=y.map(e=>e.id===j.id?(0,Le.A)((0,Le.A)({},k),{},{id:j.id,updatedAt:(new Date).toISOString()}):e);try{if(c&&a){const e=a.id||a.customerID;await f(e,(0,Le.A)((0,Le.A)({},a),{},{contacts:t})),g("Kontakt erfolgreich aktualisiert","success")}v(t)}catch(e){console.error("Error updating contact:",e),g("Fehler beim Aktualisieren des Kontakts","error")}finally{N(null),S({name:"",email:"",phone:"",position:"",notes:""})}}else{const t=(0,Le.A)((0,Le.A)({id:Date.now().toString()},k),{},{createdAt:(new Date).toISOString()}),n=[...y,t];try{if(c&&a){const e=a.id||a.customerID;await f(e,(0,Le.A)((0,Le.A)({},a),{},{contacts:n})),g("Kontakt erfolgreich hinzugef\xfcgt","success")}v(n)}catch(e){console.error("Error adding contact:",e),g("Fehler beim Hinzuf\xfcgen des Kontakts","error")}finally{w(!1),S({name:"",email:"",phone:"",position:"",notes:""})}}else g("Bitte f\xfcllen Sie alle Pflichtfelder aus","error")},z=(e,t)=>{P(n=>(0,Le.A)((0,Le.A)({},n),{},{[e]:t})),M[e]&&R(t=>(0,Le.A)((0,Le.A)({},t),{},{[e]:""}))},U=(null===a||void 0===a?void 0:a.id)||(null===a||void 0===a?void 0:a.customerID),K=(0,s.useMemo)(()=>U&&h(U)||[],[h,U]),B=(0,s.useCallback)(async()=>{if(c&&K.length){I(!0);try{const e=await(async(e,t)=>{if(!e||0===e.length)return 0;let n=0;const r=new Set,s={};e.forEach(e=>{const n=t.filter(t=>t.projectID===e.id);s[e.id]=n,n.forEach(e=>{var t;null===(t=e.materials)||void 0===t||t.forEach(e=>{e.materialID&&r.add(e.materialID)})})});const a={};try{(await ks.FirebaseService.getDocuments("materials")).forEach(e=>{r.has(e.materialID)&&(a[e.materialID]=e)})}catch(i){return console.error("Fehler beim Laden der Materialien f\xfcr Kundenkostenberechnung:",i),0}return Object.values(s).forEach(e=>{e.forEach(e=>{var t;null===(t=e.materials)||void 0===t||t.forEach(e=>{const t=a[e.materialID];if(t&&t.price&&e.quantity){const r=Number(t.price),s=Number(e.quantity);isNaN(r)||isNaN(s)||(n+=r*s)}})})}),n})(K,x);E(e)}catch(Ao){console.error("Fehler beim Berechnen der Kundenkosten:",Ao),E(0)}finally{I(!1)}}},[c,K,x]);if((0,s.useEffect)(()=>{c&&K.length>=0&&B()},[c,K,x,B]),!t)return null;const q=c?"Kundendetails":u?"Kunde bearbeiten":"Neuen Kunden hinzuf\xfcgen",H=(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsxs)("button",{onClick:()=>{null===i||void 0===i||i(a),null===n||void 0===n||n()},className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center space-x-2",children:[(0,gs.jsx)(Ca,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"Bearbeiten"})]}),(0,gs.jsxs)("button",{onClick:()=>{null===l||void 0===l||l(null===a||void 0===a?void 0:a.id),null===n||void 0===n||n()},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 flex items-center space-x-2",children:[(0,gs.jsx)(Ea,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"L\xf6schen"})]})]}),G=(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Abbrechen"}),(0,gs.jsxs)("button",{type:"submit",form:"customer-form",className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center space-x-2",children:[(0,gs.jsx)(Aa,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:u?"Aktualisieren":"Hinzuf\xfcgen"})]})]});if(c&&a){const e=a.address||ri({street:a.street,houseNumber:a.houseNumber,postalCode:a.postalCode,city:a.city});return(0,gs.jsxs)(_a,{isOpen:t,onClose:n,title:q,icon:ma,footerButtons:H,children:[(0,gs.jsxs)("div",{className:"space-y-6",children:[(0,gs.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,gs.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Kundeninformationen"}),(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(ma,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Firmenname/Kundenname"})]}),(0,gs.jsx)("p",{className:"text-gray-900 ml-6",children:a.firmennameKundenname})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(Ya,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Kunden-ID"})]}),(0,gs.jsx)("p",{className:"text-gray-900 ml-6",children:a.customerID})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(Ja,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Adresse"})]}),(0,gs.jsx)("p",{className:"text-gray-900 ml-6",children:e||"Nicht angegeben"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(Xa,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Telefon"})]}),(0,gs.jsx)("p",{className:"text-gray-900 ml-6",children:a.phone||"Nicht angegeben"})]})]})]}),(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow border",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Aktive Projekte"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:K.filter(e=>"Aktiv"===e.status).length})]}),(0,gs.jsx)(Va,{className:"h-8 w-8 text-blue-600"})]})}),(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow border",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Gesamt Projekte"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-green-600",children:K.length})]}),(0,gs.jsx)(ba,{className:"h-8 w-8 text-green-600"})]})}),(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow border",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Gesamtkosten"}),A?(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-orange-600"}),(0,gs.jsx)("span",{className:"text-sm text-gray-500",children:"Berechne..."})]}):(0,gs.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:ti(C)})]}),(0,gs.jsx)($a,{className:"h-8 w-8 text-orange-600"})]})})]}),(0,gs.jsxs)("div",{className:"space-y-4",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("h3",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:["Ansprechpartner (",y.length,")"]}),(0,gs.jsxs)("button",{onClick:()=>{w(!0),N(null),S({name:"",email:"",phone:"",position:"",notes:""})},className:"px-3 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center space-x-2 text-sm",children:[(0,gs.jsx)(Za,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"Kontakt hinzuf\xfcgen"})]})]}),(0,gs.jsx)(ai,{contacts:y,onEditClick:O,onDeleteClick:L}),(b||j)&&(0,gs.jsx)(si,{value:k,onChange:S,onCancel:()=>{w(!1),N(null),S({name:"",email:"",phone:"",position:"",notes:""})},onSubmit:V,submitLabel:j?"Aktualisieren":"Hinzuf\xfcgen"})]}),(0,gs.jsxs)("div",{className:"space-y-4",children:[(0,gs.jsxs)("h3",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:["Projekte (",K.length,")"]}),0===K.length?(0,gs.jsxs)("div",{className:"text-center py-8",children:[(0,gs.jsx)(Va,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,gs.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Keine Projekte"}),(0,gs.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"F\xfcr diesen Kunden wurden noch keine Projekte angelegt."})]}):(0,gs.jsx)("div",{className:"space-y-3",children:K.map((e,t)=>(0,gs.jsxs)("div",{className:"bg-white border rounded-lg p-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>null===o||void 0===o?void 0:o(e),children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)(Va,{className:"h-4 w-4 text-blue-500"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,gs.jsx)("span",{className:ei("px-2 py-1 rounded-full text-xs font-medium","Aktiv"===e.status?"bg-green-100 text-green-800":"Abgeschlossen"===e.status?"bg-gray-100 text-gray-800":"bg-yellow-100 text-yellow-800"),children:e.status})]}),e.startDate&&(0,gs.jsx)("span",{className:"text-sm text-gray-500",children:ni(e.startDate)})]}),e.description&&(0,gs.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),e.endDate&&(0,gs.jsx)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:(0,gs.jsxs)("span",{children:["Ende: ",ni(e.endDate)]})})]},t))})]})]}),_&&(0,gs.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,gs.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,gs.jsxs)("div",{className:"flex items-center mb-4",children:[(0,gs.jsx)("div",{className:"flex-shrink-0",children:(0,gs.jsx)(Ea,{className:"h-6 w-6 text-red-600"})}),(0,gs.jsx)("div",{className:"ml-3",children:(0,gs.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Kontakt l\xf6schen"})})]}),(0,gs.jsx)("div",{className:"mb-4",children:(0,gs.jsxs)("p",{className:"text-sm text-gray-500",children:["M\xf6chten Sie den Kontakt ",(0,gs.jsx)("strong",{children:_.contactName})," wirklich l\xf6schen? Diese Aktion kann nicht r\xfcckg\xe4ngig gemacht werden."]})}),(0,gs.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,gs.jsx)("button",{type:"button",onClick:()=>T(null),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Abbrechen"}),(0,gs.jsx)("button",{type:"button",onClick:F,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700",children:"L\xf6schen"})]})]})})]})}return(0,gs.jsx)(_a,{isOpen:t,onClose:n,title:q,icon:ma,footerButtons:G,children:(0,gs.jsxs)("form",{id:"customer-form",onSubmit:async e=>{var t;if(null===e||void 0===e||null===(t=e.preventDefault)||void 0===t||t.call(e),!(()=>{const e={};return D.firmennameKundenname.trim()||(e.firmennameKundenname="Firmenname/Kundenname ist erforderlich"),D.street.trim()||(e.street="Stra\xdfe ist erforderlich"),D.houseNumber.trim()||(e.houseNumber="Hausnummer ist erforderlich"),D.postalCode.trim()?/^\d{5}$/.test(D.postalCode.trim())||(e.postalCode="PLZ muss 5 Ziffern haben"):e.postalCode="PLZ ist erforderlich",D.city.trim()||(e.city="Stadt ist erforderlich"),R(e),0===Object.keys(e).length})())return;let r=D.customerID;if(d&&!r)try{r=function(){const e=/^KUN-(\d{3,})$/,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((t,n)=>{const r=null===n||void 0===n?void 0:n.customerID;if(!r||"string"!==typeof r)return t;const s=r.match(e);if(!s)return t;const a=parseInt(s[1],10);return Number.isFinite(a)&&a>t?a:t},0);return"KUN-".concat(String(t+1).padStart(3,"0"))}(m)}catch(i){console.error("Fehler beim Generieren der Kunden-ID:",i),r="KUN-001"}const s=(0,Le.A)((0,Le.A)({},D),{},{customerID:r,address:ri(D),contacts:y,street:D.street,houseNumber:D.houseNumber,postalCode:D.postalCode,city:D.city});try{u&&a?(await f(a.id,(0,Le.A)((0,Le.A)({},s),{},{createdAt:a.createdAt,lastActivity:new Date})),g("Kunde erfolgreich aktualisiert","success")):d&&(await p((0,Le.A)((0,Le.A)({},s),{},{createdAt:(new Date).toISOString()})),g("Kunde erfolgreich hinzugef\xfcgt","success")),null===n||void 0===n||n()}catch(i){console.error("Fehler beim Speichern des Kunden:",i),g("Fehler beim Speichern","error")}},className:"space-y-6",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kunden-ID *"}),(0,gs.jsx)("input",{type:"text",value:D.customerID,readOnly:!0,placeholder:"Wird automatisch generiert",className:"w-full px-3 py-2 border rounded-lg bg-gray-100 text-gray-700 cursor-not-allowed"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Firmenname / Kundenname *"}),(0,gs.jsx)("input",{type:"text",value:D.firmennameKundenname,onChange:e=>z("firmennameKundenname",e.target.value),className:ei("w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",M.firmennameKundenname?"border-red-300":"border-gray-300"),placeholder:"z.B. Mustermann GmbH oder Max Mustermann"}),M.firmennameKundenname&&(0,gs.jsx)("p",{className:"mt-1 text-sm text-red-600",children:M.firmennameKundenname})]}),(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,gs.jsxs)("div",{className:"md:col-span-2",children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Stra\xdfe *"}),(0,gs.jsx)("input",{type:"text",value:D.street,onChange:e=>z("street",e.target.value),className:ei("w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",M.street?"border-red-300":"border-gray-300"),placeholder:"z.B. Musterstra\xdfe"}),M.street&&(0,gs.jsx)("p",{className:"mt-1 text-sm text-red-600",children:M.street})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hausnummer *"}),(0,gs.jsx)("input",{type:"text",value:D.houseNumber,onChange:e=>z("houseNumber",e.target.value),className:ei("w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",M.houseNumber?"border-red-300":"border-gray-300"),placeholder:"z.B. 123a"}),M.houseNumber&&(0,gs.jsx)("p",{className:"mt-1 text-sm text-red-600",children:M.houseNumber})]})]}),(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PLZ *"}),(0,gs.jsx)("input",{type:"text",value:D.postalCode,onChange:e=>z("postalCode",e.target.value),className:ei("w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",M.postalCode?"border-red-300":"border-gray-300"),placeholder:"z.B. 12345",maxLength:5,inputMode:"numeric"}),M.postalCode&&(0,gs.jsx)("p",{className:"mt-1 text-sm text-red-600",children:M.postalCode})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Stadt *"}),(0,gs.jsx)("input",{type:"text",value:D.city,onChange:e=>z("city",e.target.value),className:ei("w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",M.city?"border-red-300":"border-gray-300"),placeholder:"z.B. Musterstadt"}),M.city&&(0,gs.jsx)("p",{className:"mt-1 text-sm text-red-600",children:M.city})]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notizen"}),(0,gs.jsx)("textarea",{value:D.notes,onChange:e=>z("notes",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:3,placeholder:"Zus\xe4tzliche Informationen..."})]}),(0,gs.jsxs)("div",{className:"space-y-4",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Ansprechpartner (",y.length,")"]}),(0,gs.jsxs)("button",{type:"button",onClick:()=>{w(!0),N(null),S({name:"",email:"",phone:"",position:"",notes:""})},className:"px-3 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center space-x-2 text-sm",children:[(0,gs.jsx)(Za,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"Kontakt hinzuf\xfcgen"})]})]}),0===y.length?(0,gs.jsxs)("div",{className:"text-center py-6 bg-gray-50 rounded-lg",children:[(0,gs.jsx)(Za,{className:"mx-auto h-8 w-8 text-gray-400"}),(0,gs.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Noch keine Ansprechpartner hinzugef\xfcgt"})]}):(0,gs.jsx)("div",{className:"space-y-2",children:y.map(e=>(0,gs.jsxs)("div",{className:"bg-gray-50 border rounded-lg p-3",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)(ma,{className:"h-4 w-4 text-blue-500"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.name}),e.position&&(0,gs.jsx)("span",{className:"px-2 py-1 bg-gray-200 text-gray-700 rounded-full text-xs",children:e.position})]}),(0,gs.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,gs.jsx)("button",{type:"button",onClick:()=>O(e),className:"p-1 text-gray-400 hover:text-blue-600",children:(0,gs.jsx)(Ca,{className:"h-3 w-3"})}),(0,gs.jsx)("button",{type:"button",onClick:()=>L(e.id),className:"p-1 text-gray-400 hover:text-red-600",children:(0,gs.jsx)(Ea,{className:"h-3 w-3"})})]})]}),(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-1 text-xs",children:[e.email&&(0,gs.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,gs.jsx)(ca,{className:"h-3 w-3 text-gray-400"}),(0,gs.jsx)("span",{className:"text-gray-600",children:e.email})]}),e.phone&&(0,gs.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,gs.jsx)(Xa,{className:"h-3 w-3 text-gray-400"}),(0,gs.jsx)("span",{className:"text-gray-600",children:e.phone})]})]})]},e.id))}),(b||j)&&(0,gs.jsx)(si,{value:k,onChange:S,onCancel:()=>{w(!1),N(null),S({name:"",email:"",phone:"",position:"",notes:""})},onSubmit:()=>{j?(v(e=>e.map(e=>e.id===j.id?(0,Le.A)((0,Le.A)({},k),{},{id:j.id,updatedAt:(new Date).toISOString()}):e)),N(null)):(v(e=>[...e,(0,Le.A)((0,Le.A)({id:Date.now().toString()},k),{},{createdAt:(new Date).toISOString()})]),w(!1)),S({name:"",email:"",phone:"",position:"",notes:""})},submitLabel:j?"Aktualisieren":"Hinzuf\xfcgen"})]})]})})},li=ii,oi=e=>{let{isOpen:t,onClose:n,customer:r=null}=e;return(0,gs.jsx)(ii,{isOpen:t,onClose:n,mode:r?"edit":"create",customer:r})},ci=_s("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),ui=_s("Car",[["path",{d:"M14 16H9m10 0h3v-3.15a1 1 0 0 0-.84-.99L16 11l-2.7-3.6a1 1 0 0 0-.8-.4H5.24a2 2 0 0 0-1.8 1.1l-.8 1.63A6 6 0 0 0 2 12.42V16h2",key:"l5np60"}],["circle",{cx:"6.5",cy:"16.5",r:"2.5",key:"ae40ju"}],["circle",{cx:"16.5",cy:"16.5",r:"2.5",key:"1smtlt"}]]),di=_s("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),hi=_s("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),mi=_s("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),pi=_s("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),fi={PMAX_DC:"l5YKWiis3xv1nM5BAawD",UOC:"YuqUNbkdBZqpeLdqfLWP",ISC:"u41eflH6Ak3AOUMueySE",UMPP:"Irsy90GsYpb5t0IMEo8q"},gi={ISO_MON:"gSFt9cxxbLKMFzgmfMGp",SPD_DC:"QaoagxVWqsGmDB5jQ5yQ",SPD_AC:"SMVHZ0IEKCd2rtmzf75d",RCM:"O3cfxHm1deuw6PwrZdDb",AC_OC:"R7THqMHCNV2PN1GFs5c3",AC_SC:"2pYLbsyV2M0bG5snzDsy",AFCI:"P9e994aQn34DacV5jnN3",PMAX_DC:"nYZpbMVkT7GTzgBJuPTo",PNOM_AC:"0dytwvoi0zhNVpYhifa0",PMAX_AC:"8OGt81iqbClXYtLqXVHy"},xi={SPD_TYPE:"VWQS3uZfdtDsbuFz1GCl",RATED_CURRENT:"lHavHHgqgUnqhGFSMAlx",RATED_VOLTAGE:"BavUAeJxUeOi9dnVjt2p"},yi={WIRING_TYPE:"be3CMLpLw9QncaZu8uRw",PHASE_LEADER:"LzWhwzGGkxryk7Jyot5B",EARTH_LEADER:"wuKlDRXKCpFu2gTO58CQ"},vi=(e,t)=>Array.isArray(e)?e.find(e=>e.id===t):void 0,bi=(e,t,n)=>(e=>{if(null==e)return"";const t=String(e).replace(",","."),n=Number(t);return Number.isFinite(n)?t:""})(((e,t,n)=>{var r;const s=vi(e,t);return null===s||void 0===s||null===(r=s.specifications)||void 0===r?void 0:r[n]})(e,t,n)),wi=s.memo(function(e){let{title:t,subtitle:n,customerName:r}=e;return(0,gs.jsxs)("div",{className:"mb-6",children:[(0,gs.jsx)("h1",{className:"text-xl font-bold mb-1",children:t}),n&&(0,gs.jsx)("p",{className:"text-sm mb-2",children:n}),r?(0,gs.jsxs)("div",{className:"text-sm border-b border-gray-300 pb-1",children:[(0,gs.jsx)("span",{className:"font-medium",children:"Kunde:\xa0"}),r]}):null]})}),ji=s.memo(function(e){let{title:t,children:n}=e;return(0,gs.jsxs)("div",{className:"mb-8",children:[(0,gs.jsx)("h3",{className:"font-bold mb-3 pb-2 border-b-2 border-gray-800",children:t}),n]})}),Ni=s.memo(function(e){let{field:t,label:n,checked:r,onChange:s,small:a=!1}=e;return(0,gs.jsxs)("label",{className:"flex items-start ".concat(a?"mb-1":"mb-2"),children:[(0,gs.jsx)("input",{type:"checkbox",checked:!!r,onChange:e=>s(t,e.target.checked),className:"".concat(a?"mr-2":"mt-1 mr-3"," flex-shrink-0")}),(0,gs.jsx)("span",{className:a?"text-xs":"text-sm",children:n})]})}),ki=s.memo(function(e){let{type:t="text",value:n,onChange:r,placeholder:s="",className:a="",align:i="left"}=e;const l="center"===i?"text-center":"right"===i?"text-right":"text-left";return(0,gs.jsx)("input",{type:t,value:null!==n&&void 0!==n?n:"",onChange:e=>r(e.target.value),placeholder:s,className:"".concat("border-b border-gray-400 bg-transparent"," ").concat(l," ").concat(a)})}),Si=s.memo(function(e){let{vdeData:t,handleVdeDataChange:n}=e;return(0,gs.jsxs)("div",{className:"page bg-white p-8 min-h-[297mm] w-[210mm] mx-auto",style:{fontSize:"12px"},children:[(0,gs.jsxs)("div",{className:"text-left mb-2",children:[(0,gs.jsx)("h1",{className:"text-xl font-bold mb-4",children:"Anlagen\xfcbersicht"}),(0,gs.jsx)("div",{className:"text-lg font-semibold border-b border-gray-400 pb-1",children:t.projectName||""})]}),(0,gs.jsxs)("div",{className:"mb-8 grid grid-cols-2 gap-8",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h3",{className:"font-bold mb-2",children:"Pr\xfcfer"}),(0,gs.jsxs)("div",{className:"flex",children:[(0,gs.jsx)("span",{className:"w-20",children:"Name:"}),(0,gs.jsx)(ki,{value:t.inspectorName,onChange:e=>n("inspectorName",e),className:"flex-1"})]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h3",{className:"font-bold mb-2",children:"Anlagenstandort"}),(0,gs.jsxs)("div",{className:"flex",children:[(0,gs.jsx)("span",{className:"w-20",children:"Adresse"}),(0,gs.jsx)(ki,{value:t.address,onChange:e=>n("address",e),className:"flex-1"})]})]})]}),(0,gs.jsxs)("div",{className:"mb-2 grid grid-cols-2 gap-8",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h3",{className:"font-bold mb-2",children:"PV-Module"}),(0,gs.jsxs)("div",{className:"flex",children:[(0,gs.jsx)("span",{className:"w-20",children:"Anzahl"}),(0,gs.jsx)(ki,{type:"number",value:t.moduleCount,onChange:e=>n("moduleCount",e),className:"w-16 text-center"})]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h3",{className:"font-bold mb-2",children:"Leistung"}),(0,gs.jsxs)("div",{className:"flex",children:[(0,gs.jsx)("span",{className:"w-40",children:"Installierte Leistung (kWp)"}),(0,gs.jsx)(ki,{type:"number",value:t.installedPower,onChange:e=>n("installedPower",e),className:"w-24 text-center"})]})]})]}),(0,gs.jsx)("div",{className:"mb-8",children:(0,gs.jsxs)("table",{className:"w-full border-collapse border border-gray-400",children:[(0,gs.jsx)("thead",{children:(0,gs.jsxs)("tr",{className:"bg-gray-100",children:[(0,gs.jsx)("th",{className:"border border-gray-400 p-2 text-left",children:"Typ"}),(0,gs.jsx)("th",{className:"border border-gray-400 p-2 text-left",children:"Pmax DC (Wp)"}),(0,gs.jsx)("th",{className:"border border-gray-400 p-2 text-left",children:"Uoc (V)"}),(0,gs.jsx)("th",{className:"border border-gray-400 p-2 text-left",children:"Isc (A)"}),(0,gs.jsx)("th",{className:"border border-gray-400 p-2 text-left",children:"Umpp (V)"})]})}),(0,gs.jsx)("tbody",{children:(0,gs.jsxs)("tr",{children:[(0,gs.jsx)("td",{className:"border border-gray-400 p-2",children:(0,gs.jsx)(ki,{value:t.moduleType,onChange:e=>n("moduleType",e),className:"w-full"})}),(0,gs.jsx)("td",{className:"border border-gray-400 p-2",children:(0,gs.jsx)(ki,{type:"number",value:t.modulePmaxDC,onChange:e=>n("modulePmaxDC",e),className:"w-full text-center"})}),(0,gs.jsx)("td",{className:"border border-gray-400 p-2",children:(0,gs.jsx)(ki,{type:"number",value:t.moduleUoc,onChange:e=>n("moduleUoc",e),className:"w-full text-center"})}),(0,gs.jsx)("td",{className:"border border-gray-400 p-2",children:(0,gs.jsx)(ki,{type:"number",value:t.moduleIsc,onChange:e=>n("moduleIsc",e),className:"w-full text-center"})}),(0,gs.jsx)("td",{className:"border border-gray-400 p-2",children:(0,gs.jsx)(ki,{type:"number",value:t.moduleUmpp,onChange:e=>n("moduleUmpp",e),className:"w-full text-center"})})]})})]})}),(0,gs.jsxs)("div",{className:"mb-8",children:[(0,gs.jsx)("h3",{className:"font-bold mb-2",children:"PV\u2011Wechselrichter"}),(0,gs.jsxs)("div",{className:"flex mb-2",children:[(0,gs.jsx)("span",{className:"w-20",children:"Anzahl"}),(0,gs.jsx)(ki,{type:"number",value:t.inverterCount,onChange:e=>n("inverterCount",e),className:"w-16 text-center"})]}),(0,gs.jsxs)("table",{className:"w-full border-collapse border border-gray-400",children:[(0,gs.jsx)("thead",{children:(0,gs.jsxs)("tr",{className:"bg-gray-100",children:[(0,gs.jsx)("th",{className:"border border-gray-400 p-2 text-left",children:"Typ"}),(0,gs.jsx)("th",{className:"border border-gray-400 p-2 text-left",children:"Pmax DC (Wp)"}),(0,gs.jsx)("th",{className:"border border-gray-400 p-2 text-left",children:"Pnom AC (W)"}),(0,gs.jsx)("th",{className:"border border-gray-400 p-2 text-left",children:"Pmax AC (VA)"})]})}),(0,gs.jsx)("tbody",{children:Array.from({length:3},(e,r)=>(0,gs.jsxs)("tr",{children:[(0,gs.jsx)("td",{className:"border border-gray-400 p-2",children:(0,gs.jsx)(ki,{value:t["inverterType".concat(r+1)],onChange:e=>n("inverterType".concat(r+1),e),className:"w-full"})}),(0,gs.jsx)("td",{className:"border border-gray-400 p-2",children:(0,gs.jsx)(ki,{type:"number",value:t["inverterPmaxDC".concat(r+1)],onChange:e=>n("inverterPmaxDC".concat(r+1),e),className:"w-full text-center"})}),(0,gs.jsx)("td",{className:"border border-gray-400 p-2",children:(0,gs.jsx)(ki,{type:"number",value:t["inverterPnomAC".concat(r+1)],onChange:e=>n("inverterPnomAC".concat(r+1),e),className:"w-full text-center"})}),(0,gs.jsx)("td",{className:"border border-gray-400 p-2",children:(0,gs.jsx)(ki,{type:"number",value:t["inverterPmaxAC".concat(r+1)],onChange:e=>n("inverterPmaxAC".concat(r+1),e),className:"w-full text-center"})})]},r))})]})]}),(0,gs.jsxs)("div",{className:"mb-8",children:[(0,gs.jsx)("h3",{className:"font-bold mb-4",children:"Einspeise\u2011Stromz\xe4hler"}),(0,gs.jsxs)("div",{className:"flex mb-4",children:[(0,gs.jsx)("span",{className:"w-40",children:"Datum Inbetriebnahme:"}),(0,gs.jsx)(ki,{type:"date",value:t.commissioningDate,onChange:e=>n("commissioningDate",e),className:"flex-1"})]}),Array.from({length:2},(e,r)=>(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-8 mb-4",children:[(0,gs.jsxs)("div",{className:"flex",children:[(0,gs.jsxs)("span",{className:"w-36",children:["Stromz\xe4hler ",r+1," Nr.:"]}),(0,gs.jsx)(ki,{value:t["meterNumber".concat(r+1)],onChange:e=>n("meterNumber".concat(r+1),e),className:"flex-1"})]}),(0,gs.jsxs)("div",{className:"flex",children:[(0,gs.jsxs)("span",{className:"w-36",children:["Z\xe4hlerstand ",r+1,":"]}),(0,gs.jsx)(ki,{value:t["meterReading".concat(r+1)],onChange:e=>n("meterReading".concat(r+1),e),className:"flex-1"})]})]},r))]}),(0,gs.jsxs)("div",{className:"mb-8",children:[(0,gs.jsx)("h3",{className:"font-bold mb-4",children:"Konstruktion, Aufbau, Besichtigung sowie Pr\xfcfung"}),(0,gs.jsx)("p",{className:"mb-4 text-sm",children:"Ich/Wir best\xe4tigen, dass alle Arbeiten fachgerecht und nach bestem Wissen ausgef\xfchrt wurden."}),(0,gs.jsxs)("div",{className:"mb-4 flex",children:[(0,gs.jsx)("span",{className:"w-28",children:"Pr\xfcfger\xe4te:"}),(0,gs.jsx)(ki,{value:t.testEquipment,onChange:e=>n("testEquipment",e),className:"flex-1",placeholder:"Benning IT130 ... / PV2 ... / SUN2 ..."})]}),(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-8 mb-4",children:[(0,gs.jsx)(Ni,{field:"initialTest",label:"Erstpr\xfcfung",checked:t.initialTest,onChange:n}),(0,gs.jsx)(Ni,{field:"repeatTest",label:"Wiederholungspr\xfcfung",checked:t.repeatTest,onChange:n})]}),(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-8 mb-4",children:[(0,gs.jsxs)("div",{className:"flex",children:[(0,gs.jsx)("span",{className:"w-36",children:"Datum der Pr\xfcfung:"}),(0,gs.jsx)(ki,{type:"date",value:t.testDate,onChange:e=>n("testDate",e),className:"flex-1"})]}),(0,gs.jsxs)("div",{className:"flex",children:[(0,gs.jsx)("span",{className:"w-36",children:"N\xe4chster Pr\xfcftermin:"}),(0,gs.jsx)(ki,{type:"date",value:t.nextTestDate,onChange:e=>n("nextTestDate",e),className:"flex-1"})]})]}),(0,gs.jsxs)("div",{className:"space-y-2",children:[(0,gs.jsx)(Ni,{field:"noDefectsFound",label:"Es wurden keine M\xe4ngel festgestellt",checked:t.noDefectsFound,onChange:n}),(0,gs.jsx)(Ni,{field:"compliesWithStandards",label:"Die PV\u2011Anlage entspricht den anerkannten Regeln der Elektrotechnik",checked:t.compliesWithStandards,onChange:n})]}),(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-8 mt-8",children:[(0,gs.jsxs)("div",{className:"flex",children:[(0,gs.jsx)("span",{className:"w-28",children:"Ort/Datum:"}),(0,gs.jsx)(ki,{value:t.locationDate,onChange:e=>n("locationDate",e),className:"flex-1"})]}),(0,gs.jsxs)("div",{className:"flex",children:[(0,gs.jsx)("span",{className:"w-40",children:"Unterschrift/Pr\xfcfer:"}),(0,gs.jsx)(ki,{value:t.inspectorSignature,onChange:e=>n("inspectorSignature",e),className:"flex-1"})]})]})]})]})}),Ci=[{field:"entirePVSystem",label:"Gesamte Photovoltaikanlage:"},{field:"followingCircuits",label:"Folgende Stromkreise:"},{field:"pvSystemInspected",label:"Besichtigung nach DIN VDE 0100-600 (IEC 60364-6)"}],Ei=[{field:"dcSystemGeneral",label:"Gleichstromsystem nach DIN VDE 0100 / -712 konstruiert, ausgew\xe4hlt und errichtet"},{field:"dcComponentsRated",label:"Gleichstromkomponenten f\xfcr DC-Betrieb bemessen"},{field:"dcComponentsMaxRated",label:"Komponenten f\xfcr max. Strom & Spannung bemessen"},{field:"protectionClass2",label:"Schutz durch Klasse II oder gleichwertige Isolation"},{field:"pvCablesSelected",label:"PV-Kabel so ausgew\xe4hlt, dass Erd-/Kurzschlussrisiko minimiert ist (712 522.8.1)"},{field:"wiringSystemSelected",label:"Verdrahtungssystem widersteht \xe4u\xdferen Einfl\xfcssen (712 522.8.3)"},{field:"systemsWithoutOvercurrent",label:"Ohne Strang\u2011\xdcberstromschutz: Strangkabel f\xfcr summierten Fehlerstrom ausgelegt (712 433)"},{field:"acDcCablesSeparated",label:"AC- und DC\u2011Kabel physikalisch getrennt"},{field:"systemsWithOvercurrent",label:"Mit Strang\u2011\xdcberstromschutz: korrekt festgelegt (712 433.2)"},{field:"dcDisconnectorInstalled",label:"DC\u2011Lasttrennschalter auf DC\u2011Seite des WR (712 536.2.2)"},{field:"blockingDiodesInstalled",label:"Sperrdioden: R\xfcckspannung \u2265 2\xd7Uo, stc (712 512.1.1)"}],Ai=s.memo(function(e){let{vdeData:t,handleVdeDataChange:n}=e;return(0,gs.jsxs)("div",{className:"page bg-white p-8 min-h-[297mm] w-[210mm] mx-auto",style:{fontSize:"12px"},children:[(0,gs.jsx)(wi,{title:"Pr\xfcfbericht Besichtigung (1)",subtitle:"gem\xe4\xdf VDE 0126\u201123 (DIN EN 62446)",customerName:t.projectName||""}),(0,gs.jsx)(ji,{title:"Besichtigte Stromkreise",children:Ci.map(e=>(0,gs.jsx)(Ni,(0,Le.A)((0,Le.A)({},e),{},{checked:t[e.field],onChange:n}),e.field))}),(0,gs.jsx)(ji,{title:"Konstruktion und Installation des PV\u2011Generators",children:Ei.map(e=>(0,gs.jsx)(Ni,(0,Le.A)((0,Le.A)({},e),{},{checked:t[e.field],onChange:n}),e.field))}),(0,gs.jsx)(ji,{title:"PV\u2011System / Schutz gegen \xdcberspannung / elektrischen Schlag",children:[{field:"inverterSimpleSeparation",label:"Wechselrichter mit einfacher Trennung (AC/DC)"},{field:"alternativeRcdTypeB",label:"Alternative: RCD Typ B im Kreis (712 413.1.1.1.2)"},{field:"wiringLoopsMinimized",label:"Verdrahtungsschleifen m\xf6glichst klein (712 54)"},{field:"pvFrameEquipotential",label:"Rahmen des PV\u2011Generators mit Potentialausgleich"},{field:"equipotentialConductors",label:"PA\u2011Leiter parallel & nahe an DC\u2011Kabeln"}].map(e=>(0,gs.jsx)(Ni,(0,Le.A)((0,Le.A)({},e),{},{checked:t[e.field],onChange:n}),e.field))})]})}),Ii=s.memo(function(e){let{vdeData:t,handleVdeDataChange:n}=e;return(0,gs.jsxs)("div",{className:"page bg-white p-8 min-h-[297mm] w-[210mm] mx-auto",style:{fontSize:"12px"},children:[(0,gs.jsx)(wi,{title:"Pr\xfcfbericht Besichtigung (2)",subtitle:"gem\xe4\xdf VDE 0126\u201123 (DIN EN 62446)",customerName:t.projectName||""}),(0,gs.jsx)(ji,{title:"Besondere Faktoren PV\u2011System \u2013 Wechselstromkreis",children:[{field:"acSideDisconnection",label:"Trennvorrichtungen auf AC\u2011Seite vorhanden"},{field:"switchingDevicesConnected",label:"Trenn-/Schalteinrichtungen: PV an Last\u2011, Netz an Quellen\u2011Seite (712 536.2.2.1)"},{field:"protectionSettingsProgrammed",label:"Schutzeinstellungen des WR gem\xe4\xdf \xf6rtlichen Bestimmungen"}].map(e=>(0,gs.jsx)(Ni,(0,Le.A)((0,Le.A)({},e),{},{checked:t[e.field],onChange:n}),e.field))}),(0,gs.jsx)(ji,{title:"Aufschriften und Kennzeichnung des PV\u2011Systems",children:[{field:"allCircuitsLabeled",label:"Alle Stromkreise/Schutzeinrichtungen/Schalter/Klemmen beschriftet"},{field:"dcJunctionBoxesWarning",label:"DC\u2011Anschlussk\xe4sten mit Warnhinweis (Speisung durch PV, nach Abschaltung ggf. noch Spannung)"},{field:"acMainSwitchLabeled",label:"AC\u2011Haupttrennschalter deutlich beschriftet"},{field:"dualSupplyWarnings",label:"Am Zusammenschaltpunkt Warnhinweis Doppelversorgung"},{field:"schematicDiagramOnSite",label:"Prinzipstromlaufplan vor Ort angebracht"},{field:"protectionSettingsOnSite",label:"WR\u2011Schutzeinstellungen und Installationsdetails vor Ort"},{field:"emergencyShutdownProcedures",label:"Verfahren Notabschaltung vor Ort angegeben"},{field:"signsSecurelyAttached",label:"Zeichen/Aufschriften dauerhaft befestigt"}].map(e=>(0,gs.jsx)(Ni,(0,Le.A)((0,Le.A)({},e),{},{checked:t[e.field],onChange:n}),e.field))}),(0,gs.jsx)(ji,{title:"Allgemeine (mechanische) Installation des PV\u2011Systems",children:[{field:"ventilationBehindPV",label:"Bel\xfcftung hinter PV\u2011Generator (\xdcberhitzung/Brand vermeiden)"},{field:"framesCorrosionResistant",label:"Rahmen/Werkstoffe korrosionsbest\xe4ndig"},{field:"framesProperlySecured",label:"Rahmen ordnungsgem\xe4\xdf befestigt; Dachteile witterungsbest\xe4ndig"},{field:"cableRoutingWeatherproof",label:"Kabelf\xfchrung witterungsbest\xe4ndig"}].map(e=>(0,gs.jsx)(Ni,(0,Le.A)((0,Le.A)({},e),{},{checked:t[e.field],onChange:n}),e.field))})]})}),_i=s.memo(function(e){var t,n,r;let{vdeData:s,handleVdeDataChange:a}=e;return(0,gs.jsxs)("div",{className:"page bg-white p-6 min-h-[297mm] w-[210mm] mx-auto",style:{fontSize:"10px"},children:[(0,gs.jsx)(wi,{title:"Pr\xfcfbericht der elektrischen Pr\xfcfung der AC\u2011Seite der PV\u2011Anlage",subtitle:"gem\xe4\xdf ZVEH\u2011Vorlage",customerName:s.projectName||""}),(0,gs.jsxs)("div",{className:"mb-4",children:[(0,gs.jsxs)("div",{className:"flex items-center mb-2",children:[(0,gs.jsx)("span",{className:"font-bold mr-4",children:"Pr\xfcfung nach:"}),(0,gs.jsx)(Ni,{small:!0,field:"testAccordingVDE0100600",label:"DIN VDE 0100\u2011600",checked:s.testAccordingVDE0100600,onChange:a}),(0,gs.jsx)("div",{className:"w-3"}),(0,gs.jsx)(Ni,{small:!0,field:"testAccordingVDE0105100",label:"DIN VDE 0105\u2011100",checked:s.testAccordingVDE0105100,onChange:a})]}),(0,gs.jsxs)("div",{className:"flex items-center mb-2",children:[(0,gs.jsx)("span",{className:"font-bold mr-4",children:"Netz"}),(0,gs.jsx)(ki,{type:"number",value:null!==(t=s.networkVoltage1)&&void 0!==t?t:230,onChange:e=>a("networkVoltage1",e),className:"w-12 px-1 mr-1 text-xs"}),(0,gs.jsx)("span",{className:"mr-2",children:"/"}),(0,gs.jsx)(ki,{type:"number",value:null!==(n=s.networkVoltage2)&&void 0!==n?n:400,onChange:e=>a("networkVoltage2",e),className:"w-12 px-1 mr-2 text-xs"}),(0,gs.jsx)("span",{className:"mr-4",children:"V"}),(0,gs.jsx)("div",{className:"flex items-center space-x-4",children:["TNC","TNS","TNCS","TT","IT"].map(e=>(0,gs.jsx)(Ni,{small:!0,field:"network".concat(e),label:e.replace("TNCS","TN-C-S").replace("TNC","TN-C").replace("TNS","TN-S"),checked:s["network".concat(e)],onChange:a},e))})]})]}),(0,gs.jsx)(ji,{title:"Besichtigen",children:(0,gs.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)(Ni,{small:!0,field:"selectionOfEquipment",label:"Auswahl der Betriebsmittel",checked:s.selectionOfEquipment,onChange:a}),(0,gs.jsx)(Ni,{small:!0,field:"protectionAgainstDirectContact",label:"Schutz gegen direktes Ber\xfchren",checked:s.protectionAgainstDirectContact,onChange:a}),(0,gs.jsx)(Ni,{small:!0,field:"cablesLinesbusbars",label:"Kabel, Leitungen, Stromschienen",checked:s.cablesLinesbusbars,onChange:a})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)(Ni,{small:!0,field:"circuitIdentification",label:"Kennzeichnung Stromkreis, Betriebsmittel",checked:s.circuitIdentification,onChange:a}),(0,gs.jsx)(Ni,{small:!0,field:"nPeIdentification",label:"Kennzeichnung N\u2011 und PE\u2011Leiter",checked:s.nPeIdentification,onChange:a}),(0,gs.jsx)(Ni,{small:!0,field:"protectionMonitoringDevices",label:"Schutz- und \xdcberwachungseinrichtungen",checked:s.protectionMonitoringDevices,onChange:a})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)(Ni,{small:!0,field:"mainEquipotentialBonding",label:"Hauptpotentialausgleich",checked:s.mainEquipotentialBonding,onChange:a}),(0,gs.jsx)(Ni,{small:!0,field:"conductorConnections",label:"Leiterverbindung",checked:s.conductorConnections,onChange:a}),(0,gs.jsx)(Ni,{small:!0,field:"isolatingDevices",label:"Trenn- und Schaltger\xe4te",checked:s.isolatingDevices,onChange:a})]})]})}),(0,gs.jsx)(ji,{title:"Erproben",children:(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-8",children:[(0,gs.jsx)(Ni,{small:!0,field:"systemFunctionTest",label:"Funktionspr\xfcfung der Anlage",checked:s.systemFunctionTest,onChange:a}),(0,gs.jsx)(Ni,{small:!0,field:"rcdTest",label:"FI\u2011Schutzschalter (RCD) / wenn vorhanden",checked:s.rcdTest,onChange:a})]})}),(0,gs.jsx)(ji,{title:"Messen",children:(0,gs.jsxs)("table",{className:"w-full border-collapse border border-gray-400 text-xs",children:[(0,gs.jsxs)("thead",{children:[(0,gs.jsxs)("tr",{className:"bg-gray-100",children:[(0,gs.jsx)("th",{className:"border p-1 text-left",colSpan:"2",children:"Stromkreis"}),(0,gs.jsx)("th",{className:"border p-1 text-left",colSpan:"2",children:"Leitung/Kabel"}),(0,gs.jsx)("th",{className:"border p-1 text-left",colSpan:"3",children:"\xdcberstrom\u2011Schutzeinrichtung"}),(0,gs.jsx)("th",{className:"border p-1 text-left",children:"Riso (M\u03a9)"}),(0,gs.jsx)("th",{className:"border p-1 text-left",colSpan:"5",children:"Fehlerstrom\u2011Schutzeinrichtung (RCD)"})]}),(0,gs.jsxs)("tr",{className:"bg-gray-50",children:[(0,gs.jsx)("th",{className:"border p-1 text-xs",children:"Nr."}),(0,gs.jsx)("th",{className:"border p-1 text-xs",children:"Zielbezeichnung"}),(0,gs.jsx)("th",{className:"border p-1 text-xs",children:"Typ"}),(0,gs.jsx)("th",{className:"border p-1 text-xs",children:"Leiter Anzahl \xd7 Quers. (mm\xb2)"}),(0,gs.jsx)("th",{className:"border p-1 text-xs",children:"Art"}),(0,gs.jsx)("th",{className:"border p-1 text-xs",children:"In (A)"}),(0,gs.jsx)("th",{className:"border p-1 text-xs",children:"Zs (\u03a9)"}),(0,gs.jsx)("th",{className:"border p-1 text-xs",children:(0,gs.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,gs.jsx)(Ni,{small:!0,field:"measurementWithoutLoad",label:"ohne",checked:s.measurementWithoutLoad,onChange:a}),(0,gs.jsx)(Ni,{small:!0,field:"measurementWithLoad",label:"mit Verbraucher",checked:s.measurementWithLoad,onChange:a})]})}),(0,gs.jsx)("th",{className:"border p-1 text-xs",children:"In (A)"}),(0,gs.jsx)("th",{className:"border p-1 text-xs",children:"I\u0394n (mA)"}),(0,gs.jsx)("th",{className:"border p-1 text-xs",children:"Imess (mA) (I\u0394n)"}),(0,gs.jsx)("th",{className:"border p-1 text-xs",children:"Ausl. Zeit (ms) tA"}),(0,gs.jsx)("th",{className:"border p-1 text-xs",children:"Umess (V)"})]})]}),(0,gs.jsx)("tbody",{children:Array.from({length:12},(e,t)=>{var n,r,i,l,o,c,u,d,h;const m=((e,t)=>{let n={nr:"",designation:"",cableType:"",cableInfo:"",breakerType:"",breakerCurrent:"",rcdIn:"",rcdIdn:""};const r=e.materials,s=e.projectConfig||{},a=s.inverters||[],i=a.length;if(t<i){const e=a[t];if(n.nr=String(t+1),n.designation="".concat((null===e||void 0===e?void 0:e.description)||"WR","_").concat(t),null!==e&&void 0!==e&&e.recommendedCable&&r){const t=r.find(t=>t.id===e.recommendedCable),s=(null===t||void 0===t?void 0:t.specifications)||{},a=s.hRDtjnTqWu1tuPhqg1Ql||"",i=s.qZP1lmJFLNXMyd9pYvcw||"",l=s.Yn0WBipreNBAZnaZWWJX||"";n.cableType=l||"",n.cableInfo=a&&i?"".concat(a," x ").concat(i):""}if(null!==e&&void 0!==e&&e.recommendedBreaker&&r){const t=r.find(t=>t.id===e.recommendedBreaker),s=(null===t||void 0===t?void 0:t.specifications)||{};n.breakerType=s.r2lRsnr7SZ5xxGzmcLts||"",n.breakerCurrent=s["55ZFekLPfQThKJO0xwFn"]||""}return n}if(s.wallbox){const e=i,a=s.wallbox.quantity||1;if(t>=e&&t<e+a){const a=t-e,i=s.wallbox;if(n.nr=String(t+1),n.designation="".concat((null===i||void 0===i?void 0:i.description)||"Wallbox","_").concat(a),null!==i&&void 0!==i&&i.recommendedCable&&r){const e=r.find(e=>e.id===i.recommendedCable),t=(null===e||void 0===e?void 0:e.specifications)||{},s=t.hRDtjnTqWu1tuPhqg1Ql||"",a=t.qZP1lmJFLNXMyd9pYvcw||"",l=t.Yn0WBipreNBAZnaZWWJX||"";n.cableType=l||"",n.cableInfo=s&&a?"".concat(s," x ").concat(a):""}if(null!==i&&void 0!==i&&i.recommendedBreaker&&r){const e=r.find(e=>e.id===i.recommendedBreaker),t=(null===e||void 0===e?void 0:e.specifications)||{};n.breakerType=t.r2lRsnr7SZ5xxGzmcLts||"",n.breakerCurrent=t["55ZFekLPfQThKJO0xwFn"]||""}if(null!==i&&void 0!==i&&i.recommendedRCD&&r){const e=r.find(e=>e.id===i.recommendedRCD),t=(null===e||void 0===e?void 0:e.specifications)||{};n.rcdIn=t.xeEG32si5hPDky1bsavj||"",n.rcdIdn=t.CAwoyaTvY5SyVGTJPHN9||""}return n}}return n})(s,t);return(0,gs.jsxs)("tr",{children:[(0,gs.jsx)("td",{className:"border p-1 h-6",children:(0,gs.jsx)("input",{className:"w-full bg-transparent text-xs text-center",value:null!==(n=s["ac_row_".concat(t,"_nr")])&&void 0!==n?n:m.nr,onChange:e=>a("ac_row_".concat(t,"_nr"),e.target.value)})}),(0,gs.jsx)("td",{className:"border p-1 h-6",children:(0,gs.jsx)("input",{className:"w-full bg-transparent text-xs",value:null!==(r=s["ac_row_".concat(t,"_designation")])&&void 0!==r?r:m.designation,onChange:e=>a("ac_row_".concat(t,"_designation"),e.target.value)})}),(0,gs.jsx)("td",{className:"border p-1 h-6",children:(0,gs.jsx)("input",{className:"w-full bg-transparent text-xs",value:null!==(i=s["ac_row_".concat(t,"_cableType")])&&void 0!==i?i:m.cableType,onChange:e=>a("ac_row_".concat(t,"_cableType"),e.target.value)})}),(0,gs.jsx)("td",{className:"border p-1 h-6",children:(0,gs.jsx)("input",{className:"w-full bg-transparent text-xs",value:null!==(l=s["ac_row_".concat(t,"_cableInfo")])&&void 0!==l?l:m.cableInfo,onChange:e=>a("ac_row_".concat(t,"_cableInfo"),e.target.value)})}),(0,gs.jsx)("td",{className:"border p-1 h-6",children:(0,gs.jsx)("input",{className:"w-full bg-transparent text-xs",value:null!==(o=s["ac_row_".concat(t,"_breakerType")])&&void 0!==o?o:m.breakerType,onChange:e=>a("ac_row_".concat(t,"_breakerType"),e.target.value)})}),(0,gs.jsx)("td",{className:"border p-1 h-6",children:(0,gs.jsx)("input",{className:"w-full bg-transparent text-xs",value:null!==(c=s["ac_row_".concat(t,"_breakerCurrent")])&&void 0!==c?c:m.breakerCurrent,onChange:e=>a("ac_row_".concat(t,"_breakerCurrent"),e.target.value)})}),(0,gs.jsx)("td",{className:"border p-1 h-6",children:(0,gs.jsx)("input",{className:"w-full bg-transparent text-xs",value:null!==(u=s["ac_row_".concat(t,"_zs")])&&void 0!==u?u:"",onChange:e=>a("ac_row_".concat(t,"_zs"),e.target.value)})}),(0,gs.jsx)("td",{className:"border p-1 h-6"}),(0,gs.jsx)("td",{className:"border p-1 h-6",children:(0,gs.jsx)("input",{className:"w-full bg-transparent text-xs",value:null!==(d=s["ac_row_".concat(t,"_rcdIn")])&&void 0!==d?d:m.rcdIn,onChange:e=>a("ac_row_".concat(t,"_rcdIn"),e.target.value)})}),(0,gs.jsx)("td",{className:"border p-1 h-6",children:(0,gs.jsx)("input",{className:"w-full bg-transparent text-xs",value:null!==(h=s["ac_row_".concat(t,"_rcdIdn")])&&void 0!==h?h:m.rcdIdn,onChange:e=>a("ac_row_".concat(t,"_rcdIdn"),e.target.value)})}),["rcdImess","rcdTa","uMess"].map((e,n)=>{var r;return(0,gs.jsx)("td",{className:"border p-1 h-6",children:(0,gs.jsx)("input",{className:"w-full bg-transparent text-xs",value:null!==(r=s["ac_row_".concat(t,"_").concat(e)])&&void 0!==r?r:"",onChange:n=>a("ac_row_".concat(t,"_").concat(e),n.target.value)})},n)})]},t)})})]})}),(0,gs.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-8",children:[(0,gs.jsxs)("div",{className:"flex items-center",children:[(0,gs.jsx)("span",{className:"text-xs mr-4",children:"Durchg\xe4ngigkeit Schutzleiter:"}),(0,gs.jsx)("span",{className:"text-xs mr-2",children:"< 1 \u03a9"}),(0,gs.jsx)("input",{type:"checkbox",checked:!!s.protectiveConductorContinuity,onChange:e=>a("protectiveConductorContinuity",e.target.checked),className:"mr-4"}),(0,gs.jsx)("span",{className:"text-xs mr-4",children:"Erdungswiderstand Re"}),(0,gs.jsx)("input",{type:"text",value:null!==(r=s.earthingResistance)&&void 0!==r?r:"",onChange:e=>a("earthingResistance",e.target.value),className:"w-16 border border-gray-400 px-1 text-xs mr-1 bg-transparent"}),(0,gs.jsx)("span",{className:"text-xs",children:"\u03a9"})]}),(0,gs.jsxs)("div",{className:"flex items-center",children:[(0,gs.jsx)("span",{className:"text-xs mr-4",children:"Durchg\xe4ngigkeit Potentialausgleich:"}),(0,gs.jsx)("span",{className:"text-xs",children:"(< 1 \u03a9 nachgewiesen)"})]})]})]})}),Ti=s.memo(function(e){var t,n,r,a;let{vdeData:i,handleVdeDataChange:l,inverterData:o,inverterIndex:c,stringNames:u=[],pageNumber:d=1}=e;const h=9*(d-1),m=e=>i["inverter".concat(c,"_").concat(e)]||"",p=e=>((e,t)=>{var n,r;const s=null===e||void 0===e||null===(n=e.projectConfig)||void 0===n||null===(r=n.modules)||void 0===r?void 0:r.materialID;return s?bi(e.materials,s,t):""})(i,e),f="".concat((null===o||void 0===o?void 0:o.type)||(null===(t=vi(i.materials,null===o||void 0===o?void 0:o.materialID))||void 0===t?void 0:t.type)||"WR","_").concat(c),g=(0,s.useMemo)(()=>[{label:"Isc (STC)",field:"stringIsc",spec:fi.ISC},{label:"Uoc (STC)",field:"stringUoc",spec:fi.UOC}],[]),x=(0,s.useMemo)(()=>[{label:"Isolations\xfcberwachung",field:"isolationMonitoring",spec:gi.ISO_MON},{label:"DC\u2011\xdcberspannungsschutz",field:"dcOvervoltageProtection",spec:gi.SPD_DC},{label:"AC\u2011\xdcberspannungsschutz",field:"acOvervoltageProtection",spec:gi.SPD_AC},{label:"Fehlerstrom\xfcberwachung",field:"residualCurrentMonitoring",spec:gi.RCM},{label:"AC\u2011\xdcberstromschutz",field:"acOvercurrentProtection",spec:gi.AC_OC},{label:"AC\u2011Kurzschlussschutz",field:"acShortCircuitProtection",spec:gi.AC_SC},{label:"Lichtbogenerkennung",field:"arcFaultDetection",spec:gi.AFCI}],[]),y=(0,s.useMemo)(()=>[{label:"SPD Typ",field:"spdType",spec:xi.SPD_TYPE},{label:"Bemessungsstrom (A)",field:"ratedCurrent",spec:xi.RATED_CURRENT},{label:"Bemessungsspannung (V)",field:"ratedVoltage",spec:xi.RATED_VOLTAGE}],[]),v=(0,s.useMemo)(()=>[{label:"Typ",field:"wiringType",spec:yi.WIRING_TYPE},{label:"Phasenleiter (mm\xb2)",field:"phaseLeader",spec:yi.PHASE_LEADER},{label:"Erdleiter (mm\xb2)",field:"earthLeader",spec:yi.EARTH_LEADER}],[]),b=(0,s.useMemo)(()=>[{label:"Uoc (V)",field:"measurementUoc"},{label:"Isc (A)",field:"measurementIsc"}],[]),w=(0,s.useMemo)(()=>[{label:"Pr\xfcfspannung",field:"testVoltage"},{label:"(+) & (\u2013) Elektrode Erde (M\u03a9)",field:"positiveNegativeElectrode"},{label:"opt. (+) Elektrode Erde (M\u03a9)",field:"optionalPositiveElectrode"},{label:"opt. (\u2013) Elektrode Erde (M\u03a9)",field:"optionalNegativeElectrode"}],[]);return(0,gs.jsxs)("div",{className:"page bg-white p-6 min-h-[297mm] w-[210mm] mx-auto",style:{fontSize:"10px"},children:[(0,gs.jsx)(wi,{title:"Pr\xfcfbericht der elektrischen Pr\xfcfung des PV\u2011Generators",subtitle:"gem\xe4\xdf VDE 0126\u201123 (DIN EN 62446)",customerName:i.projectName||""}),(0,gs.jsx)("div",{className:"mb-6",children:(0,gs.jsx)("table",{className:"w-full border-collapse border border-gray-400 text-xs",children:(0,gs.jsxs)("tbody",{children:[(0,gs.jsxs)("tr",{children:[(0,gs.jsx)("td",{className:"border p-2 font-semibold bg-gray-100 w-1/3",children:"Marke/ Modell des Wechselrichters"}),(0,gs.jsx)("td",{className:"border p-2",colSpan:2,children:(0,gs.jsx)("input",{type:"text",value:(null===o||void 0===o?void 0:o.description)||"".concat(null!==(n=null===o||void 0===o?void 0:o.manufacturer)&&void 0!==n?n:""," ").concat(null!==(r=null===o||void 0===o?void 0:o.type)&&void 0!==r?r:"").trim()||i["inverterBrandModel_".concat(c)]||"",onChange:e=>l("inverterBrandModel_".concat(c),e.target.value),className:"w-full bg-transparent"})})]}),(0,gs.jsxs)("tr",{children:[(0,gs.jsx)("td",{className:"border p-2 font-semibold bg-gray-100",children:"Wechselrichter Typenkennzeichnung"}),(0,gs.jsx)("td",{className:"border p-2",colSpan:2,children:(0,gs.jsx)("input",{type:"text",value:f,onChange:e=>l("inverterTypeDesignation_".concat(c),e.target.value),className:"w-full bg-transparent"})})]}),(0,gs.jsxs)("tr",{children:[(0,gs.jsx)("td",{className:"border p-2 font-semibold bg-gray-100",children:"Bestimmungsgem\xe4\xdfe WR\u2011Funktion"}),(0,gs.jsx)("td",{className:"border p-2 text-center",colSpan:2,children:(0,gs.jsx)("input",{type:"checkbox",checked:null===(a=i["inverterProperFunction_".concat(c)])||void 0===a||a,onChange:e=>l("inverterProperFunction_".concat(c),e.target.checked),className:"mr-1"})})]})]})})}),(0,gs.jsx)("div",{className:"mb-4",children:(0,gs.jsxs)("table",{className:"w-full border-collapse border border-gray-400 text-xs",children:[(0,gs.jsx)("thead",{children:(0,gs.jsxs)("tr",{className:"bg-gray-100",children:[(0,gs.jsx)("th",{className:"border p-1 text-left font-semibold w-32",colSpan:2,children:"Strang"}),u.map((e,t)=>(0,gs.jsx)("th",{className:"border p-1 text-center w-15",title:e,children:e},t))]})}),(0,gs.jsxs)("tbody",{children:[(0,gs.jsxs)("tr",{children:[(0,gs.jsx)("td",{className:"border p-1 font-semibold bg-gray-50 w-20",children:"PV\u2011Generator"}),(0,gs.jsx)("td",{className:"border p-1 text-xs w-16",children:"Anzahl"}),u.map((e,t)=>{var n,r,s,a,u,d,m;const p=h+t,f=null!==(n=null!==(r=null===o||void 0===o||null===(s=o.strings)||void 0===s||null===(a=s[p])||void 0===a?void 0:a.moduleCount)&&void 0!==r?r:null===(u=i.projectConfig)||void 0===u||null===(d=u.modules)||void 0===d?void 0:d.totalQuantity)&&void 0!==n?n:"";return(0,gs.jsx)("td",{className:"border p-1",children:(0,gs.jsx)("input",{type:"number",value:null!==(m=i["stringCount_".concat(c,"_").concat(p+1)])&&void 0!==m?m:f,onChange:e=>l("stringCount_".concat(c,"_").concat(p+1),e.target.value),className:"w-full bg-transparent text-center text-xs"})},t)})]}),g.map((e,t)=>(0,gs.jsxs)("tr",{children:[0===t&&(0,gs.jsx)("td",{className:"border p-1 font-semibold bg-gray-50 w-20",rowSpan:g.length,children:"PV\u2011Generator\u2011Parameter"}),(0,gs.jsx)("td",{className:"border p-1 text-xs w-16",children:e.label}),u.map((t,n)=>{var r;const s=h+n;return(0,gs.jsx)("td",{className:"border p-1",children:(0,gs.jsx)("input",{type:"number",value:null!==(r=i["".concat(e.field,"_").concat(c,"_").concat(s+1)])&&void 0!==r?r:p(e.spec),onChange:t=>l("".concat(e.field,"_").concat(c,"_").concat(s+1),t.target.value),className:"w-full bg-transparent text-center text-xs"})},n)})]},e.field)),x.map((e,t)=>(0,gs.jsxs)("tr",{children:[0===t&&(0,gs.jsx)("td",{className:"border p-1 font-semibold bg-gray-50",rowSpan:x.length,children:"Schutzeinrichtung (WR)"}),(0,gs.jsx)("td",{className:"border p-1 text-xs",children:e.label}),u.map((t,n)=>{var r;const s=h+n;return(0,gs.jsx)("td",{className:"border p-1",children:(0,gs.jsx)("input",{type:"text",value:null!==(r=i["string".concat(e.field,"_").concat(c,"_").concat(s+1)])&&void 0!==r?r:m(e.field),onChange:t=>l("string".concat(e.field,"_").concat(c,"_").concat(s+1),t.target.value),className:"w-full bg-transparent text-center text-xs"})},n)})]},e.field)),y.map((e,t)=>(0,gs.jsxs)("tr",{children:[0===t&&(0,gs.jsx)("td",{className:"border p-1 font-semibold bg-gray-50",rowSpan:y.length,children:"Schutzeinrichtung (Zweigsicherung)"}),(0,gs.jsx)("td",{className:"border p-1 text-xs",children:e.label}),u.map((t,n)=>{var r;const s=h+n;return(0,gs.jsx)("td",{className:"border p-1",children:(0,gs.jsx)("input",{type:"text",value:null!==(r=i["string".concat(e.field,"_").concat(c,"_").concat(s+1)])&&void 0!==r?r:m(e.field)||"-",onChange:t=>l("string".concat(e.field,"_").concat(c,"_").concat(s+1),t.target.value),className:"w-full bg-transparent text-center text-xs"})},n)})]},e.field)),v.map((e,t)=>(0,gs.jsxs)("tr",{children:[0===t&&(0,gs.jsx)("td",{className:"border p-1 font-semibold bg-gray-50",rowSpan:v.length,children:"Verdrahtung"}),(0,gs.jsx)("td",{className:"border p-1 text-xs",children:e.label}),u.map((t,n)=>{const r=h+n,s="string".concat(e.field,"_").concat(c,"_").concat(r+1),a="inverter".concat(c,"_").concat(e.field),o=i[s]||i[a]||m(e.field)||"";return(0,gs.jsx)("td",{className:"border p-1",children:(0,gs.jsx)("input",{type:"text",value:o,onChange:e=>l(s,e.target.value),className:"w-full bg-transparent text-center text-xs"})},n)})]},e.field)),b.map((e,t)=>(0,gs.jsxs)("tr",{children:[0===t&&(0,gs.jsx)("td",{className:"border p-1 font-semibold bg-gray-50",rowSpan:b.length,children:"Erprobung und Messung des Stranges"}),(0,gs.jsx)("td",{className:"border p-1 text-xs",children:e.label}),u.map((t,n)=>{var r;const s=h+n;return(0,gs.jsx)("td",{className:"border p-1",children:(0,gs.jsx)("input",{type:"text",value:null!==(r=i["string".concat(e.field,"_").concat(c,"_").concat(s+1)])&&void 0!==r?r:"",onChange:t=>l("string".concat(e.field,"_").concat(c,"_").concat(s+1),t.target.value),className:"w-full bg-transparent text-center text-xs"})},n)})]},e.field)),(0,gs.jsxs)("tr",{children:[(0,gs.jsx)("td",{className:"border p-1 font-semibold bg-gray-50",colSpan:2,children:"Kontrolle der Polarit\xe4t"}),u.map((e,t)=>{var n;const r=h+t;return(0,gs.jsx)("td",{className:"border p-1",children:(0,gs.jsx)("input",{type:"text",value:null!==(n=i["stringPolarityControl_".concat(c,"_").concat(r+1)])&&void 0!==n?n:"i.O",onChange:e=>l("stringPolarityControl_".concat(c,"_").concat(r+1),e.target.value),className:"w-full bg-transparent text-center text-xs"})},t)})]}),w.map((e,t)=>(0,gs.jsxs)("tr",{children:[0===t&&(0,gs.jsx)("td",{className:"border p-1 font-semibold bg-gray-50",rowSpan:w.length,children:"Isolationswiderstand des Stranges"}),(0,gs.jsx)("td",{className:"border p-1 text-xs",children:e.label}),u.map((t,n)=>{var r;const s=h+n,a="optionalPositiveElectrode"===e.field||"optionalNegativeElectrode"===e.field;return(0,gs.jsx)("td",{className:"border p-1",children:a?(0,gs.jsx)("div",{className:"w-full text-center text-xs",children:"-"}):(0,gs.jsx)("input",{type:"text",value:null!==(r=i["string".concat(e.field,"_").concat(c,"_").concat(s+1)])&&void 0!==r?r:"testVoltage"===e.field?"1000":"",onChange:t=>l("string".concat(e.field,"_").concat(c,"_").concat(s+1),t.target.value),className:"w-full bg-transparent text-center text-xs"})},n)})]},e.field))]})]})})]})}),Di=s.memo(function(e){let{vdeData:t,handleVdeDataChange:n}=e;const r=(0,s.useMemo)(()=>{var e,n;const r=[];if((null!==(e=null===(n=t.projectConfig)||void 0===n?void 0:n.inverters)&&void 0!==e?e:[]).forEach((e,t)=>{for(let a=0;a<(null!==(n=e.quantity)&&void 0!==n?n:0);a++){var n,s;r.push((0,Le.A)((0,Le.A)({},e),{},{originalIndex:t,instanceIndex:a,globalIndex:r.length,strings:null!==(s=e.strings)&&void 0!==s?s:[]}))}}),0===r.length){var s,a;const e=parseInt(null!==(s=t.inverterCount)&&void 0!==s?s:"1",10)||1,n=null!==(a=t.strings)&&void 0!==a?a:[];for(let s=0;s<e;s++)r.push({type:t["inverterType".concat(s+1)]||t.inverterType||"Unbekannt",manufacturer:t.inverterManufacturer||"Unbekannt",quantity:1,originalIndex:s,instanceIndex:0,globalIndex:s,strings:n.length?n:[{stringName:"String 1"}]})}return r},[t]),a=[];return r.forEach((e,r)=>{var s;const i=(null!==(s=e.strings)&&void 0!==s?s:[]).map(e=>e.stringName||e.name||"String"),l=i.length,o=Math.max(1,Math.ceil(l/9));for(let c=1;c<=o;c++){const s=9*(c-1),o=Math.min(s+9,l);a.push((0,gs.jsx)(Ti,{vdeData:t,handleVdeDataChange:n,inverterData:e,inverterIndex:r,stringNames:i.slice(s,o),pageNumber:c},"inv-".concat(r,"-p-").concat(c)))}}),(0,gs.jsx)(gs.Fragment,{children:a})}),Pi=[Si,Ai,Ii,_i,Di],Mi=["Anlagen\xfcbersicht","Besichtigung (1)","Besichtigung (2)","AC\u2011Seite Pr\xfcfung","PV\u2011Generator Pr\xfcfung"],Ri={address:"",customerName:"",projectName:"",contractorName:"",inspectorName:"Matteo Stockmann",installedPower:"",moduleCount:"",moduleType:"",modulePmaxDC:"",moduleUoc:"",moduleIsc:"",moduleUmpp:"",inverterCount:"",inverterType:"",inverterManufacturer:"",inverterPmaxDC:"",inverterPnomAC:"",inverterPmaxAC:"",commissioningDate:"",testEquipment:"Benning IT130 SN23351174 /Benning PV2 SN09R-0875 / Benning SUN2 SN40Q-0981",initialTest:!0,repeatTest:!1,testDate:"",nextTestDate:"",noDefectsFound:!0,compliesWithStandards:!0,locationDate:"",inspectorSignature:"",entirePVSystem:!0,followingCircuits:!0,pvSystemInspected:!0,dcSystemGeneral:!0,dcComponentsRated:!0,dcComponentsMaxRated:!0,protectionClass2:!0,pvCablesSelected:!0,wiringSystemSelected:!0,systemsWithoutOvercurrent:!0,acDcCablesSeparated:!0,systemsWithOvercurrent:!0,dcDisconnectorInstalled:!0,blockingDiodesInstalled:!0,inverterSimpleSeparation:!0,alternativeRcdTypeB:!1,wiringLoopsMinimized:!0,pvFrameEquipotential:!0,equipotentialConductors:!0,acSideDisconnection:!0,switchingDevicesConnected:!0,protectionSettingsProgrammed:!0,allCircuitsLabeled:!0,dcJunctionBoxesWarning:!0,acMainSwitchLabeled:!0,dualSupplyWarnings:!0,schematicDiagramOnSite:!0,protectionSettingsOnSite:!0,emergencyShutdownProcedures:!0,signsSecurelyAttached:!0,ventilationBehindPV:!0,framesCorrosionResistant:!0,framesProperlySecured:!0,cableRoutingWeatherproof:!0,testAccordingVDE0100600:!0,testAccordingVDE0105100:!1,networkVoltage1:230,networkVoltage2:400,networkTNC:!1,networkTNS:!1,networkTNCS:!1,networkTT:!1,networkIT:!1,selectionOfEquipment:!0,protectionAgainstDirectContact:!0,cablesLinesbusbars:!0,circuitIdentification:!0,nPeIdentification:!0,protectionMonitoringDevices:!0,mainEquipotentialBonding:!0,conductorConnections:!0,isolatingDevices:!0,systemFunctionTest:!0,rcdTest:!0,protectiveConductorContinuity:!0,earthingResistance:"",measurementWithoutLoad:!0,measurementWithLoad:!1,projectConfig:void 0,materials:void 0,strings:[]},Oi=e=>{let{isOpen:t,onClose:n,protocol:r=null,hideActions:a=!1}=e;const{materials:i}=Cs(),{showNotification:o}=Os(),[c,u]=(0,s.useState)(1),[d,h]=(0,s.useState)(!1),[m,p]=(0,s.useState)(Ri),[f,g]=(0,s.useState)({}),[x,y]=(0,s.useState)(null);(0,s.useEffect)(()=>{if(!t)return;const e=document.createElement("div");return e.id="vde-print-root",e.style.display="none",document.body.appendChild(e),y(e),()=>{document.body.removeChild(e),y(null)}},[t]),(0,s.useEffect)(()=>{var e,n,s,a,l,o,c;if(!t)return;if(null!==r&&void 0!==r&&r.vdeData)return void p(e=>(0,Le.A)((0,Le.A)({},e),r.vdeData));const u=r||{},d=(0,Le.A)({},Ri);if(d.customerName=u.customerName||"",d.address=u.address||"",d.projectName=u.projectName||"",null!==(e=u.modules)&&void 0!==e&&e.materialID&&Array.isArray(i)){var h,m;const e=i.find(e=>e.id===u.modules.materialID),t=t=>{var n,r,s;return null===(n=null!==(r=null===e||void 0===e||null===(s=e.specifications)||void 0===s?void 0:s[t])&&void 0!==r?r:"")||void 0===n?void 0:n.toString().replace(",",".")};d.moduleType=(null===(h=u.modules)||void 0===h?void 0:h.description)||"",d.moduleCount=(null===(m=u.modules)||void 0===m?void 0:m.totalQuantity)||"",d.modulePmaxDC=t(fi.PMAX_DC),d.moduleUoc=t(fi.UOC),d.moduleIsc=t(fi.ISC),d.moduleUmpp=t(fi.UMPP);const n=parseFloat(d.modulePmaxDC||"0"),r=parseFloat(String(d.moduleCount||"0"));n&&r&&(d.installedPower=(n*r/1e3).toFixed(2))}if(Array.isArray(u.inverters)){d.inverterCount=u.inverters.reduce((e,t)=>e+(t.quantity||0),0)||"";const e=new Set;u.inverters.filter(t=>!e.has(t.materialID)&&(e.add(t.materialID),!0)).forEach((e,t)=>{const n=t+1;if(d["inverterType".concat(n)]=e.description||"",e.materialID&&Array.isArray(i)){const r=i.find(t=>t.id===e.materialID),s=e=>{var t,n,s;return null===(t=null!==(n=null===r||void 0===r||null===(s=r.specifications)||void 0===s?void 0:s[e])&&void 0!==n?n:"")||void 0===t?void 0:t.toString().replace(",",".")};d["inverterPmaxDC".concat(n)]=s(gi.PMAX_DC),d["inverterPnomAC".concat(n)]=s(gi.PNOM_AC),d["inverterPmaxAC".concat(n)]=s(gi.PMAX_AC),d["inverter".concat(t,"_isolationMonitoring")]=s(gi.ISO_MON),d["inverter".concat(t,"_dcOvervoltageProtection")]=s(gi.SPD_DC),d["inverter".concat(t,"_acOvervoltageProtection")]=s(gi.SPD_AC),d["inverter".concat(t,"_residualCurrentMonitoring")]=s(gi.RCM),d["inverter".concat(t,"_acOvercurrentProtection")]=s(gi.AC_OC),d["inverter".concat(t,"_acShortCircuitProtection")]=s(gi.AC_SC),d["inverter".concat(t,"_arcFaultDetection")]=s(gi.AFCI)}})}if(null!==u&&void 0!==u&&null!==(n=u.generatoranschlusskasten)&&void 0!==n&&n.materialID&&Array.isArray(i)){const e=i.find(e=>e.id===u.generatoranschlusskasten.materialID);if(null!==e&&void 0!==e&&e.specifications){const t=t=>{var n,r;return null===(n=null!==(r=e.specifications[t])&&void 0!==r?r:"")||void 0===n?void 0:n.toString().replace(",",".")};if(Array.isArray(u.inverters)){u.inverters.filter((e,t,n)=>n.findIndex(t=>t.materialID===e.materialID)===t).forEach((e,n)=>{d["inverter".concat(n,"_spdType")]=t(xi.SPD_TYPE),d["inverter".concat(n,"_ratedCurrent")]=t(xi.RATED_CURRENT),d["inverter".concat(n,"_ratedVoltage")]=t(xi.RATED_VOLTAGE)})}}}if(null!==u&&void 0!==u&&null!==(s=u.pvCables)&&void 0!==s&&s.materialID&&Array.isArray(i)){const e=i.find(e=>e.id===u.pvCables.materialID);if(null!==e&&void 0!==e&&e.specifications){const t=t=>{var n,r;return null===(n=null!==(r=e.specifications[t])&&void 0!==r?r:"")||void 0===n?void 0:n.toString().replace(",",".")};if(Array.isArray(u.inverters)){u.inverters.filter((e,t,n)=>n.findIndex(t=>t.materialID===e.materialID)===t).forEach((e,n)=>{d["inverter".concat(n,"_wiringType")]=t(yi.WIRING_TYPE),d["inverter".concat(n,"_phaseLeader")]=t(yi.PHASE_LEADER)})}}}if(null!==u&&void 0!==u&&null!==(a=u.potentialausgleichHESUK)&&void 0!==a&&a.materialID&&Array.isArray(i)){const e=i.find(e=>e.id===u.potentialausgleichHESUK.materialID);if(null!==e&&void 0!==e&&e.specifications){const t=t=>{var n,r;return null===(n=null!==(r=e.specifications[t])&&void 0!==r?r:"")||void 0===n?void 0:n.toString().replace(",",".")};if(Array.isArray(u.inverters)){u.inverters.filter((e,t,n)=>n.findIndex(t=>t.materialID===e.materialID)===t).forEach((e,n)=>{d["inverter".concat(n,"_earthLeader")]=t(yi.EARTH_LEADER)})}}}d.strings=(null===u||void 0===u||null===(l=u.inverters)||void 0===l||null===(o=l[0])||void 0===o||null===(c=o.strings)||void 0===c?void 0:c.map((e,t)=>{var n;return{id:t+1,name:e.stringName||"String ".concat(t+1),moduleCount:(null===(n=u.modules)||void 0===n?void 0:n.totalQuantity)||0}}))||[],d.projectConfig=u,d.materials=i,p(d)},[t,r,i]);const v=(e,t)=>{p(n=>(0,Le.A)((0,Le.A)({},n),{},{[e]:t}))},b=(0,s.useMemo)(()=>Pi[Math.min(Math.max(c,1),Pi.length)-1],[c]);return t?(0,gs.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 !m-0 !top-0",children:[(0,gs.jsx)("style",{children:"\n        @media print {\n          /* 1) Keine doppelten R\xe4nder mehr auf @page */\n          @page { size: A4 portrait; margin: 0; }\n\n          /* 2) Nur den Portal-Root drucken (wie zuvor) */\n          body > *:not(#vde-print-root) { display: none !important; }\n          #vde-print-root { display: block !important; }\n\n          /* 3) A4-Layout: Padding = Seitenrand, H\xf6he exakt A4 (inkl. Padding) */\n          #vde-print-root .page {\n            width: 210mm !important;\n            min-height: calc(297mm - 0.1mm) !important; /* kleine Toleranz gegen Rundungsfehler */\n            padding: 12mm !important;                   /* Innenrand statt @page margin */\n            box-sizing: border-box !important;          /* Padding in H\xf6he mitrechnen */\n            margin: 0 auto !important;\n            break-after: page;                          /* moderner Umbruch */\n          }\n          #vde-print-root .page:last-child { break-after: auto; }\n\n          /* 4) Tailwind-Padding/-H\xf6hen \xfcberschreiben, damit nichts doppelt z\xe4hlt */\n          #vde-print-root .page.p-6,\n          #vde-print-root .page.p-8 { padding: 12mm !important; }\n          \n          /* 5) Typografie-Margins zur\xfccksetzen */\n          #vde-print-root h1, \n          #vde-print-root h2, \n          #vde-print-root h3 { margin-top: 0; }\n        }\n      "}),(0,gs.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto no-print",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,gs.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[(0,gs.jsx)(di,{className:"h-5 w-5 mr-2"}),r?"VDE\u2011Protokoll bearbeiten":"VDE\u2011Protokoll erstellen"]}),(0,gs.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,gs.jsx)(Ms,{className:"h-6 w-6"})})]}),(0,gs.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-gray-50",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Seite ",c," von ",Pi.length,":"]}),(0,gs.jsx)("span",{className:"text-sm text-gray-600",children:Mi[c-1]})]}),(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsxs)("button",{onClick:()=>u(e=>Math.max(1,e-1)),disabled:1===c,className:"px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:[(0,gs.jsx)(hi,{className:"h-4 w-4 mr-1"}),"Zur\xfcck"]}),(0,gs.jsxs)("button",{onClick:()=>u(e=>Math.min(Pi.length,e+1)),disabled:c===Pi.length,className:"px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:["Weiter",(0,gs.jsx)(mi,{className:"h-4 w-4 ml-1"})]})]})]}),(0,gs.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return m.customerName||(e.customerName="Kundenname ist erforderlich"),m.address||(e.address="Adresse ist erforderlich"),g(e),0===Object.keys(e).length})()){h(!0);try{var t,s,a,i,l,c,u,d,p;const e=(null===r||void 0===r?void 0:r.protocolNumber)||"VDE-".concat((new Date).getFullYear(),"-").concat(String(Date.now()).slice(-6));let h=parseFloat(m.installedPower)||0;if(null!==(t=m.projectConfig)&&void 0!==t&&null!==(s=t.modules)&&void 0!==s&&s.materialID&&m.materials){var f,x,y,v;const e=m.materials.find(e=>e.id===m.projectConfig.modules.materialID),t=parseFloat(String(null!==(f=null===e||void 0===e||null===(x=e.specifications)||void 0===x?void 0:x[fi.PMAX_DC])&&void 0!==f?f:"").replace(",","."))||0,n=(null===(y=m.projectConfig)||void 0===y||null===(v=y.modules)||void 0===v?void 0:v.totalQuantity)||0;h=t&&n?parseFloat((t*n/1e3).toFixed(2)):h}const g={protocolNumber:e,customerName:m.customerName||"",address:m.address,projectName:(null===r||void 0===r?void 0:r.projectName)||m.projectName||"-",vdeData:m,power:h,moduleCount:(null===(a=m.projectConfig)||void 0===a||null===(i=a.modules)||void 0===i?void 0:i.totalQuantity)||parseInt(m.moduleCount||"0",10)||0,stringCount:((null===(l=m.projectConfig)||void 0===l?void 0:l.inverters)||[]).reduce((e,t)=>{var n;return e+((null===(n=t.strings)||void 0===n?void 0:n.length)||0)},0)||(null===(c=m.strings)||void 0===c?void 0:c.length)||1,inverterModel:(null===(u=m.projectConfig)||void 0===u||null===(d=u.inverters)||void 0===d||null===(p=d[0])||void 0===p?void 0:p.description)||m.inverterType||"Unbekannt",status:(null===r||void 0===r?void 0:r.status)||"Erstellt",createdDate:(null===r||void 0===r?void 0:r.createdDate)||new Date,updatedDate:new Date};null!==r&&void 0!==r&&r.id?(await ks.FirebaseService.updateDocument("vde-protocols",r.id,g),o("VDE\u2011Protokoll aktualisiert","success")):(await ks.FirebaseService.addDocument("vde-protocols",g),o("VDE\u2011Protokoll erstellt","success")),n()}catch(b){console.error("Error saving VDE protocol:",b),o("Fehler beim Speichern des Protokolls","error")}finally{h(!1)}}},children:[(0,gs.jsx)("div",{className:"overflow-auto max-h-[60vh]",children:(0,gs.jsx)(b,{vdeData:m,handleVdeDataChange:v})}),(0,gs.jsxs)("div",{className:"flex items-center justify-end p-6 border-t border-gray-200 bg-gray-50",children:[!a&&(0,gs.jsx)("div",{className:"flex space-x-3 mr-auto",children:(0,gs.jsxs)("button",{type:"button",onClick:()=>{requestAnimationFrame(()=>window.print())},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center space-x-2",title:"Drucken oder als PDF speichern",children:[(0,gs.jsx)(pi,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"Drucken / PDF"})]})}),(0,gs.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,gs.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Abbrechen"}),(0,gs.jsxs)("button",{type:"submit",disabled:d,className:"px-4 py-2 text-sm font-medium text-white bg-primary-600 border border-transparent rounded-lg hover:bg-primary-700 flex items-center space-x-2 disabled:opacity-50",children:[(0,gs.jsx)(Aa,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:d?"Speichert\u2026":null!==r&&void 0!==r&&r.id?"Aktualisieren":"Speichern"})]})]})]})]}),Object.keys(f).length>0&&(0,gs.jsxs)("div",{className:"px-6 pb-6 text-sm text-red-700",children:[f.customerName&&(0,gs.jsxs)("div",{children:["\u2022 ",f.customerName]}),f.address&&(0,gs.jsxs)("div",{children:["\u2022 ",f.address]})]})]}),x&&(0,l.createPortal)((0,gs.jsx)(gs.Fragment,{children:Pi.map((e,t)=>(0,gs.jsx)(e,{vdeData:m,handleVdeDataChange:v},t))}),x)]}):null},Li=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")},Fi=e=>{if(null===e||void 0===e||""===e)return"0,00 \u20ac";const t=Number(e);return Number.isNaN(t)?"0,00 \u20ac":"".concat(t.toFixed(2).replace(".",",")," \u20ac")},Vi=e=>{if(!e)return"Nicht gesetzt";try{let t;if(e instanceof Date)t=e;else if("string"===typeof e||"number"===typeof e)t=new Date(e);else{if(null===e||void 0===e||!e.seconds)return"Ung\xfcltiges Datum";t=new Date(1e3*e.seconds)}return isNaN(t.getTime())?"Ung\xfcltiges Datum":t.toLocaleDateString("de-DE")}catch(t){return"Ung\xfcltiges Datum"}},zi=e=>{if(!e)return"Unbekannt";try{let t;if(e instanceof Date)t=e;else if("string"===typeof e||"number"===typeof e)t=new Date(e);else{if(null===e||void 0===e||!e.seconds)return"Ung\xfcltiges Datum";t=new Date(1e3*e.seconds)}return isNaN(t.getTime())?"Ung\xfcltiges Datum":t.toLocaleString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(t){return"Ung\xfcltiges Datum"}},Ui=()=>String(Math.floor(1e4*Math.random())).padStart(4,"0"),Ki=e=>{let{street:t,houseNumber:n,postalCode:r,city:s}=e;return"".concat((t||"").trim()," ").concat((n||"").trim(),", ").concat((r||"").trim()," ").concat((s||"").trim()).replace(/\s+,/g,",").replace(/,\s*$/,"").replace(/\s{2,}/g," ").trim()},Bi=e=>{if(!e||"string"!==typeof e)return{street:"",houseNumber:"",postalCode:"",city:""};const[t="",n=""]=e.split(", "),r=t.match(/^(.+?)\s+(\d+.*)$/),s=r?r[1]:t,a=r?r[2]:"",i=n.match(/^(\d+)\s+(.+)$/),l=i?i[1]:"",o=i?i[2]:n;return{street:s.trim(),houseNumber:a.trim(),postalCode:l.trim(),city:o.trim()}},qi=[{value:"Aktiv",label:"Aktiv"},{value:"Geplant",label:"Geplant"},{value:"Pausiert",label:"Pausiert"},{value:"Abgeschlossen",label:"Abgeschlossen"},{value:"Storniert",label:"Storniert"}],Hi=e=>{switch(e){case"Aktiv":return"bg-green-100 text-green-800";case"Abgeschlossen":default:return"bg-gray-100 text-gray-800";case"Geplant":return"bg-blue-100 text-blue-800";case"Pausiert":return"bg-yellow-100 text-yellow-800";case"Storniert":return"bg-red-100 text-red-800"}},Gi=e=>{switch(e){case"Erstellt":return"bg-blue-100 text-blue-800";case"Gepr\xfcft":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},Wi=e=>{let{isOpen:t,onClose:n,mode:r="view",project:a=null,onSave:i,onEdit:l,onDelete:o,customers:c=[],projects:u=[]}=e;const d="view"===r,h="edit"===r,m="create"===r,{bookings:p=[]}=Hs(),{customers:f=[]}=Vs(),g=(m||h)&&c.length?c:f,x=m||h?u:[],[y,v]=(0,s.useState)([]),[b,w]=(0,s.useState)(!1),[j,N]=(0,s.useState)(null),[k,S]=(0,s.useState)([]),[C,E]=(0,s.useState)(!1),[A,I]=(0,s.useState)(!1),[_,T]=(0,s.useState)(null),[D,P]=(0,s.useState)(0),[M,R]=(0,s.useState)(!1),[O,L]=(0,s.useState)({projectID:"",name:"",description:"",customerID:"",customerName:"",contactPersonId:"",contactPersonName:"",street:"",houseNumber:"",postalCode:"",city:"",status:"Aktiv",notes:""}),[F,V]=(0,s.useState)({}),[z,U]=(0,s.useState)([]);(0,s.useEffect)(()=>{if(t)if(d&&null!==a&&void 0!==a&&a.id&&((async()=>{try{w(!0);const e=await ks.FirebaseService.getDocuments("project-configurations");v(e.filter(e=>e.projectID===a.id))}catch(Ao){console.error("Fehler beim Laden der Projektkonfigurationen:",Ao)}finally{w(!1)}})(),K(),G()),m){let e="PRO-001";try{e=function(){const e=/^PRO-(\d{3,})$/,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((t,n)=>{const r=null===n||void 0===n?void 0:n.projectID;if(!r||"string"!==typeof r)return t;const s=r.match(e);if(!s)return t;const a=parseInt(s[1],10);return Number.isFinite(a)&&a>t?a:t},0);return"PRO-".concat(String(t+1).padStart(3,"0"))}(x)}catch(Ao){console.error("Fehler bei ID-Generierung, Fallback auf PRO-001:",Ao)}L(t=>(0,Le.A)((0,Le.A)({},t),{},{projectID:e,name:Ui(),description:"",customerID:"",customerName:"",contactPersonId:"",contactPersonName:"",street:"",houseNumber:"",postalCode:"",city:"",status:"Aktiv",notes:""})),U([]),V({})}else if(h&&a){const{street:e,houseNumber:t,postalCode:n,city:r}=Bi(a.address||"");L({projectID:a.projectID||a.id||"",name:a.name||"",description:a.description||"",customerID:a.customerID||"",customerName:a.customerName||"",contactPersonId:a.contactPersonId||"",contactPersonName:a.contactPersonName||"",street:e,houseNumber:t,postalCode:n,city:r,status:a.status||"Aktiv",notes:a.notes||""});const s=g.find(e=>e.id===(a.customerID||""));U((null===s||void 0===s?void 0:s.contacts)||[]),V({})}},[t,r,null===a||void 0===a?void 0:a.id]);const K=(0,s.useCallback)(async()=>{if(null!==a&&void 0!==a&&a.id){E(!0);try{const e=await ks.FirebaseService.getDocuments("vde-protocols"),t=f.find(e=>e.id===a.customerID)||null,n=(e||[]).filter(e=>{const n=e.projectID===a.id,r=e.customerID===a.customerID,s=e.projectName===a.name,i=e.customerName===(null===t||void 0===t?void 0:t.firmennameKundenname)||e.customerName===a.customerName;return n||r||s||i});S(n)}catch(Ao){console.error("Fehler beim Laden der VDE-Protokolle:",Ao),S([])}finally{E(!1)}}},[null===a||void 0===a?void 0:a.id,null===a||void 0===a?void 0:a.customerID,null===a||void 0===a?void 0:a.name,null===a||void 0===a?void 0:a.customerName,f]),B=e=>{const{name:t,value:n}=e.target;L(e=>(0,Le.A)((0,Le.A)({},e),{},{[t]:n})),F[t]&&V(e=>(0,Le.A)((0,Le.A)({},e),{},{[t]:""}))},q=(0,s.useMemo)(()=>null!==a&&void 0!==a&&a.id?p.filter(e=>e.projectID===a.id):[],[p,null===a||void 0===a?void 0:a.id]),H=(0,s.useMemo)(()=>null!==a&&void 0!==a&&a.customerID&&f.find(e=>e.id===a.customerID)||null,[f,null===a||void 0===a?void 0:a.customerID]),G=(0,s.useCallback)(async()=>{if(null!==a&&void 0!==a&&a.id){R(!0);try{const e=await(async e=>{if(!e||0===e.length)return 0;let t=0;return e.forEach(e=>{var n;null===(n=e.materials)||void 0===n||n.forEach(e=>{if(void 0!==e.totalCost){const n=Number(e.totalCost);isNaN(n)||(t+=n)}else if(e.priceAtBooking&&e.quantity){const n=Number(e.priceAtBooking),r=Number(e.quantity);isNaN(n)||isNaN(r)||(t+=n*r)}else e.quantity})}),t})(q);P(e)}catch(Ao){console.error("Fehler beim Berechnen der Projektkosten:",Ao),P(0)}finally{R(!1)}}},[null===a||void 0===a?void 0:a.id,q]);(0,s.useEffect)(()=>{d&&null!==a&&void 0!==a&&a.id&&q.length>=0&&G()},[d,null===a||void 0===a?void 0:a.id,q,G]);const W=(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsxs)("button",{onClick:()=>null===l||void 0===l?void 0:l(a),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center space-x-2",children:[(0,gs.jsx)(Ca,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"Bearbeiten"})]}),(0,gs.jsxs)("button",{onClick:()=>{null===o||void 0===o||o(null===a||void 0===a?void 0:a.id),null===n||void 0===n||n()},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 flex items-center space-x-2",children:[(0,gs.jsx)(Ea,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"L\xf6schen"})]})]}),Q=(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Abbrechen"}),(0,gs.jsxs)("button",{type:"submit",form:"project-form",className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center space-x-2",children:[(0,gs.jsx)(Aa,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:h?"Aktualisieren":"Hinzuf\xfcgen"})]})]});if(!t)return null;if(d&&a){const e=a.address||Ki(Bi(a.address||""));return(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsx)(_a,{isOpen:t,onClose:n,title:"Projektdetails",icon:Va,footerButtons:W,children:(0,gs.jsxs)("div",{className:"space-y-6",children:[(0,gs.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,gs.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Projektinformationen"}),(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(Va,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Projektname"})]}),(0,gs.jsx)("p",{className:"text-gray-900 ml-6",children:a.name})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(Ya,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Projekt-ID"})]}),(0,gs.jsx)("p",{className:"text-gray-900 ml-6",children:a.projectID||a.id})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(Ya,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Status"})]}),(0,gs.jsx)("div",{className:"ml-6",children:(0,gs.jsx)("span",{className:Li("px-2 py-1 rounded-full text-xs font-medium",Hi(a.status)),children:a.status})})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(ma,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Kunde"})]}),(0,gs.jsx)("p",{className:"text-gray-900 ml-6",children:(null===H||void 0===H?void 0:H.firmennameKundenname)||a.customerName||"Unbekannter Kunde"})]}),a.contactPersonId&&(e=>{const t=null===H||void 0===H||null===(e=H.contacts)||void 0===e?void 0:e.find(e=>e.id===a.contactPersonId);return t?(0,gs.jsxs)("div",{className:"md:col-span-2",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(ci,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Ansprechpartner"})]}),(0,gs.jsxs)("div",{className:"ml-6 bg-white p-3 rounded border",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(ma,{className:"h-4 w-4 text-blue-500"}),(0,gs.jsx)("span",{className:"font-medium text-gray-900",children:t.name}),t.position&&(0,gs.jsxs)("span",{className:"text-sm text-gray-500",children:["(",t.position,")"]})]}),(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[t.email&&(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)(ca,{className:"h-3 w-3 text-gray-400"}),(0,gs.jsx)("span",{className:"text-gray-600",children:t.email})]}),t.phone&&(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)(Xa,{className:"h-3 w-3 text-gray-400"}),(0,gs.jsx)("span",{className:"text-gray-600",children:t.phone})]})]}),t.notes&&(0,gs.jsxs)("div",{className:"mt-2 text-sm text-gray-600",children:[(0,gs.jsx)("span",{className:"font-medium",children:"Notizen:"})," ",t.notes]})]})]}):a.contactPersonName?(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(ci,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Ansprechpartner"})]}),(0,gs.jsxs)("p",{className:"text-gray-900 ml-6",children:[a.contactPersonName," ",(0,gs.jsx)("span",{className:"text-sm text-gray-500",children:"(Kontakt nicht mehr verf\xfcgbar)"})]})]}):null})(),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(Ja,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Adresse"})]}),(0,gs.jsx)("p",{className:"text-gray-900 ml-6",children:e||"Nicht angegeben"})]})]}),a.description&&(0,gs.jsxs)("div",{className:"mt-4",children:[(0,gs.jsx)("div",{className:"flex items-center space-x-2 mb-2",children:(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Beschreibung"})}),(0,gs.jsx)("p",{className:"text-gray-900 bg-white p-3 rounded border",children:a.description})]}),a.notes&&(0,gs.jsxs)("div",{className:"mt-4",children:[(0,gs.jsx)("div",{className:"flex items-center space-x-2 mb-2",children:(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Notizen"})}),(0,gs.jsx)("p",{className:"text-gray-900 bg-white p-3 rounded border",children:a.notes})]})]}),(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow border",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Materialbuchungen"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:q.length})]}),(0,gs.jsx)(ba,{className:"h-8 w-8 text-blue-600"})]})}),(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow border",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Materialien gesamt"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-green-600",children:q.reduce((e,t)=>e+t.materials.reduce((e,t)=>e+(t.quantity||0),0),0)})]}),(0,gs.jsx)(xa,{className:"h-8 w-8 text-green-600"})]})}),(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow border",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Projektkosten"}),M?(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-orange-600"}),(0,gs.jsx)("span",{className:"text-sm text-gray-500",children:"Berechne..."})]}):(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:Fi(D)}),(0,gs.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Basierend auf historischen Preisen"})]})]}),(0,gs.jsx)($a,{className:"h-8 w-8 text-orange-600"})]})})]}),y.length>0&&(0,gs.jsxs)("div",{className:"space-y-4",children:[(0,gs.jsxs)("h3",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:["PV-Konfigurationen (",y.length,")"]}),b?(0,gs.jsxs)("div",{className:"text-center py-8",children:[(0,gs.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"}),(0,gs.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Lade Konfigurationen..."})]}):(0,gs.jsx)("div",{className:"space-y-4",children:y.map((e,t)=>{var n;const r=e.pvConfiguration||e,s=e.id;return(0,gs.jsxs)("div",{className:"bg-white border rounded-lg p-4",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)(ja,{className:"h-5 w-5 text-yellow-500"}),(0,gs.jsx)("span",{className:"text-lg font-medium text-gray-900",children:"PV-Konfiguration"}),(0,gs.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["v",r.configurationVersion||"1.0"]})]}),(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)("span",{className:"text-sm text-gray-500",children:zi(e.createdAt||r.timestamp)}),(0,gs.jsx)("button",{onClick:async()=>{if(window.confirm("Diese PV-Konfiguration wirklich l\xf6schen?"))try{N(s),await ks.FirebaseService.deleteDocument("project-configurations",s),v(e=>e.filter(e=>e.id!==s))}catch(Ao){console.error("Fehler beim L\xf6schen:",Ao),alert("Fehler beim L\xf6schen der Konfiguration!")}finally{N(null)}},disabled:j===s,className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-50 rounded disabled:opacity-50",title:"Konfiguration l\xf6schen",children:j===s?(0,gs.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"}):(0,gs.jsx)(Ea,{className:"h-4 w-4"})})]})]}),(null===(n=r.inverters)||void 0===n?void 0:n.length)>0&&(0,gs.jsxs)("div",{className:"mb-4",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(ja,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Wechselrichter"})]}),(0,gs.jsx)("div",{className:"ml-6 space-y-2",children:r.inverters.map((e,t)=>{var n;return(0,gs.jsxs)("div",{className:"bg-gray-50 rounded p-3",children:[(0,gs.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,gs.jsx)("span",{className:"font-medium text-gray-900",children:e.description}),(0,gs.jsxs)("span",{className:"text-sm text-gray-600",children:[e.quantity,"x"]})]}),(e.recommendedBreaker||e.recommendedCable)&&(0,gs.jsxs)("div",{className:"mb-2 p-2 bg-blue-50 rounded",children:[(0,gs.jsx)("span",{className:"text-xs font-medium text-blue-800",children:"Empfohlene Komponenten:"}),(0,gs.jsxs)("div",{className:"text-xs text-blue-700 mt-1 space-y-1",children:[e.recommendedBreaker&&(0,gs.jsxs)("div",{children:["\u2022 Leitungsschutzschalter: ",e.recommendedBreaker]}),e.recommendedCable&&(0,gs.jsxs)("div",{children:["\u2022 Mantelleitung: ",e.recommendedCable]})]})]}),(null===(n=e.strings)||void 0===n?void 0:n.length)>0&&(0,gs.jsxs)("div",{className:"space-y-1",children:[(0,gs.jsx)("span",{className:"text-xs font-medium text-gray-600",children:"Strings:"}),e.strings.map((e,t)=>(0,gs.jsxs)("div",{className:"text-xs text-gray-600 ml-2",children:[e.stringName,": ",e.moduleCount,"x ",e.moduleDescription]},t))]})]},t)})})]}),r.modules&&(0,gs.jsxs)("div",{className:"mb-4",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(ba,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Module"})]}),(0,gs.jsx)("div",{className:"ml-6 bg-gray-50 rounded p-3",children:(0,gs.jsxs)("div",{className:"flex justify-between items-center",children:[(0,gs.jsx)("span",{className:"font-medium text-gray-900",children:r.modules.description}),(0,gs.jsxs)("span",{className:"text-sm text-gray-600",children:[r.modules.totalQuantity,"x"]})]})})]}),r.wallbox&&(0,gs.jsxs)("div",{className:"mb-4",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(ui,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Wallbox"})]}),(0,gs.jsxs)("div",{className:"ml-6 bg-gray-50 rounded p-3",children:[(0,gs.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,gs.jsx)("span",{className:"font-medium text-gray-900",children:r.wallbox.description}),(0,gs.jsxs)("span",{className:"text-sm text-gray-600",children:[r.wallbox.quantity,"x"]})]}),(r.wallbox.recommendedBreaker||r.wallbox.recommendedCable||r.wallbox.recommendedRCD)&&(0,gs.jsxs)("div",{className:"p-2 bg-blue-50 rounded",children:[(0,gs.jsx)("span",{className:"text-xs font-medium text-blue-800",children:"Empfohlene Komponenten:"}),(0,gs.jsxs)("div",{className:"text-xs text-blue-700 mt-1 space-y-1",children:[r.wallbox.recommendedBreaker&&(0,gs.jsxs)("div",{children:["\u2022 Leitungsschutzschalter: ",r.wallbox.recommendedBreaker]}),r.wallbox.recommendedCable&&(0,gs.jsxs)("div",{children:["\u2022 Mantelleitung: ",r.wallbox.recommendedCable]}),r.wallbox.recommendedRCD&&(0,gs.jsxs)("div",{children:["\u2022 FI-Schutzschalter: ",r.wallbox.recommendedRCD]})]})]})]})]}),r.backupSolutions&&(0,gs.jsxs)("div",{className:"mb-4",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(Ia,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Notstroml\xf6sungen"})]}),(0,gs.jsxs)("div",{className:"ml-6 bg-gray-50 rounded p-3",children:[(0,gs.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,gs.jsx)("span",{className:"font-medium text-gray-900",children:r.backupSolutions.description}),(0,gs.jsxs)("span",{className:"text-sm text-gray-600",children:[r.backupSolutions.quantity,"x"]})]}),(r.backupSolutions.recommendedBreaker||r.backupSolutions.recommendedCable)&&(0,gs.jsxs)("div",{className:"p-2 bg-blue-50 rounded",children:[(0,gs.jsx)("span",{className:"text-xs font-medium text-blue-800",children:"Empfohlene Komponenten:"}),(0,gs.jsxs)("div",{className:"text-xs text-blue-700 mt-1 space-y-1",children:[r.backupSolutions.recommendedBreaker&&(0,gs.jsxs)("div",{children:["\u2022 Leitungsschutzschalter: ",r.backupSolutions.recommendedBreaker]}),r.backupSolutions.recommendedCable&&(0,gs.jsxs)("div",{children:["\u2022 Mantelleitung: ",r.backupSolutions.recommendedCable]})]})]})]})]}),r.pvCables&&(0,gs.jsxs)("div",{className:"mb-4",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(ba,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"PV-Kabel"})]}),(0,gs.jsx)("div",{className:"ml-6 bg-gray-50 rounded p-3",children:(0,gs.jsxs)("div",{className:"flex justify-between items-center",children:[(0,gs.jsx)("span",{className:"font-medium text-gray-900",children:r.pvCables.description}),(0,gs.jsxs)("span",{className:"text-sm text-gray-600",children:[r.pvCables.quantity,"m"]})]})})]}),r.potentialausgleichHESUK&&(0,gs.jsxs)("div",{className:"mb-4",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(ja,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Potentialausgleich HES-UK"})]}),(0,gs.jsx)("div",{className:"ml-6 bg-gray-50 rounded p-3",children:(0,gs.jsxs)("div",{className:"flex justify-between items-center",children:[(0,gs.jsx)("span",{className:"font-medium text-gray-900",children:r.potentialausgleichHESUK.description}),(0,gs.jsxs)("span",{className:"text-sm text-gray-600",children:[r.potentialausgleichHESUK.quantity,"m"]})]})})]}),r.generatoranschlusskasten&&(0,gs.jsxs)("div",{className:"mb-4",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(ja,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Generatoranschlusskasten"})]}),(0,gs.jsx)("div",{className:"ml-6 bg-gray-50 rounded p-3",children:(0,gs.jsxs)("div",{className:"flex justify-between items-center",children:[(0,gs.jsx)("span",{className:"font-medium text-gray-900",children:r.generatoranschlusskasten.description}),(0,gs.jsxs)("span",{className:"text-sm text-gray-600",children:[r.generatoranschlusskasten.quantity,"x"]})]})})]})]},t)})})]}),(0,gs.jsxs)("div",{className:"space-y-4",children:[(0,gs.jsxs)("h3",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:["VDE-Protokolle (",k.length,")"]}),C?(0,gs.jsxs)("div",{className:"text-center py-8",children:[(0,gs.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"}),(0,gs.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Lade VDE-Protokolle..."})]}):0===k.length?(0,gs.jsxs)("div",{className:"text-center py-8",children:[(0,gs.jsx)(di,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,gs.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Keine VDE-Protokolle"}),(0,gs.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"F\xfcr dieses Projekt wurden noch keine VDE-Protokolle erstellt."})]}):(0,gs.jsx)("div",{className:"space-y-2",children:k.map((e,t)=>(0,gs.jsxs)("div",{className:"bg-white border rounded-lg p-3 hover:bg-gray-50 cursor-pointer transition-colors flex items-center justify-between",onClick:()=>{T(e),I(!0)},children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,gs.jsx)(di,{className:"h-4 w-4 text-blue-500"}),(0,gs.jsx)("span",{className:"font-medium text-gray-900",children:e.protocolNumber||"VDE-Protokoll"}),e.status&&(0,gs.jsx)("span",{className:Li("px-2 py-0.5 rounded-full text-xs",Gi(e.status)),children:e.status})]}),(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)("span",{className:"text-sm text-gray-500",children:Vi(e.createdAt||e.createdDate)}),(0,gs.jsx)(ha,{className:"h-4 w-4 text-gray-400"})]})]},t))})]}),(0,gs.jsxs)("div",{className:"space-y-4",children:[(0,gs.jsxs)("h3",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:["Materialbuchungen (",q.length,")"]}),0===q.length?(0,gs.jsxs)("div",{className:"text-center py-8",children:[(0,gs.jsx)(ba,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,gs.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Keine Buchungen"}),(0,gs.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"F\xfcr dieses Projekt wurden noch keine Materialbuchungen durchgef\xfchrt."})]}):(0,gs.jsx)("div",{className:"space-y-3",children:q.map((e,t)=>(0,gs.jsxs)("div",{className:"bg-white border rounded-lg p-4",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)(xa,{className:"h-4 w-4 text-red-500"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.type}),(0,gs.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Abgeschlossen"})]}),(0,gs.jsx)("span",{className:"text-sm text-gray-500",children:zi(e.timestamp)})]}),(0,gs.jsx)("div",{className:"space-y-2",children:e.materials.map((e,t)=>(0,gs.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"font-medium text-gray-900",children:e.description}),(0,gs.jsx)("p",{className:"text-gray-500 text-xs",children:e.materialID})]}),(0,gs.jsxs)("span",{className:"font-medium text-gray-900",children:[e.quantity,"x"]})]},t))}),e.notes&&(0,gs.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,gs.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,gs.jsx)("span",{className:"font-medium",children:"Notiz:"})," ",e.notes]})})]},t))})]})]})}),A&&(0,gs.jsx)(Oi,{isOpen:A,onClose:async()=>{I(!1),T(null),await K()},protocol:_,hideActions:!1})]})}return(0,gs.jsx)(_a,{isOpen:t,onClose:n,title:h?"Projekt bearbeiten":"Projekt hinzuf\xfcgen",icon:Va,footerButtons:Q,children:(0,gs.jsxs)("form",{id:"project-form",onSubmit:e=>{var t;if(null===e||void 0===e||null===(t=e.preventDefault)||void 0===t||t.call(e),!(()=>{const e={};return O.name.trim()||(e.name="Projektname ist erforderlich"),O.customerID||(e.customerID="Kunde ist erforderlich"),V(e),0===Object.keys(e).length})())return;const r=Ki({street:O.street,houseNumber:O.houseNumber,postalCode:O.postalCode,city:O.city}),s=(0,Le.A)((0,Le.A)({},O),{},{address:r});null===i||void 0===i||i(s),null===n||void 0===n||n()},className:"space-y-6",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Projekt-ID *"}),(0,gs.jsx)("input",{type:"text",value:O.projectID,readOnly:!0,placeholder:"Wird automatisch generiert",className:"w-full px-4 py-2 border rounded-lg bg-gray-100 text-gray-700 cursor-not-allowed"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,gs.jsx)(Va,{className:"h-4 w-4 inline mr-1"}),"Projektname *"]}),(0,gs.jsx)("input",{type:"text",value:O.name,readOnly:!0,placeholder:"Wird automatisch generiert",className:"w-full px-4 py-2 border rounded-lg bg-gray-100 text-gray-700 cursor-not-allowed"}),F.name&&(0,gs.jsx)("p",{className:"mt-1 text-sm text-red-600",children:F.name})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,gs.jsx)(ma,{className:"h-4 w-4 inline mr-1"}),"Kunde *"]}),(0,gs.jsxs)("select",{name:"customerID",value:O.customerID,onChange:e=>{const t=e.target.value,n=g.find(e=>e.id===t),r=n&&(n.name||n.firmennameKundenname)||"",s=n?"".concat((a=r,(a||"").replace(/\s+/g,""))).concat(Ui()):O.name||Ui();var a;U((null===n||void 0===n?void 0:n.contacts)||[]),L(e=>(0,Le.A)((0,Le.A)({},e),{},{customerID:t,customerName:r,contactPersonId:"",contactPersonName:"",name:s,street:(null===n||void 0===n?void 0:n.street)||"",houseNumber:(null===n||void 0===n?void 0:n.houseNumber)||"",postalCode:(null===n||void 0===n?void 0:n.postalCode)||"",city:(null===n||void 0===n?void 0:n.city)||""})),F.customerID&&t&&V(e=>{const t=(0,Le.A)({},e);return delete t.customerID,t})},className:Li("w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",F.customerID?"border-red-300":"border-gray-300"),children:[(0,gs.jsx)("option",{value:"",children:"Kunde ausw\xe4hlen..."}),g.map(e=>(0,gs.jsx)("option",{value:e.id,children:e.name||e.firmennameKundenname||"Unbekannter Kunde"},e.id))]}),F.customerID&&(0,gs.jsx)("p",{className:"mt-1 text-sm text-red-600",children:F.customerID})]}),O.customerID&&z.length>0&&(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,gs.jsx)(ci,{className:"h-4 w-4 inline mr-1"}),"Ansprechpartner"]}),(0,gs.jsxs)("select",{name:"contactPersonId",value:O.contactPersonId,onChange:e=>{const t=e.target.value,n=z.find(e=>e.id===t);L(e=>(0,Le.A)((0,Le.A)({},e),{},{contactPersonId:t,contactPersonName:n?n.name:""}))},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Ansprechpartner ausw\xe4hlen..."}),z.map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.position?"(".concat(e.position,")"):""," - ",e.email]},e.id))]})]}),O.customerID&&0===z.length&&(0,gs.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:(0,gs.jsxs)("div",{className:"flex items-center",children:[(0,gs.jsx)(ci,{className:"h-4 w-4 text-yellow-600 mr-2"}),(0,gs.jsx)("p",{className:"text-sm text-yellow-800",children:"F\xfcr diesen Kunden sind noch keine Ansprechpartner hinterlegt. F\xfcgen Sie Kontakte in den Kundendetails hinzu."})]})}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,gs.jsx)(di,{className:"h-4 w-4 inline mr-1"}),"Beschreibung"]}),(0,gs.jsx)("textarea",{name:"description",value:O.description,onChange:B,rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Projektbeschreibung..."})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,gs.jsx)(Ja,{className:"h-4 w-4 inline mr-1"}),"Projektadresse"]}),(0,gs.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,gs.jsx)("div",{className:"col-span-2",children:(0,gs.jsx)("input",{type:"text",name:"street",value:O.street,onChange:B,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Stra\xdfe"})}),(0,gs.jsx)("div",{children:(0,gs.jsx)("input",{type:"text",name:"houseNumber",value:O.houseNumber,onChange:B,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Nr."})})]}),(0,gs.jsxs)("div",{className:"grid grid-cols-3 gap-3 mt-3",children:[(0,gs.jsx)("div",{children:(0,gs.jsx)("input",{type:"text",name:"postalCode",value:O.postalCode,onChange:B,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"PLZ",maxLength:5,inputMode:"numeric"})}),(0,gs.jsx)("div",{className:"col-span-2",children:(0,gs.jsx)("input",{type:"text",name:"city",value:O.city,onChange:B,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Ort"})})]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,gs.jsx)("select",{name:"status",value:O.status,onChange:B,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:qi.map(e=>(0,gs.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notizen"}),(0,gs.jsx)("textarea",{name:"notes",value:O.notes,onChange:B,rows:2,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Zus\xe4tzliche Notizen..."})]})]})})},Qi=Wi,Ji=e=>{let{isOpen:t,onClose:n,onSave:r,project:s=null,customers:a=[],projects:i=[]}=e;return(0,gs.jsx)(Wi,{isOpen:t,onClose:n,mode:s?"edit":"create",project:s,onSave:r,customers:a,projects:i})},Zi=()=>{const{customers:e,deleteCustomer:t}=Vs(),{projects:n,updateProject:r,deleteProject:a}=Ks(),{showNotification:i}=Os(),[l,o]=(0,s.useState)(""),[c,u]=(0,s.useState)(null),[d,h]=(0,s.useState)(!1),[m,p]=(0,s.useState)(null),[f,g]=(0,s.useState)(!1),[x,y]=(0,s.useState)(null),[v,b]=(0,s.useState)(!1),[w,j]=(0,s.useState)(null),[N,k]=(0,s.useState)(!1),[S,C]=(0,s.useState)(null),[E,A]=(0,s.useState)(!0),[I,_]=(0,s.useState)(!1),[T,D]=(0,s.useState)(null),[P,M]=(0,s.useState)({city:"alle",dateRange:"alle"}),[R,O]=(0,s.useState)({kunde:!0,adresse:!0,telefon:!1,email:!1,aktionen:!0}),L=["alle",...new Set(e.map(e=>e.city).filter(Boolean))],F=e.filter(e=>{const t=e.firmennameKundenname.toLowerCase().includes(l.toLowerCase())||e.customerID.toLowerCase().includes(l.toLowerCase())||e.city.toLowerCase().includes(l.toLowerCase()),n="alle"===P.city||e.city===P.city,r=((e,t)=>{if(!e||"alle"===t)return!0;const n=new Date,r=e.toDate?e.toDate():new Date(e),s=Math.abs(n-r),a=Math.ceil(s/864e5);switch(t){case"heute":return 0===a;case"7tage":return a<=7;case"30tage":return a<=30;case"90tage":return a<=90;case"jahr":return a<=365;default:return!0}})(e.createdAt,P.dateRange);return t&&n&&r}),V=e=>{window.confirm("Kunde wirklich l\xf6schen?")&&(t(e),i("Kunde erfolgreich gel\xf6scht","success")),u(null)},z=e=>{p(e),h(!0),u(null)},U=async e=>{try{const t=(await ks.FirebaseService.getDocuments("user-preferences")).find(e=>"customerColumns"===e.type),n={type:"customerColumns",columns:e,updatedAt:new Date};t?await ks.FirebaseService.updateDocument("user-preferences",t.id,n):await ks.FirebaseService.addDocument("user-preferences",(0,Le.A)((0,Le.A)({},n),{},{createdAt:new Date}))}catch(t){console.error("Fehler beim Speichern der Spalteneinstellungen:",t),i("Fehler beim Speichern der Spalteneinstellungen","error")}};return s.useEffect(()=>{(async()=>{try{A(!0);const e=(await ks.FirebaseService.getDocuments("user-preferences")).find(e=>"customerColumns"===e.type);e&&e.columns&&O(e.columns)}catch(e){console.error("Fehler beim Laden der Spalteneinstellungen:",e)}finally{A(!1)}})()},[]),s.useEffect(()=>{const e=e=>{I&&!e.target.closest(".column-settings-container")&&_(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[I]),(0,gs.jsxs)("div",{className:"h-full flex flex-col space-y-6",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Kundenverwaltung"}),(0,gs.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:"Verwalten Sie Ihre Kunden und deren Projekte"})]}),(0,gs.jsxs)("button",{onClick:()=>h(!0),className:"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 flex items-center space-x-2",children:[(0,gs.jsx)(ya,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"Kunde hinzuf\xfcgen"})]})]}),(0,gs.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,gs.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,gs.jsx)("input",{type:"text",placeholder:"Kunde suchen (Name, ID, Stadt)...",value:l,onChange:e=>o(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),("alle"!==P.city||"alle"!==P.dateRange)&&(0,gs.jsx)("div",{className:"flex items-center space-x-2",children:(0,gs.jsxs)("button",{onClick:()=>{M({city:"alle",dateRange:"alle"}),D(null)},className:"px-3 py-1.5 text-sm bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 flex items-center space-x-1",children:[(0,gs.jsx)(Ms,{className:"h-3 w-3"}),(0,gs.jsx)("span",{children:"Filter zur\xfccksetzen"})]})})]})}),(0,gs.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-4",children:(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Gesamt Kunden"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.length})]}),(0,gs.jsx)(Qa,{className:"h-8 w-8 text-primary-600"})]})})}),(0,gs.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden flex-1 flex flex-col",children:[(0,gs.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between flex-shrink-0",children:[(0,gs.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Kundenliste"}),(0,gs.jsxs)("div",{className:"relative column-settings-container",children:[(0,gs.jsx)("button",{onClick:()=>_(!I),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",title:"Spalten ausw\xe4hlen",children:(0,gs.jsx)(ja,{className:"h-5 w-5"})}),I&&(0,gs.jsx)("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:(0,gs.jsxs)("div",{className:"p-4",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,gs.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:"Spalten ausw\xe4hlen"}),E&&(0,gs.jsx)("div",{className:"text-xs text-gray-500",children:"L\xe4dt..."})]}),(0,gs.jsx)("div",{className:"space-y-2",children:[{key:"kunde",label:"Kunde",required:!0},{key:"adresse",label:"Adresse"},{key:"telefon",label:"Telefon"},{key:"email",label:"Email"},{key:"aktionen",label:"Aktionen",required:!0}].map(e=>(0,gs.jsxs)("label",{className:"flex items-center",children:[(0,gs.jsx)("input",{type:"checkbox",checked:R[e.key],onChange:()=>!e.required&&(async e=>{const t=(0,Le.A)((0,Le.A)({},R),{},{[e]:!R[e]});O(t),await U(t)})(e.key),disabled:e.required||E,className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500 mr-2"}),(0,gs.jsxs)("span",{className:"text-sm ".concat(e.required?"text-gray-400":"text-gray-700"),children:[e.label,e.required&&" (erforderlich)"]})]},e.key))}),(0,gs.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,gs.jsx)("p",{className:"text-xs text-gray-500",children:"\ud83d\udcbe Einstellungen werden automatisch in Firebase gespeichert"})})]})})]})]}),(0,gs.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,gs.jsxs)("div",{className:"h-full overflow-auto",children:[(0,gs.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,gs.jsx)("thead",{className:"bg-gray-50 sticky top-0 z-10",children:(0,gs.jsxs)("tr",{children:[R.kunde&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kunde"}),R.adresse&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,gs.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,gs.jsx)("span",{children:"Adresse"}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)("button",{onClick:()=>D("city"===T?null:"city"),className:"text-gray-400 hover:text-gray-600 p-1",children:(0,gs.jsx)(Na,{className:"h-3 w-3"})}),"city"===T&&(0,gs.jsx)("div",{className:"absolute left-0 mt-1 w-48 bg-white rounded-md shadow-lg z-30 border border-gray-200",children:(0,gs.jsx)("div",{className:"p-2",children:(0,gs.jsx)("select",{value:P.city,onChange:e=>{return t="city",n=e.target.value,void M(e=>(0,Le.A)((0,Le.A)({},e),{},{[t]:n}));var t,n},className:"w-full rounded-md border-gray-300 text-sm focus:border-primary-500 focus:ring-primary-500",children:L.map(e=>(0,gs.jsx)("option",{value:e,children:"alle"===e?"Alle St\xe4dte":e},e))})})})]})]})}),R.telefon&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Telefon"}),R.email&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),R.aktionen&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aktionen"})]})}),(0,gs.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:F.map(e=>(0,gs.jsxs)("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>(e=>{y(e),g(!0)})(e),children:[R.kunde&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsxs)("div",{children:[(0,gs.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.firmennameKundenname}),(0,gs.jsxs)("div",{className:"text-sm text-gray-500",children:["ID: ",e.customerID]})]})}),R.adresse&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsxs)("div",{className:"flex items-center text-sm text-gray-900",children:[(0,gs.jsx)(Ja,{className:"h-4 w-4 mr-1 text-gray-400"}),e.street," ",e.houseNumber,", ",e.postalCode," ",e.city]})}),R.telefon&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.phone||"-"}),R.email&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.email||"-"}),R.aktionen&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,gs.jsxs)("div",{className:"relative",onClick:e=>e.stopPropagation(),children:[(0,gs.jsx)("button",{onClick:t=>{t.stopPropagation(),u(c===e.id?null:e.id)},className:"text-gray-400 hover:text-gray-600",children:(0,gs.jsx)(Sa,{className:"h-4 w-4"})}),c===e.id&&(0,gs.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-10 border border-gray-200",children:(0,gs.jsxs)("div",{className:"py-1",children:[(0,gs.jsxs)("button",{onClick:t=>{t.stopPropagation(),z(e)},className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left",children:[(0,gs.jsx)(Ca,{className:"h-4 w-4 mr-2"}),"Bearbeiten"]}),(0,gs.jsxs)("button",{onClick:t=>{t.stopPropagation(),V(e.id)},className:"flex items-center px-4 py-2 text-sm text-red-700 hover:bg-red-50 w-full text-left",children:[(0,gs.jsx)(Ea,{className:"h-4 w-4 mr-2"}),"L\xf6schen"]})]})})]})})]},e.id))})]}),0===F.length&&(0,gs.jsxs)("div",{className:"text-center py-12",children:[(0,gs.jsx)(Qa,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,gs.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Keine Kunden gefunden"}),(0,gs.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:l?"Versuchen Sie andere Suchbegriffe.":"Beginnen Sie mit dem Hinzuf\xfcgen Ihres ersten Kunden."})]})]})})]}),c&&(0,gs.jsx)("div",{className:"fixed inset-0 z-0",onClick:()=>u(null)}),(0,gs.jsx)(oi,{isOpen:d,onClose:()=>{h(!1),p(null)},customer:m}),(0,gs.jsx)(li,{isOpen:f,onClose:()=>{g(!1),y(null)},customer:x,onEdit:z,onDelete:V,onProjectClick:e=>{j(e),b(!0),g(!1)}}),(0,gs.jsx)(Qi,{isOpen:v,onClose:()=>{b(!1),j(null)},project:w,onEdit:e=>{C(e),k(!0),b(!1)},onDelete:async e=>{if(window.confirm("Sind Sie sicher, dass Sie dieses Projekt l\xf6schen m\xf6chten?"))try{await a(e),i("Projekt erfolgreich gel\xf6scht","success"),b(!1),j(null)}catch(t){i("Fehler beim L\xf6schen des Projekts","error")}}}),(0,gs.jsx)(Ji,{isOpen:N,onClose:()=>{k(!1),C(null)},project:S,onSave:async e=>{try{await r(S.id,e),i("Projekt erfolgreich aktualisiert","success"),k(!1),C(null),b(!0),w&&w.id===S.id&&j((0,Le.A)((0,Le.A)({},w),e))}catch(t){i("Fehler beim Aktualisieren des Projekts","error")}},customers:e,projects:n})]})},Xi=_s("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Yi=()=>{const{projects:e,addProject:t,updateProject:n,deleteProject:r}=Ks(),{customers:a}=Vs(),{showNotification:i}=Os(),[l,o]=(0,s.useState)(""),[c,u]=(0,s.useState)("alle"),[d,h]=(0,s.useState)("alle"),[m,p]=(0,s.useState)(!1),[f,g]=(0,s.useState)(null),[x,y]=(0,s.useState)(null),[v,b]=(0,s.useState)(!1),[w,j]=(0,s.useState)(null),[N,k]=(0,s.useState)(!1),[S,C]=(0,s.useState)({name:!0,customer:!0,status:!0,address:!1,description:!1}),[E,A]=(0,s.useState)({key:null,direction:"asc"}),[I,_]=(0,s.useState)({status:"alle",customer:"alle"}),[T,D]=(0,s.useState)(null),[P,M]=(0,s.useState)(!0),R=[{value:"alle",label:"Alle Status"},{value:"Aktiv",label:"Aktiv",color:"bg-green-100 text-green-800"},{value:"Geplant",label:"Geplant",color:"bg-blue-100 text-blue-800"},{value:"Pausiert",label:"Pausiert",color:"bg-yellow-100 text-yellow-800"},{value:"Abgeschlossen",label:"Abgeschlossen",color:"bg-gray-100 text-gray-800"},{value:"Storniert",label:"Storniert",color:"bg-red-100 text-red-800"}],O=e=>{const t=R.find(t=>t.value===e);return(null===t||void 0===t?void 0:t.color)||"bg-gray-100 text-gray-800"},L=["alle",...new Set(e.map(e=>e.status).filter(Boolean))],F=["alle",...new Set(e.map(e=>{const t=a.find(t=>t.id===e.customerID);return t?t.firmennameKundenname||t.name:"Unbekannt"}).filter(Boolean))],V=(e,t)=>{_(n=>(0,Le.A)((0,Le.A)({},n),{},{[e]:t})),D(null)},z=async e=>{try{const t=(await ks.FirebaseService.getDocuments("user-preferences")).find(e=>"projectColumns"===e.type),n={type:"projectColumns",columns:e,updatedAt:new Date};t?await ks.FirebaseService.updateDocument("user-preferences",t.id,n):await ks.FirebaseService.addDocument("user-preferences",(0,Le.A)((0,Le.A)({},n),{},{createdAt:new Date}))}catch(t){console.error("Fehler beim Speichern der Spalteneinstellungen:",t),i("Fehler beim Speichern der Spalteneinstellungen","error")}},U=[...e.filter(e=>{var t;const n=""===l||e.name.toLowerCase().includes(l.toLowerCase())||(null===(t=e.description)||void 0===t?void 0:t.toLowerCase().includes(l.toLowerCase()))||e.projectID&&e.projectID.toLowerCase().includes(l.toLowerCase()),r="alle"===I.status||e.status===I.status,s=a.find(t=>t.id===e.customerID),i=s?s.firmennameKundenname||s.name:"Unbekannt",o="alle"===I.customer||i===I.customer;return n&&r&&o})].sort((e,t)=>{if(!E.key)return 0;let n=e[E.key],r=t[E.key];if("customer"===E.key){const s=a.find(t=>t.id===e.customerID),i=a.find(e=>e.id===t.customerID);n=s?s.firmennameKundenname||s.name:"Unbekannt",r=i?i.firmennameKundenname||i.name:"Unbekannt"}return n<r?"asc"===E.direction?-1:1:n>r?"asc"===E.direction?1:-1:0}),K=e=>{g(e),p(!0),y(null),b(!1)},B=async e=>{if(window.confirm("Sind Sie sicher, dass Sie dieses Projekt l\xf6schen m\xf6chten?"))try{await r(e),i("Projekt erfolgreich gel\xf6scht","success")}catch(t){i("Fehler beim L\xf6schen des Projekts","error")}y(null)};s.useEffect(()=>{(async()=>{try{M(!0);const e=(await ks.FirebaseService.getDocuments("user-preferences")).find(e=>"projectColumns"===e.type);e&&e.columns&&C(e.columns)}catch(e){console.error("Fehler beim Laden der Spalteneinstellungen:",e)}finally{M(!1)}})()},[]),s.useEffect(()=>{const e=e=>{N&&!e.target.closest(".column-settings-container")&&k(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[N]);e.length,e.filter(e=>"Aktiv"===e.status).length,e.filter(e=>"Geplant"===e.status).length,e.filter(e=>"Abgeschlossen"===e.status).length;return(0,gs.jsxs)("div",{className:"h-full flex flex-col space-y-6",children:[(0,gs.jsxs)("div",{className:"flex justify-between items-center flex-shrink-0",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Projekte"}),(0,gs.jsx)("p",{className:"text-gray-600",children:"Verwalten Sie Ihre Kundenprojekte"})]}),(0,gs.jsxs)("div",{className:"flex space-x-3",children:[(0,gs.jsxs)("button",{className:"flex items-center px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[(0,gs.jsx)(ba,{className:"h-4 w-4 mr-2"}),"Exportieren"]}),(0,gs.jsxs)("button",{onClick:()=>{g(null),p(!0)},className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[(0,gs.jsx)(ya,{className:"h-4 w-4 mr-2"}),"Projekt hinzuf\xfcgen"]})]})]}),(0,gs.jsx)("div",{className:"bg-white rounded-lg shadow p-6 flex-shrink-0",children:(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,gs.jsx)("input",{type:"text",placeholder:"Projekt suchen (ID, Beschreibung, Hersteller)...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",value:l,onChange:e=>o(e.target.value)})]})}),(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 flex-shrink-0",children:[(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Gesamt Projekte"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.length})]}),(0,gs.jsx)(Va,{className:"h-8 w-8 text-primary-600"})]})}),(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Aktiv"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-green-600",children:e.filter(e=>"Aktiv"===e.status).length})]}),(0,gs.jsx)(ba,{className:"h-8 w-8 text-green-500"})]})}),(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Geplant"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:e.filter(e=>"Geplant"===e.status).length})]}),(0,gs.jsx)(Xi,{className:"h-8 w-8 text-yellow-500"})]})}),(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Abgeschlossen"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-gray-600",children:e.filter(e=>"Abgeschlossen"===e.status).length})]}),(0,gs.jsx)(di,{className:"h-8 w-8 text-gray-500"})]})})]}),(0,gs.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden flex-1 flex flex-col min-h-0",children:[(0,gs.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Projektliste"}),(0,gs.jsxs)("div",{className:"relative column-settings-container",children:[(0,gs.jsx)("button",{onClick:()=>k(!N),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",title:"Spalten anpassen",children:(0,gs.jsx)(ja,{className:"h-5 w-5"})}),N&&(0,gs.jsx)("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-md shadow-lg z-20 border border-gray-200",children:(0,gs.jsxs)("div",{className:"p-4",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,gs.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:"Spalten anzeigen"}),P&&(0,gs.jsx)("div",{className:"text-xs text-gray-500",children:"L\xe4dt..."})]}),(0,gs.jsx)("div",{className:"space-y-2",children:[{key:"name",label:"Projekt",required:!0},{key:"customer",label:"Kunde",required:!1},{key:"status",label:"Status",required:!1},{key:"address",label:"Adresse",required:!1},{key:"description",label:"Beschreibung",required:!1}].map(e=>(0,gs.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,gs.jsx)("input",{type:"checkbox",checked:S[e.key],onChange:()=>!e.required&&(async e=>{const t=(0,Le.A)((0,Le.A)({},S),{},{[e]:!S[e]});C(t),await z(t)})(e.key),disabled:e.required||P,className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),(0,gs.jsxs)("span",{className:"text-sm ".concat(e.required?"text-gray-400":"text-gray-700"),children:[e.label,e.required&&" (erforderlich)"]})]},e.key))}),(0,gs.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,gs.jsx)("p",{className:"text-xs text-gray-500",children:"\ud83d\udcbe Einstellungen werden automatisch in Firebase gespeichert"})})]})})]})]})}),(0,gs.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,gs.jsx)("div",{className:"h-full overflow-auto",children:(0,gs.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,gs.jsx)("thead",{className:"bg-gray-50 sticky top-0 z-10",children:(0,gs.jsxs)("tr",{children:[S.name&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-50",onClick:()=>(e=>{let t="asc";E.key===e&&"asc"===E.direction&&(t="desc"),A({key:e,direction:t})})("name"),children:(0,gs.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,gs.jsx)("span",{children:"PROJEKT"}),(0,gs.jsx)("div",{className:"relative",children:"name"===E.key?(0,gs.jsx)("span",{className:"text-gray-400 hover:text-gray-600 text-lg font-bold",children:"asc"===E.direction?"\u2191":"\u2193"}):(0,gs.jsx)(Na,{className:"h-3 w-3 text-gray-400 hover:text-gray-600"})})]})}),S.customer&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,gs.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,gs.jsx)("span",{children:"Kunde"}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)("button",{onClick:()=>D("customer"===T?null:"customer"),className:"text-gray-400 hover:text-gray-600 p-1",children:(0,gs.jsx)(Na,{className:"h-3 w-3"})}),"customer"===T&&(0,gs.jsx)("div",{className:"absolute left-0 mt-1 w-48 bg-white rounded-md shadow-lg z-30 border border-gray-200",children:(0,gs.jsx)("div",{className:"p-2",children:(0,gs.jsx)("select",{value:I.customer,onChange:e=>V("customer",e.target.value),className:"w-full rounded-md border-gray-300 text-sm focus:border-primary-500 focus:ring-primary-500",children:F.map(e=>(0,gs.jsx)("option",{value:e,children:e},e))})})})]})]})}),S.status&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,gs.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,gs.jsx)("span",{children:"Status"}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)("button",{onClick:()=>D("status"===T?null:"status"),className:"text-gray-400 hover:text-gray-600 p-1",children:(0,gs.jsx)(Na,{className:"h-3 w-3"})}),"status"===T&&(0,gs.jsx)("div",{className:"absolute left-0 mt-1 w-48 bg-white rounded-md shadow-lg z-30 border border-gray-200",children:(0,gs.jsx)("div",{className:"p-2",children:(0,gs.jsx)("select",{value:I.status,onChange:e=>V("status",e.target.value),className:"w-full rounded-md border-gray-300 text-sm focus:border-primary-500 focus:ring-primary-500",children:L.map(e=>(0,gs.jsx)("option",{value:e,children:e},e))})})})]})]})}),S.address&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Adresse"}),S.description&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Beschreibung"}),(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aktionen"})]})}),(0,gs.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:U.map(e=>{var t;return(0,gs.jsxs)("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>(e=>{j(e),b(!0)})(e),children:[S.name&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsxs)("div",{children:[(0,gs.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,gs.jsxs)("div",{className:"text-sm text-gray-500",children:["ID: ",e.projectID]})]})}),S.customer&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsxs)("div",{className:"flex items-center",children:[(0,gs.jsx)(ma,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,gs.jsx)("span",{className:"text-sm text-gray-900",children:(null===(t=a.find(t=>t.id===e.customerID))||void 0===t?void 0:t.firmennameKundenname)||"Unbekannter Kunde"})]})}),S.status&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(O(e.status)),children:e.status})}),S.address&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsxs)("div",{className:"flex items-center",children:[(0,gs.jsx)(Ja,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,gs.jsx)("span",{className:"text-sm text-gray-900 truncate max-w-xs",children:e.address||"Nicht angegeben"})]})}),S.description&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsxs)("div",{className:"flex items-center",children:[(0,gs.jsx)(di,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,gs.jsx)("span",{className:"text-sm text-gray-900 truncate max-w-xs",children:e.description||"Keine Beschreibung"})]})}),(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)("button",{onClick:t=>{t.stopPropagation(),y(x===e.id?null:e.id)},className:"text-gray-400 hover:text-gray-600 p-1",children:(0,gs.jsx)(Sa,{className:"h-4 w-4"})}),x===e.id&&(0,gs.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-10 border border-gray-200",children:(0,gs.jsxs)("div",{className:"py-1",children:[(0,gs.jsxs)("button",{onClick:t=>{t.stopPropagation(),K(e)},className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left",children:[(0,gs.jsx)(Ca,{className:"h-4 w-4 mr-2"}),"Bearbeiten"]}),(0,gs.jsxs)("button",{onClick:t=>{t.stopPropagation(),B(e.id)},className:"flex items-center px-4 py-2 text-sm text-red-600 hover:bg-gray-100 w-full text-left",children:[(0,gs.jsx)(Ea,{className:"h-4 w-4 mr-2"}),"L\xf6schen"]})]})})]})})]},e.id)})})]})})}),0===U.length&&(0,gs.jsxs)("div",{className:"text-center py-12",children:[(0,gs.jsx)(Va,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,gs.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Keine Projekte gefunden"}),(0,gs.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:l||"alle"!==I.status||"alle"!==I.customer?"Versuchen Sie andere Suchbegriffe oder Filter.":"Beginnen Sie mit dem Erstellen Ihres ersten Projekts."})]})]}),(0,gs.jsx)(Ji,{isOpen:m,onClose:()=>{p(!1),g(null)},onSave:f?async e=>{try{await n(f.id,e),i("Projekt erfolgreich aktualisiert","success"),p(!1),g(null)}catch(t){console.error("Error updating project:",t),i("Fehler beim Aktualisieren des Projekts","error")}}:async e=>{try{f?(await n(f.id,e),i("Projekt erfolgreich aktualisiert","success")):(await t(e),i("Projekt erfolgreich erstellt","success")),p(!1),g(null)}catch(r){i("Fehler beim Speichern des Projekts","error")}},project:f,customers:a,projects:e}),(0,gs.jsx)(Qi,{isOpen:v,onClose:()=>b(!1),project:w,onEdit:K,onDelete:B})]})},$i=_s("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),el=_s("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),tl=()=>{const{bookings:e,undoBooking:t,getBookingStatistics:n}=Hs(),{showNotification:r}=Os(),[a,i]=(0,s.useState)(""),[l,o]=(0,s.useState)("alle"),[c,u]=(0,s.useState)("alle"),d=e,h=n(),m=d.filter(e=>{const t=e.customerName.toLowerCase().includes(a.toLowerCase())||e.customerID.toLowerCase().includes(a.toLowerCase())||e.projectName&&e.projectName.toLowerCase().includes(a.toLowerCase())||e.materials.some(e=>e.materialID.toLowerCase().includes(a.toLowerCase())||e.description.toLowerCase().includes(a.toLowerCase())),n="alle"===c||e.type===c;let r=!0;if("alle"!==l){const t=new Date(e.timestamp),n=new Date;switch(l){case"heute":r=t.toDateString()===n.toDateString();break;case"woche":r=t>=new Date(n.getTime()-6048e5);break;case"monat":r=t>=new Date(n.getTime()-2592e6);break;default:r=!0}}return t&&n&&r}),p=e=>{if(!e)return"Unbekannt";try{let t;if(e instanceof Date)t=e;else if("string"===typeof e||"number"===typeof e)t=new Date(e);else if(e.seconds)t=new Date(1e3*e.seconds);else{if(!e.toDate||"function"!==typeof e.toDate)return"Ung\xfcltiges Datum";t=e.toDate()}return isNaN(t.getTime())?"Ung\xfcltiges Datum":t.toLocaleString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(t){return console.error("Fehler beim Formatieren des Datums:",t,e),"Ung\xfcltiges Datum"}},f=e=>"Eingang"===e?"bg-green-100 text-green-800":"bg-red-100 text-red-800";return(0,gs.jsxs)("div",{className:"h-full flex flex-col space-y-6",children:[(0,gs.jsx)("div",{className:"flex items-center justify-between",children:(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Buchungshistorie"}),(0,gs.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:"\xdcbersicht \xfcber alle Material-Buchungen und Bewegungen"})]})}),(0,gs.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,gs.jsxs)("div",{className:"flex-1 relative",children:[(0,gs.jsx)(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,gs.jsx)("input",{type:"text",placeholder:"Suchen (Kunde, Projekt, Material)...",value:a,onChange:e=>i(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})}),(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Gesamt Buchungen"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:h.total})]}),(0,gs.jsx)($i,{className:"h-8 w-8 text-primary-600"})]})}),(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Eing\xe4nge"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-green-600",children:h.eingaenge})]}),(0,gs.jsx)(ga,{className:"h-8 w-8 text-green-600"})]})}),(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Ausg\xe4nge"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-red-600",children:h.ausgaenge})]}),(0,gs.jsx)(xa,{className:"h-8 w-8 text-red-600"})]})}),(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Heute"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:h.heute})]}),(0,gs.jsx)(Xi,{className:"h-8 w-8 text-blue-600"})]})})]}),(0,gs.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden flex-1 flex flex-col",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 flex-shrink-0",children:[(0,gs.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Buchungsliste"}),(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)(Xi,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsxs)("select",{value:l,onChange:e=>o(e.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"alle",children:"Alle Zeiten"}),(0,gs.jsx)("option",{value:"heute",children:"Heute"}),(0,gs.jsx)("option",{value:"woche",children:"Letzte Woche"}),(0,gs.jsx)("option",{value:"monat",children:"Letzter Monat"})]}),(0,gs.jsx)(Na,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsxs)("select",{value:c,onChange:e=>u(e.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"alle",children:"Alle Buchungen"}),(0,gs.jsx)("option",{value:"Eingang",children:"Nur Eing\xe4nge"}),(0,gs.jsx)("option",{value:"Ausgang",children:"Nur Ausg\xe4nge"})]})]})]}),(0,gs.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,gs.jsx)("div",{className:"h-full overflow-auto",children:(0,gs.jsxs)("div",{className:"space-y-4 p-6",children:[m.map(e=>{return(0,gs.jsx)("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50",children:(0,gs.jsxs)("div",{className:"flex items-start justify-between",children:[(0,gs.jsxs)("div",{className:"flex-1",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(n=e.type,"Eingang"===n?(0,gs.jsx)(ga,{className:"h-4 w-4 text-green-600"}):(0,gs.jsx)(xa,{className:"h-4 w-4 text-red-600"})),(0,gs.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(f(e.type)),children:e.type}),(0,gs.jsx)("span",{className:"text-sm text-gray-500",children:p(e.timestamp)})]}),(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,gs.jsx)(ma,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.customerName}),(0,gs.jsxs)("span",{className:"text-sm text-gray-500",children:["(",e.customerID,")"]})]}),e.projectName&&"Unbekannt"!==e.projectName?(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,gs.jsx)(Va,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsxs)("span",{className:"text-sm font-medium text-blue-900",children:["Projekt: ",e.projectName]})]}):e.projectID&&(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,gs.jsx)(Va,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsxs)("span",{className:"text-sm font-medium text-blue-900",children:["Projekt-ID: ",e.projectID]})]}),(0,gs.jsx)("div",{className:"space-y-2",children:e.materials.map((e,t)=>(0,gs.jsxs)("div",{className:"flex items-center space-x-3 text-sm",children:[(0,gs.jsx)(ba,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsxs)("span",{className:"font-medium text-gray-900",children:[e.quantity,"x"]}),(0,gs.jsx)("span",{className:"font-medium text-gray-900",children:e.description}),(0,gs.jsx)("span",{className:"text-gray-500 text-xs",children:e.materialID})]},t))})]}),(0,gs.jsx)("div",{className:"flex items-center space-x-2",children:(0,gs.jsx)("button",{onClick:()=>{return n=e.id,void(window.confirm("Buchung wirklich r\xfcckg\xe4ngig machen?")&&(t(n),r("Buchung erfolgreich r\xfcckg\xe4ngig gemacht","success")));var n},className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Buchung r\xfcckg\xe4ngig machen",children:(0,gs.jsx)(el,{className:"h-4 w-4"})})})]})},e.id);var n}),0===m.length&&(0,gs.jsxs)("div",{className:"text-center py-12",children:[(0,gs.jsx)($i,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,gs.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Keine Buchungen gefunden"}),(0,gs.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:a||"alle"!==l||"alle"!==c?"Versuchen Sie andere Filter oder Suchbegriffe.":"Es wurden noch keine Buchungen durchgef\xfchrt."})]})]})})})]})]})},nl=_s("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),rl=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Number(e);return Number.isFinite(n)?n:t},sl=e=>(null===e||void 0===e?void 0:e.firmennameKundenname)||(null===e||void 0===e?void 0:e.name)||"Unbekannter Kunde",al=e=>{var t,n,r,s,a,i,l,o,c;if(!e)return"Keine Adresse";return[null!==(t=null!==(n=null===e||void 0===e||null===(r=e.address)||void 0===r?void 0:r.street)&&void 0!==n?n:null===e||void 0===e?void 0:e.street)&&void 0!==t?t:"",[null!==(s=null!==(a=null===e||void 0===e||null===(i=e.address)||void 0===i?void 0:i.zipCode)&&void 0!==a?a:null===e||void 0===e?void 0:e.postalCode)&&void 0!==s?s:"",null!==(l=null!==(o=null===e||void 0===e||null===(c=e.address)||void 0===c?void 0:c.city)&&void 0!==o?o:null===e||void 0===e?void 0:e.city)&&void 0!==l?l:""].filter(Boolean).join(" ")].filter(Boolean).join(", ")||"Keine Adresse"},il=e=>(e||"").toString().toLowerCase(),ll=()=>{const{customers:e}=Vs(),{projects:t}=Ks(),{bookings:n}=Hs(),{materials:r}=Cs(),[a,i]=(0,s.useState)(null),[l,o]=(0,s.useState)(""),[c,u]=(0,s.useState)([]),[d,h]=(0,s.useState)(!0),[m,p]=(0,s.useState)(0),f=(0,s.useMemo)(()=>{const t=new Map;return e.forEach(e=>t.set(e.id,e)),t},[e]),g=(0,s.useMemo)(()=>{const e=il(l);return e?t.filter(t=>{if(!t)return!1;const n=f.get(t.customerID);return il(t.name).includes(e)||il(t.status).includes(e)||il(t.customerName).includes(e)||il(sl(n)).includes(e)}):t},[l,t,f]),x=(e,t,n)=>{if(!e)return[];const r=t.filter(t=>(null===t||void 0===t?void 0:t.projectID)===e.id&&"ausgang"===il(null===t||void 0===t?void 0:t.type)),s=new Map;for(const i of r){const e=Array.isArray(null===i||void 0===i?void 0:i.materials)?i.materials:[];for(const t of e){const e=n.find(e=>(null===e||void 0===e?void 0:e.id)===(null===t||void 0===t?void 0:t.materialID)||(null===e||void 0===e?void 0:e.materialID)===(null===t||void 0===t?void 0:t.materialID)||(null===e||void 0===e?void 0:e.id)===(null===t||void 0===t?void 0:t.id)||(null===e||void 0===e?void 0:e.materialID)===(null===t||void 0===t?void 0:t.id));if(!e)continue;const r=e.id||e.materialID||"".concat(e.description||e.name),i=rl(e.itemsPerUnit,1),l=e.unit||"St\xfcck",o=e.description||e.name||e.materialID||"Material";if(s.has(r)){const e=s.get(r);s.set(r,(0,Le.A)((0,Le.A)({},e),{},{quantity:e.quantity+rl(t.quantity,0),totalUnits:i*(e.quantity+rl(t.quantity,0))}))}else{var a;const n=rl(t.quantity,0);s.set(r,{key:r,id:e.id||e.materialID||r,materialID:e.materialID||"",description:o,unit:l,itemsPerUnit:i,quantity:n,totalUnits:i*n,categoryId:null!==(a=e.categoryId)&&void 0!==a?a:null})}}}return Array.from(s.values()).sort((e,t)=>{const n=e.description||"",r=t.description||"",s=n.localeCompare(r,"de",{sensitivity:"base"});return 0!==s?s:(e.materialID||"").localeCompare(t.materialID||"","de",{sensitivity:"base"})})},y=(0,s.useRef)(!0);(0,s.useEffect)(()=>{if(!a)return;if(!y.current&&0===m)return;const e=x(a,n,r);u(e),y.current=!1},[a,m]);const v=e=>{u(t=>t.filter(t=>t.id!==e))},b=a?f.get(a.customerID):null;return d?(0,gs.jsxs)("div",{className:"h-full flex flex-col bg-white",children:[(0,gs.jsx)("div",{className:"flex-shrink-0 border-b border-gray-200 p-4",children:(0,gs.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,gs.jsx)(di,{className:"h-6 w-6 text-blue-600"}),(0,gs.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"St\xfcckliste"})]})}),(0,gs.jsx)("div",{className:"flex-1 p-6",children:(0,gs.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,gs.jsxs)("div",{className:"relative mb-4",children:[(0,gs.jsx)(va,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,gs.jsx)("input",{type:"text",placeholder:"Projekt suchen\u2026",value:l,onChange:e=>o(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{className:"space-y-1 max-h-72 overflow-y-auto",children:[g.map(e=>{const t=f.get(e.customerID);return(0,gs.jsxs)("button",{onClick:()=>(e=>{i(e),h(!1),p(0),y.current=!0})(e),className:"w-full text-left flex items-center space-x-3 p-2 hover:bg-gray-50 cursor-pointer transition-colors rounded",children:[(0,gs.jsx)(Va,{className:"h-4 w-4 text-gray-400"}),(0,gs.jsxs)("div",{className:"flex-1",children:[(0,gs.jsx)("p",{className:"font-medium text-gray-900 text-sm",children:e.name}),(0,gs.jsxs)("p",{className:"text-xs text-gray-600",children:[sl(t)," \u2022 ",e.status]})]})]},e.id)}),0===g.length&&(0,gs.jsx)("div",{className:"text-center py-4 text-gray-500",children:(0,gs.jsx)("p",{className:"text-sm",children:"Keine Projekte gefunden"})})]})]})})]}):(0,gs.jsxs)("div",{className:"h-full flex flex-col bg-white",children:[(0,gs.jsx)("div",{className:"flex-shrink-0 border-b border-gray-200 p-6 print:hidden",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,gs.jsx)(di,{className:"h-8 w-8 text-blue-600"}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"St\xfcckliste"}),(0,gs.jsx)("p",{className:"text-gray-600",children:null===a||void 0===a?void 0:a.name})]})]}),(0,gs.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,gs.jsx)("button",{onClick:()=>{i(null),u([]),h(!0),o(""),p(0),y.current=!0},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",title:"Neues Projekt w\xe4hlen",children:"Zur\xfcck"}),(0,gs.jsxs)("button",{onClick:()=>{p(e=>e+1);const e=x(a,n,r);u(e)},className:"flex items-center space-x-2 px-4 py-2 bg-white border rounded-lg hover:bg-gray-50 transition-colors",title:"Aus Buchungen aktualisieren",children:[(0,gs.jsx)(nl,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"Aktualisieren"})]}),(0,gs.jsxs)("button",{onClick:()=>{window.print()},className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",title:"Drucken",children:[(0,gs.jsx)(pi,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:"Drucken"})]})]})]})}),(0,gs.jsx)("div",{className:"flex-1 overflow-auto print:overflow-visible",children:(0,gs.jsxs)("div",{className:"p-8 print:p-0 print:m-0",children:[(0,gs.jsxs)("div",{className:"mb-6 print:mb-2",children:[(0,gs.jsx)("div",{className:"text-center mb-4 print:mb-1",children:(0,gs.jsx)("h1",{className:"text-2xl font-bold text-gray-900 print:text-black print:text-lg",children:"ST\xdcCKLISTE"})}),(0,gs.jsxs)("div",{className:"bg-gray-50 print:bg-white print:border print:border-gray-300 rounded-lg p-4 print:p-2",children:[(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 print:hidden",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(Va,{className:"h-4 w-4 text-gray-600"}),(0,gs.jsx)("span",{className:"font-semibold text-gray-900",children:"Projekt:"})]}),(0,gs.jsx)("p",{className:"text-base font-medium text-gray-900",children:(null===a||void 0===a?void 0:a.name)||"Unbekanntes Projekt"}),(0,gs.jsxs)("p",{className:"text-sm text-gray-600",children:["Status: ",(null===a||void 0===a?void 0:a.status)||"Unbekannt"]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(ma,{className:"h-4 w-4 text-gray-600"}),(0,gs.jsx)("span",{className:"font-semibold text-gray-900",children:"Kunde:"})]}),(0,gs.jsx)("p",{className:"text-gray-900",children:sl(b)})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,gs.jsx)(Ja,{className:"h-4 w-4 text-gray-600"}),(0,gs.jsx)("span",{className:"font-semibold text-gray-900",children:"Adresse:"})]}),(0,gs.jsx)("p",{className:"text-gray-900",children:al(b)})]})]}),(0,gs.jsxs)("div",{className:"hidden print:block text-sm space-y-1",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"font-semibold",children:"Projekt:"})," ",(null===a||void 0===a?void 0:a.name)||"Unbekanntes Projekt"," (",(null===a||void 0===a?void 0:a.status)||"Unbekannt",")"]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"font-semibold",children:"Kunde:"})," ",sl(b)]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"font-semibold",children:"Adresse:"})," ",al(b)]})]})]})]}),(0,gs.jsxs)("div",{className:"bg-white print:bg-white",children:[(0,gs.jsxs)("table",{className:"w-full border-collapse border border-gray-300 print:border-black",children:[(0,gs.jsx)("thead",{children:(0,gs.jsxs)("tr",{className:"bg-gray-100 print:bg-gray-200",children:[(0,gs.jsx)("th",{className:"border border-gray-300 print:border-black px-4 py-3 text-left font-semibold text-gray-900 print:text-black w-16",children:"Pos."}),(0,gs.jsx)("th",{className:"border border-gray-300 print:border-black px-4 py-3 text-left font-semibold text-gray-900 print:text-black",children:"Material"}),(0,gs.jsx)("th",{className:"border border-gray-300 print:border-black px-4 py-3 text-left font-semibold text-gray-900 print:text-black w-40",children:"St\xfcck pro Einheit"}),(0,gs.jsx)("th",{className:"border border-gray-300 print:border-black px-4 py-3 text-left font-semibold text-gray-900 print:text-black w-28",children:"Anzahl"}),(0,gs.jsx)("th",{className:"border border-gray-300 print:border-black px-4 py-3 text-center w-16 print:hidden",children:"Aktion"})]})}),(0,gs.jsx)("tbody",{children:c.map((e,t)=>(0,gs.jsxs)("tr",{className:"hover:bg-gray-50 print:hover:bg-white",children:[(0,gs.jsx)("td",{className:"border border-gray-300 print:border-black px-4 py-3 text-gray-900 print:text-black text-center",children:t+1}),(0,gs.jsx)("td",{className:"border border-gray-300 print:border-black px-4 py-3 align-top",children:(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"font-medium text-gray-900 print:text-black",children:e.description||e.name}),(0,gs.jsx)("p",{className:"text-sm text-gray-500 print:text-gray-700",children:e.materialID})]})}),(0,gs.jsx)("td",{className:"border border-gray-300 print:border-black px-4 py-3 text-gray-900 print:text-black text-center",children:e.itemsPerUnit||1}),(0,gs.jsxs)("td",{className:"border border-gray-300 print:border-black px-4 py-3 text-gray-900 print:text-black",children:[(0,gs.jsx)("input",{type:"number",value:e.quantity,onChange:t=>((e,t)=>{const n=Math.max(0,rl(t,0));0!==n?u(t=>t.map(t=>t.id===e?(0,Le.A)((0,Le.A)({},t),{},{quantity:n,totalUnits:(t.itemsPerUnit||1)*n}):t)):v(e)})(e.id,t.target.value),className:"print:hidden w-full px-2 py-1 border border-gray-300 rounded text-center",min:"1"}),(0,gs.jsx)("span",{className:"hidden print:block text-center",children:e.quantity})]}),(0,gs.jsx)("td",{className:"border border-gray-300 print:border-black px-4 py-3 text-center print:hidden",children:(0,gs.jsx)("button",{onClick:()=>v(e.id),className:"text-red-600 hover:text-red-800 transition-colors",title:"Position entfernen",children:(0,gs.jsx)(Ea,{className:"h-4 w-4"})})})]},e.id))})]}),0===c.length&&(0,gs.jsxs)("div",{className:"text-center py-8 text-gray-500 print:hidden",children:[(0,gs.jsx)(di,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),(0,gs.jsx)("p",{children:"Keine Materialien f\xfcr dieses Projekt gebucht"})]})]})]})}),(0,gs.jsx)("style",{children:'\n          @media print {\n            @page { size: A4; margin: 12mm; }\n\n            /* Grundlegende Print-Bereinigung, ohne harte Resets */\n            html, body { background: #fff !important; }\n            .print\\:hidden { display: none !important; }\n            .hidden.print\\:block { display: block !important; }\n\n            /* Verstecke alle UI-Elemente au\xdfer Druckinhalt */\n            nav, header, aside, .sidebar, [role="navigation"], [role="banner"] { display: none !important; }\n            \n            /* Verstecke Sidebar und alle Navigations-Buttons */\n            .fixed.top-4.left-4, .fixed.inset-0.z-40 { display: none !important; }\n            button:not(.print-button), .menu-button, [data-testid*="menu"] { display: none !important; }\n            .hamburger, .mobile-menu, .nav-toggle { display: none !important; }\n            \n            /* Verstecke speziell das Hamburger-Men\xfc der Sidebar */\n            .lg\\:hidden button { display: none !important; }\n\n            /* Entferne Web-Styles von Inputs im Druck */\n            input { border: none !important; background: transparent !important; padding: 0 !important; }\n\n            /* Sichere klare Tabellenrahmen */\n            table, th, td { border-color: #000 !important; }\n\n            /* Verhindere Layout-Verschiebungen */\n            .print\\:overflow-visible { overflow: visible !important; }\n            .print\\:p-0 { padding: 0 !important; }\n            .print\\:m-0 { margin: 0 !important; }\n          }\n        '})]})},ol=_s("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),cl=_s("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),ul=e=>{let{isOpen:t,onClose:n,onSelectConfiguration:r}=e;const{projects:a}=Ks(),{customers:i}=Vs(),[l,o]=(0,s.useState)(""),[c,u]=(0,s.useState)(""),[d,h]=(0,s.useState)(""),[m,p]=(0,s.useState)([]),[f,g]=(0,s.useState)([]),[x,y]=(0,s.useState)(!1);(0,s.useEffect)(()=>{t&&(o(""),u(""),h(""),p([]),g([]))},[t]),(0,s.useEffect)(()=>{if(l){const e=a.filter(e=>e.customerID===l);p(e),u(""),h(""),g([])}else p([])},[l,a]),(0,s.useEffect)(()=>{(async()=>{if(!c)return g([]),void h("");y(!0);try{const e=(await ks.FirebaseService.getDocuments("project-configurations")).filter(e=>e.projectID===c);e.sort((e,t)=>new Date(t.createdAt)-new Date(e.createdAt)),g(e),h("")}catch(e){console.error("Fehler beim Laden der Projektkonfigurationen:",e),g([])}finally{y(!1)}})()},[c]);const v=(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsx)("button",{onClick:n,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Abbrechen"}),(0,gs.jsx)("button",{onClick:()=>{if(!l||!c||!d)return void alert("Bitte w\xe4hlen Sie Kunde, Projekt und Konfiguration aus!");const e=i.find(e=>e.id===l),t=a.find(e=>e.id===c),s=f.find(e=>e.id===d);r({customer:e,project:t,configuration:s,selectedProject:c,selectedCustomer:l}),n()},disabled:!l||!c||!d,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"VDE-Protokoll generieren"})]});return(0,gs.jsx)(_a,{isOpen:t,onClose:n,title:"VDE-Protokoll aus Projekt generieren",icon:di,footerButtons:v,children:(0,gs.jsxs)("div",{className:"space-y-6",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[(0,gs.jsx)(ma,{className:"h-4 w-4 mr-2"}),"Kunde ausw\xe4hlen"]}),(0,gs.jsxs)("select",{value:l,onChange:e=>o(e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[(0,gs.jsx)("option",{value:"",children:"-- Kunde w\xe4hlen --"}),i.map(e=>(0,gs.jsx)("option",{value:e.id,children:e.firmennameKundenname},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[(0,gs.jsx)(Va,{className:"h-4 w-4 mr-2"}),"Projekt ausw\xe4hlen"]}),(0,gs.jsxs)("select",{value:c,onChange:e=>u(e.target.value),disabled:!l,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[(0,gs.jsx)("option",{value:"",children:"-- Projekt w\xe4hlen --"}),m.map(e=>(0,gs.jsx)("option",{value:e.id,children:e.projectName||e.name||e.title||e.projektName||e.address||e.id},e.id))]}),l&&0===m.length&&(0,gs.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Keine Projekte f\xfcr diesen Kunden gefunden."})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[(0,gs.jsx)(di,{className:"h-4 w-4 mr-2"}),"Konfiguration ausw\xe4hlen"]}),x?(0,gs.jsx)("div",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-50 text-gray-500",children:"Lade Konfigurationen..."}):(0,gs.jsxs)("select",{value:d,onChange:e=>h(e.target.value),disabled:!c,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[(0,gs.jsx)("option",{value:"",children:"-- Konfiguration w\xe4hlen --"}),f.map(e=>(0,gs.jsx)("option",{value:e.id,children:(e=>{if(!e)return"Unbekanntes Datum";if(e&&"object"===typeof e&&e.seconds){const t=new Date(1e3*e.seconds);return t.toLocaleDateString("de-DE")+" "+t.toLocaleTimeString("de-DE")}if("string"===typeof e&&e.includes("um")&&e.includes("UTC"))return e.replace(" UTC+2","").replace(" um "," ");try{const t=new Date(e);return isNaN(t.getTime())?String(e):t.toLocaleDateString("de-DE")+" "+t.toLocaleTimeString("de-DE")}catch(t){return String(e)}})(e.createdAt)},e.id))]}),c&&!x&&0===f.length&&(0,gs.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Keine Konfigurationen f\xfcr dieses Projekt gefunden."})]})]})})},dl=()=>{const{projects:e}=Ks(),{customers:t}=Vs(),{showNotification:n}=Os(),[r,a]=(0,s.useState)(""),[i,l]=(0,s.useState)(null),[o,c]=(0,s.useState)(!1),[u,d]=(0,s.useState)(null),[h,m]=(0,s.useState)(!1),[p,f]=(0,s.useState)(!1),[g,x]=(0,s.useState)([]),[y,v]=(0,s.useState)(!0),[b,w]=(0,s.useState)(!1),[j,N]=(0,s.useState)({protocolNumber:!0,customerName:!0,projectName:!0,power:!0,moduleCount:!0,stringCount:!0,inverterModel:!0,createdDate:!0}),[k,S]=(0,s.useState)({key:null,direction:"asc"}),[C,E]=(0,s.useState)({status:"alle",customer:"alle"}),[A,I]=(0,s.useState)(null),[_,T]=(0,s.useState)(!0),[D,P]=(0,s.useState)(null),[M,R]=(0,s.useState)("");s.useEffect(()=>{const e=e=>{b&&!e.target.closest(".column-settings-container")&&w(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[b]),(0,s.useEffect)(()=>{O(),U()},[]);const O=async()=>{try{v(!0);const e=await ks.FirebaseService.getDocuments("vde-protocols");x(e||[])}catch(e){console.error("Fehler beim Laden der VDE-Protokolle:",e)}finally{v(!1)}},L=["alle",...new Set(g.map(e=>e.status).filter(Boolean))],F=(new Set(g.map(e=>e.customerName).filter(Boolean)),[...g.filter(e=>{var t,n,s;const a=""===r||(null===(t=e.protocolNumber)||void 0===t?void 0:t.toLowerCase().includes(r.toLowerCase()))||(null===(n=e.customerName)||void 0===n?void 0:n.toLowerCase().includes(r.toLowerCase()))||(null===(s=e.customerID)||void 0===s?void 0:s.toLowerCase().includes(r.toLowerCase())),i="alle"===C.status||e.status===C.status,l="alle"===C.customer||e.customerName===C.customer;return a&&i&&l})].sort((e,t)=>{if(!k.key)return 0;let n=e[k.key],r=t[k.key];return"power"!==k.key&&"moduleCount"!==k.key&&"stringCount"!==k.key||(n=parseFloat(n)||0,r=parseFloat(r)||0),n<r?"asc"===k.direction?-1:1:n>r?"asc"===k.direction?1:-1:0})),V=e=>{if(!e)return"-";const t=new Date(e);return isNaN(t.getTime())?"-":t.toLocaleDateString("de-DE")},z=e=>{let t="asc";k.key===e&&"asc"===k.direction&&(t="desc"),S({key:e,direction:t})},U=async()=>{try{T(!0);const e=(await ks.FirebaseService.getDocuments("user-preferences")).find(e=>"vdeProtocolColumns"===e.type);e&&e.columns&&N(e.columns)}catch(e){console.error("Fehler beim Laden der Spalteneinstellungen:",e)}finally{T(!1)}},K=async e=>{try{const t=(await ks.FirebaseService.getDocuments("user-preferences")).find(e=>"vdeProtocolColumns"===e.type),n={type:"vdeProtocolColumns",columns:e,updatedAt:new Date};t?await ks.FirebaseService.updateDocument("user-preferences",t.id,n):await ks.FirebaseService.addDocument("user-preferences",(0,Le.A)((0,Le.A)({},n),{},{createdAt:new Date}))}catch(t){console.error("Fehler beim Speichern der Spalteneinstellungen:",t),n("Fehler beim Speichern der Spalteneinstellungen","error")}},B=e=>{const t=g.find(t=>t.id===e);d(t),c(!0),f(!1),l(null)};return(0,gs.jsxs)("div",{className:"h-full flex flex-col space-y-6",children:[(0,gs.jsxs)("div",{className:"flex justify-between items-center flex-shrink-0",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"VDE Protokolle"}),(0,gs.jsx)("p",{className:"text-gray-600",children:"Erstellen und verwalten Sie VDE-Pr\xfcfprotokolle f\xfcr PV-Anlagen"})]}),(0,gs.jsxs)("div",{className:"flex space-x-3",children:[(0,gs.jsxs)("button",{className:"flex items-center px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[(0,gs.jsx)(ba,{className:"h-4 w-4 mr-2"}),"Exportieren"]}),(0,gs.jsxs)("button",{onClick:()=>{m(!0)},className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[(0,gs.jsx)(ol,{className:"h-4 w-4 mr-2"}),"Aus Projekt generieren"]})]})]}),(0,gs.jsx)("div",{className:"bg-white rounded-lg shadow p-6 flex-shrink-0",children:(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,gs.jsx)("input",{type:"text",placeholder:"Protokoll suchen (Nummer, Kunde)...",value:r,onChange:e=>a(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})}),(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 flex-shrink-0",children:[(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Gesamt Protokolle"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:g.length})]}),(0,gs.jsx)(di,{className:"h-8 w-8 text-primary-600"})]})}),(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Erstellt"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:g.filter(e=>"Erstellt"===e.status).length})]}),(0,gs.jsx)(Va,{className:"h-8 w-8 text-blue-500"})]})}),(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Gepr\xfcft"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-green-600",children:g.filter(e=>"Gepr\xfcft"===e.status).length})]}),(0,gs.jsx)(ol,{className:"h-8 w-8 text-green-500"})]})}),(0,gs.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Abgeschlossen"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-gray-600",children:g.filter(e=>"Abgeschlossen"===e.status).length})]}),(0,gs.jsx)(ma,{className:"h-8 w-8 text-gray-500"})]})})]}),(0,gs.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden flex-1 flex flex-col min-h-0",children:[(0,gs.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Protokoll-Liste"}),(0,gs.jsxs)("div",{className:"relative column-settings-container",children:[(0,gs.jsx)("button",{onClick:()=>w(!b),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",title:"Spalten anpassen",children:(0,gs.jsx)(ja,{className:"h-5 w-5"})}),b&&(0,gs.jsx)("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-md shadow-lg z-20 border border-gray-200",children:(0,gs.jsxs)("div",{className:"p-4",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,gs.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:"Spalten anzeigen"}),_&&(0,gs.jsx)("div",{className:"text-xs text-gray-500",children:"L\xe4dt..."})]}),(0,gs.jsx)("div",{className:"space-y-2",children:[{key:"protocolNumber",label:"Protokoll-Nr.",required:!0},{key:"customerName",label:"Kunde",required:!1},{key:"projectName",label:"Projekt",required:!1},{key:"power",label:"Leistung (kWp)",required:!1},{key:"moduleCount",label:"Module",required:!1},{key:"stringCount",label:"Strings",required:!1},{key:"inverterModel",label:"Wechselrichter",required:!1},{key:"createdDate",label:"Erstellt",required:!1}].map(e=>(0,gs.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,gs.jsx)("input",{type:"checkbox",checked:j[e.key],onChange:()=>!e.required&&(async e=>{const t=(0,Le.A)((0,Le.A)({},j),{},{[e]:!j[e]});N(t),await K(t)})(e.key),disabled:e.required||_,className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),(0,gs.jsxs)("span",{className:"text-sm ".concat(e.required?"text-gray-400":"text-gray-700"),children:[e.label,e.required&&" (erforderlich)"]})]},e.key))}),(0,gs.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,gs.jsx)("p",{className:"text-xs text-gray-500",children:"\ud83d\udcbe Einstellungen werden automatisch in Firebase gespeichert"})})]})})]})]})}),(0,gs.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,gs.jsx)("div",{className:"h-full overflow-auto",children:(0,gs.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,gs.jsx)("thead",{className:"bg-gray-50 sticky top-0 z-10",children:(0,gs.jsxs)("tr",{children:[j.protocolNumber&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-50",onClick:()=>z("protocolNumber"),children:(0,gs.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,gs.jsx)("span",{children:"PROTOKOLL-NR."}),(0,gs.jsx)("div",{className:"relative",children:"protocolNumber"===k.key?(0,gs.jsx)("span",{className:"text-gray-400 hover:text-gray-600 text-lg font-bold",children:"asc"===k.direction?"\u2191":"\u2193"}):(0,gs.jsx)(Na,{className:"h-3 w-3 text-gray-400 hover:text-gray-600"})})]})}),j.customerName&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,gs.jsx)("div",{className:"flex items-center space-x-1",children:(0,gs.jsx)("span",{children:"KUNDE"})})}),j.projectName&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,gs.jsx)("div",{className:"flex items-center space-x-1",children:(0,gs.jsx)("span",{children:"PROJEKT"})})}),j.status&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,gs.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,gs.jsx)("span",{children:"STATUS"}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)("button",{onClick:()=>I("status"===A?null:"status"),className:"text-gray-400 hover:text-gray-600 p-1",children:(0,gs.jsx)(Na,{className:"h-3 w-3"})}),"status"===A&&(0,gs.jsx)("div",{className:"absolute left-0 mt-1 w-48 bg-white rounded-md shadow-lg z-30 border border-gray-200",children:(0,gs.jsx)("div",{className:"p-2",children:(0,gs.jsx)("select",{value:C.status,onChange:e=>{return t="status",n=e.target.value,E(e=>(0,Le.A)((0,Le.A)({},e),{},{[t]:n})),void I(null);var t,n},className:"w-full rounded-md border-gray-300 text-sm focus:border-primary-500 focus:ring-primary-500",children:L.map(e=>(0,gs.jsx)("option",{value:e,children:e},e))})})})]})]})}),j.power&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-50",onClick:()=>z("power"),children:(0,gs.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,gs.jsx)("span",{children:"LEISTUNG (kWp)"}),"power"===k.key&&(0,gs.jsx)("span",{className:"text-gray-400 hover:text-gray-600 text-lg font-bold",children:"asc"===k.direction?"\u2191":"\u2193"})]})}),j.moduleCount&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-50",onClick:()=>z("moduleCount"),children:"MODULE"}),j.stringCount&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-50",onClick:()=>z("stringCount"),children:"STRINGS"}),j.inverterModel&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"WECHSELRICHTER"}),j.createdDate&&(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-50",onClick:()=>z("createdDate"),children:"ERSTELLT"}),(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"AKTIONEN"})]})}),(0,gs.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:F.map(e=>(0,gs.jsxs)("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>B(e.id),children:[j.protocolNumber&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.protocolNumber})}),j.customerName&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.customerName||"-"})}),j.projectName&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsx)("div",{className:"text-sm text-gray-900",children:e.projectName||"-"})}),j.power&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsxs)("div",{className:"text-sm text-gray-900",children:[e.power," kWp"]})}),j.moduleCount&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsx)("div",{className:"text-sm text-gray-900",children:e.moduleCount})}),j.stringCount&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsx)("div",{className:"text-sm text-gray-900",children:e.stringCount})}),j.inverterModel&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,gs.jsx)("div",{className:"text-sm text-gray-900",children:e.inverterModel||"-"})}),j.createdDate&&(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:V(e.createdDate)}),(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)("button",{onClick:t=>{t.stopPropagation(),l(i===e.id?null:e.id)},className:"text-gray-400 hover:text-gray-600 p-1",children:(0,gs.jsx)(Sa,{className:"h-4 w-4"})}),i===e.id&&(0,gs.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-10 border border-gray-200",children:(0,gs.jsxs)("div",{className:"py-1",children:[(0,gs.jsxs)("button",{onClick:t=>{var n;t.stopPropagation(),n=e.id,console.log("Download protocol:",n),l(null)},className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left",children:[(0,gs.jsx)(cl,{className:"h-4 w-4 mr-2"}),"PDF herunterladen"]}),(0,gs.jsxs)("button",{onClick:t=>{t.stopPropagation(),B(e.id)},className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left",children:[(0,gs.jsx)(Ca,{className:"h-4 w-4 mr-2"}),"Bearbeiten"]}),(0,gs.jsxs)("button",{onClick:t=>{t.stopPropagation(),(async e=>{if(window.confirm("Protokoll wirklich l\xf6schen?"))try{await ks.FirebaseService.deleteDocument("vde-protocols",e),await O(),n("Protokoll erfolgreich gel\xf6scht","success")}catch(t){console.error("Fehler beim L\xf6schen des Protokolls:",t),n("Fehler beim L\xf6schen des Protokolls","error")}l(null)})(e.id)},className:"flex items-center px-4 py-2 text-sm text-red-600 hover:bg-gray-100 w-full text-left",children:[(0,gs.jsx)(Ea,{className:"h-4 w-4 mr-2"}),"L\xf6schen"]})]})})]})})]},e.id))})]})})}),y?(0,gs.jsxs)("div",{className:"text-center py-12",children:[(0,gs.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"}),(0,gs.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Lade VDE-Protokolle..."})]}):0===F.length?(0,gs.jsxs)("div",{className:"text-center py-12",children:[(0,gs.jsx)(di,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,gs.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Keine Protokolle gefunden"}),(0,gs.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:r||"alle"!==C.status||"alle"!==C.customer?"Versuchen Sie andere Suchbegriffe oder Filter.":"Beginnen Sie mit der Erstellung Ihres ersten VDE-Protokolls."})]}):null]}),i&&(0,gs.jsx)("div",{className:"fixed inset-0 z-0",onClick:()=>l(null)}),(0,gs.jsx)(Oi,{isOpen:o,onClose:()=>{c(!1),d(null),f(!1),O()},protocol:u,hideActions:p}),(0,gs.jsx)(ul,{isOpen:h,onClose:()=>m(!1),onSelectConfiguration:e=>{var t,n;let{customer:r,project:s,configuration:a,selectedProject:i,selectedCustomer:l}=e;const o=a.pvConfiguration,u={projectID:i,customerID:l,customerName:(null===r||void 0===r?void 0:r.firmennameKundenname)||"Unbekannt",projectName:(null===s||void 0===s?void 0:s.name)||(null===s||void 0===s?void 0:s.projektname)||"Unbekanntes Projekt",contractorName:(null===r||void 0===r?void 0:r.firmennameKundenname)||"Unbekannt",address:(null===s||void 0===s?void 0:s.address)||(null===r||void 0===r?void 0:r.adresse)||"Nicht angegeben",inverters:o.inverters||[],modules:o.modules,wallbox:o.wallbox,generatoranschlusskasten:o.generatoranschlusskasten,pvCables:o.pvCables,potentialausgleichHESUK:o.potentialausgleichHESUK,strings:(null===(t=o.inverters)||void 0===t?void 0:t.reduce((e,t)=>{var n;return e+((null===(n=t.strings)||void 0===n?void 0:n.length)||0)},0))||0,totalModules:(null===(n=o.modules)||void 0===n?void 0:n.totalQuantity)||0,createdAt:(new Date).toISOString(),configurationVersion:o.configurationVersion||"1.0"};d(u),c(!0),f(!0)}})]})},hl=_s("Grid",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"3",x2:"21",y1:"9",y2:"9",key:"1vqk6q"}],["line",{x1:"3",x2:"21",y1:"15",y2:"15",key:"o2sbyz"}],["line",{x1:"9",x2:"9",y1:"3",y2:"21",key:"13tij5"}],["line",{x1:"15",x2:"15",y1:"3",y2:"21",key:"1hpv9i"}]]),ml=_s("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),pl=_s("Battery",[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]),fl=_s("Plug",[["path",{d:"M12 22v-5",key:"1ega77"}],["path",{d:"M9 8V2",key:"14iosj"}],["path",{d:"M15 8V2",key:"18g5xt"}],["path",{d:"M18 8v5a4 4 0 0 1-4 4h-4a4 4 0 0 1-4-4V8Z",key:"osxo6l"}]]),gl=_s("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),xl=_s("Layers",[["polygon",{points:"12 2 2 7 12 12 22 7 12 2",key:"1b0ttc"}],["polyline",{points:"2 17 12 22 22 17",key:"imjtdl"}],["polyline",{points:"2 12 12 17 22 12",key:"5dexcv"}]]),yl=_s("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),vl=_s("Anchor",[["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}],["line",{x1:"12",x2:"12",y1:"22",y2:"8",key:"abakz7"}],["path",{d:"M5 12H2a10 10 0 0 0 20 0h-3",key:"1hv3nh"}]]),bl=_s("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),wl="1uOB8fBkWQYkPS0LOZxk",jl="yGGCjoiZrmbabhCqWSyS",Nl="sBUZ1B1IRinmuSPZNh7o",kl="CSVTWpEA5NSAIOZVyHTq",Sl="mHvC6RpkDKFFCqoZjZcW",Cl="WGfZvGlkrPiTDUC3SqL2",El="bArNeyutPDFXhpPBTsOw",Al="aAhBqQFaynXXCf42Ws1H",Il="a6eKXo8lJX2RU7Ny8rDW",_l="xcd6LYhzBSV2u6r3lvTH",Tl="MhQf6qQNd5I08mqloE7R",Dl="mMfrQeYNHrQJVT4hLAZs",Pl="BKL1zeVvHbOvtrD8udg9",Ml="cpCa7ZqKiQfX37GvQVQn",Rl="SyxjypSzRnCwf5ygddfh",Ol="b5ipLND4IHvhV59PJdEP",Ll="FFt4SWvmCjA51fL9JqIo",Fl="XSJEgR8thn3PGhcH9W4f",Vl="GP8qqjTGy7rb61Ldy4JR",zl="GbQ7mvPpvShm8yaXss5R",Ul="sPp6SFLYLBt7jqj6ESV8",Kl="oAkX5Hj0lu3KBVVvVnJv",Bl="ZlqQZdDkuckVCHmCoU7T",ql="UttktkBYB4PCle22csnr",Hl={DEV_MAX_I_1:"Y3pBJPJrkUQMmVtLNOcv",DEV_MAX_I_2:"Hvh5hlfkgPx78maaL72i",DEV_MAX_I_3:"jqU0neeeT3zUIo4Aj9MJ",MODULE_WIDTH_MM:"wScGOKYdt4X1KdjYmZyy",MODULE_LENGTH_MM:"JI4bqhXSzmm9WGgddTYA",PROFILE_LENGTH_MM:"8YZJStJTGnHxZxBU30CP",CABLE_CORES:"hRDtjnTqWu1tuPhqg1Ql",SMART_DONGLE_REQUIRED:"fzK2fI7oj4XXbEYZe5tJ",ENERGIEMANAGEMENT_SMART_DONGLE_ERSATZ:"vtRsEoszWmDtdPZdKfBB"},Gl=e=>{if(null===e||void 0===e)return 0;const t=parseFloat(String(e).replace(",","."));return Number.isFinite(t)?t:0},Wl=(e,t)=>{if(null!==e&&void 0!==e&&e.specifications)for(const n of t)if(void 0!==e.specifications[n]&&""!==e.specifications[n])return e.specifications[n]},Ql=e=>[{mm2:1.5,maxA:e.strombelastbarkeit15,breaker:16},{mm2:2.5,maxA:e.strombelastbarkeit25,breaker:20},{mm2:4,maxA:e.strombelastbarkeit4,breaker:25},{mm2:6,maxA:e.strombelastbarkeit6,breaker:32},{mm2:10,maxA:e.strombelastbarkeit10,breaker:50},{mm2:16,maxA:e.strombelastbarkeit16,breaker:63}],Jl=e=>{let{titleIcon:t,title:n,children:r,className:s=""}=e;return(0,gs.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 ".concat(s),children:[n&&(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[t?(0,gs.jsx)(t,{className:"h-4 w-4 text-gray-600"}):null,(0,gs.jsx)("h3",{className:"text-base font-medium text-gray-900",children:n})]}),r]})},Zl=e=>{let{label:t,value:n,onChange:r,options:s,required:a=!1,hasError:i=!1,placeholder:l="Ausw\xe4hlen..."}=e;return(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[t," ",a&&(0,gs.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,gs.jsxs)("select",{value:n,onChange:r,className:"w-full border rounded-md px-3 py-2 focus:ring-1 focus:ring-gray-400 focus:border-gray-400 ".concat(i?"border-red-300":"border-gray-300"),children:[(0,gs.jsx)("option",{value:"",children:l}),s.map(e=>(0,gs.jsx)("option",{value:e.value,children:e.label},e.value))]}),i&&(0,gs.jsx)("p",{className:"text-red-600 text-xs mt-1",children:"Feld ist erforderlich"})]})},Xl=e=>{let{label:t,value:n,onChange:r,min:s=0,hasError:a=!1}=e;return(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t}),(0,gs.jsx)("input",{type:"number",min:s,value:n,onChange:r,className:"w-full border rounded px-3 py-2 ".concat(a?"border-red-300":"border-gray-300")})]})},Yl=e=>{let{materials:t,onAddMaterial:n,onClose:r}=e;const[a,i]=(0,s.useState)(""),[l,o]=(0,s.useState)([]),c=t.filter(e=>e.materialID&&e.description&&(e.materialID.toLowerCase().includes(a.toLowerCase())||e.description.toLowerCase().includes(a.toLowerCase()))),u=(e,t)=>{o(t<=0?t=>t.filter(t=>t.materialID!==e):n=>n.map(n=>n.materialID===e?(0,Le.A)((0,Le.A)({},n),{},{quantity:t}):n))},d=(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Abbrechen"}),(0,gs.jsxs)("button",{type:"button",onClick:()=>{l.forEach(e=>{n(e.materialID,e.quantity)}),r()},disabled:0===l.length,className:"px-4 py-2 text-sm font-medium text-white bg-primary-600 border border-transparent rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:bg-gray-300 disabled:cursor-not-allowed",children:["Hinzuf\xfcgen (",l.length,")"]})]});return(0,gs.jsxs)(_a,{isOpen:!0,onClose:r,title:"Material hinzuf\xfcgen",icon:ya,footerButtons:d,maxWidth:"max-w-4xl",children:[(0,gs.jsx)("div",{className:"mb-6",children:(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,gs.jsx)(va,{className:"h-5 w-5 text-gray-400"})}),(0,gs.jsx)("input",{type:"text",value:a,onChange:e=>i(e.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-primary-500 focus:border-primary-500",placeholder:"Material suchen..."})]})}),(0,gs.jsxs)("div",{className:"mb-6",children:[(0,gs.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Verf\xfcgbare Materialien"}),(0,gs.jsxs)("div",{className:"max-h-80 overflow-y-auto border border-gray-200 rounded-md",children:[c.map(e=>(0,gs.jsxs)("div",{className:"flex items-center justify-between p-3 border-b border-gray-100 hover:bg-gray-50",children:[(0,gs.jsxs)("div",{className:"flex-1",children:[(0,gs.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.description}),(0,gs.jsxs)("div",{className:"text-sm text-gray-500",children:[e.materialID," | Lager: ",e.stock||0," St\xfcck"]})]}),(0,gs.jsx)("button",{onClick:()=>(e=>{const t=l.find(t=>t.materialID===e.materialID);o(t?t=>t.map(t=>t.materialID===e.materialID?(0,Le.A)((0,Le.A)({},t),{},{quantity:t.quantity+1}):t):t=>[...t,{materialID:e.materialID||e.id,description:e.description,quantity:1}])})(e),className:"ml-3 inline-flex items-center px-3 py-1 border border-transparent text-sm leading-4 font-medium rounded-md text-primary-700 bg-primary-100 hover:bg-primary-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:(0,gs.jsx)(ya,{className:"h-4 w-4"})})]},e.id)),0===c.length&&(0,gs.jsx)("div",{className:"p-4 text-center text-gray-500",children:"Keine Materialien gefunden"})]})]}),l.length>0&&(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Ausgew\xe4hlte Materialien"}),(0,gs.jsx)("div",{className:"space-y-2",children:l.map(e=>(0,gs.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,gs.jsxs)("div",{className:"flex-1",children:[(0,gs.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.description}),(0,gs.jsx)("div",{className:"text-xs text-gray-500",children:e.materialID})]}),(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)("button",{onClick:()=>u(e.materialID,e.quantity-1),className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded",children:(0,gs.jsx)(za,{className:"h-4 w-4"})}),(0,gs.jsx)("span",{className:"text-sm font-medium w-8 text-center",children:e.quantity}),(0,gs.jsx)("button",{onClick:()=>u(e.materialID,e.quantity+1),className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded",children:(0,gs.jsx)(ya,{className:"h-4 w-4"})}),(0,gs.jsx)("button",{onClick:()=>u(e.materialID,0),className:"w-8 h-8 flex items-center justify-center text-red-400 hover:text-red-600 hover:bg-red-100 rounded ml-2",children:(0,gs.jsx)(Ea,{className:"h-4 w-4"})})]})]},e.materialID))})]})]})},$l=()=>{var e,t,n,r,a,i,l;const{materials:o,updateMaterialStock:c}=Cs(),{customers:u}=Vs(),{projects:d}=Ks(),{addBooking:h}=Hs(),[m,p]=(0,s.useState)(0),[f,g]=(0,s.useState)([]),[x,y]=(0,s.useState)(""),[v,b]=(0,s.useState)(""),[w,j]=(0,s.useState)([]),[N,k]=(0,s.useState)({module:"",roofType:"",querformatRows:[],hochformatRows:[],pvMountingSystem:"",befestigungPVMountingSystem:"",modulEndklemmen:"",modulMittelklemmen:"",pvSteckerMale:"",pvSteckerFemale:"",profile:"",verbinder:"",endkappen:"",inverters:[{type:"",quantity:1,strings:[{name:"1.0",modules:1}]}],optimizer:"",optimizerQty:0,battery:"",batteryQty:0,wallbox:"",wallboxQty:0,energiemanagement:"",energiemanagementQty:0,notstromloesungen:"",notstromloesungenQty:0,sls:"",slsQty:0,tiefenerder:"",tiefenerderQty:0,kombiableiter:"",kombiableiterQty:0,zaehlerschrank:"",zaehlerschrankQty:0,generatoranschlusskasten:"",generatoranschlusskastenQty:0,spannungsversorgungAPZ:"",spannungsversorgungAPZQty:0}),[S,C]=(0,s.useState)({}),[E,A]=(0,s.useState)(null),[I,_]=(0,s.useState)(10),[T,D]=(0,s.useState)(null),[P,M]=(0,s.useState)(null),[R,O]=(0,s.useState)(null),[L,F]=(0,s.useState)(null),[V,z]=(0,s.useState)(null),[U,K]=(0,s.useState)(null),[B,q]=(0,s.useState)(null),[H,G]=(0,s.useState)(null),[W,Q]=(0,s.useState)(null),[J,Z]=(0,s.useState)(null),[X,Y]=(0,s.useState)(null),[$,ee]=(0,s.useState)(null),[te,ne]=(0,s.useState)(null),[re,se]=(0,s.useState)(null),[ae,ie]=(0,s.useState)(null),[le,oe]=(0,s.useState)(null),[ce,ue]=(0,s.useState)(null),[de,he]=(0,s.useState)(null),[me,pe]=(0,s.useState)(null),[fe,ge]=(0,s.useState)(null),[xe,ye]=(0,s.useState)(null),[ve,be]=(0,s.useState)(null),[we,je]=(0,s.useState)(null),[Ne,ke]=(0,s.useState)(null),[Se,Ce]=(0,s.useState)(null),[Ee,Ae]=(0,s.useState)(null),[Ie,_e]=(0,s.useState)(null),[Te,De]=(0,s.useState)(null),[Pe,Me]=(0,s.useState)(null),[Re,Oe]=(0,s.useState)(null),[Fe,Ve]=(0,s.useState)(null),[ze,Ue]=(0,s.useState)(null),[Ke,Be]=(0,s.useState)(null),[qe,He]=(0,s.useState)(null),[Ge,We]=(0,s.useState)(null),[Qe,Je]=(0,s.useState)(null),[Ze,Xe]=(0,s.useState)(null),[Ye,$e]=(0,s.useState)(null),[et,tt]=(0,s.useState)(null),[nt,rt]=(0,s.useState)(null),[st,at]=(0,s.useState)(null),[it,lt]=(0,s.useState)(null),[ot,ct]=(0,s.useState)(null),[ut,dt]=(0,s.useState)(null),[ht,mt]=(0,s.useState)(null),[pt,ft]=(0,s.useState)(null),[gt,xt]=(0,s.useState)(null),[yt,vt]=(0,s.useState)(null),[bt,wt]=(0,s.useState)(null),[jt,Nt]=(0,s.useState)(null),[kt,St]=(0,s.useState)(null),[Ct,Et]=(0,s.useState)(null),[At,It]=(0,s.useState)(null),[_t,Tt]=(0,s.useState)(null),[Dt,Pt]=(0,s.useState)(null),[Mt,Rt]=(0,s.useState)(null),[Ot,Lt]=(0,s.useState)(null),[Ft,Vt]=(0,s.useState)(null),[zt,Ut]=(0,s.useState)(null),[Kt,Bt]=(0,s.useState)(null),[qt,Ht]=(0,s.useState)(null),[Gt,Wt]=(0,s.useState)(null),[Qt,Jt]=(0,s.useState)(null),[Zt,Xt]=(0,s.useState)(null),[Yt,$t]=(0,s.useState)(null),[en,tn]=(0,s.useState)(null),[nn,rn]=(0,s.useState)(null),[sn,an]=(0,s.useState)(null),[ln,on]=(0,s.useState)(null),[cn,un]=(0,s.useState)(null),[dn,hn]=(0,s.useState)(null),[mn,pn]=(0,s.useState)(null),[fn,gn]=(0,s.useState)(null),[xn,yn]=(0,s.useState)(null),[vn,bn]=(0,s.useState)(null),[wn,jn]=(0,s.useState)(null),[Nn,kn]=(0,s.useState)(null),[Sn,Cn]=(0,s.useState)(null),[En,An]=(0,s.useState)(null),[In,_n]=(0,s.useState)(null),[Tn,Dn]=(0,s.useState)(null),[Pn,Mn]=(0,s.useState)(null),[Rn,On]=(0,s.useState)(1),[Ln,Fn]=(0,s.useState)(null),[Vn,zn]=(0,s.useState)(null),[Un,Kn]=(0,s.useState)(1),[Bn,qn]=(0,s.useState)(null),Hn=(0,s.useMemo)(()=>{const e=new Map;for(const t of o)e.set(t.id,t);return e},[o]),Gn=(0,s.useCallback)(e=>o.filter(t=>t.categoryId===e).map(e=>({value:e.id,label:e.description||e.name||e.id})),[o]);(0,s.useEffect)(()=>{if(!x)return j([]),void b("");const e=d.filter(e=>e.customerID===x);j(e),b("")},[x,d]);const Wn=(0,s.useMemo)(()=>{var e,t;const n=(N.querformatRows||[]).reduce((e,t)=>e+(parseInt(t.modules)||0),0),r=(N.hochformatRows||[]).reduce((e,t)=>e+(parseInt(t.modules)||0),0),s=(null===(e=N.querformatRows)||void 0===e?void 0:e.length)||0,a=(null===(t=N.hochformatRows)||void 0===t?void 0:t.length)||0;return{totalModules:n+r,totalRows:s+a,qCount:n,hCount:r,qRows:s,hRows:a}},[N.querformatRows,N.hochformatRows]);(0,s.useEffect)(()=>{(async()=>{try{var e,t,n,r,s,a,i,l,o,c,u,d,h,m,p,f,g,x,y,v,b,w,j,N,S,E,I,T,P,R,L,V,U,B,H,W,J,X,$,te,re,ae,le,ce,de,me,fe,xe,ve,we,Ne,Se,Ee,Ie,Te,Pe,Re,Fe,ze,Ke,qe,Ge,Qe,Ze,Ye,et,nt,st,it,ot,ut,ht,pt,gt,yt,bt,jt,kt,Ct,At,_t,Dt,Mt,Ot,Ft,zt,Kt,qt,Gt;const Qt=await ks.FirebaseService.getDocuments("pv-defaults");if(null===Qt||void 0===Qt||!Qt.length)return;const Zt=Qt[0];C(Zt),A(null!==(e=Zt.modulHakenVerhaeltnis)&&void 0!==e?e:null),_(null!==(t=Zt.defaultCableLength)&&void 0!==t?t:10),D(null!==(n=Zt.PotentialausgleichUK)&&void 0!==n?n:null),M(null!==(r=Zt.defaultPotentialausgleich)&&void 0!==r?r:null),O(null!==(s=Zt.KabelmanagementUK)&&void 0!==s?s:null),F(null!==(a=Zt.defaultKabelmanagement)&&void 0!==a?a:null),z(null!==(i=Zt.AderendhuelsenProGeraet)&&void 0!==i?i:null),K(null!==(l=Zt.KabelkanalStandard)&&void 0!==l?l:null),q(null!==(o=Zt.defaultKabelkanalStandard)&&void 0!==o?o:null),G(null!==(c=Zt.KabelkanalGross)&&void 0!==c?c:null),Q(null!==(u=Zt.defaultKabelkanalGross)&&void 0!==u?u:null),Z(null!==(d=Zt.PvKabel)&&void 0!==d?d:null),Y(null!==(h=Zt.defaultPvKabel)&&void 0!==h?h:null),ee(null!==(m=Zt.Kabelschuh6M8)&&void 0!==m?m:null),ne(null!==(p=Zt.Kabelschuh10M6)&&void 0!==p?p:null),se(null!==(f=Zt.Kabelschuh16M6)&&void 0!==f?f:null),ie(null!==(g=Zt.defaultKabelschuh6M8)&&void 0!==g?g:null),oe(null!==(x=Zt.defaultKabelschuh10M6)&&void 0!==x?x:null),ue(null!==(y=Zt.defaultKabelschuh16M6)&&void 0!==y?y:null),he(null!==(v=Zt.defaultAderendhuelsen10mm2)&&void 0!==v?v:null),pe(null!==(b=Zt.defaultAderendhuelsen16mm2)&&void 0!==b?b:null),ge(null!==(w=Zt.BefestigungPotentialausgleichUKUK)&&void 0!==w?w:null),ye(null!==(j=Zt.defaultBefestigungPotentialausgleichUKUK)&&void 0!==j?j:null),be(null!==(N=Zt.BefestigungLeistungsoptimierer)&&void 0!==N?N:null),je(null!==(S=Zt.defaultBefestigungLeistungsoptimierer)&&void 0!==S?S:null),ke(null!==(E=Zt.PotentialausgleichHESUK)&&void 0!==E?E:null),Ce(null!==(I=Zt.defaultPotentialausgleichUKUK)&&void 0!==I?I:null),Ae(null!==(T=Zt.defaultPotentialausgleichHESUK)&&void 0!==T?T:null),_e(null!==(P=Zt.SchutzleiterPV)&&void 0!==P?P:null),De(null!==(R=Zt.defaultSchutzleiterPV)&&void 0!==R?R:null),Me(null!==(L=Zt.ErdungHES)&&void 0!==L?L:null),Oe(null!==(V=Zt.Duebel14)&&void 0!==V?V:null),Ve(null!==(U=Zt.defaultDuebel14)&&void 0!==U?U:null),Ue(null!==(B=Zt.KabelkanalBefestigungsmaterial)&&void 0!==B?B:null),Be(null!==(H=Zt.PvGeraeteBefestigungsmaterial)&&void 0!==H?H:null),He(null!==(W=Zt.defaultKabelkanalSchrauben)&&void 0!==W?W:null),We(null!==(J=Zt.defaultKabelkanalDuebel)&&void 0!==J?J:null),Je(null!==(X=Zt.defaultPvGeraeteSchrauben)&&void 0!==X?X:null),Xe(null!==($=Zt.defaultPvGeraeteDuebel)&&void 0!==$?$:null),$e(null!==(te=Zt.Flexrohr)&&void 0!==te?te:null),tt(null!==(re=Zt.Installationsrohr)&&void 0!==re?re:null),rt(null!==(ae=Zt.Rohrschelle)&&void 0!==ae?ae:null),at(null!==(le=Zt.RohrschelleBefestigungsmaterial)&&void 0!==le?le:null),lt(null!==(ce=Zt.defaultSchraubenRohrschelle)&&void 0!==ce?ce:null),ct(null!==(de=Zt.defaultInstallationsrohr)&&void 0!==de?de:null),dt(null!==(me=Zt.defaultFlexrohrStandard)&&void 0!==me?me:null),mt(null!==(fe=Zt.defaultFlexrohrGross)&&void 0!==fe?fe:null),ft(null!==(xe=Zt.defaultRohrschelleStandard)&&void 0!==xe?xe:null),xt(null!==(ve=Zt.defaultRohrschelleGross)&&void 0!==ve?ve:null),vt(null!==(we=Zt.InstallationsrohrOutdoor)&&void 0!==we?we:null),wt(null!==(Ne=Zt.RohrschelleOutdoor)&&void 0!==Ne?Ne:null),Nt(null!==(Se=Zt.MuffeOutdoor)&&void 0!==Se?Se:null),St(null!==(Ee=Zt.defaultInstallationsrohrOutdoor)&&void 0!==Ee?Ee:null),Et(null!==(Ie=Zt.defaultRohrschelleOutdoor)&&void 0!==Ie?Ie:null),It(null!==(Te=Zt.defaultMuffeOutdoor)&&void 0!==Te?Te:null),Tt(null!==(Pe=Zt.Dammstoffduebel)&&void 0!==Pe?Pe:null),Pt(null!==(Re=Zt.defaultDammstoffduebel)&&void 0!==Re?Re:null),Rt(null!==(Fe=Zt.DuebelGeruestanker)&&void 0!==Fe?Fe:null),Lt(null!==(ze=Zt.defaultDuebelGeruestanker)&&void 0!==ze?ze:null),Vt(null!==(Ke=Zt.Adernleitung10mm2Blau)&&void 0!==Ke?Ke:null),Ut(null!==(qe=Zt.Adernleitung10mm2Schwarz)&&void 0!==qe?qe:null),Bt(null!==(Ge=Zt.Adernleitung10mm2GruenGelb)&&void 0!==Ge?Ge:null),Ht(null!==(Qe=Zt.Adernleitung16mm2Blau)&&void 0!==Qe?Qe:null),Wt(null!==(Ze=Zt.Adernleitung16mm2Schwarz)&&void 0!==Ze?Ze:null),Jt(null!==(Ye=Zt.Adernleitung16mm2GruenGelb)&&void 0!==Ye?Ye:null),Xt(null!==(et=Zt.defaultAdernleitung10mm2Blau)&&void 0!==et?et:null),$t(null!==(nt=Zt.defaultAdernleitung10mm2Schwarz)&&void 0!==nt?nt:null),tn(null!==(st=Zt.defaultAdernleitung10mm2GruenGelb)&&void 0!==st?st:null),rn(null!==(it=Zt.defaultAdernleitung16mm2Blau)&&void 0!==it?it:null),an(null!==(ot=Zt.defaultAdernleitung16mm2Schwarz)&&void 0!==ot?ot:null),on(null!==(ut=Zt.defaultAdernleitung16mm2GruenGelb)&&void 0!==ut?ut:null),un(null!==(ht=Zt.Potentialausgleichsschiene)&&void 0!==ht?ht:null),hn(null!==(pt=Zt.Hauptleitungsabzweigklemme)&&void 0!==pt?pt:null),pn(null!==(gt=Zt.Sammelschienenklemme)&&void 0!==gt?gt:null),gn(null!==(yt=Zt.Abdeckstreifen)&&void 0!==yt?yt:null),yn(null!==(bt=Zt.RJ45Stecker)&&void 0!==bt?bt:null),bn(null!==(jt=Zt.defaultPotentialausgleichsschiene)&&void 0!==jt?jt:null),jn(null!==(kt=Zt.defaultHauptleitungsabzweigklemme)&&void 0!==kt?kt:null),kn(null!==(Ct=Zt.defaultSammelschienenklemme)&&void 0!==Ct?Ct:null),Cn(null!==(At=Zt.defaultAbdeckstreifen)&&void 0!==At?At:null),An(null!==(_t=Zt.defaultRJ45Stecker)&&void 0!==_t?_t:null),_n(null!==(Dt=Zt.defaultAufkleberPV)&&void 0!==Dt?Dt:null),Dn(null!==(Mt=Zt.defaultAufkleberPVMitSpeicher)&&void 0!==Mt?Mt:null),Mn(null!==(Ot=Zt.defaultAufkleberPVMitNotstrom)&&void 0!==Ot?Ot:null),On(null!==(Ft=Zt.defaultStromwandlerValue)&&void 0!==Ft?Ft:1),Fn(null!==(zt=Zt.defaultStromwandler)&&void 0!==zt?zt:null),zn(null!==(Kt=Zt.defaultErdungHES)&&void 0!==Kt?Kt:null),Kn(null!==(qt=Zt.defaultErdungStaberderValue)&&void 0!==qt?qt:1),qn(null!==(Gt=Zt.defaultErdungStaberder)&&void 0!==Gt?Gt:null),k(e=>(0,Le.A)((0,Le.A)({},e),{},{module:Zt.defaultModule||e.module,roofType:Zt.defaultRoofType||e.roofType,pvMountingSystem:Zt.defaultPvMountingSystem||e.pvMountingSystem,befestigungPVMountingSystem:Zt.defaultBefestigungPVMountingSystem||e.befestigungPVMountingSystem,modulEndklemmen:Zt.defaultModulEndklemmen||e.modulEndklemmen,modulMittelklemmen:Zt.defaultModulMittelklemmen||e.modulMittelklemmen,pvSteckerMale:Zt.defaultPvSteckerMale||e.pvSteckerMale,pvSteckerFemale:Zt.defaultPvSteckerFemale||e.pvSteckerFemale,profile:Zt.defaultProfile||e.profile,verbinder:Zt.defaultVerbinder||e.verbinder,endkappen:Zt.defaultEndkappen||e.endkappen,inverters:e.inverters.map((e,t)=>0===t?(0,Le.A)((0,Le.A)({},e),{},{type:Zt.defaultInverter||e.type}):e)}))}catch(Ao){console.error("Fehler beim Laden der PV-Standardeinstellungen:",Ao)}})()},[]);const Qn=(0,s.useMemo)(()=>Gn(wl),[Gn]),Jn=(0,s.useMemo)(()=>Gn(jl),[Gn]),Zn=(0,s.useMemo)(()=>Gn(Nl),[Gn]),Xn=(0,s.useMemo)(()=>Gn(kl),[Gn]),Yn=(0,s.useMemo)(()=>Gn(Sl),[Gn]),$n=(0,s.useMemo)(()=>Gn(Cl),[Gn]),er=(0,s.useMemo)(()=>Gn(El),[Gn]),tr=(0,s.useMemo)(()=>Gn(Al),[Gn]),nr=(0,s.useMemo)(()=>Gn(Il),[Gn]),rr=(0,s.useMemo)(()=>Gn(Dl),[Gn]),sr=(0,s.useMemo)(()=>Gn(Pl),[Gn]),ar=(0,s.useMemo)(()=>Gn(Ml),[Gn]),ir=(0,s.useCallback)(e=>{const t={16:S.defaultSicherung16A,20:S.defaultSicherung20A,25:S.defaultSicherung25A,32:S.defaultSicherung32A,50:S.defaultSicherung50A,63:S.defaultSicherung63A},n=Ql(S);return t[(n.find(t=>t.maxA>=e)||n[n.length-1]).breaker]||null},[S]),lr=(0,s.useCallback)(e=>{const t={1.5:S.defaultKabel5x15,2.5:S.defaultKabel5x25,4:S.defaultKabel5x4,6:S.defaultKabel5x6,10:S.defaultKabel5x10,16:S.defaultKabel5x16},n=Ql(S);return t[(n.find(t=>t.maxA>=e)||n[n.length-1]).mm2]||null},[S]),or=(0,s.useCallback)(()=>S.defaultFehlerstromschutzschalterWallbox||null,[S]),cr=(0,s.useCallback)(e=>{const t=Hn.get(e);return t?Gl(Wl(t,[Hl.DEV_MAX_I_1,Hl.DEV_MAX_I_2,Hl.DEV_MAX_I_3])):0},[Hn]),ur=(0,s.useMemo)(()=>{var e,t;const n={inverterBreaker:null,inverterCable:null,wallboxBreaker:null,wallboxCable:null,wallboxRCD:null,backupBreaker:null,backupCable:null},r=null===(e=N.inverters)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.type;if(r){const e=cr(r);e>0&&(n.inverterBreaker=ir(e),n.inverterCable=lr(e))}if(N.wallbox){const e=cr(N.wallbox);e>0&&(n.wallboxBreaker=ir(e),n.wallboxCable=lr(e)),n.wallboxRCD=or()}if(N.notstromloesungen){const e=cr(N.notstromloesungen);e>0&&(n.backupBreaker=ir(e),n.backupCable=lr(e))}return n},[N.inverters,N.wallbox,N.notstromloesungen,cr,ir,lr,or]),[dr,hr]=(0,s.useState)({}),mr={inverterBreaker:null!==(e=dr.inverterBreaker)&&void 0!==e?e:ur.inverterBreaker,inverterCable:null!==(t=dr.inverterCable)&&void 0!==t?t:ur.inverterCable,wallboxBreaker:null!==(n=dr.wallboxBreaker)&&void 0!==n?n:ur.wallboxBreaker,wallboxCable:null!==(r=dr.wallboxCable)&&void 0!==r?r:ur.wallboxCable,wallboxRCD:null!==(a=dr.wallboxRCD)&&void 0!==a?a:ur.wallboxRCD,backupBreaker:null!==(i=dr.backupBreaker)&&void 0!==i?i:ur.backupBreaker,backupCable:null!==(l=dr.backupCable)&&void 0!==l?l:ur.backupCable},pr=(0,s.useMemo)(()=>{const e=[],t=[],{totalModules:n,totalRows:r}=Wn;if(0===n)return{bom:e,warnings:t};var s;N.module&&e.push({materialID:N.module,quantity:n,description:(null===(s=Hn.get(N.module))||void 0===s?void 0:s.description)||"PV-Module",category:"Module"});let a=0;if(N.inverters.forEach((t,n)=>{var r;t.type&&t.quantity>0&&e.push({materialID:t.type,quantity:t.quantity,description:(null===(r=Hn.get(t.type))||void 0===r?void 0:r.description)||"Wechselrichter ".concat(n+1),category:"Wechselrichter"});(t.strings||[]).forEach(e=>a+=parseInt(e.modules)||0)}),n!==a&&t.push("Die Anzahl der Module in den Strings (".concat(a,") stimmt nicht mit der Gesamtanzahl (").concat(n,") \xfcberein.")),N.roofType){const t=Math.ceil(n*(null!==E&&void 0!==E?E:0));var i,l;if(N.pvMountingSystem&&t>0)e.push({materialID:N.pvMountingSystem,quantity:t,description:(null===(i=Hn.get(N.pvMountingSystem))||void 0===i?void 0:i.description)||"PV-Montagesystem",category:"Montagesystem"});if(N.befestigungPVMountingSystem&&t>0)e.push({materialID:N.befestigungPVMountingSystem,quantity:2*t,description:(null===(l=Hn.get(N.befestigungPVMountingSystem))||void 0===l?void 0:l.description)||"Befestigung",category:"Befestigung"});const s=4*r,a=2*(n-r);var c,u;if(N.modulEndklemmen&&s>0)e.push({materialID:N.modulEndklemmen,quantity:s,description:(null===(c=Hn.get(N.modulEndklemmen))||void 0===c?void 0:c.description)||"Modul-Endklemmen",category:"Klemmen"});if(N.modulMittelklemmen&&a>0)e.push({materialID:N.modulMittelklemmen,quantity:a,description:(null===(u=Hn.get(N.modulMittelklemmen))||void 0===u?void 0:u.description)||"Modul-Mittelklemmen",category:"Klemmen"});if("Ziegel"===N.roofType&&N.profile){const t=Hn.get(N.module),n=Hn.get(N.profile),r=Gl(Wl(t,[Hl.MODULE_WIDTH_MM])),a=Gl(Wl(t,[Hl.MODULE_LENGTH_MM])),i=Gl(Wl(n,[Hl.PROFILE_LENGTH_MM])),l=Gl(Wl(Hn.get(N.modulEndklemmen),[Hl.MODULE_WIDTH_MM])),o=Gl(Wl(Hn.get(N.modulMittelklemmen),[Hl.MODULE_WIDTH_MM]));let c=0,u=0;const p=(e,t)=>{if(!e||!i)return{p:0,v:0};const n=Math.max(0,2*(e-1)),r=e*t*2+200+4*l+n*o,s=Math.ceil(r/i);return{p:s,v:2*Math.max(0,s-1)}};var d,h,m;if((N.querformatRows||[]).forEach(e=>{const{p:t,v:n}=p(parseInt(e.modules)||0,a);c+=t,u+=n}),(N.hochformatRows||[]).forEach(e=>{const{p:t,v:n}=p(parseInt(e.modules)||0,r);c+=t,u+=n}),c>0)e.push({materialID:N.profile,quantity:c,description:(null===(d=Hn.get(N.profile))||void 0===d?void 0:d.description)||"Profile",category:"Profile"});if(N.verbinder&&u>0)e.push({materialID:N.verbinder,quantity:u,description:(null===(h=Hn.get(N.verbinder))||void 0===h?void 0:h.description)||"Verbinder",category:"Verbinder"});if(N.endkappen&&s>0)e.push({materialID:N.endkappen,quantity:s,description:(null===(m=Hn.get(N.endkappen))||void 0===m?void 0:m.description)||"Endkappen",category:"Endkappen"})}}const p=N.inverters.reduce((e,t)=>e+(t.strings||[]).length,0);var f,g,x;N.pvSteckerMale&&p>0&&e.push({materialID:N.pvSteckerMale,quantity:p,description:(null===(f=Hn.get(N.pvSteckerMale))||void 0===f?void 0:f.description)||"PV-Stecker (Male)",category:"PV-Stecker"});N.pvSteckerFemale&&p>0&&e.push({materialID:N.pvSteckerFemale,quantity:p,description:(null===(g=Hn.get(N.pvSteckerFemale))||void 0===g?void 0:g.description)||"PV-Stecker (Female)",category:"PV-Stecker"});p>0&&J>0&&X&&e.push({materialID:X,quantity:p*J*2,description:(null===(x=Hn.get(X))||void 0===x?void 0:x.description)||"PV-Kabel (".concat(J,"m \xd7 2 \xd7 ").concat(p," Strings)"),category:"PV-Kabel"});const y=(t,n,r,s)=>{if(t&&n>0){var a;const i=(null===(a=Hn.get(t))||void 0===a?void 0:a.description)||r;e.push({materialID:t,quantity:n,description:i,category:s})}};y(N.optimizer,N.optimizerQty,"Leistungsoptimierer","Optimierer"),y(N.battery,N.batteryQty,"Batteriespeicher","Speicher"),y(N.wallbox,N.wallboxQty,"Wallbox","Wallbox"),y(N.energiemanagement,N.energiemanagementQty,"Energiemanagement","Energiemanagement"),y(N.smartDongle,N.smartDongleQty,"Smart Dongle-WLAN-FE","Smart Dongle"),y(N.sls,N.slsQty,"SLS","Elektrische Komponenten"),y(N.tiefenerder,N.tiefenerderQty,"Tiefenerder","Elektrische Komponenten"),y(N.kombiableiter,N.kombiableiterQty,"Kombiableiter","Elektrische Komponenten"),y(N.zaehlerschrank,N.zaehlerschrankQty,"Z\xe4hlerschrank","Elektrische Komponenten"),y(N.generatoranschlusskasten,N.generatoranschlusskastenQty,"Generatoranschlusskasten","Elektrische Komponenten"),y(N.spannungsversorgungAPZ,N.spannungsversorgungAPZQty,"Spannungsversorgung APZ","Elektrische Komponenten");let v=!1;if(N.energiemanagement){const e=o.find(e=>e.id===N.energiemanagement);if((null===e||void 0===e?void 0:e.categoryId)===_l){var b;"Ja"===(null===e||void 0===e||null===(b=e.specifications)||void 0===b?void 0:b[Hl.ENERGIEMANAGEMENT_SMART_DONGLE_ERSATZ])&&(v=!0)}}let w=0;if(v||N.inverters.forEach(e=>{if(e.type){var t;const n=o.find(t=>t.id===e.type);"Nein"===(null===n||void 0===n||null===(t=n.specifications)||void 0===t?void 0:t[Hl.SMART_DONGLE_REQUIRED])&&(w+=e.quantity||1)}}),w>0&&!N.smartDongle){const t=o.filter(e=>e.categoryId===Bl),n=t.find(e=>{var t;return null===(t=e.description)||void 0===t?void 0:t.includes("Smart Dongle-WLAN-FE")})||t[0];var j;if(n)e.push({materialID:n.id,quantity:w,description:(null===(j=Hn.get(n.id))||void 0===j?void 0:j.description)||"Smart Dongle-WLAN-FE (automatisch f\xfcr ".concat(w," WR)"),category:"Smart Dongle"})}let k=0;if(N.tiefenerder){const e=o.find(e=>e.id===N.tiefenerder);(null===e||void 0===e?void 0:e.categoryId)===Vl&&(k=N.tiefenerderQty||1)}var S;k>0&&Bn&&e.push({materialID:Bn,quantity:k*(Un||1),description:(null===(S=Hn.get(Bn))||void 0===S?void 0:S.description)||"ErdungStaberder (automatisch f\xfcr ".concat(k," Tiefenerder \xd7 ").concat(Un||1,")"),category:"Erdung"});y(N.notstromloesungen,N.notstromloesungenQty,"Notstroml\xf6sungen","Notstroml\xf6sungen");const C=N.inverters.filter(e=>e.type&&e.quantity>0).reduce((e,t)=>e+(parseInt(t.quantity)||1),0);var A,_,D,M,O,F,z;mr.inverterBreaker&&C>0&&e.push({materialID:mr.inverterBreaker,quantity:C,description:(null===(A=Hn.get(mr.inverterBreaker))||void 0===A?void 0:A.description)||"Leitungsschutzschalter (Wechselrichter)",category:"Schutzschalter"});mr.inverterCable&&C>0&&e.push({materialID:mr.inverterCable,quantity:C*I,description:(null===(_=Hn.get(mr.inverterCable))||void 0===_?void 0:_.description)||"Mantelleitung (Wechselrichter) - ".concat(I,"m pro WR"),category:"Kabel"});mr.wallboxBreaker&&N.wallboxQty>0&&e.push({materialID:mr.wallboxBreaker,quantity:N.wallboxQty,description:(null===(D=Hn.get(mr.wallboxBreaker))||void 0===D?void 0:D.description)||"Leitungsschutzschalter (Wallbox)",category:"Schutzschalter"});mr.wallboxCable&&N.wallboxQty>0&&e.push({materialID:mr.wallboxCable,quantity:N.wallboxQty*I,description:(null===(M=Hn.get(mr.wallboxCable))||void 0===M?void 0:M.description)||"Mantelleitung (Wallbox) - ".concat(I,"m pro Wallbox"),category:"Kabel"});mr.wallboxRCD&&N.wallboxQty>0&&e.push({materialID:mr.wallboxRCD,quantity:N.wallboxQty,description:(null===(O=Hn.get(mr.wallboxRCD))||void 0===O?void 0:O.description)||"FI-Schutzschalter (Wallbox)",category:"Schutzschalter"});mr.backupBreaker&&N.notstromloesungenQty>0&&e.push({materialID:mr.backupBreaker,quantity:N.notstromloesungenQty,description:(null===(F=Hn.get(mr.backupBreaker))||void 0===F?void 0:F.description)||"Leitungsschutzschalter (Notstrom)",category:"Schutzschalter"});mr.backupCable&&N.notstromloesungenQty>0&&e.push({materialID:mr.backupCable,quantity:N.notstromloesungenQty*I,description:(null===(z=Hn.get(mr.backupCable))||void 0===z?void 0:z.description)||"Mantelleitung (Notstrom) - ".concat(I,"m pro Ger\xe4t"),category:"Kabel"});const K=(t,n,r,s)=>{if(t&&n>0){var a;const i=(null===(a=Hn.get(t))||void 0===a?void 0:a.description)||r;e.push({materialID:t,quantity:n,description:i,category:s})}};K(P,T,"Potentialausgleich UK (Standard)","Potentialausgleich"),K(L,R,"Kabelmanagement UK (Standard)","Kabelmanagement");const B=(mr.inverterBreaker?C:0)+(N.wallbox&&mr.wallboxBreaker?N.wallboxQty||1:0)+(N.battery?N.batteryQty||1:0)+(N.notstromloesungen&&mr.backupBreaker&&N.notstromloesungenQty||0);var q;de&&V>0&&B>0&&e.push({materialID:de,quantity:B*V,description:(null===(q=Hn.get(de))||void 0===q?void 0:q.description)||"Aderendh\xfclsen 10mm\xb2 (".concat(B," Ger\xe4te \xd7 ").concat(V,")"),category:"Aderendh\xfclsen"});K(ae,$,"Kabelschuh 6xM8 (Flat Rate)","Kabelschuh");const H=(N.batteryQty||0)+C;var G,W,Q,Z,Y;le&&te>0&&H>0&&e.push({materialID:le,quantity:H*te,description:(null===(G=Hn.get(le))||void 0===G?void 0:G.description)||"Kabelschuh 10xM6 (".concat(H," Ger\xe4te \xd7 ").concat(te,")"),category:"Kabelschuh"});ce&&re>0&&N.notstromloesungenQty>0&&"MAT-080"===N.notstromloesungen&&e.push({materialID:ce,quantity:N.notstromloesungenQty*re,description:(null===(W=Hn.get(ce))||void 0===W?void 0:W.description)||"Kabelschuh 16xM6 (".concat(N.notstromloesungenQty," \xd7 ").concat(re,")"),category:"Kabelschuh"});(K(Dt,_t,"D\xe4mmstoffd\xfcbel (Standard)","Befestigungsmaterial"),K(Ot,Mt,"D\xfcbel Ger\xfcstanker (Standard)","D\xfcbel"),K(Zt,Ft,"Adernleitung 10mm\xb2 Blau","Kabel"),K(Yt,zt,"Adernleitung 10mm\xb2 Schwarz","Kabel"),K(en,Kt,"Adernleitung 10mm\xb2 Gr\xfcn/Gelb","Kabel"),K(nn,qt,"Adernleitung 16mm\xb2 Blau","Kabel"),K(sn,Gt,"Adernleitung 16mm\xb2 Schwarz","Kabel"),K(ln,Qt,"Adernleitung 16mm\xb2 Gr\xfcn/Gelb","Kabel"),K(vn,cn,"Potentialausgleichsschiene","Potentialausgleich"),K(wn,dn,"Hauptleitungsabzweigklemme","Klemmen"),K(Nn,mn,"Sammelschienenklemme","Klemmen"),K(Sn,fn,"Abdeckstreifen","Abdeckung"),En&&xn>0&&N.wallboxQty>0)&&e.push({materialID:En,quantity:N.wallboxQty*xn,description:(null===(Q=Hn.get(En))||void 0===Q?void 0:Q.description)||"RJ45-Stecker (".concat(N.wallboxQty," \xd7 ").concat(xn,")"),category:"Stecker"});if(xe){const t=fe||0;var ee;if(t>0)e.push({materialID:xe,quantity:t,description:(null===(ee=Hn.get(xe))||void 0===ee?void 0:ee.description)||"BefestigungsmaterialPotentialausgleich UK-UK (".concat(t,")"),category:"Befestigungsmaterial"})}if(we&&N.optimizerQty>0){const t=ve||0,n=t*N.optimizerQty;var ne;if(n>0)e.push({materialID:we,quantity:n,description:(null===(ne=Hn.get(we))||void 0===ne?void 0:ne.description)||"Befestigung Leistungsoptimierer (".concat(N.optimizerQty," \xd7 ").concat(t,")"),category:"Befestigungsmaterial"})}Se&&T>0&&e.push({materialID:Se,quantity:T,description:(null===(Z=Hn.get(Se))||void 0===Z?void 0:Z.description)||"Potentialausgleich UK-UK (".concat(T,"m)"),category:"Potentialausgleich"});Ee&&Ne>0&&e.push({materialID:Ee,quantity:Ne,description:(null===(Y=Hn.get(Ee))||void 0===Y?void 0:Y.description)||"Potentialausgleich HES-UK (".concat(Ne,"m)"),category:"Erdkabel"});if(Te&&Ie>0){const t=C+(N.batteryQty||0);var se;if(t>0)e.push({materialID:Te,quantity:t*Ie,description:(null===(se=Hn.get(Te))||void 0===se?void 0:se.description)||"SchutzleiterPV (".concat(t," Ger\xe4te \xd7 ").concat(Ie,"m)"),category:"Mantelleitung"})}if(K(Vn,Pe,"ErdungHES","Mantelleitung"),K(Fe,Re,"14mm D\xfcbel (Standard)","D\xfcbel"),ze>0&&U>0){const t=Math.ceil(U*ze);var ie,oe;if(qe)e.push({materialID:qe,quantity:t,description:(null===(ie=Hn.get(qe))||void 0===ie?void 0:ie.description)||"Kabelkanal Schrauben (".concat(U,"m \xd7 ").concat(ze,")"),category:"Schrauben"});if(Ge)e.push({materialID:Ge,quantity:t,description:(null===(oe=Hn.get(Ge))||void 0===oe?void 0:oe.description)||"Kabelkanal D\xfcbel (".concat(U,"m \xd7 ").concat(ze,")"),category:"D\xfcbel"})}if(Ke>0){const t=C+(N.batteryQty||0)+(N.wallbox?1:0)+(N.notstromloesungenQty||0),n=t*Ke;var ue,he;if(Qe&&n>0)e.push({materialID:Qe,quantity:n,description:(null===(ue=Hn.get(Qe))||void 0===ue?void 0:ue.description)||"PV-Ger\xe4te Schrauben (".concat(t," \xd7 ").concat(Ke,")"),category:"Schrauben"});if(Ze&&n>0)e.push({materialID:Ze,quantity:n,description:(null===(he=Hn.get(Ze))||void 0===he?void 0:he.description)||"PV-Ger\xe4te D\xfcbel (".concat(t," \xd7 ").concat(Ke,")"),category:"D\xfcbel"})}const me=(e,t,n)=>{var r;const s=(null===(r=Hn.get(e))||void 0===r?void 0:r.description)||"".concat(n," (").concat(t).concat(n.includes("St\xfcck")?"":"m",")");K(e,t,s,"Kabelverlegung")};me(ut,Ye,"Flexrohr Standard"),me(ot,et,"Installationsrohr"),me(pt,nt,"Rohrschelle (St\xfcck)"),me(ht,Ye,"Flexrohr Gro\xdf"),me(gt,nt,"Rohrschelle Gro\xdf (St\xfcck)"),me(kt,yt,"Installationsrohr Outdoor"),me(Ct,bt,"Rohrschelle Outdoor (St\xfcck)"),me(At,jt,"Muffe Outdoor (St\xfcck)");const pe=N.battery&&N.batteryQty>0;var ge;if(N.notstromloesungen&&N.notstromloesungenQty>0&&Pn)e.push({materialID:Pn,quantity:1,description:(null===(ge=Hn.get(Pn))||void 0===ge?void 0:ge.description)||"Aufkleber PV mit Notstrom",category:"Aufkleber"});else if(pe&&Tn){var ye;e.push({materialID:Tn,quantity:1,description:(null===(ye=Hn.get(Tn))||void 0===ye?void 0:ye.description)||"Aufkleber PV mit Speicher",category:"Aufkleber"})}else if(In){var be;e.push({materialID:In,quantity:1,description:(null===(be=Hn.get(In))||void 0===be?void 0:be.description)||"Aufkleber PV",category:"Aufkleber"})}const je=[],ke=new Map;return e.forEach(e=>{if(ke.has(e.materialID)){const t=ke.get(e.materialID);t.quantity+=e.quantity,t.description!==e.description&&e.description.length>t.description.length&&(t.description=e.description)}else ke.set(e.materialID,(0,Le.A)({},e))}),ke.forEach(e=>{je.push(e)}),{bom:je,warnings:t}},[N,Wn,o,Hn,E,J,X,I,T,P,R,L,V,de,me,$,ae,te,le,re,ce,fe,xe,ve,we,Ne,Se,Ee,Ie,Te,Pe,Re,Fe,ze,Ke,qe,Ge,Qe,Ze,Ye,et,nt,st,it,ot,ut,ht,pt,gt,yt,bt,jt,kt,Ct,At,_t,Dt,Mt,Ot,Ft,zt,Kt,qt,Gt,Qt,Zt,Yt,en,nn,sn,ln,cn,dn,mn,fn,xn,vn,wn,Nn,Sn,En,In,Tn,Pn,Rn,mr.inverterBreaker,mr.inverterCable,mr.wallboxBreaker,mr.wallboxCable,mr.wallboxRCD,mr.backupBreaker,mr.backupCable]),[fr,gr]=(0,s.useState)([]),[xr,yr]=(0,s.useState)([]),[vr,br]=(0,s.useState)(!1);(0,s.useEffect)(()=>{5===m&&(gr(pr.bom),yr(pr.warnings))},[m,pr]);const wr=(e,t)=>{const n=!!e,r=!!t&&t>0;return n&&r||!n&&!r},jr=e=>f.includes(e),Nr=e=>g(t=>t.filter(t=>t!==e)),kr=[{title:"Layout",icon:hl},{title:"Montagesystem",icon:ml},{title:"Wechselrichter",icon:ol},{title:"Komponenten",icon:pl},{title:"Elektrisch",icon:fl},{title:"Abschluss",icon:Ts}];return(0,gs.jsxs)("div",{className:"h-dvh flex flex-col bg-gray-50",children:[(0,gs.jsxs)("div",{className:"flex-shrink-0 bg-white shadow-sm p-6",children:[0===m&&(0,gs.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,gs.jsx)("div",{className:"bg-gray-100 p-2 rounded-lg",children:(0,gs.jsx)(hl,{className:"h-6 w-6 text-gray-600"})}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Layout & Dachkonfiguration"}),(0,gs.jsx)("p",{className:"text-gray-600",children:"Definieren Sie die Grundparameter Ihrer PV-Anlage"})]})]}),1===m&&(0,gs.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,gs.jsx)("div",{className:"bg-gray-100 p-2 rounded-lg",children:(0,gs.jsx)(ml,{className:"h-6 w-6 text-gray-600"})}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"PV-Montagesystem"}),(0,gs.jsx)("p",{className:"text-gray-600",children:"W\xe4hlen Sie das passende Montagesystem"})]})]}),2===m&&(0,gs.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,gs.jsx)("div",{className:"bg-gray-100 p-2 rounded-lg",children:(0,gs.jsx)(ol,{className:"h-6 w-6 text-gray-600"})}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Wechselrichter & Strings"}),(0,gs.jsx)("p",{className:"text-gray-600",children:"Konfigurieren Sie Wechselrichter und String-Aufteilung"})]})]}),3===m&&(0,gs.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,gs.jsx)("div",{className:"bg-gray-100 p-2 rounded-lg",children:(0,gs.jsx)(pl,{className:"h-6 w-6 text-gray-600"})}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Zus\xe4tzliche Komponenten"}),(0,gs.jsx)("p",{className:"text-gray-600",children:"Optimierer, Speicher, Wallbox usw."})]})]}),4===m&&(0,gs.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,gs.jsx)("div",{className:"bg-gray-100 p-2 rounded-lg",children:(0,gs.jsx)(fl,{className:"h-6 w-6 text-gray-600"})}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Elektrische Komponenten"}),(0,gs.jsx)("p",{className:"text-gray-600",children:"SLS, Kombiableiter & Co."})]})]}),5===m&&(0,gs.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,gs.jsx)("div",{className:"bg-gray-100 p-2 rounded-lg",children:(0,gs.jsx)(Ts,{className:"h-6 w-6 text-gray-600"})}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"St\xfcckliste & Buchung"}),(0,gs.jsx)("p",{className:"text-gray-600",children:"\xdcberpr\xfcfen & buchen"})]})]})]}),(0,gs.jsx)("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:(0,gs.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,gs.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[0===m&&(0,gs.jsxs)("div",{className:"space-y-4",children:[(0,gs.jsx)(Jl,{titleIcon:gl,title:"PV\u2011Modul",children:(0,gs.jsx)(Zl,{label:"PV\u2011Modul",value:N.module,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{module:e.target.value})),Nr("PV-Modul")},options:Qn,required:!0,hasError:jr("PV-Modul"),placeholder:"Modul ausw\xe4hlen..."})}),(0,gs.jsxs)(Jl,{titleIcon:Va,title:"Dachtyp",children:[jr("Dachtyp")&&(0,gs.jsx)("p",{className:"text-red-600 text-xs mb-3",children:"Dachtyp muss ausgew\xe4hlt werden"}),(0,gs.jsx)("div",{className:"grid grid-cols-3 gap-3",children:[{value:"Ziegel",emoji:"\ud83c\udfe0",desc:"Klassisches Ziegeldach"},{value:"Trapez",emoji:"\ud83c\udfed",desc:"Gewerbedach"},{value:"Flach",emoji:"\ud83c\udfe2",desc:"Flachdach"}].map(e=>(0,gs.jsxs)("div",{onClick:()=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{roofType:e.value})),Nr("Dachtyp")},className:"p-3 rounded-lg border cursor-pointer text-center transition-all ".concat(N.roofType===e.value?"border-gray-900 bg-gray-50":"border-gray-200 bg-white hover:border-gray-400"),children:[(0,gs.jsx)("div",{className:"text-2xl mb-1",children:e.emoji}),(0,gs.jsxs)("div",{className:"font-medium text-gray-900 text-sm",children:[e.value,"dach"]}),(0,gs.jsx)("div",{className:"text-xs text-gray-600",children:e.desc})]},e.value))})]}),(0,gs.jsxs)(Jl,{titleIcon:xl,title:"Modulanordnung",children:[jr("Modulanordnung")&&(0,gs.jsx)("p",{className:"text-red-600 text-xs mb-3",children:"Mindestens eine Reihe hinzuf\xfcgen"}),(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,gs.jsxs)("div",{className:"space-y-3",children:[(0,gs.jsxs)("h3",{className:"font-medium text-gray-800 flex items-center text-sm",children:[(0,gs.jsx)(yl,{className:"h-4 w-4 mr-2 text-gray-600"}),"Querformat"]}),(N.querformatRows||[]).map((e,t)=>(0,gs.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[(0,gs.jsx)("div",{className:"flex items-center justify-center w-8 h-8 bg-blue-600 text-white rounded-full text-sm font-medium",children:t+1}),(0,gs.jsx)("input",{type:"number",min:"1",value:e.modules,onChange:e=>k(n=>{const r=[...n.querformatRows||[]];return r[t]=(0,Le.A)((0,Le.A)({},r[t]),{},{modules:Math.max(1,parseInt(e.target.value)||1)}),(0,Le.A)((0,Le.A)({},n),{},{querformatRows:r})}),className:"w-20 px-3 py-2 border border-gray-300 rounded-md text-sm font-medium"}),(0,gs.jsx)("span",{className:"text-sm text-gray-700 font-medium",children:"Module"}),(0,gs.jsx)("button",{onClick:()=>k(e=>(0,Le.A)((0,Le.A)({},e),{},{querformatRows:(e.querformatRows||[]).filter((e,n)=>n!==t)})),className:"text-red-500 hover:text-red-700 hover:bg-red-50 p-1 rounded ml-auto",children:(0,gs.jsx)(Ea,{className:"h-4 w-4"})})]},t)),(0,gs.jsxs)("button",{onClick:()=>{k(e=>(0,Le.A)((0,Le.A)({},e),{},{querformatRows:[...e.querformatRows||[],{modules:1}]})),Nr("Modulanordnung")},className:"flex items-center px-3 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:[(0,gs.jsx)(ya,{className:"h-4 w-4 mr-1"}),"Reihe hinzuf\xfcgen"]})]}),(0,gs.jsxs)("div",{className:"space-y-3",children:[(0,gs.jsxs)("h3",{className:"font-medium text-gray-800 flex items-center text-sm",children:[(0,gs.jsx)(yl,{className:"h-4 w-4 mr-2 text-gray-600"}),"Hochformat"]}),(N.hochformatRows||[]).map((e,t)=>(0,gs.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-green-50 rounded-lg border border-green-200",children:[(0,gs.jsx)("div",{className:"flex items-center justify-center w-8 h-8 bg-green-600 text-white rounded-full text-sm font-medium",children:t+1}),(0,gs.jsx)("input",{type:"number",min:"1",value:e.modules,onChange:e=>k(n=>{const r=[...n.hochformatRows||[]];return r[t]=(0,Le.A)((0,Le.A)({},r[t]),{},{modules:Math.max(1,parseInt(e.target.value)||1)}),(0,Le.A)((0,Le.A)({},n),{},{hochformatRows:r})}),className:"w-20 px-3 py-2 border border-gray-300 rounded-md text-sm font-medium"}),(0,gs.jsx)("span",{className:"text-sm text-gray-700 font-medium",children:"Module"}),(0,gs.jsx)("button",{onClick:()=>k(e=>(0,Le.A)((0,Le.A)({},e),{},{hochformatRows:(e.hochformatRows||[]).filter((e,n)=>n!==t)})),className:"text-red-500 hover:text-red-700 hover:bg-red-50 p-1 rounded ml-auto",children:(0,gs.jsx)(Ea,{className:"h-4 w-4"})})]},t)),(0,gs.jsxs)("button",{onClick:()=>{k(e=>(0,Le.A)((0,Le.A)({},e),{},{hochformatRows:[...e.hochformatRows||[],{modules:1}]})),Nr("Modulanordnung")},className:"flex items-center px-3 py-2 text-sm bg-green-600 text-white rounded hover:bg-green-700",children:[(0,gs.jsx)(ya,{className:"h-4 w-4 mr-1"}),"Reihe hinzuf\xfcgen"]})]})]}),(0,gs.jsxs)("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[(0,gs.jsx)("h4",{className:"font-medium text-gray-800 text-sm mb-2",children:"Zusammenfassung"}),(0,gs.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-gray-600",children:"Anzahl Reihen:"}),(0,gs.jsx)("div",{className:"font-bold text-gray-900",children:Wn.totalRows})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-gray-600",children:"Querformat Module:"}),(0,gs.jsx)("div",{className:"font-bold text-blue-900",children:Wn.qCount})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-gray-600",children:"Hochformat Module:"}),(0,gs.jsx)("div",{className:"font-bold text-green-900",children:Wn.hCount})]})]}),(0,gs.jsx)("div",{className:"mt-2 pt-2 border-t border-gray-300",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsx)("span",{className:"font-medium text-gray-800",children:"Summe Module:"}),(0,gs.jsx)("span",{className:"text-lg font-bold text-gray-900",children:Wn.totalModules})]})})]})]})]}),1===m&&(0,gs.jsxs)("div",{className:"space-y-6",children:[(0,gs.jsx)(Jl,{titleIcon:ml,title:"Montagesystem",children:(0,gs.jsx)(Zl,{label:"Montagesystem",value:N.pvMountingSystem,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{pvMountingSystem:e.target.value})),Nr("Montagesystem")},options:Yn,required:!0,hasError:jr("Montagesystem"),placeholder:"System ausw\xe4hlen..."})}),(0,gs.jsx)(Jl,{titleIcon:vl,title:"Befestigung",children:(0,gs.jsx)(Zl,{label:"Befestigung f\xfcr Montagesystem",value:N.befestigungPVMountingSystem,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{befestigungPVMountingSystem:e.target.value})),Nr("Befestigung")},options:Gn(Rl),required:!0,hasError:jr("Befestigung"),placeholder:"Befestigung ausw\xe4hlen..."})}),(0,gs.jsx)(Jl,{titleIcon:fl,title:"Modulklemmen",children:(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,gs.jsx)(Zl,{label:"Endklemmen",value:N.modulEndklemmen,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{modulEndklemmen:e.target.value})),Nr("Endklemmen")},options:$n,required:!0,hasError:jr("Endklemmen"),placeholder:"Klemme ausw\xe4hlen..."}),(0,gs.jsx)(Zl,{label:"Mittelklemmen",value:N.modulMittelklemmen,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{modulMittelklemmen:e.target.value})),Nr("Mittelklemmen")},options:$n,required:!0,hasError:jr("Mittelklemmen"),placeholder:"Klemme ausw\xe4hlen..."})]})}),"Ziegel"===N.roofType&&(0,gs.jsx)(Jl,{titleIcon:bl,title:"Zus\xe4tzlich f\xfcr Ziegeldach",children:(0,gs.jsxs)("div",{className:"space-y-4",children:[(0,gs.jsx)(Zl,{label:"Profile",value:N.profile,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{profile:e.target.value})),Nr("Profil")},options:tr,required:!0,hasError:jr("Profil"),placeholder:"Profil ausw\xe4hlen..."}),(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,gs.jsx)(Zl,{label:"Verbinder",value:N.verbinder,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{verbinder:e.target.value})),Nr("Verbinder")},options:Gn(Ol),required:!0,hasError:jr("Verbinder"),placeholder:"Verbinder ausw\xe4hlen..."}),(0,gs.jsx)(Zl,{label:"Endkappen",value:N.endkappen,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{endkappen:e.target.value})),Nr("Endkappen")},options:Gn(Ll),required:!0,hasError:jr("Endkappen"),placeholder:"Endkappen ausw\xe4hlen..."})]})]})}),(0,gs.jsx)(Jl,{titleIcon:fl,title:"PV\u2011Stecker",children:(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,gs.jsx)(Zl,{label:"PV\u2011Stecker (Male)",value:N.pvSteckerMale,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{pvSteckerMale:e.target.value})),Nr("PV-Stecker Male")},options:er,required:!0,hasError:jr("PV-Stecker Male"),placeholder:"Stecker ausw\xe4hlen..."}),(0,gs.jsx)(Zl,{label:"PV\u2011Stecker (Female)",value:N.pvSteckerFemale,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{pvSteckerFemale:e.target.value})),Nr("PV-Stecker Female")},options:er,required:!0,hasError:jr("PV-Stecker Female"),placeholder:"Stecker ausw\xe4hlen..."})]})})]}),2===m&&(0,gs.jsxs)("div",{className:"space-y-6",children:[N.inverters.map((e,t)=>(0,gs.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg space-y-4",children:[(0,gs.jsxs)("div",{className:"flex justify-between items-center",children:[(0,gs.jsxs)("h3",{className:"font-medium text-gray-800",children:["Wechselrichter #",t+1]}),t>0&&(0,gs.jsx)("button",{onClick:()=>(e=>k(t=>(0,Le.A)((0,Le.A)({},t),{},{inverters:t.inverters.filter((t,n)=>n!==e)})))(t),className:"text-red-500 hover:text-red-700",children:(0,gs.jsx)(Ea,{className:"h-4 w-4"})})]}),(0,gs.jsx)(Zl,{label:"Typ",value:e.type,onChange:e=>{const n=e.target.value;k(e=>{const r=(0,Le.A)((0,Le.A)({},e),{},{inverters:e.inverters.map(e=>(0,Le.A)({},e))});return r.inverters[t].type=n,r}),Nr("Wechselrichter ".concat(t+1))},options:Jn,required:!0,hasError:jr("Wechselrichter ".concat(t+1)),placeholder:"Wechselrichter ausw\xe4hlen..."}),(ur.inverterBreaker||ur.inverterCable)&&e.type&&(0,gs.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[(0,gs.jsx)("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Automatische Empfehlungen"}),(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[ur.inverterBreaker&&(0,gs.jsx)(Zl,{label:"Leitungsschutzschalter (WR)",value:mr.inverterBreaker||"",onChange:e=>hr(t=>(0,Le.A)((0,Le.A)({},t),{},{inverterBreaker:e.target.value})),options:rr,placeholder:"LS ausw\xe4hlen..."}),ur.inverterCable&&(0,gs.jsx)(Zl,{label:"Mantelleitung (WR)",value:mr.inverterCable||"",onChange:e=>hr(t=>(0,Le.A)((0,Le.A)({},t),{},{inverterCable:e.target.value})),options:sr,placeholder:"Kabel ausw\xe4hlen..."})]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Strings"}),(0,gs.jsx)("div",{className:"space-y-2",children:(e.strings||[]).map((e,n)=>(0,gs.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded",children:[(0,gs.jsx)("span",{className:"font-mono text-sm",children:e.name}),(0,gs.jsx)("input",{type:"number",min:"1",value:e.modules,onChange:e=>((e,t,n)=>{const r=Math.max(1,parseInt(n)||1);k(n=>{const s=(0,Le.A)((0,Le.A)({},n),{},{inverters:n.inverters.map(e=>(0,Le.A)((0,Le.A)({},e),{},{strings:[...e.strings]}))});return s.inverters[e].strings[t].modules=r,s})})(t,n,e.target.value),className:"w-full border border-gray-300 rounded px-2 py-1"}),(0,gs.jsx)("button",{onClick:()=>((e,t)=>{k(n=>{const r=(0,Le.A)((0,Le.A)({},n),{},{inverters:n.inverters.map(e=>(0,Le.A)((0,Le.A)({},e),{},{strings:[...e.strings]}))});return r.inverters[e].strings.splice(t,1),r.inverters[e].strings=r.inverters[e].strings.map((t,n)=>(0,Le.A)((0,Le.A)({},t),{},{name:"".concat(e+1,".").concat(n)})),r})})(t,n),className:"text-gray-500 hover:text-red-600",children:(0,gs.jsx)(Ea,{className:"h-4 w-4"})})]},n))}),(0,gs.jsxs)("button",{onClick:()=>(e=>{k(t=>{const n=(0,Le.A)((0,Le.A)({},t),{},{inverters:t.inverters.map(e=>(0,Le.A)((0,Le.A)({},e),{},{strings:[...e.strings]}))}),r=n.inverters[e].strings.length;return n.inverters[e].strings.push({name:"".concat(e+1,".").concat(r),modules:1}),n})})(t),className:"mt-2 flex items-center text-sm text-primary-600 hover:text-primary-800",children:[(0,gs.jsx)(ya,{className:"h-4 w-4 mr-1"}),"String hinzuf\xfcgen"]})]})]},t)),(0,gs.jsxs)("button",{onClick:()=>k(e=>(0,Le.A)((0,Le.A)({},e),{},{inverters:[...e.inverters,{type:"",quantity:1,strings:[{name:"".concat(e.inverters.length+1,".0"),modules:1}]}]})),className:"w-full flex justify-center items-center py-2 px-4 border border-dashed border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50",children:[(0,gs.jsx)(ya,{className:"h-4 w-4 mr-2"}),"Weiteren Wechselrichter hinzuf\xfcgen"]}),jr("String-Module-Anzahl")&&(0,gs.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,gs.jsxs)("div",{className:"flex items-center",children:[(0,gs.jsx)(wa,{className:"h-5 w-5 text-red-600 mr-2"}),(0,gs.jsx)("p",{className:"text-red-800 font-medium",children:"String-Module-Anzahl stimmt nicht mit der Gesamtsumme \xfcberein."})]})})]}),3===m&&(0,gs.jsxs)("div",{className:"space-y-6",children:[(0,gs.jsxs)(Jl,{children:[(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,gs.jsx)(Zl,{label:"Wallbox",value:N.wallbox,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{wallbox:e.target.value})),Nr("Wallbox")},options:Zn,placeholder:"Keine Wallbox",hasError:jr("Wallbox")}),(0,gs.jsx)(Xl,{label:"Anzahl",value:N.wallboxQty,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{wallboxQty:Math.max(0,parseInt(e.target.value)||0)})),Nr("Wallbox")},min:0,hasError:jr("Wallbox")})]}),N.wallbox&&(0,gs.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg mt-3",children:[(0,gs.jsx)("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Automatische Empfehlungen"}),(0,gs.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,gs.jsx)(Zl,{label:"Leitungsschutzschalter",value:mr.wallboxBreaker||"",onChange:e=>hr(t=>(0,Le.A)((0,Le.A)({},t),{},{wallboxBreaker:e.target.value})),options:rr,placeholder:"LS ausw\xe4hlen..."}),(0,gs.jsx)(Zl,{label:"Mantelleitung",value:mr.wallboxCable||"",onChange:e=>hr(t=>(0,Le.A)((0,Le.A)({},t),{},{wallboxCable:e.target.value})),options:sr,placeholder:"Kabel ausw\xe4hlen..."}),(0,gs.jsx)(Zl,{label:"FI\u2011Schutzschalter",value:mr.wallboxRCD||"",onChange:e=>hr(t=>(0,Le.A)((0,Le.A)({},t),{},{wallboxRCD:e.target.value})),options:ar,placeholder:"RCD ausw\xe4hlen..."})]})]})]}),(0,gs.jsx)(Jl,{title:"Speicher",children:(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,gs.jsx)(Zl,{label:"Speicher",value:N.battery,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{battery:e.target.value})),Nr("Speicher")},options:Xn,placeholder:"Kein Speicher",hasError:jr("Speicher")}),(0,gs.jsx)(Xl,{label:"Anzahl",value:N.batteryQty,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{batteryQty:Math.max(0,parseInt(e.target.value)||0)})),Nr("Speicher")},min:0,hasError:jr("Speicher")})]})}),(0,gs.jsx)(Jl,{title:"Energiemanagement",children:(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,gs.jsx)(Zl,{label:"Energiemanagement",value:N.energiemanagement,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{energiemanagement:e.target.value})),Nr("Energiemanagement")},options:Gn(_l),placeholder:"Kein Energiemanagement",hasError:jr("Energiemanagement")}),(0,gs.jsx)(Xl,{label:"Anzahl",value:N.energiemanagementQty,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{energiemanagementQty:Math.max(0,parseInt(e.target.value)||0)})),Nr("Energiemanagement")},min:0,hasError:jr("Energiemanagement")})]})}),(0,gs.jsxs)(Jl,{title:"Notstroml\xf6sungen",children:[(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,gs.jsx)(Zl,{label:"Notstroml\xf6sung",value:N.notstromloesungen,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{notstromloesungen:e.target.value})),Nr("Notstroml\xf6sungen")},options:Gn(Tl),placeholder:"Keine Notstroml\xf6sung",hasError:jr("Notstroml\xf6sungen")}),(0,gs.jsx)(Xl,{label:"Anzahl",value:N.notstromloesungenQty,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{notstromloesungenQty:Math.max(0,parseInt(e.target.value)||0)})),Nr("Notstroml\xf6sungen")},min:0,hasError:jr("Notstroml\xf6sungen")})]}),N.notstromloesungen&&(0,gs.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg mt-3",children:[(0,gs.jsx)("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Automatische Empfehlungen"}),(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,gs.jsx)(Zl,{label:"Leitungsschutzschalter",value:mr.backupBreaker||"",onChange:e=>hr(t=>(0,Le.A)((0,Le.A)({},t),{},{backupBreaker:e.target.value})),options:rr,placeholder:"LS ausw\xe4hlen..."}),(0,gs.jsx)(Zl,{label:"Mantelleitung",value:mr.backupCable||"",onChange:e=>hr(t=>(0,Le.A)((0,Le.A)({},t),{},{backupCable:e.target.value})),options:sr,placeholder:"Kabel ausw\xe4hlen..."})]})]})]}),(0,gs.jsx)(Jl,{title:"Optimierer",children:(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,gs.jsx)(Zl,{label:"Optimierer",value:N.optimizer,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{optimizer:e.target.value})),Nr("Optimierer")},options:nr,placeholder:"Kein Optimierer",hasError:jr("Optimierer")}),(0,gs.jsx)(Xl,{label:"Anzahl",value:N.optimizerQty,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{optimizerQty:Math.max(0,parseInt(e.target.value)||0)})),Nr("Optimierer")},min:0,hasError:jr("Optimierer")})]})})]}),4===m&&(0,gs.jsxs)("div",{className:"space-y-6",children:[(0,gs.jsx)(Jl,{title:"SLS",children:(0,gs.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,gs.jsx)("div",{className:"col-span-2",children:(0,gs.jsx)(Zl,{label:"SLS",value:N.sls,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{sls:e.target.value})),Nr("SLS")},options:Gn(Fl),placeholder:"SLS ausw\xe4hlen...",hasError:jr("SLS")})}),(0,gs.jsx)(Xl,{label:"Anzahl",value:N.slsQty,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{slsQty:Math.max(0,parseInt(e.target.value)||0)})),Nr("SLS")},min:0,hasError:jr("SLS")})]})}),(0,gs.jsx)(Jl,{title:"Tiefenerder",children:(0,gs.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,gs.jsx)("div",{className:"col-span-2",children:(0,gs.jsx)(Zl,{label:"Tiefenerder",value:N.tiefenerder,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{tiefenerder:e.target.value})),Nr("Tiefenerder")},options:Gn(Vl),placeholder:"Tiefenerder ausw\xe4hlen...",hasError:jr("Tiefenerder")})}),(0,gs.jsx)(Xl,{label:"Anzahl",value:N.tiefenerderQty,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{tiefenerderQty:Math.max(0,parseInt(e.target.value)||0)})),Nr("Tiefenerder")},min:0,hasError:jr("Tiefenerder")})]})}),(0,gs.jsx)(Jl,{title:"Kombiableiter",children:(0,gs.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,gs.jsx)("div",{className:"col-span-2",children:(0,gs.jsx)(Zl,{label:"Kombiableiter",value:N.kombiableiter,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{kombiableiter:e.target.value})),Nr("Kombiableiter")},options:Gn(zl),placeholder:"Kombiableiter ausw\xe4hlen...",hasError:jr("Kombiableiter")})}),(0,gs.jsx)(Xl,{label:"Anzahl",value:N.kombiableiterQty,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{kombiableiterQty:Math.max(0,parseInt(e.target.value)||0)})),Nr("Kombiableiter")},min:0,hasError:jr("Kombiableiter")})]})}),(0,gs.jsx)(Jl,{title:"Z\xe4hlerschrank",children:(0,gs.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,gs.jsx)("div",{className:"col-span-2",children:(0,gs.jsx)(Zl,{label:"Z\xe4hlerschrank",value:N.zaehlerschrank,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{zaehlerschrank:e.target.value})),Nr("Z\xe4hlerschrank")},options:Gn(Ul),placeholder:"Z\xe4hlerschrank ausw\xe4hlen...",hasError:jr("Z\xe4hlerschrank")})}),(0,gs.jsx)(Xl,{label:"Anzahl",value:N.zaehlerschrankQty,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{zaehlerschrankQty:Math.max(0,parseInt(e.target.value)||0)})),Nr("Z\xe4hlerschrank")},min:0,hasError:jr("Z\xe4hlerschrank")})]})}),(0,gs.jsx)(Jl,{title:"Generatoranschlusskasten",children:(0,gs.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,gs.jsx)("div",{className:"col-span-2",children:(0,gs.jsx)(Zl,{label:"Generatoranschlusskasten",value:N.generatoranschlusskasten,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{generatoranschlusskasten:e.target.value})),Nr("Generatoranschlusskasten")},options:Gn(ql),placeholder:"Generatoranschlusskasten ausw\xe4hlen...",hasError:jr("Generatoranschlusskasten")})}),(0,gs.jsx)(Xl,{label:"Anzahl",value:N.generatoranschlusskastenQty,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{generatoranschlusskastenQty:Math.max(0,parseInt(e.target.value)||0)})),Nr("Generatoranschlusskasten")},min:0,hasError:jr("Generatoranschlusskasten")})]})}),(0,gs.jsx)(Jl,{title:"Spannungsversorgung APZ",children:(0,gs.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,gs.jsx)("div",{className:"col-span-2",children:(0,gs.jsx)(Zl,{label:"Spannungsversorgung APZ",value:N.spannungsversorgungAPZ,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{spannungsversorgungAPZ:e.target.value})),Nr("SpannungsversorgungAPZ")},options:Gn(Kl),placeholder:"APZ ausw\xe4hlen...",hasError:jr("SpannungsversorgungAPZ")})}),(0,gs.jsx)(Xl,{label:"Anzahl",value:N.spannungsversorgungAPZQty,onChange:e=>{k(t=>(0,Le.A)((0,Le.A)({},t),{},{spannungsversorgungAPZQty:Math.max(0,parseInt(e.target.value)||0)})),Nr("SpannungsversorgungAPZ")},min:0,hasError:jr("SpannungsversorgungAPZ")})]})})]}),5===m&&(0,gs.jsxs)("div",{className:"space-y-6",children:[(xr.length>0||pr.warnings.length>0)&&(0,gs.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,gs.jsxs)("div",{className:"flex",children:[(0,gs.jsx)(wa,{className:"h-5 w-5 text-yellow-400"}),(0,gs.jsxs)("div",{className:"ml-3",children:[(0,gs.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Warnungen"}),(0,gs.jsx)("ul",{className:"mt-2 text-sm text-yellow-700 list-disc list-inside",children:[...new Set([...xr||[],...pr.warnings||[]])].map((e,t)=>(0,gs.jsx)("li",{children:e},t))})]})]})}),fr.length>0?(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"St\xfcckliste"}),(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)("button",{type:"button",onClick:()=>{gr(pr.bom),yr(pr.warnings)},className:"px-3 py-2 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50",title:"BOM auf aktuelle Empfehlungen zur\xfccksetzen",children:"Neu berechnen"}),(0,gs.jsx)("button",{type:"button",onClick:()=>br(!0),className:"px-3 py-2 text-sm bg-primary-600 text-white border border-transparent rounded hover:bg-primary-700",title:"Material manuell hinzuf\xfcgen",children:"+ Material hinzuf\xfcgen"})]})]}),(0,gs.jsx)("div",{className:"overflow-x-auto",children:(0,gs.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,gs.jsx)("thead",{className:"bg-gray-50",children:(0,gs.jsxs)("tr",{children:[(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Material"}),(0,gs.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Anzahl"}),(0,gs.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Aktion"})]})}),(0,gs.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:fr.map((e,t)=>{var n;return(0,gs.jsxs)("tr",{children:[(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)("span",{children:(null===(n=Hn.get(e.materialID))||void 0===n?void 0:n.description)||e.description}),e.isManual&&(0,gs.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:"manuell hinzugef\xfcgt"})]})}),(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,gs.jsx)("input",{type:"number",min:"1",value:e.quantity,onChange:e=>{const n=Math.max(1,parseInt(e.target.value)||1);gr(e=>{const r=[...e];return r[t]=(0,Le.A)((0,Le.A)({},e[t]),{},{quantity:n}),r})},className:"w-20 border border-gray-300 rounded px-2 py-1 text-sm"})}),(0,gs.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(0,gs.jsx)("button",{onClick:()=>gr(e=>e.filter((e,n)=>n!==t)),className:"text-red-600 hover:text-red-800 transition-colors",title:"Position entfernen",children:(0,gs.jsx)(Ea,{className:"h-4 w-4"})})})]},"".concat(e.materialID,"-").concat(t))})})]})})]}):(0,gs.jsx)("p",{className:"text-gray-500",children:"Keine Materialien berechnet."}),(0,gs.jsxs)("div",{className:"pt-6 border-t border-gray-200",children:[(0,gs.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Kundenbuchung"}),(0,gs.jsx)("div",{className:"mt-2",children:(0,gs.jsx)(Zl,{label:"Kunde",value:x,onChange:e=>y(e.target.value),options:u.map(e=>({value:e.id,label:e.firmennameKundenname})),placeholder:"Kunde ausw\xe4hlen..."})}),x&&(0,gs.jsxs)("div",{className:"mt-4",children:[(0,gs.jsx)(Zl,{label:"Projekt",value:v,onChange:e=>b(e.target.value),options:w.length?w.map(e=>({value:e.id,label:"".concat(e.name||e.projectName," (").concat(e.status,")")})):[],placeholder:"Projekt ausw\xe4hlen..."}),0===w.length&&(0,gs.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Keine Projekte f\xfcr diesen Kunden gefunden"})]}),(0,gs.jsx)("button",{onClick:async()=>{if(x&&v&&0!==fr.length)try{var e,t,n,r,s,a,i,l,m;const f=(await ks.FirebaseService.getDocuments("project-configurations")).filter(e=>e.projectID===v),g=()=>{if(0===f.length)return"1.0";const e=f.map(e=>{var t;return(null===(t=e.pvConfiguration)||void 0===t?void 0:t.configurationVersion)||"1.0"}).map(e=>parseFloat(e)).filter(e=>!isNaN(e));return(Math.max(...e,0)+1).toFixed(1)},b=g(),w={id:"pv-booking-".concat(v,"-").concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,11)),customerID:x,customerName:(null===(e=u.find(e=>e.id===x))||void 0===e?void 0:e.firmennameKundenname)||"Unbekannt",projectID:v,projectName:(null===(t=d.find(e=>e.id===v))||void 0===t?void 0:t.projectName)||"Unbekannt",type:"Ausgang",materials:fr.map(e=>{const t=o.find(t=>t.materialID===e.materialID||t.id===e.materialID),n=(null===t||void 0===t?void 0:t.price)||0,r=n*e.quantity;return{materialID:e.materialID,quantity:e.quantity,description:e.description,priceAtBooking:n,totalCost:r}}),status:"Abgeschlossen",notes:"PV-Anlagen-Konfiguration - Automatisch generierte St\xfcckliste"},j={timestamp:(new Date).toISOString(),configurationVersion:b,inverters:N.inverters.filter(e=>e.type).map(e=>{var t;return{materialID:e.type,description:(null===(t=Hn.get(e.type))||void 0===t?void 0:t.description)||"Unbekannt",quantity:e.quantity,recommendedBreaker:mr.inverterBreaker,recommendedCable:mr.inverterCable,strings:(e.strings||[]).map(e=>{var t;return{stringName:e.name,moduleCount:e.modules,moduleType:N.module,moduleDescription:(null===(t=Hn.get(N.module))||void 0===t?void 0:t.description)||"Unbekannt"}})}}),modules:N.module?{materialID:N.module,description:(null===(n=Hn.get(N.module))||void 0===n?void 0:n.description)||"Unbekannt",totalQuantity:Wn.totalModules}:null,wallbox:N.wallbox&&N.wallboxQty>0?{materialID:N.wallbox,description:(null===(r=Hn.get(N.wallbox))||void 0===r?void 0:r.description)||"Unbekannt",quantity:N.wallboxQty,recommendedBreaker:mr.wallboxBreaker,recommendedCable:mr.wallboxCable,recommendedRCD:mr.wallboxRCD}:null,backupSolutions:N.notstromloesungen&&N.notstromloesungenQty>0?{materialID:N.notstromloesungen,description:(null===(s=Hn.get(N.notstromloesungen))||void 0===s?void 0:s.description)||"Unbekannt",quantity:N.notstromloesungenQty,recommendedBreaker:mr.backupBreaker,recommendedCable:mr.backupCable}:null,pvCables:X?{materialID:X,description:null===(a=Hn.get(X))||void 0===a?void 0:a.description,quantity:(null===(i=fr.find(e=>e.materialID===X))||void 0===i?void 0:i.quantity)||0}:null,potentialausgleichHESUK:Ee?{materialID:Ee,description:null===(l=Hn.get(Ee))||void 0===l?void 0:l.description,quantity:Ne||0}:null,generatoranschlusskasten:N.generatoranschlusskasten?{materialID:N.generatoranschlusskasten,description:(null===(m=Hn.get(N.generatoranschlusskasten))||void 0===m?void 0:m.description)||"Unbekannt",quantity:N.generatoranschlusskastenQty}:null},S="pv-config-".concat(v,"-").concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,11));await h(w);for(const e of fr){const t=o.find(t=>t.materialID===e.materialID||t.id===e.materialID);t&&await c(t.id,-e.quantity)}await ks.FirebaseService.addDocument("project-configurations",{id:S,projectID:v,customerID:x,pvConfiguration:j,createdAt:(new Date).toISOString(),createdBy:"PV-Konfigurator",type:"pv-configuration"}),alert("St\xfcckliste und Projektkonfiguration erfolgreich gespeichert!"),k({module:"",roofType:"",querformatRows:[],hochformatRows:[],pvMountingSystem:"",befestigungPVMountingSystem:"",modulEndklemmen:"",modulMittelklemmen:"",pvSteckerMale:"",pvSteckerFemale:"",profile:"",verbinder:"",endkappen:"",inverters:[{type:"",quantity:1,strings:[{name:"1.0",modules:1}]}],optimizer:"",optimizerQty:0,battery:"",batteryQty:0,wallbox:"",wallboxQty:0,energiemanagement:"",energiemanagementQty:0,notstromloesungen:"",notstromloesungenQty:0,sls:"",slsQty:0,tiefenerder:"",tiefenerderQty:0,kombiableiter:"",kombiableiterQty:0,zaehlerschrank:"",zaehlerschrankQty:0,generatoranschlusskasten:"",generatoranschlusskastenQty:0,spannungsversorgungAPZ:"",spannungsversorgungAPZQty:0}),p(0),y(""),gr([]),yr([])}catch(Ao){console.error("Fehler beim Buchen:",Ao),alert("Fehler beim Buchen der St\xfcckliste!")}else alert("Bitte Kunde und Projekt ausw\xe4hlen und Konfiguration vervollst\xe4ndigen!")},disabled:!x||!v||0===fr.length||xr.length>0,className:"mt-4 w-full bg-primary-600 text-white py-2 px-4 rounded-lg hover:bg-primary-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"St\xfcckliste an Projekt buchen"})]})]})]})})}),(0,gs.jsx)("div",{className:"flex-shrink-0 bg-white shadow-lg border-t border-gray-200 p-6",children:(0,gs.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,gs.jsxs)("div",{className:"flex justify-between items-center",children:[(0,gs.jsxs)("button",{onClick:()=>m>0&&p(e=>e-1),disabled:0===m,className:"flex items-center px-6 py-3 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed transition-colors",children:[(0,gs.jsx)(hi,{className:"h-4 w-4 mr-2"}),"Zur\xfcck"]}),(0,gs.jsxs)("div",{className:"text-sm text-gray-500",children:["Schritt ",m+1," von ",kr.length]}),(0,gs.jsxs)("button",{onClick:()=>{const e=(e=>{const t=[];if(0===e){var n,r;N.module||t.push("PV-Modul"),N.roofType||t.push("Dachtyp"),((null===(n=N.querformatRows)||void 0===n?void 0:n.length)||0)+((null===(r=N.hochformatRows)||void 0===r?void 0:r.length)||0)>0||t.push("Modulanordnung")}if(1===e&&(N.pvMountingSystem||t.push("Montagesystem"),N.befestigungPVMountingSystem||t.push("Befestigung"),N.modulEndklemmen||t.push("Endklemmen"),N.modulMittelklemmen||t.push("Mittelklemmen"),N.pvSteckerMale||t.push("PV-Stecker Male"),N.pvSteckerFemale||t.push("PV-Stecker Female"),"Ziegel"===N.roofType&&(N.profile||t.push("Profil"),N.verbinder||t.push("Verbinder"),N.endkappen||t.push("Endkappen"))),2===e){N.inverters.forEach((e,n)=>{e.type||t.push("Wechselrichter ".concat(n+1))});const e=Wn.totalModules,n=N.inverters.flatMap(e=>e.strings||[]).reduce((e,t)=>e+(parseInt(t.modules)||0),0);e>0&&e!==n&&t.push("String-Module-Anzahl")}return 3===e&&(wr(N.wallbox,N.wallboxQty)||t.push("Wallbox"),wr(N.battery,N.batteryQty)||t.push("Speicher"),wr(N.energiemanagement,N.energiemanagementQty)||t.push("Energiemanagement"),wr(N.notstromloesungen,N.notstromloesungenQty)||t.push("Notstroml\xf6sungen"),wr(N.optimizer,N.optimizerQty)||t.push("Optimierer")),4===e&&(wr(N.sls,N.slsQty)||t.push("SLS"),wr(N.tiefenerder,N.tiefenerderQty)||t.push("Tiefenerder"),wr(N.kombiableiter,N.kombiableiterQty)||t.push("Kombiableiter"),wr(N.zaehlerschrank,N.zaehlerschrankQty)||t.push("Z\xe4hlerschrank"),wr(N.generatoranschlusskasten,N.generatoranschlusskastenQty)||t.push("Generatoranschlusskasten"),wr(N.spannungsversorgungAPZ,N.spannungsversorgungAPZQty)||t.push("SpannungsversorgungAPZ")),t})(m);e.length?g(e):(g([]),m<5&&p(e=>e+1))},disabled:5===m,className:"flex items-center px-6 py-3 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:[5===m?"Fertig":"Weiter",(0,gs.jsx)(mi,{className:"h-4 w-4 ml-2"})]})]})})}),vr&&(0,gs.jsx)(Yl,{materials:o,onAddMaterial:(e,t)=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=Hn.get(e);if(!r)return;const s=fr.findIndex(t=>t.materialID===e);if(s>=0)gr(e=>{const n=[...e];return n[s]=(0,Le.A)((0,Le.A)({},n[s]),{},{quantity:n[s].quantity+t}),n});else{const s={materialID:e,description:r.description,quantity:t,isManual:n};gr(e=>[...e,s])}n&&br(!1)}(e,t,!0),onClose:()=>br(!1)})]})},eo=_s("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),to=_s("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),no=_s("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),ro=e=>{var t,n,r,a,i,l,o,c,u,d,h,m,p,f,g,x,y;let{offer:v,isOpen:b,onClose:w}=e;const{customers:j}=Vs(),{projects:N}=Ks(),k=(0,s.useMemo)(()=>j.find(e=>e.id===(null===v||void 0===v?void 0:v.customerID)),[j,null===v||void 0===v?void 0:v.customerID]),S=(0,s.useMemo)(()=>N.find(e=>e.id===(null===v||void 0===v?void 0:v.projectID)),[N,null===v||void 0===v?void 0:v.projectID]),C=e=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(e||0),E=e=>{if(!e)return"-";try{return(e.toDate?e.toDate():new Date(e)).toLocaleDateString("de-DE")}catch(t){return e}};return v?(0,gs.jsxs)(_a,{isOpen:b,onClose:w,title:"Angebotsvorschau",size:"xl",children:[(0,gs.jsxs)("div",{className:"flex flex-col h-full max-h-[85vh]",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between px-6 py-3 border-b bg-gray-50",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)(di,{className:"h-5 w-5 text-gray-600"}),(0,gs.jsx)("span",{className:"font-medium",children:v.offerNumber}),(0,gs.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs ".concat("green"===(null===(t=la[v.status])||void 0===t?void 0:t.color)?"bg-green-100 text-green-700":"blue"===(null===(n=la[v.status])||void 0===n?void 0:n.color)?"bg-blue-100 text-blue-700":"red"===(null===(r=la[v.status])||void 0===r?void 0:r.color)?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"),children:null===(a=la[v.status])||void 0===a?void 0:a.label})]}),(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsxs)("button",{onClick:()=>{window.print()},className:"px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-200 rounded-lg flex items-center",children:[(0,gs.jsx)(pi,{className:"h-4 w-4 mr-1"}),"Drucken"]}),(0,gs.jsxs)("button",{onClick:()=>{window.print()},className:"px-3 py-1.5 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center",children:[(0,gs.jsx)(cl,{className:"h-4 w-4 mr-1"}),"PDF"]})]})]}),(0,gs.jsx)("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-100",children:(0,gs.jsx)("div",{className:"max-w-[210mm] mx-auto bg-white shadow-lg rounded-lg overflow-hidden print:shadow-none",children:(0,gs.jsxs)("div",{className:"p-8 print:p-0",id:"offer-pdf-content",children:[(0,gs.jsxs)("div",{className:"flex justify-between items-start mb-8 pb-6 border-b",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"ANGEBOT"}),(0,gs.jsx)("p",{className:"text-gray-600 mt-1",children:v.offerNumber})]}),(0,gs.jsxs)("div",{className:"text-right text-sm text-gray-600",children:[(0,gs.jsx)("p",{className:"font-medium text-gray-900",children:"Ihr Unternehmen"}),(0,gs.jsx)("p",{children:"Musterstra\xdfe 123"}),(0,gs.jsx)("p",{children:"12345 Musterstadt"}),(0,gs.jsx)("p",{children:"Tel: 0123 456789"}),(0,gs.jsx)("p",{children:"info@unternehmen.de"})]})]}),(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-8 mb-8",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"Empf\xe4nger"}),(0,gs.jsxs)("div",{className:"text-sm",children:[(0,gs.jsx)("p",{className:"font-medium text-gray-900",children:(null===k||void 0===k?void 0:k.firmennameKundenname)||(null===k||void 0===k?void 0:k.name)||"-"}),(null===k||void 0===k?void 0:k.strasse)&&(0,gs.jsx)("p",{children:k.strasse}),((null===k||void 0===k?void 0:k.plz)||(null===k||void 0===k?void 0:k.ort))&&(0,gs.jsxs)("p",{children:[null===k||void 0===k?void 0:k.plz," ",null===k||void 0===k?void 0:k.ort]})]})]}),(0,gs.jsx)("div",{className:"text-right",children:(0,gs.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,gs.jsxs)("div",{className:"flex justify-between",children:[(0,gs.jsx)("span",{className:"text-gray-500",children:"Datum:"}),(0,gs.jsx)("span",{children:E(v.createdAt)})]}),(0,gs.jsxs)("div",{className:"flex justify-between",children:[(0,gs.jsx)("span",{className:"text-gray-500",children:"G\xfcltig bis:"}),(0,gs.jsx)("span",{children:E(null===(i=v.conditions)||void 0===i?void 0:i.validUntil)})]}),S&&(0,gs.jsxs)("div",{className:"flex justify-between",children:[(0,gs.jsx)("span",{className:"text-gray-500",children:"Projekt:"}),(0,gs.jsx)("span",{children:S.projektname||S.name})]})]})})]}),(0,gs.jsx)("div",{className:"mb-6",children:(0,gs.jsxs)("p",{className:"font-medium text-gray-900",children:["Betreff: Angebot ",S?"- ".concat(S.projektname||S.name):""]})}),(0,gs.jsx)("div",{className:"mb-6 text-sm text-gray-600",children:(0,gs.jsx)("p",{children:"Vielen Dank f\xfcr Ihre Anfrage. Wir freuen uns, Ihnen folgendes Angebot unterbreiten zu d\xfcrfen:"})}),(0,gs.jsx)("div",{className:"mb-8",children:(0,gs.jsxs)("table",{className:"w-full text-sm",children:[(0,gs.jsx)("thead",{children:(0,gs.jsxs)("tr",{className:"border-b-2 border-gray-300",children:[(0,gs.jsx)("th",{className:"py-2 text-left font-medium text-gray-700 w-12",children:"Pos."}),(0,gs.jsx)("th",{className:"py-2 text-left font-medium text-gray-700",children:"Beschreibung"}),(0,gs.jsx)("th",{className:"py-2 text-right font-medium text-gray-700 w-16",children:"Menge"}),(0,gs.jsx)("th",{className:"py-2 text-center font-medium text-gray-700 w-16",children:"Einheit"}),(0,gs.jsx)("th",{className:"py-2 text-right font-medium text-gray-700 w-24",children:"EP (netto)"}),(0,gs.jsx)("th",{className:"py-2 text-right font-medium text-gray-700 w-28",children:"Gesamt"})]})}),(0,gs.jsx)("tbody",{children:(v.items||[]).map((e,t)=>(0,gs.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,gs.jsx)("td",{className:"py-3 text-gray-600",children:e.position||t+1}),(0,gs.jsxs)("td",{className:"py-3",children:[(0,gs.jsx)("p",{className:"font-medium text-gray-900",children:e.shortText}),e.longText&&(0,gs.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.longText})]}),(0,gs.jsx)("td",{className:"py-3 text-right",children:e.quantity}),(0,gs.jsx)("td",{className:"py-3 text-center text-gray-600",children:e.unit}),(0,gs.jsx)("td",{className:"py-3 text-right",children:C(e.unitPriceNet)}),(0,gs.jsx)("td",{className:"py-3 text-right font-medium",children:C(e.totalNet)})]},e.id||t))})]})}),(0,gs.jsx)("div",{className:"flex justify-end mb-8",children:(0,gs.jsx)("div",{className:"w-64",children:(0,gs.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,gs.jsxs)("div",{className:"flex justify-between",children:[(0,gs.jsx)("span",{className:"text-gray-600",children:"Zwischensumme (netto):"}),(0,gs.jsx)("span",{children:C(null===(l=v.totals)||void 0===l?void 0:l.subtotalNet)})]}),(null===(o=v.totals)||void 0===o?void 0:o.discountPercent)>0&&(0,gs.jsxs)("div",{className:"flex justify-between text-red-600",children:[(0,gs.jsxs)("span",{children:["Rabatt (",null===(c=v.totals)||void 0===c?void 0:c.discountPercent,"%):"]}),(0,gs.jsxs)("span",{children:["- ",C(null===(u=v.totals)||void 0===u?void 0:u.discountAmount)]})]}),(0,gs.jsxs)("div",{className:"flex justify-between border-t pt-2",children:[(0,gs.jsx)("span",{className:"text-gray-600",children:"Netto:"}),(0,gs.jsx)("span",{children:C(null===(d=v.totals)||void 0===d?void 0:d.netTotal)})]}),(0,gs.jsxs)("div",{className:"flex justify-between",children:[(0,gs.jsxs)("span",{className:"text-gray-600",children:["MwSt (",(null===(h=v.totals)||void 0===h?void 0:h.taxRate)||19,"%):"]}),(0,gs.jsx)("span",{children:C(null===(m=v.totals)||void 0===m?void 0:m.taxAmount)})]}),(0,gs.jsxs)("div",{className:"flex justify-between border-t-2 border-gray-900 pt-2 text-lg font-bold",children:[(0,gs.jsx)("span",{children:"Gesamtbetrag:"}),(0,gs.jsx)("span",{children:C(null===(p=v.totals)||void 0===p?void 0:p.grossTotal)})]})]})})}),(0,gs.jsxs)("div",{className:"border-t pt-6 mb-6 text-sm",children:[(0,gs.jsx)("h3",{className:"font-medium text-gray-900 mb-3",children:"Zahlungs- und Lieferbedingungen"}),(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-gray-600",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-gray-500",children:"Zahlungsbedingungen:"}),(0,gs.jsx)("p",{children:(null===(f=v.conditions)||void 0===f?void 0:f.paymentTerms)||"14 Tage netto"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-gray-500",children:"Lieferbedingungen:"}),(0,gs.jsx)("p",{children:(null===(g=v.conditions)||void 0===g?void 0:g.deliveryTerms)||"Nach Vereinbarung"})]})]})]}),(null===(x=v.conditions)||void 0===x?void 0:x.notes)&&(0,gs.jsxs)("div",{className:"border-t pt-6 mb-6 text-sm",children:[(0,gs.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Anmerkungen"}),(0,gs.jsx)("p",{className:"text-gray-600 whitespace-pre-line",children:v.conditions.notes})]}),(0,gs.jsxs)("div",{className:"border-t pt-6 text-sm text-gray-500",children:[(0,gs.jsxs)("p",{children:["Dieses Angebot ist g\xfcltig bis zum ",E(null===(y=v.conditions)||void 0===y?void 0:y.validUntil),". Bei Fragen stehen wir Ihnen gerne zur Verf\xfcgung."]}),(0,gs.jsx)("p",{className:"mt-4",children:"Mit freundlichen Gr\xfc\xdfen"}),(0,gs.jsx)("p",{className:"mt-4 font-medium text-gray-700",children:"Ihr Unternehmen"})]})]})})}),(0,gs.jsx)("div",{className:"flex justify-end px-6 py-4 border-t bg-gray-50",children:(0,gs.jsx)("button",{onClick:w,className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300",children:"Schlie\xdfen"})})]}),(0,gs.jsx)("style",{children:"\n        @media print {\n          body * {\n            visibility: hidden;\n          }\n          #offer-pdf-content, #offer-pdf-content * {\n            visibility: visible;\n          }\n          #offer-pdf-content {\n            position: absolute;\n            left: 0;\n            top: 0;\n            width: 100%;\n            padding: 20mm;\n          }\n        }\n      "})]}):null},so=()=>{var e,t,n;const r=ne(),{offers:a,loading:i,deleteOffer:l,duplicateOffer:o,updateOfferStatus:c,getStatistics:u}=aa(),{customers:d}=Vs(),{projects:h}=Ks(),{showNotification:m}=Os(),[p,f]=(0,s.useState)(""),[g,x]=(0,s.useState)("all"),[y,v]=(0,s.useState)("all"),[b,w]=(0,s.useState)(null),[j,N]=(0,s.useState)(!1),[k,S]=(0,s.useState)(!1),[C,E]=(0,s.useState)(null),[A,I]=(0,s.useState)(null),_=(0,s.useMemo)(()=>u(),[u,a]),T=(0,s.useMemo)(()=>a.filter(e=>{if(p.trim()){var t,n,r,s;const a=p.toLowerCase(),i=d.find(t=>t.id===e.customerID),l=h.find(t=>t.id===e.projectID);if(!((null===(t=e.offerNumber)||void 0===t?void 0:t.toLowerCase().includes(a))||(null===i||void 0===i||null===(n=i.firmennameKundenname)||void 0===n?void 0:n.toLowerCase().includes(a))||(null===i||void 0===i||null===(r=i.name)||void 0===r?void 0:r.toLowerCase().includes(a))||(null===l||void 0===l||null===(s=l.projektname)||void 0===s?void 0:s.toLowerCase().includes(a))))return!1}return("all"===g||e.status===g)&&("all"===y||e.customerID===y)}),[a,p,g,y,d,h]),D=e=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(e||0),P=e=>{const t=d.find(t=>t.id===e);return(null===t||void 0===t?void 0:t.firmennameKundenname)||(null===t||void 0===t?void 0:t.name)||"-"},M=e=>{if(!e)return"-";const t=h.find(t=>t.id===e);return(null===t||void 0===t?void 0:t.projektname)||(null===t||void 0===t?void 0:t.name)||"-"},R=e=>{const t=la[e]||{label:e,color:"gray"};return(0,gs.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat({gray:"bg-gray-100 text-gray-700",blue:"bg-blue-100 text-blue-700",green:"bg-green-100 text-green-700",red:"bg-red-100 text-red-700",orange:"bg-orange-100 text-orange-700"}[t.color]),children:t.label})},O=()=>{r("/offers/new")},L=async(e,t)=>{(await c(e.id,t)).success?m("Status ge\xe4ndert: ".concat(la[t].label),"success"):m("Fehler beim Status-Update","error"),I(null)},F=(0,s.useMemo)(()=>{const e=[...new Set(a.map(e=>e.customerID))];return d.filter(t=>e.includes(t.id))},[a,d]);return(0,gs.jsxs)("div",{className:"space-y-6",children:[(0,gs.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Angebote"}),(0,gs.jsxs)("p",{className:"text-sm text-gray-500",children:[T.length," von ",a.length," Angeboten"]})]}),(0,gs.jsxs)("button",{onClick:O,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center text-sm font-medium",children:[(0,gs.jsx)(ya,{className:"h-4 w-4 mr-2"}),"Neues Angebot"]})]}),(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,gs.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm text-gray-500",children:"Gesamt"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:_.total})]}),(0,gs.jsx)("div",{className:"p-3 bg-gray-100 rounded-lg",children:(0,gs.jsx)(di,{className:"h-6 w-6 text-gray-600"})})]})}),(0,gs.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm text-gray-500",children:"Offen"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:((null===(e=_.byStatus)||void 0===e?void 0:e.draft)||0)+((null===(t=_.byStatus)||void 0===t?void 0:t.sent)||0)})]}),(0,gs.jsx)("div",{className:"p-3 bg-blue-100 rounded-lg",children:(0,gs.jsx)(Ha,{className:"h-6 w-6 text-blue-600"})})]})}),(0,gs.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm text-gray-500",children:"Angenommen"}),(0,gs.jsx)("p",{className:"text-2xl font-bold text-green-600",children:(null===(n=_.byStatus)||void 0===n?void 0:n.accepted)||0})]}),(0,gs.jsx)("div",{className:"p-3 bg-green-100 rounded-lg",children:(0,gs.jsx)(Ts,{className:"h-6 w-6 text-green-600"})})]})}),(0,gs.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"text-sm text-gray-500",children:"Angenommener Wert"}),(0,gs.jsx)("p",{className:"text-xl font-bold text-green-600",children:D(_.acceptedValue)})]}),(0,gs.jsx)("div",{className:"p-3 bg-green-100 rounded-lg",children:(0,gs.jsx)($a,{className:"h-6 w-6 text-green-600"})})]})})]}),(0,gs.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,gs.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,gs.jsxs)("div",{className:"flex-1 relative",children:[(0,gs.jsx)(va,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,gs.jsx)("input",{type:"text",value:p,onChange:e=>f(e.target.value),placeholder:"Angebotsnummer, Kunde oder Projekt suchen...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,gs.jsx)("div",{className:"w-full md:w-48",children:(0,gs.jsxs)("select",{value:g,onChange:e=>x(e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500",children:[(0,gs.jsx)("option",{value:"all",children:"Alle Status"}),Object.entries(la).map(e=>{let[t,n]=e;return(0,gs.jsx)("option",{value:t,children:n.label},t)})]})}),(0,gs.jsx)("div",{className:"w-full md:w-48",children:(0,gs.jsxs)("select",{value:y,onChange:e=>v(e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500",children:[(0,gs.jsx)("option",{value:"all",children:"Alle Kunden"}),F.map(e=>(0,gs.jsx)("option",{value:e.id,children:e.firmennameKundenname||e.name},e.id))]})})]})}),(0,gs.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:i?(0,gs.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,gs.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):0===T.length?(0,gs.jsxs)("div",{className:"text-center py-12",children:[(0,gs.jsx)(di,{className:"h-12 w-12 mx-auto text-gray-300 mb-4"}),(0,gs.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Keine Angebote gefunden"}),(0,gs.jsx)("p",{className:"text-gray-500 mb-4",children:0===a.length?"Erstellen Sie Ihr erstes Angebot":"Passen Sie Ihre Filterkriterien an"}),0===a.length&&(0,gs.jsx)("button",{onClick:O,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Erstes Angebot erstellen"})]}):(0,gs.jsx)("div",{className:"overflow-x-auto",children:(0,gs.jsxs)("table",{className:"w-full",children:[(0,gs.jsx)("thead",{className:"bg-gray-50",children:(0,gs.jsxs)("tr",{children:[(0,gs.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Angebot"}),(0,gs.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Kunde"}),(0,gs.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Projekt"}),(0,gs.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Betrag"}),(0,gs.jsx)("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Status"}),(0,gs.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Datum"}),(0,gs.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Aktionen"})]})}),(0,gs.jsx)("tbody",{className:"divide-y divide-gray-100",children:T.map(e=>{var t,n,s,a;return(0,gs.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,gs.jsxs)("td",{className:"px-4 py-3",children:[(0,gs.jsx)("span",{className:"font-medium text-gray-900",children:e.offerNumber}),(0,gs.jsxs)("span",{className:"text-xs text-gray-500 block",children:["v",e.version||1]})]}),(0,gs.jsx)("td",{className:"px-4 py-3 text-gray-600",children:P(e.customerID)}),(0,gs.jsx)("td",{className:"px-4 py-3 text-gray-600",children:M(e.projectID)}),(0,gs.jsx)("td",{className:"px-4 py-3 text-right font-medium",children:D(null===(t=e.totals)||void 0===t?void 0:t.grossTotal)}),(0,gs.jsx)("td",{className:"px-4 py-3 text-center",children:R(e.status)}),(0,gs.jsx)("td",{className:"px-4 py-3 text-gray-600 text-sm",children:(a=(null===(n=e.createdAt)||void 0===n||null===(s=n.toDate)||void 0===s?void 0:s.call(n))||e.createdAt,a?new Date(a).toLocaleDateString("de-DE"):"-")}),(0,gs.jsx)("td",{className:"px-4 py-3 text-right",children:(0,gs.jsxs)("div",{className:"relative inline-block",children:[(0,gs.jsx)("button",{onClick:()=>I(A===e.id?null:e.id),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:(0,gs.jsx)(Sa,{className:"h-5 w-5"})}),A===e.id&&(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>I(null)}),(0,gs.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-20",children:(0,gs.jsxs)("div",{className:"py-1",children:[(0,gs.jsxs)("button",{onClick:()=>{(e=>{w(e),S(!0)})(e),I(null)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center",children:[(0,gs.jsx)(ha,{className:"h-4 w-4 mr-3"}),"Anzeigen"]}),(0,gs.jsxs)("button",{onClick:()=>{(e=>{r("/offers/".concat(e.id))})(e),I(null)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center",children:[(0,gs.jsx)(Ca,{className:"h-4 w-4 mr-3"}),"Bearbeiten"]}),(0,gs.jsxs)("button",{onClick:()=>(async e=>{(await o(e.id)).success?m("Angebot dupliziert","success"):m("Fehler beim Duplizieren","error"),I(null)})(e),className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center",children:[(0,gs.jsx)(eo,{className:"h-4 w-4 mr-3"}),"Duplizieren"]}),(0,gs.jsx)("hr",{className:"my-1"}),e.status===ia.DRAFT&&(0,gs.jsxs)("button",{onClick:()=>L(e,ia.SENT),className:"w-full px-4 py-2 text-left text-sm text-blue-600 hover:bg-blue-50 flex items-center",children:[(0,gs.jsx)(to,{className:"h-4 w-4 mr-3"}),"Als gesendet markieren"]}),e.status===ia.SENT&&(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsxs)("button",{onClick:()=>L(e,ia.ACCEPTED),className:"w-full px-4 py-2 text-left text-sm text-green-600 hover:bg-green-50 flex items-center",children:[(0,gs.jsx)(Ts,{className:"h-4 w-4 mr-3"}),"Angenommen"]}),(0,gs.jsxs)("button",{onClick:()=>L(e,ia.REJECTED),className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center",children:[(0,gs.jsx)(no,{className:"h-4 w-4 mr-3"}),"Abgelehnt"]})]}),(0,gs.jsx)("hr",{className:"my-1"}),(0,gs.jsxs)("button",{onClick:()=>(e=>{E(e),N(!0),I(null)})(e),className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center",children:[(0,gs.jsx)(Ea,{className:"h-4 w-4 mr-3"}),"L\xf6schen"]})]})})]})]})})]},e.id)})})]})})}),(0,gs.jsx)(_a,{isOpen:j,onClose:()=>{N(!1),E(null)},title:"Angebot l\xf6schen",size:"sm",children:(0,gs.jsxs)("div",{className:"p-6",children:[(0,gs.jsxs)("p",{className:"text-gray-600 mb-4",children:["M\xf6chten Sie das Angebot ",(0,gs.jsx)("strong",{children:null===C||void 0===C?void 0:C.offerNumber})," wirklich l\xf6schen? Diese Aktion kann nicht r\xfcckg\xe4ngig gemacht werden."]}),(0,gs.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,gs.jsx)("button",{onClick:()=>{N(!1),E(null)},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Abbrechen"}),(0,gs.jsx)("button",{onClick:async()=>{if(!C)return;(await l(C.id)).success?m("Angebot gel\xf6scht","success"):m("Fehler beim L\xf6schen","error"),N(!1),E(null)},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"L\xf6schen"})]})]})}),k&&b&&(0,gs.jsx)(ro,{offer:b,isOpen:k,onClose:()=>{S(!1),w(null)}})]})},ao=[{id:0,title:"Kunde & Projekt",icon:Qa},{id:1,title:"Leistungen",icon:ba},{id:2,title:"Positionen",icon:Ca},{id:3,title:"Konditionen",icon:di},{id:4,title:"Abschluss",icon:Ts}],io=()=>{var e;const t=ne(),{id:n}=function(){let{matches:e}=s.useContext(X),t=e[e.length-1];return t?t.params:{}}(),r=!!n,{createOffer:a,updateOffer:i,getOfferById:l}=aa(),{activeServices:o,getServicesByCategory:c}=$s(),{calculateOfferTotals:u,calculateValidUntil:d,settings:h}=Qs(),{customers:m}=Vs(),{projects:p}=Ks(),{materials:f}=Cs(),{showNotification:g}=Os(),[x,y]=(0,s.useState)(0),[v,b]=(0,s.useState)(!1),[w,j]=(0,s.useState)({customerID:"",projectID:"",items:[],totals:{subtotalNet:0,discountPercent:0,discountAmount:0,netTotal:0,taxRate:19,taxAmount:0,grossTotal:0},conditions:{validUntil:"",paymentTerms:"",deliveryTerms:"",notes:""}}),[N,k]=(0,s.useState)({}),[S,C]=(0,s.useState)("");(0,s.useEffect)(()=>{if(r&&n){const e=l(n);e&&j({customerID:e.customerID||"",projectID:e.projectID||"",items:e.items||[],totals:e.totals||{},conditions:e.conditions||{}})}else j(e=>{var t,n;return(0,Le.A)((0,Le.A)({},e),{},{conditions:(0,Le.A)((0,Le.A)({},e.conditions),{},{validUntil:d(),paymentTerms:(null===(t=h.offerDefaults)||void 0===t?void 0:t.paymentTerms)||"",deliveryTerms:(null===(n=h.offerDefaults)||void 0===n?void 0:n.deliveryTerms)||""})})})},[r,n,l,d,h]);const E=(0,s.useMemo)(()=>w.customerID?p.filter(e=>e.customerID===w.customerID):[],[p,w.customerID]),A=(0,s.useMemo)(()=>{const e={};return ea.forEach(t=>{const n=o.filter(e=>e.category===t.id);if(S.trim()){const r=S.toLowerCase();e[t.id]=n.filter(e=>{var t,n;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(r))||(null===(n=e.shortText)||void 0===n?void 0:n.toLowerCase().includes(r))})}else e[t.id]=n}),e},[o,S]);(0,s.useEffect)(()=>{var e;const t=u(w.items,(null===(e=w.totals)||void 0===e?void 0:e.discountPercent)||0);j(e=>(0,Le.A)((0,Le.A)({},e),{},{totals:t}))},[w.items,null===(e=w.totals)||void 0===e?void 0:e.discountPercent,u]);const I=()=>{const e={id:"item-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),position:w.items.length+1,type:"manual",serviceID:null,shortText:"Neue Position",longText:"",quantity:1,unit:"Stk",unitPriceNet:0,originalUnitPrice:0,priceOverridden:!0,discount:0,totalNet:0};j(t=>(0,Le.A)((0,Le.A)({},t),{},{items:[...t.items,e]}))},_=(e,t)=>{j(n=>(0,Le.A)((0,Le.A)({},n),{},{items:n.items.map(n=>{if(n.id===e){const e=(0,Le.A)((0,Le.A)({},n),t);return e.totalNet=(e.quantity||1)*(e.unitPriceNet||0)*(1-(e.discount||0)/100),void 0!==t.unitPriceNet&&t.unitPriceNet!==n.originalUnitPrice&&(e.priceOverridden=!0),e}return n})}))},T=e=>{const t={};switch(e){case 0:w.customerID||(t.customerID="Bitte Kunde ausw\xe4hlen");break;case 1:case 2:0===w.items.length&&(t.items="Mindestens eine Position erforderlich")}return k(t),0===Object.keys(t).length},D=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ia.DRAFT;if(T(x)){b(!0);try{const s=(0,Le.A)((0,Le.A)({},w),{},{status:e});let l;l=r?await i(n,s,"Angebot aktualisiert"):await a(s),l.success?(g(r?"Angebot aktualisiert":"Angebot ".concat(l.offerNumber," erstellt"),"success"),t("/offers")):g("Fehler beim Speichern","error")}catch(s){g("Fehler beim Speichern","error")}finally{b(!1)}}},P=e=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(e||0),M=()=>{var e;return(0,gs.jsxs)("div",{className:"space-y-6",children:[(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)(va,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,gs.jsx)("input",{type:"text",value:S,onChange:e=>C(e.target.value),placeholder:"Leistungen suchen...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),N.items&&(0,gs.jsxs)("div",{className:"flex items-center space-x-2 text-red-500 text-sm",children:[(0,gs.jsx)(Ds,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:N.items})]}),w.items.length>0&&(0,gs.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,gs.jsxs)("span",{className:"font-medium text-blue-900",children:[w.items.length," Position(en) hinzugef\xfcgt"]}),(0,gs.jsx)("span",{className:"text-blue-700 font-bold",children:P(null===(e=w.totals)||void 0===e?void 0:e.netTotal)})]}),(0,gs.jsxs)("div",{className:"text-sm text-blue-700",children:[w.items.map(e=>e.shortText).join(", ").substring(0,100),w.items.map(e=>e.shortText).join(", ").length>100&&"..."]})]}),(0,gs.jsx)("div",{className:"space-y-4",children:ea.map(e=>{const t=A[e.id]||[];return 0===t.length?null:(0,gs.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,gs.jsx)("div",{className:"bg-gray-50 px-4 py-2 font-medium text-gray-700",children:e.label}),(0,gs.jsx)("div",{className:"divide-y divide-gray-100",children:t.map(e=>{var t;return(0,gs.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between hover:bg-gray-50",children:[(0,gs.jsxs)("div",{className:"flex-1 min-w-0 mr-4",children:[(0,gs.jsx)("p",{className:"font-medium text-gray-900 truncate",children:e.name}),(0,gs.jsx)("p",{className:"text-sm text-gray-500 truncate",children:e.shortText})]}),(0,gs.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,gs.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:[P(null===(t=e.calculatedPrices)||void 0===t?void 0:t.unitPriceNet)," / ",e.unit]}),(0,gs.jsx)("button",{onClick:()=>(e=>{var t,n,r,s,a;const i={id:"item-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),position:w.items.length+1,type:"service",serviceID:e.id,shortText:e.shortText,longText:e.longText,quantity:1,unit:e.unit,unitPriceNet:(null===(t=e.calculatedPrices)||void 0===t?void 0:t.unitPriceNet)||0,originalUnitPrice:(null===(n=e.calculatedPrices)||void 0===n?void 0:n.unitPriceNet)||0,priceOverridden:!1,discount:0,totalNet:(null===(r=e.calculatedPrices)||void 0===r?void 0:r.unitPriceNet)||0,breakdown:{materials:e.materials,labor:e.labor,materialCost:(null===(s=e.calculatedPrices)||void 0===s?void 0:s.materialCostVK)||0,laborCost:(null===(a=e.calculatedPrices)||void 0===a?void 0:a.laborCost)||0}};j(e=>(0,Le.A)((0,Le.A)({},e),{},{items:[...e.items,i]})),g("Position hinzugef\xfcgt","success")})(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",children:(0,gs.jsx)(ya,{className:"h-5 w-5"})})]})]},e.id)})})]},e.id)})}),(0,gs.jsxs)("button",{onClick:I,className:"w-full py-3 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-blue-500 hover:text-blue-600 flex items-center justify-center",children:[(0,gs.jsx)(ya,{className:"h-5 w-5 mr-2"}),"Manuelle Position hinzuf\xfcgen"]})]})},R=()=>{var e,t,n,r,s,a,i;return(0,gs.jsx)("div",{className:"space-y-6",children:0===w.items.length?(0,gs.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,gs.jsx)(ba,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,gs.jsx)("p",{children:"Noch keine Positionen hinzugef\xfcgt"}),(0,gs.jsx)("button",{onClick:()=>y(1),className:"mt-4 text-blue-600 hover:text-blue-700",children:"Leistungen hinzuf\xfcgen"})]}):(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,gs.jsxs)("table",{className:"w-full",children:[(0,gs.jsx)("thead",{className:"bg-gray-50",children:(0,gs.jsxs)("tr",{children:[(0,gs.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase w-8",children:"Pos"}),(0,gs.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Beschreibung"}),(0,gs.jsx)("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase w-20",children:"Menge"}),(0,gs.jsx)("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase w-16",children:"Einheit"}),(0,gs.jsx)("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase w-28",children:"EP (netto)"}),(0,gs.jsx)("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase w-16",children:"Rabatt"}),(0,gs.jsx)("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase w-28",children:"Gesamt"}),(0,gs.jsx)("th",{className:"px-3 py-2 w-10"})]})}),(0,gs.jsx)("tbody",{className:"divide-y divide-gray-100",children:w.items.map((e,t)=>(0,gs.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,gs.jsx)("td",{className:"px-3 py-2 text-gray-500",children:e.position}),(0,gs.jsxs)("td",{className:"px-3 py-2",children:[(0,gs.jsx)("input",{type:"text",value:e.shortText,onChange:t=>_(e.id,{shortText:t.target.value}),className:"w-full border-0 bg-transparent focus:ring-0 p-0"}),e.priceOverridden&&(0,gs.jsx)("span",{className:"text-xs text-amber-600",children:"Preis angepasst"})]}),(0,gs.jsx)("td",{className:"px-3 py-2",children:(0,gs.jsx)("input",{type:"number",min:"0",step:"0.1",value:e.quantity,onChange:t=>_(e.id,{quantity:parseFloat(t.target.value)||0}),className:"w-full text-right border border-gray-200 rounded px-2 py-1"})}),(0,gs.jsx)("td",{className:"px-3 py-2 text-center text-gray-600",children:e.unit}),(0,gs.jsx)("td",{className:"px-3 py-2",children:(0,gs.jsx)("input",{type:"number",min:"0",step:"0.01",value:e.unitPriceNet,onChange:t=>_(e.id,{unitPriceNet:parseFloat(t.target.value)||0}),className:"w-full text-right border border-gray-200 rounded px-2 py-1"})}),(0,gs.jsx)("td",{className:"px-3 py-2",children:(0,gs.jsxs)("div",{className:"flex items-center",children:[(0,gs.jsx)("input",{type:"number",min:"0",max:"100",value:e.discount,onChange:t=>_(e.id,{discount:parseFloat(t.target.value)||0}),className:"w-full text-right border border-gray-200 rounded px-2 py-1"}),(0,gs.jsx)("span",{className:"ml-1 text-gray-500",children:"%"})]})}),(0,gs.jsx)("td",{className:"px-3 py-2 text-right font-medium",children:P(e.totalNet)}),(0,gs.jsx)("td",{className:"px-3 py-2",children:(0,gs.jsx)("button",{onClick:()=>{return t=e.id,void j(e=>(0,Le.A)((0,Le.A)({},e),{},{items:e.items.filter(e=>e.id!==t).map((e,t)=>(0,Le.A)((0,Le.A)({},e),{},{position:t+1}))}));var t},className:"p-1 text-gray-400 hover:text-red-500",children:(0,gs.jsx)(Ea,{className:"h-4 w-4"})})})]},e.id))})]})}),(0,gs.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[(0,gs.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,gs.jsx)("span",{className:"text-gray-600",children:"Zwischensumme (netto):"}),(0,gs.jsx)("span",{children:P(null===(e=w.totals)||void 0===e?void 0:e.subtotalNet)})]}),(0,gs.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,gs.jsx)("span",{className:"text-gray-600",children:"Gesamtrabatt:"}),(0,gs.jsxs)("div",{className:"flex items-center",children:[(0,gs.jsx)("input",{type:"number",min:"0",max:"100",value:(null===(t=w.totals)||void 0===t?void 0:t.discountPercent)||0,onChange:e=>j(t=>(0,Le.A)((0,Le.A)({},t),{},{totals:(0,Le.A)((0,Le.A)({},t.totals),{},{discountPercent:parseFloat(e.target.value)||0})})),className:"w-16 text-right border border-gray-300 rounded px-2 py-1 mr-1"}),(0,gs.jsx)("span",{className:"text-gray-500",children:"%"}),(0,gs.jsxs)("span",{className:"ml-4",children:["- ",P(null===(n=w.totals)||void 0===n?void 0:n.discountAmount)]})]})]}),(0,gs.jsxs)("div",{className:"flex justify-between text-sm border-t pt-2",children:[(0,gs.jsx)("span",{className:"text-gray-600",children:"Netto:"}),(0,gs.jsx)("span",{className:"font-medium",children:P(null===(r=w.totals)||void 0===r?void 0:r.netTotal)})]}),(0,gs.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,gs.jsxs)("span",{className:"text-gray-600",children:["MwSt (",null===(s=w.totals)||void 0===s?void 0:s.taxRate,"%):"]}),(0,gs.jsx)("span",{children:P(null===(a=w.totals)||void 0===a?void 0:a.taxAmount)})]}),(0,gs.jsxs)("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[(0,gs.jsx)("span",{children:"Gesamtbetrag (brutto):"}),(0,gs.jsx)("span",{className:"text-blue-600",children:P(null===(i=w.totals)||void 0===i?void 0:i.grossTotal)})]})]})]})})};return(0,gs.jsxs)("div",{className:"h-dvh flex flex-col bg-gray-50",children:[(0,gs.jsxs)("div",{className:"flex-shrink-0 bg-white shadow-sm",children:[(0,gs.jsx)("div",{className:"px-6 py-4",children:(0,gs.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:r?"Angebot bearbeiten":"Neues Angebot erstellen"})}),(0,gs.jsx)("div",{className:"px-6 pb-4",children:(0,gs.jsx)("div",{className:"flex items-center justify-between",children:ao.map((e,t)=>{const n=e.icon,r=t===x,a=t<x;return(0,gs.jsxs)(s.Fragment,{children:[(0,gs.jsxs)("div",{className:"flex items-center cursor-pointer ".concat(r?"text-blue-600":a?"text-green-600":"text-gray-400"),onClick:()=>t<x&&y(t),children:[(0,gs.jsx)("div",{className:"\n                      flex items-center justify-center w-10 h-10 rounded-full border-2\n                      ".concat(r?"border-blue-600 bg-blue-50":a?"border-green-600 bg-green-50":"border-gray-300","\n                    "),children:a?(0,gs.jsx)(Ts,{className:"h-5 w-5 text-green-600"}):(0,gs.jsx)(n,{className:"h-5 w-5"})}),(0,gs.jsx)("span",{className:"ml-2 text-sm font-medium hidden md:block",children:e.title})]}),t<ao.length-1&&(0,gs.jsx)("div",{className:"flex-1 h-0.5 mx-4 ".concat(t<x?"bg-green-600":"bg-gray-200")})]},e.id)})})})]}),(0,gs.jsx)("div",{className:"flex-1 overflow-y-auto px-6 py-6",children:(0,gs.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,gs.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(()=>{switch(x){case 0:return(0,gs.jsxs)("div",{className:"space-y-6",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Kunde ",(0,gs.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,gs.jsxs)("select",{value:w.customerID,onChange:e=>{j(t=>(0,Le.A)((0,Le.A)({},t),{},{customerID:e.target.value,projectID:""})),k(e=>(0,Le.A)((0,Le.A)({},e),{},{customerID:null}))},className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 ".concat(N.customerID?"border-red-300":"border-gray-300"),children:[(0,gs.jsx)("option",{value:"",children:"Kunde ausw\xe4hlen..."}),m.map(e=>(0,gs.jsx)("option",{value:e.id,children:e.firmennameKundenname||e.name},e.id))]}),N.customerID&&(0,gs.jsx)("p",{className:"text-red-500 text-xs mt-1",children:N.customerID})]}),w.customerID&&(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Projekt (optional)"}),(0,gs.jsxs)("select",{value:w.projectID,onChange:e=>j(t=>(0,Le.A)((0,Le.A)({},t),{},{projectID:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500",children:[(0,gs.jsx)("option",{value:"",children:"Kein Projekt ausgew\xe4hlt"}),E.map(e=>(0,gs.jsx)("option",{value:e.id,children:e.projektname||e.name},e.id))]})]}),w.customerID&&(0,gs.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,gs.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Ausgew\xe4hlter Kunde"}),(()=>{const e=m.find(e=>e.id===w.customerID);return e?(0,gs.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,gs.jsx)("p",{className:"font-medium",children:e.firmennameKundenname||e.name}),e.strasse&&(0,gs.jsx)("p",{children:e.strasse}),e.plz&&e.ort&&(0,gs.jsxs)("p",{children:[e.plz," ",e.ort]}),e.email&&(0,gs.jsx)("p",{children:e.email})]}):null})()]})]});case 1:return M();case 2:return R();case 3:return(()=>{var e,t,n,r;return(0,gs.jsxs)("div",{className:"space-y-6",children:[(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"G\xfcltig bis"}),(0,gs.jsx)("input",{type:"date",value:(null===(e=w.conditions)||void 0===e?void 0:e.validUntil)||"",onChange:e=>j(t=>(0,Le.A)((0,Le.A)({},t),{},{conditions:(0,Le.A)((0,Le.A)({},t.conditions),{},{validUntil:e.target.value})})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Zahlungsbedingungen"}),(0,gs.jsx)("input",{type:"text",value:(null===(t=w.conditions)||void 0===t?void 0:t.paymentTerms)||"",onChange:e=>j(t=>(0,Le.A)((0,Le.A)({},t),{},{conditions:(0,Le.A)((0,Le.A)({},t.conditions),{},{paymentTerms:e.target.value})})),placeholder:"z.B. 14 Tage netto",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"})]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lieferbedingungen"}),(0,gs.jsx)("input",{type:"text",value:(null===(n=w.conditions)||void 0===n?void 0:n.deliveryTerms)||"",onChange:e=>j(t=>(0,Le.A)((0,Le.A)({},t),{},{conditions:(0,Le.A)((0,Le.A)({},t.conditions),{},{deliveryTerms:e.target.value})})),placeholder:"z.B. Nach Vereinbarung",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Anmerkungen / Notizen"}),(0,gs.jsx)("textarea",{value:(null===(r=w.conditions)||void 0===r?void 0:r.notes)||"",onChange:e=>j(t=>(0,Le.A)((0,Le.A)({},t),{},{conditions:(0,Le.A)((0,Le.A)({},t.conditions),{},{notes:e.target.value})})),rows:5,placeholder:"Zus\xe4tzliche Informationen zum Angebot...",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"})]})]})})();case 4:return(()=>{var e,t,n,r,s,a;const i=m.find(e=>e.id===w.customerID),l=p.find(e=>e.id===w.projectID);return(0,gs.jsxs)("div",{className:"space-y-6",children:[(0,gs.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,gs.jsx)("h3",{className:"font-medium text-gray-900 mb-4",children:"Angebots-Zusammenfassung"}),(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-sm text-gray-500",children:"Kunde"}),(0,gs.jsx)("p",{className:"font-medium",children:(null===i||void 0===i?void 0:i.firmennameKundenname)||(null===i||void 0===i?void 0:i.name)||"-"})]}),l&&(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-sm text-gray-500",children:"Projekt"}),(0,gs.jsx)("p",{className:"font-medium",children:(null===l||void 0===l?void 0:l.projektname)||(null===l||void 0===l?void 0:l.name)})]})]}),(0,gs.jsxs)("div",{className:"border-t pt-4 space-y-2",children:[(0,gs.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,gs.jsx)("span",{className:"text-gray-600",children:"Anzahl Positionen:"}),(0,gs.jsx)("span",{children:w.items.length})]}),(0,gs.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,gs.jsx)("span",{className:"text-gray-600",children:"Netto-Summe:"}),(0,gs.jsx)("span",{children:P(null===(e=w.totals)||void 0===e?void 0:e.netTotal)})]}),(0,gs.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,gs.jsxs)("span",{className:"text-gray-600",children:["MwSt (",null===(t=w.totals)||void 0===t?void 0:t.taxRate,"%):"]}),(0,gs.jsx)("span",{children:P(null===(n=w.totals)||void 0===n?void 0:n.taxAmount)})]}),(0,gs.jsxs)("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[(0,gs.jsx)("span",{children:"Gesamtbetrag:"}),(0,gs.jsx)("span",{className:"text-blue-600",children:P(null===(r=w.totals)||void 0===r?void 0:r.grossTotal)})]})]}),(0,gs.jsxs)("div",{className:"border-t mt-4 pt-4 text-sm text-gray-600",children:[(0,gs.jsxs)("p",{children:["G\xfcltig bis: ",(null===(s=w.conditions)||void 0===s?void 0:s.validUntil)||"-"]}),(0,gs.jsxs)("p",{children:["Zahlungsbedingungen: ",(null===(a=w.conditions)||void 0===a?void 0:a.paymentTerms)||"-"]})]})]}),(0,gs.jsxs)("div",{className:"flex flex-col space-y-3",children:[(0,gs.jsxs)("button",{onClick:()=>D(ia.DRAFT),disabled:v,className:"w-full py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 flex items-center justify-center",children:[(0,gs.jsx)(Aa,{className:"h-5 w-5 mr-2"}),"Als Entwurf speichern"]}),(0,gs.jsxs)("button",{onClick:()=>D(ia.SENT),disabled:v,className:"w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center justify-center",children:[(0,gs.jsx)(to,{className:"h-5 w-5 mr-2"}),"Angebot speichern"]})]})]})})();default:return null}})()})})}),(0,gs.jsx)("div",{className:"flex-shrink-0 bg-white border-t px-6 py-4",children:(0,gs.jsxs)("div",{className:"max-w-4xl mx-auto flex justify-between",children:[(0,gs.jsxs)("button",{onClick:0===x?()=>t("/offers"):()=>{y(e=>Math.max(e-1,0))},className:"px-4 py-2 text-gray-600 hover:text-gray-900 flex items-center",children:[(0,gs.jsx)(hi,{className:"h-5 w-5 mr-1"}),0===x?"Abbrechen":"Zur\xfcck"]}),x<ao.length-1&&(0,gs.jsxs)("button",{onClick:()=>{T(x)&&y(e=>Math.min(e+1,ao.length-1))},className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center",children:["Weiter",(0,gs.jsx)(mi,{className:"h-5 w-5 ml-1"})]})]})})]})},lo=_s("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]),oo=_s("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]),co=_s("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]),uo=_s("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),ho=e=>{let{title:t,subtitle:n,headerActions:r,footerActions:s,children:a,maxHeight:i="max-h-[calc(100vh-200px)]"}=e;return(0,gs.jsxs)("div",{className:"space-y-6",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:t}),n&&(0,gs.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:n})]}),r&&(0,gs.jsx)("div",{className:"flex items-center space-x-3",children:r})]}),(0,gs.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,gs.jsx)("div",{className:"p-6 overflow-y-auto ".concat(i),children:a}),s&&(0,gs.jsx)("div",{className:"border-t border-gray-200 px-6 py-4",children:(0,gs.jsx)("div",{className:"flex items-center justify-end space-x-3",children:s})})]})]})},mo=_s("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]),po=_s("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]),fo=()=>{var e,t,n,r,a,i,l,o,c,u,d,h,m,p,f;const{settings:g,loading:x,saving:y,saveSettings:v,DEFAULT_SETTINGS:b}=Qs(),{showNotification:w}=Os(),[j,N]=(0,s.useState)(g),[k,S]=(0,s.useState)(!1);(0,s.useEffect)(()=>{N(g)},[g]),(0,s.useEffect)(()=>{const e=JSON.stringify(j)!==JSON.stringify(g);S(e)},[j,g]);const C=(e,t,n)=>{N(r=>(0,Le.A)((0,Le.A)({},r),{},{[e]:(0,Le.A)((0,Le.A)({},r[e]),{},{[t]:"object"===typeof r[e][t]&&"rate"!==t?(0,Le.A)((0,Le.A)({},r[e][t]),n):n})}))};return x?(0,gs.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,gs.jsx)(nl,{className:"h-8 w-8 animate-spin text-gray-400"})}):(0,gs.jsxs)("div",{className:"space-y-6",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Kalkulation & Angebote"}),(0,gs.jsx)("p",{className:"text-sm text-gray-500",children:"Stundens\xe4tze, Zuschl\xe4ge und Angebotseinstellungen"})]}),(0,gs.jsxs)("div",{className:"flex items-center space-x-3",children:[k&&(0,gs.jsxs)("span",{className:"flex items-center text-sm text-amber-600",children:[(0,gs.jsx)(Ds,{className:"h-4 w-4 mr-1"}),"Ungespeicherte \xc4nderungen"]}),(0,gs.jsxs)("button",{onClick:()=>{N(b)},className:"px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg",children:[(0,gs.jsx)(nl,{className:"h-4 w-4 inline mr-1"}),"Zur\xfccksetzen"]}),(0,gs.jsxs)("button",{onClick:async()=>{(await v(j)).success?w("Kalkulationseinstellungen gespeichert","success"):w("Fehler beim Speichern","error")},disabled:y||!k,className:"px-4 py-2 rounded-lg flex items-center text-sm font-medium ".concat(k?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-200 text-gray-500 cursor-not-allowed"),children:[y?(0,gs.jsx)(nl,{className:"h-4 w-4 mr-2 animate-spin"}):(0,gs.jsx)(Aa,{className:"h-4 w-4 mr-2"}),"Speichern"]})]})]}),(0,gs.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,gs.jsx)(Ha,{className:"h-5 w-5 text-blue-600"}),(0,gs.jsx)("h3",{className:"text-base font-medium text-gray-900",children:"Stundens\xe4tze (netto)"})]}),(0,gs.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"Diese Stundens\xe4tze werden f\xfcr die Kalkulation von Arbeitszeiten in Leistungspositionen verwendet."}),(0,gs.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:Object.entries(j.hourlyRates||{}).map(e=>{let[t,n]=e;return(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:n.label}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)("input",{type:"number",min:"0",step:"0.5",value:n.rate,onChange:e=>((e,t)=>{N(n=>(0,Le.A)((0,Le.A)({},n),{},{hourlyRates:(0,Le.A)((0,Le.A)({},n.hourlyRates),{},{[e]:(0,Le.A)((0,Le.A)({},n.hourlyRates[e]),{},{rate:parseFloat(t)||0})})}))})(t,e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 pr-12 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,gs.jsx)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm",children:"\u20ac/Std"})]})]},t)})})]}),(0,gs.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,gs.jsx)(mo,{className:"h-5 w-5 text-green-600"}),(0,gs.jsx)("h3",{className:"text-base font-medium text-gray-900",children:"Zuschl\xe4ge & Margen"})]}),(0,gs.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"Aufschl\xe4ge f\xfcr Material und Gewinnmargen auf Selbstkosten."}),(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Materialaufschlag",(0,gs.jsx)("span",{className:"ml-1 text-gray-400 cursor-help",title:"Aufschlag auf Einkaufspreise",children:(0,gs.jsx)(Ps,{className:"h-3 w-3 inline"})})]}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)("input",{type:"number",min:"0",max:"100",value:(null===(e=j.margins)||void 0===e?void 0:e.materialMarkup)||0,onChange:e=>C("margins","materialMarkup",parseFloat(e.target.value)||0),className:"w-full border border-gray-300 rounded-lg px-3 py-2 pr-8 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,gs.jsx)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:"%"})]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Gewinnmarge",(0,gs.jsx)("span",{className:"ml-1 text-gray-400 cursor-help",title:"Aufschlag auf Selbstkosten",children:(0,gs.jsx)(Ps,{className:"h-3 w-3 inline"})})]}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)("input",{type:"number",min:"0",max:"100",value:(null===(t=j.margins)||void 0===t?void 0:t.profitMargin)||0,onChange:e=>C("margins","profitMargin",parseFloat(e.target.value)||0),className:"w-full border border-gray-300 rounded-lg px-3 py-2 pr-8 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,gs.jsx)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:"%"})]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Wagnis/Risiko",(0,gs.jsx)("span",{className:"ml-1 text-gray-400 cursor-help",title:"Risikoaufschlag auf Selbstkosten",children:(0,gs.jsx)(Ps,{className:"h-3 w-3 inline"})})]}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)("input",{type:"number",min:"0",max:"100",value:(null===(n=j.margins)||void 0===n?void 0:n.riskMargin)||0,onChange:e=>C("margins","riskMargin",parseFloat(e.target.value)||0),className:"w-full border border-gray-300 rounded-lg px-3 py-2 pr-8 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,gs.jsx)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:"%"})]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Skonto-Puffer",(0,gs.jsx)("span",{className:"ml-1 text-gray-400 cursor-help",title:"Optionaler Puffer f\xfcr Skontogew\xe4hrung",children:(0,gs.jsx)(Ps,{className:"h-3 w-3 inline"})})]}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)("input",{type:"number",min:"0",max:"100",value:(null===(r=j.margins)||void 0===r?void 0:r.discountBuffer)||0,onChange:e=>C("margins","discountBuffer",parseFloat(e.target.value)||0),className:"w-full border border-gray-300 rounded-lg px-3 py-2 pr-8 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,gs.jsx)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:"%"})]})]})]}),(0,gs.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[(0,gs.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Kalkulationsbeispiel"}),(0,gs.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-gray-500",children:"Material EK:"}),(0,gs.jsx)("span",{className:"block font-medium",children:"100,00 \u20ac"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("span",{className:"text-gray-500",children:["+ Aufschlag (",(null===(a=j.margins)||void 0===a?void 0:a.materialMarkup)||0,"%):"]}),(0,gs.jsxs)("span",{className:"block font-medium",children:[(100*((null===(i=j.margins)||void 0===i?void 0:i.materialMarkup)||0)/100).toFixed(2)," \u20ac"]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"text-gray-500",children:"Lohnkosten:"}),(0,gs.jsx)("span",{className:"block font-medium",children:"50,00 \u20ac"})]}),(0,gs.jsxs)("div",{className:"border-l-2 border-blue-500 pl-3",children:[(0,gs.jsx)("span",{className:"text-gray-500",children:"Einheitspreis:"}),(0,gs.jsxs)("span",{className:"block font-bold text-blue-600",children:[((100*(1+((null===(l=j.margins)||void 0===l?void 0:l.materialMarkup)||0)/100)+50)*(1+((null===(o=j.margins)||void 0===o?void 0:o.profitMargin)||0)/100+((null===(c=j.margins)||void 0===c?void 0:c.riskMargin)||0)/100)).toFixed(2)," \u20ac"]})]})]})]})]}),(0,gs.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,gs.jsx)(po,{className:"h-5 w-5 text-purple-600"}),(0,gs.jsx)("h3",{className:"text-base font-medium text-gray-900",children:"Steuereinstellungen"})]}),(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Standard-MwSt-Satz"}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)("input",{type:"number",min:"0",max:"100",value:(null===(u=j.tax)||void 0===u?void 0:u.defaultRate)||19,onChange:e=>C("tax","defaultRate",parseFloat(e.target.value)||19),className:"w-full border border-gray-300 rounded-lg px-3 py-2 pr-8 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,gs.jsx)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:"%"})]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Erm\xe4\xdfigter Satz (optional)"}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)("input",{type:"number",min:"0",max:"100",value:(null===(d=j.tax)||void 0===d?void 0:d.reducedRate)||7,onChange:e=>C("tax","reducedRate",parseFloat(e.target.value)||7),className:"w-full border border-gray-300 rounded-lg px-3 py-2 pr-8 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,gs.jsx)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:"%"})]})]})]})]}),(0,gs.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,gs.jsx)(di,{className:"h-5 w-5 text-orange-600"}),(0,gs.jsx)("h3",{className:"text-base font-medium text-gray-900",children:"Angebotseinstellungen"})]}),(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"G\xfcltigkeit (Tage)"}),(0,gs.jsx)("input",{type:"number",min:"1",max:"365",value:(null===(h=j.offerDefaults)||void 0===h?void 0:h.validityDays)||30,onChange:e=>C("offerDefaults","validityDays",parseInt(e.target.value)||30),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Zahlungsbedingungen"}),(0,gs.jsx)("input",{type:"text",value:(null===(m=j.offerDefaults)||void 0===m?void 0:m.paymentTerms)||"",onChange:e=>C("offerDefaults","paymentTerms",e.target.value),placeholder:"z.B. 14 Tage netto",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lieferbedingungen"}),(0,gs.jsx)("input",{type:"text",value:(null===(p=j.offerDefaults)||void 0===p?void 0:p.deliveryTerms)||"",onChange:e=>C("offerDefaults","deliveryTerms",e.target.value),placeholder:"z.B. Nach Vereinbarung",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nummernformat"}),(0,gs.jsx)("input",{type:"text",value:(null===(f=j.offerDefaults)||void 0===f?void 0:f.numberFormat)||"ANG-{YEAR}-{NUMBER}",onChange:e=>C("offerDefaults","numberFormat",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,gs.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Vorschau: ANG-",(new Date).getFullYear(),"-0001"]})]})]})]})]})},go=_s("Truck",[["path",{d:"M10 17h4V5H2v12h3",key:"1jq12e"}],["path",{d:"M20 17h2v-3.34a4 4 0 0 0-1.17-2.83L19 9h-5",key:"1xb3ft"}],["path",{d:"M14 17h1",key:"nufu4t"}],["circle",{cx:"7.5",cy:"17.5",r:"2.5",key:"a7aife"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]),xo=_s("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),yo=_s("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),vo=e=>{var t,n,r,a,i;let{service:l,isOpen:o,onClose:c}=e;const{addService:u,updateService:d}=$s(),{settings:h,calculateServicePosition:m}=Qs(),{materials:p}=Cs(),{showNotification:f}=Os(),g=!!l,[x,y]=(0,s.useState)({name:"",shortText:"",longText:"",category:"pv-montage",unit:"Stk",materials:[],labor:[],isActive:!0,sortOrder:999}),[v,b]=(0,s.useState)(""),[w,j]=(0,s.useState)(!1),[N,k]=(0,s.useState)(!1),[S,C]=(0,s.useState)({});(0,s.useEffect)(()=>{y(l?{name:l.name||"",shortText:l.shortText||"",longText:l.longText||"",category:l.category||"pv-montage",unit:l.unit||"Stk",materials:l.materials||[],labor:l.labor||[],isActive:!1!==l.isActive,sortOrder:l.sortOrder||999}:{name:"",shortText:"",longText:"",category:"pv-montage",unit:"Stk",materials:[],labor:[],isActive:!0,sortOrder:999}),C({})},[l,o]);const E=(0,s.useMemo)(()=>{if(!v.trim())return p.slice(0,20);const e=v.toLowerCase();return p.filter(t=>{var n,r,s;return(null===(n=t.description)||void 0===n?void 0:n.toLowerCase().includes(e))||(null===(r=t.name)||void 0===r?void 0:r.toLowerCase().includes(e))||(null===(s=t.materialID)||void 0===s?void 0:s.toLowerCase().includes(e))}).slice(0,20)},[p,v]),A=(0,s.useMemo)(()=>m(x.materials,x.labor,p),[x.materials,x.labor,p,m]),I=(e,t)=>{y(n=>(0,Le.A)((0,Le.A)({},n),{},{[e]:t})),S[e]&&C(t=>(0,Le.A)((0,Le.A)({},t),{},{[e]:null}))},_=(e,t,n)=>{const r=[...x.labor];r[e][t]="minutes"===t?parseInt(n)||0:n,I("labor",r)},T=e=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(e||0);return(0,gs.jsxs)(_a,{isOpen:o,onClose:c,title:g?"Leistungsposition bearbeiten":"Neue Leistungsposition",size:"xl",children:[(0,gs.jsxs)("div",{className:"p-6 max-h-[80vh] overflow-y-auto",children:[(0,gs.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Name ",(0,gs.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,gs.jsx)("input",{type:"text",value:x.name,onChange:e=>I("name",e.target.value),placeholder:"z.B. PV-Modul montieren (Ziegeldach)",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 ".concat(S.name?"border-red-300":"border-gray-300")}),S.name&&(0,gs.jsx)("p",{className:"text-red-500 text-xs mt-1",children:S.name})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Kurztext ",(0,gs.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,gs.jsx)("input",{type:"text",value:x.shortText,onChange:e=>I("shortText",e.target.value),placeholder:"Erscheint im Angebot",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 ".concat(S.shortText?"border-red-300":"border-gray-300")}),S.shortText&&(0,gs.jsx)("p",{className:"text-red-500 text-xs mt-1",children:S.shortText})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Langtext (optional)"}),(0,gs.jsx)("textarea",{value:x.longText,onChange:e=>I("longText",e.target.value),placeholder:"Detaillierte Beschreibung der Leistung...",rows:3,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"})]}),(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kategorie"}),(0,gs.jsx)("select",{value:x.category,onChange:e=>I("category",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500",children:ea.map(e=>(0,gs.jsx)("option",{value:e.id,children:e.label},e.id))})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Einheit"}),(0,gs.jsx)("select",{value:x.unit,onChange:e=>I("unit",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500",children:ta.map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.label," (",e.id,")"]},e.id))})]})]})]}),(0,gs.jsxs)("div",{className:"border-t pt-6 mb-6",children:[(0,gs.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)(ba,{className:"h-5 w-5 text-blue-600"}),(0,gs.jsx)("h3",{className:"font-medium text-gray-900",children:"Materialst\xfcckliste"})]})}),(0,gs.jsxs)("div",{className:"relative mb-4",children:[(0,gs.jsx)(va,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,gs.jsx)("input",{type:"text",value:v,onChange:e=>{b(e.target.value),j(!0)},onFocus:()=>j(!0),placeholder:"Material suchen und hinzuf\xfcgen...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),w&&E.length>0&&(0,gs.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:E.map(e=>(0,gs.jsxs)("button",{onClick:()=>(e=>{const t=x.materials.findIndex(t=>t.materialID===e.id);if(t>=0){const e=[...x.materials];e[t].quantity+=1,I("materials",e)}else I("materials",[...x.materials,{materialID:e.id,description:e.description||e.name,quantity:1,isVariable:!1}]);b(""),j(!1)})(e),className:"w-full px-4 py-2 text-left hover:bg-gray-50 flex items-center justify-between",children:[(0,gs.jsx)("span",{className:"truncate",children:e.description||e.name}),(0,gs.jsx)("span",{className:"text-sm text-gray-500 ml-2",children:T(e.purchasePrice||e.price)})]},e.id))})]}),0===x.materials.length?(0,gs.jsx)("div",{className:"text-center py-4 text-gray-500 text-sm bg-gray-50 rounded-lg",children:"Noch keine Materialien hinzugef\xfcgt"}):(0,gs.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,gs.jsxs)("table",{className:"w-full text-sm",children:[(0,gs.jsx)("thead",{className:"bg-gray-50",children:(0,gs.jsxs)("tr",{children:[(0,gs.jsx)("th",{className:"px-3 py-2 text-left text-gray-600",children:"Material"}),(0,gs.jsx)("th",{className:"px-3 py-2 text-right text-gray-600 w-24",children:"Menge"}),(0,gs.jsx)("th",{className:"px-3 py-2 text-right text-gray-600 w-28",children:"EK-Preis"}),(0,gs.jsx)("th",{className:"px-3 py-2 text-right text-gray-600 w-28",children:"Gesamt"}),(0,gs.jsx)("th",{className:"px-3 py-2 w-10"})]})}),(0,gs.jsx)("tbody",{className:"divide-y divide-gray-100",children:x.materials.map((e,t)=>{const n=(e=>{const t=p.find(t=>t.id===e);return(null===t||void 0===t?void 0:t.purchasePrice)||(null===t||void 0===t?void 0:t.price)||0})(e.materialID);return(0,gs.jsxs)("tr",{children:[(0,gs.jsx)("td",{className:"px-3 py-2 truncate max-w-xs",children:e.description}),(0,gs.jsx)("td",{className:"px-3 py-2",children:(0,gs.jsx)("input",{type:"number",min:"0",step:"0.1",value:e.quantity,onChange:e=>((e,t)=>{const n=[...x.materials];n[e].quantity=parseFloat(t)||0,I("materials",n)})(t,e.target.value),className:"w-full text-right border border-gray-200 rounded px-2 py-1"})}),(0,gs.jsx)("td",{className:"px-3 py-2 text-right text-gray-600",children:T(n)}),(0,gs.jsx)("td",{className:"px-3 py-2 text-right font-medium",children:T(n*e.quantity)}),(0,gs.jsx)("td",{className:"px-3 py-2",children:(0,gs.jsx)("button",{onClick:()=>(e=>{I("materials",x.materials.filter((t,n)=>n!==e))})(t),className:"p-1 text-gray-400 hover:text-red-500",children:(0,gs.jsx)(Ea,{className:"h-4 w-4"})})})]},t)})}),(0,gs.jsxs)("tfoot",{className:"bg-gray-50",children:[(0,gs.jsxs)("tr",{children:[(0,gs.jsx)("td",{colSpan:"3",className:"px-3 py-2 text-right font-medium",children:"Materialkosten (EK):"}),(0,gs.jsx)("td",{className:"px-3 py-2 text-right font-bold",children:T(A.materialCostEK)}),(0,gs.jsx)("td",{})]}),(0,gs.jsxs)("tr",{children:[(0,gs.jsxs)("td",{colSpan:"3",className:"px-3 py-2 text-right font-medium text-blue-600",children:["+ Aufschlag (",null===(t=h.margins)||void 0===t?void 0:t.materialMarkup,"%):"]}),(0,gs.jsx)("td",{className:"px-3 py-2 text-right font-bold text-blue-600",children:T(A.materialCostVK)}),(0,gs.jsx)("td",{})]})]})]})})]}),(0,gs.jsxs)("div",{className:"border-t pt-6 mb-6",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)(Ha,{className:"h-5 w-5 text-green-600"}),(0,gs.jsx)("h3",{className:"font-medium text-gray-900",children:"Arbeitszeiten"})]}),(0,gs.jsxs)("button",{onClick:()=>{I("labor",[...x.labor,{role:"geselle",description:"Arbeitszeit",minutes:30}])},className:"px-3 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded-lg flex items-center",children:[(0,gs.jsx)(ya,{className:"h-4 w-4 mr-1"}),"Arbeitszeit"]})]}),0===x.labor.length?(0,gs.jsx)("div",{className:"text-center py-4 text-gray-500 text-sm bg-gray-50 rounded-lg",children:"Noch keine Arbeitszeiten hinzugef\xfcgt"}):(0,gs.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,gs.jsxs)("table",{className:"w-full text-sm",children:[(0,gs.jsx)("thead",{className:"bg-gray-50",children:(0,gs.jsxs)("tr",{children:[(0,gs.jsx)("th",{className:"px-3 py-2 text-left text-gray-600",children:"T\xe4tigkeit"}),(0,gs.jsx)("th",{className:"px-3 py-2 text-left text-gray-600 w-32",children:"Qualifikation"}),(0,gs.jsx)("th",{className:"px-3 py-2 text-right text-gray-600 w-24",children:"Minuten"}),(0,gs.jsx)("th",{className:"px-3 py-2 text-right text-gray-600 w-24",children:"\u20ac/Std"}),(0,gs.jsx)("th",{className:"px-3 py-2 text-right text-gray-600 w-28",children:"Kosten"}),(0,gs.jsx)("th",{className:"px-3 py-2 w-10"})]})}),(0,gs.jsx)("tbody",{className:"divide-y divide-gray-100",children:x.labor.map((e,t)=>{var n,r;const s=(null===(n=h.hourlyRates)||void 0===n||null===(r=n[e.role])||void 0===r?void 0:r.rate)||0,a=e.minutes/60*s;return(0,gs.jsxs)("tr",{children:[(0,gs.jsx)("td",{className:"px-3 py-2",children:(0,gs.jsx)("input",{type:"text",value:e.description,onChange:e=>_(t,"description",e.target.value),className:"w-full border border-gray-200 rounded px-2 py-1"})}),(0,gs.jsx)("td",{className:"px-3 py-2",children:(0,gs.jsx)("select",{value:e.role,onChange:e=>_(t,"role",e.target.value),className:"w-full border border-gray-200 rounded px-2 py-1",children:Object.entries(h.hourlyRates||{}).map(e=>{let[t,n]=e;return(0,gs.jsx)("option",{value:t,children:n.label},t)})})}),(0,gs.jsx)("td",{className:"px-3 py-2",children:(0,gs.jsx)("input",{type:"number",min:"0",value:e.minutes,onChange:e=>_(t,"minutes",e.target.value),className:"w-full text-right border border-gray-200 rounded px-2 py-1"})}),(0,gs.jsx)("td",{className:"px-3 py-2 text-right text-gray-600",children:T(s)}),(0,gs.jsx)("td",{className:"px-3 py-2 text-right font-medium",children:T(a)}),(0,gs.jsx)("td",{className:"px-3 py-2",children:(0,gs.jsx)("button",{onClick:()=>(e=>{I("labor",x.labor.filter((t,n)=>n!==e))})(t),className:"p-1 text-gray-400 hover:text-red-500",children:(0,gs.jsx)(Ea,{className:"h-4 w-4"})})})]},t)})}),(0,gs.jsx)("tfoot",{className:"bg-gray-50",children:(0,gs.jsxs)("tr",{children:[(0,gs.jsx)("td",{colSpan:"4",className:"px-3 py-2 text-right font-medium",children:"Lohnkosten:"}),(0,gs.jsx)("td",{className:"px-3 py-2 text-right font-bold",children:T(A.laborCost)}),(0,gs.jsx)("td",{})]})})]})})]}),(0,gs.jsxs)("div",{className:"border-t pt-6 mb-6",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,gs.jsx)(lo,{className:"h-5 w-5 text-purple-600"}),(0,gs.jsx)("h3",{className:"font-medium text-gray-900",children:"Kalkulation"})]}),(0,gs.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[(0,gs.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,gs.jsx)("span",{className:"text-gray-600",children:"Materialkosten (VK):"}),(0,gs.jsx)("span",{children:T(A.materialCostVK)})]}),(0,gs.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,gs.jsx)("span",{className:"text-gray-600",children:"Lohnkosten:"}),(0,gs.jsx)("span",{children:T(A.laborCost)})]}),(0,gs.jsxs)("div",{className:"flex justify-between text-sm border-t pt-2",children:[(0,gs.jsx)("span",{className:"text-gray-600",children:"Selbstkosten:"}),(0,gs.jsx)("span",{children:T(A.subtotal)})]}),(0,gs.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,gs.jsxs)("span",{className:"text-gray-600",children:["+ Gewinn (",null===(n=h.margins)||void 0===n?void 0:n.profitMargin,"%):"]}),(0,gs.jsx)("span",{children:T(A.subtotal*((null===(r=h.margins)||void 0===r?void 0:r.profitMargin)||0)/100)})]}),(0,gs.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,gs.jsxs)("span",{className:"text-gray-600",children:["+ Wagnis (",null===(a=h.margins)||void 0===a?void 0:a.riskMargin,"%):"]}),(0,gs.jsx)("span",{children:T(A.subtotal*((null===(i=h.margins)||void 0===i?void 0:i.riskMargin)||0)/100)})]}),(0,gs.jsxs)("div",{className:"flex justify-between text-base font-bold border-t pt-2 text-blue-600",children:[(0,gs.jsx)("span",{children:"Einheitspreis (netto):"}),(0,gs.jsxs)("span",{children:[T(A.unitPriceNet)," / ",x.unit]})]})]})]}),(0,gs.jsxs)("div",{className:"flex items-center justify-between border-t pt-6",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("span",{className:"font-medium text-gray-900",children:"Position aktiv"}),(0,gs.jsx)("p",{className:"text-sm text-gray-500",children:"Nur aktive Positionen erscheinen in der Auswahl"})]}),(0,gs.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,gs.jsx)("input",{type:"checkbox",checked:x.isActive,onChange:e=>I("isActive",e.target.checked),className:"sr-only peer"}),(0,gs.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]}),(0,gs.jsxs)("div",{className:"flex justify-end space-x-3 px-6 py-4 border-t bg-gray-50",children:[(0,gs.jsx)("button",{onClick:c,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Abbrechen"}),(0,gs.jsx)("button",{onClick:async()=>{if((()=>{const e={};return x.name.trim()||(e.name="Name ist erforderlich"),x.shortText.trim()||(e.shortText="Kurztext ist erforderlich"),C(e),0===Object.keys(e).length})()){k(!0);try{(g?await d(l.id,x):await u(x)).success?(f(g?"Position aktualisiert":"Position erstellt","success"),c()):f("Fehler beim Speichern","error")}catch(e){f("Fehler beim Speichern","error")}finally{k(!1)}}},disabled:N,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center disabled:opacity-50",children:N?(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Speichern..."]}):(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsx)(Aa,{className:"h-4 w-4 mr-2"}),"Speichern"]})})]})]})},bo={Sun:gl,Zap:ol,Battery:pl,Car:ui,FileText:di,Truck:go,MoreHorizontal:xo},wo=()=>{const{services:e,activeServices:t,loading:n,deleteService:r,duplicateService:a,recalculateAllPrices:i,getServicesByCategory:l}=$s(),{showNotification:o}=Os(),[c,u]=(0,s.useState)(""),[d,h]=(0,s.useState)(ea.reduce((e,t)=>(0,Le.A)((0,Le.A)({},e),{},{[t.id]:!0}),{})),[m,p]=(0,s.useState)(null),[f,g]=(0,s.useState)(!1),[x,y]=(0,s.useState)(!1),[v,b]=(0,s.useState)(null),[w,j]=(0,s.useState)(!1),N=(0,s.useMemo)(()=>{if(!c.trim())return e;const t=c.toLowerCase();return e.filter(e=>{var n,r,s;return(null===(n=e.name)||void 0===n?void 0:n.toLowerCase().includes(t))||(null===(r=e.shortText)||void 0===r?void 0:r.toLowerCase().includes(t))||(null===(s=e.category)||void 0===s?void 0:s.toLowerCase().includes(t))})},[e,c]),k=(0,s.useMemo)(()=>{const e={};return ea.forEach(t=>{e[t.id]=N.filter(e=>e.category===t.id)}),e},[N]),S=e=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(e||0),C=e=>{const t=bo[e];return t?(0,gs.jsx)(t,{className:"h-4 w-4"}):(0,gs.jsx)(ba,{className:"h-4 w-4"})};return n&&0===e.length?(0,gs.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,gs.jsx)(nl,{className:"h-8 w-8 animate-spin text-gray-400"})}):(0,gs.jsxs)("div",{className:"space-y-6",children:[(0,gs.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Leistungskatalog"}),(0,gs.jsxs)("p",{className:"text-sm text-gray-500",children:[t.length," aktive Leistungspositionen"]})]}),(0,gs.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,gs.jsxs)("button",{onClick:async()=>{j(!0);(await i()).success?o("Alle Preise wurden neu berechnet","success"):o("Fehler bei der Neuberechnung","error"),j(!1)},disabled:w,className:"px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg flex items-center",children:[(0,gs.jsx)(nl,{className:"h-4 w-4 mr-2 ".concat(w?"animate-spin":"")}),"Preise neu berechnen"]}),(0,gs.jsxs)("button",{onClick:()=>{p(null),g(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center text-sm font-medium",children:[(0,gs.jsx)(ya,{className:"h-4 w-4 mr-2"}),"Neue Position"]})]})]}),(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)(va,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,gs.jsx)("input",{type:"text",value:c,onChange:e=>u(e.target.value),placeholder:"Positionen suchen...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,gs.jsx)("div",{className:"space-y-4",children:ea.map(e=>{const t=k[e.id]||[],n=d[e.id];return(0,gs.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,gs.jsxs)("button",{onClick:()=>{return t=e.id,void h(e=>(0,Le.A)((0,Le.A)({},e),{},{[t]:!e[t]}));var t},className:"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,gs.jsx)("span",{className:"text-gray-600",children:C(e.icon)}),(0,gs.jsx)("span",{className:"font-medium text-gray-900",children:e.label}),(0,gs.jsxs)("span",{className:"text-sm text-gray-500",children:["(",t.length,")"]})]}),n?(0,gs.jsx)(yo,{className:"h-5 w-5 text-gray-400"}):(0,gs.jsx)(mi,{className:"h-5 w-5 text-gray-400"})]}),n&&(0,gs.jsx)("div",{className:"divide-y divide-gray-100",children:0===t.length?(0,gs.jsx)("div",{className:"px-4 py-6 text-center text-gray-500 text-sm",children:"Keine Positionen in dieser Kategorie"}):t.map(e=>{var t,n,r;return(0,gs.jsx)("div",{className:"px-4 py-4 hover:bg-gray-50 transition-colors",children:(0,gs.jsxs)("div",{className:"flex items-start justify-between",children:[(0,gs.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)("h4",{className:"font-medium text-gray-900 truncate",children:e.name}),!e.isActive&&(0,gs.jsx)("span",{className:"px-2 py-0.5 text-xs bg-gray-200 text-gray-600 rounded",children:"Inaktiv"})]}),(0,gs.jsx)("p",{className:"text-sm text-gray-500 mt-1 truncate",children:e.shortText}),(0,gs.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-sm",children:[(0,gs.jsxs)("span",{className:"flex items-center text-gray-500",children:[(0,gs.jsx)(ba,{className:"h-3.5 w-3.5 mr-1"}),S(null===(t=e.calculatedPrices)||void 0===t?void 0:t.materialCostVK)]}),(0,gs.jsxs)("span",{className:"flex items-center text-gray-500",children:[(0,gs.jsx)(Ha,{className:"h-3.5 w-3.5 mr-1"}),S(null===(n=e.calculatedPrices)||void 0===n?void 0:n.laborCost)]}),(0,gs.jsx)("span",{className:"text-gray-300",children:"|"}),(0,gs.jsxs)("span",{className:"font-medium text-blue-600",children:[S(null===(r=e.calculatedPrices)||void 0===r?void 0:r.unitPriceNet)," / ",e.unit]})]})]}),(0,gs.jsxs)("div",{className:"flex items-center space-x-1 ml-4",children:[(0,gs.jsx)("button",{onClick:()=>(e=>{p(e),g(!0)})(e),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg",title:"Bearbeiten",children:(0,gs.jsx)(Ca,{className:"h-4 w-4"})}),(0,gs.jsx)("button",{onClick:()=>(async e=>{(await a(e.id)).success?o("Position dupliziert","success"):o("Fehler beim Duplizieren","error")})(e),className:"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded-lg",title:"Duplizieren",children:(0,gs.jsx)(eo,{className:"h-4 w-4"})}),(0,gs.jsx)("button",{onClick:()=>(e=>{b(e),y(!0)})(e),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"L\xf6schen",children:(0,gs.jsx)(Ea,{className:"h-4 w-4"})})]})]})},e.id)})})]},e.id)})}),f&&(0,gs.jsx)(vo,{service:m,isOpen:f,onClose:()=>{g(!1),p(null)}}),(0,gs.jsx)(_a,{isOpen:x,onClose:()=>{y(!1),b(null)},title:"Position l\xf6schen",size:"sm",children:(0,gs.jsxs)("div",{className:"p-6",children:[(0,gs.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,gs.jsx)("div",{className:"flex-shrink-0",children:(0,gs.jsx)(Ds,{className:"h-6 w-6 text-red-500"})}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("p",{className:"text-gray-900",children:["M\xf6chten Sie die Position ",(0,gs.jsxs)("strong",{children:['"',null===v||void 0===v?void 0:v.name,'"']})," wirklich l\xf6schen?"]}),(0,gs.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Diese Aktion kann nicht r\xfcckg\xe4ngig gemacht werden."})]})]}),(0,gs.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,gs.jsx)("button",{onClick:()=>{y(!1),b(null)},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Abbrechen"}),(0,gs.jsx)("button",{onClick:async()=>{if(!v)return;(await r(v.id)).success?o("Position gel\xf6scht","success"):o("Fehler beim L\xf6schen","error"),y(!1),b(null)},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"L\xf6schen"})]})]})})]})},jo=()=>{const{showNotification:e}=Os(),{materials:t}=Cs(),{user:n}=ys(),{isAdmin:r}=(()=>{const e=(0,s.useContext)(js);if(!e)throw new Error("useRole must be used within a RoleProvider");return e})(),[a,i]=(0,s.useState)("users"),[l,o]=(0,s.useState)("komponenten"),[c,u]=(0,s.useState)({}),[d,h]=(0,s.useState)([]),[m,p]=(0,s.useState)(!1),[f,g]=(0,s.useState)(!1),[x,y]=(0,s.useState)(null),[v,b]=(0,s.useState)("monteur"),[w,j]=(0,s.useState)(!1),[N,k]=(0,s.useState)({defaultModule:"Kein Standard",defaultRoofType:"Kein Standard",defaultPvMountingSystem:"Kein Standard",defaultBefestigungPVMountingSystem:"Kein Standard",defaultModulEndklemmen:"Kein Standard",defaultModulMittelklemmen:"Kein Standard",defaultPvSteckerMale:"Kein Standard",defaultPvSteckerFemale:"Kein Standard",defaultProfile:"Kein Standard",defaultVerbinder:"Kein Standard",defaultEndkappen:"Kein Standard",defaultInverter:"Kein Standard",defaultOptimizer:"Kein Standard",defaultBattery:"Kein Standard",defaultWallbox:"Kein Standard",defaultEnergyManagement:"Kein Standard",defaultSmartDongle:"Kein Standard",defaultBackupBox:"Kein Standard",defaultKabelschuh6M8:"Kein Standard",defaultKabelschuh10M6:"Kein Standard",defaultKabelschuh16M6:"Kein Standard",defaultAderendhuelsen10mm2:"Kein Standard",defaultAderendhuelsen16mm2:"Kein Standard",defaultDuebelGeruestanker:"Kein Standard",defaultAufkleberPV:"Kein Standard",defaultAufkleberPVMitSpeicher:"Kein Standard",defaultAufkleberPVMitNotstrom:"Kein Standard",defaultErdungHES:"Kein Standard",defaultErdungStaberder:"Kein Standard"}),S=(0,s.useRef)(null),C=(0,s.useRef)(!1),[E,A]=(0,s.useState)(!1),[I,_]=(0,s.useState)([]),[T,D]=(0,s.useState)({}),[P,M]=(0,s.useState)(!1),[R,O]=(0,s.useState)(null),[L,F]=(0,s.useState)(""),[V,z]=(0,s.useState)([]),[U,K]=(0,s.useState)(!1),[B,q]=(0,s.useState)(""),[H,G]=(0,s.useState)(!1),W=(e,t)=>{k(n=>(0,Le.A)((0,Le.A)({},n),{},{[e]:t}))};(0,s.useEffect)(()=>{(async()=>{try{const e=await ks.FirebaseService.getDocuments("pv-defaults");e&&e.length>0&&k(e[0]),setTimeout(()=>{C.current=!0},500)}catch(e){console.error("Fehler beim Laden der PV-Standardeinstellungen:",e)}})(),Q()},[]),(0,s.useEffect)(()=>{if(C.current)return S.current&&clearTimeout(S.current),S.current=setTimeout(async()=>{try{A(!0);const e=await ks.FirebaseService.getDocuments("pv-defaults");e&&e.length>0?await ks.FirebaseService.updateDocument("pv-defaults",e[0].id,N):await ks.FirebaseService.addDocument("pv-defaults",N)}catch(e){console.error("Fehler beim Auto-Speichern der PV-Standardeinstellungen:",e)}finally{A(!1)}},2e3),()=>{S.current&&clearTimeout(S.current)}},[N]);const Q=async()=>{try{p(!0);const e=await ks.FirebaseService.getDocuments("users");h(e||[])}catch(t){console.error("Fehler beim Laden der Benutzer:",t),e("Fehler beim Laden der Benutzer","error")}finally{p(!1)}},J=e=>({admin:"Administrator",monteur:"Monteur",projektleiter:"Projektleiter"}[e]||e),Z=(0,s.useCallback)(async()=>{try{K(!0);const e=await ks.FirebaseService.getDocuments("categories"),t=await ks.FirebaseService.getDocuments("specifications");_(e||[]);const n={};t.forEach(e=>{n[e.categoryId]||(n[e.categoryId]=[]),n[e.categoryId].push(e)}),D(n)}catch(t){console.error("Fehler beim Laden der Kategorien:",t),e("Fehler beim Laden der Kategorien","error")}finally{K(!1)}},[e]);(0,s.useEffect)(()=>{Z()},[Z]);const X=(e,t,n)=>{const r=[...V];r[e]=(0,Le.A)((0,Le.A)({},r[e]),{},{[t]:n}),z(r)},Y=[{id:"users",name:"Benutzerverwaltung",icon:Qa},{id:"pv-configurator",name:"PV Konfigurator",icon:ol},{id:"kalkulation",name:"Kalkulation",icon:lo},{id:"leistungskatalog",name:"Leistungskatalog",icon:oo},{id:"categories",name:"Kategorien & Spezifikationen",icon:ba}];return(0,gs.jsxs)("div",{className:"space-y-6",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Einstellungen"}),(0,gs.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:"Verwalten Sie Ihre Anwendungseinstellungen und Pr\xe4ferenzen"})]}),"pv-configurator"===a&&(0,gs.jsx)("div",{className:"flex items-center space-x-2 text-sm text-gray-500 bg-gray-50 px-3 py-2 rounded-lg",children:E?(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsx)(co,{className:"h-4 w-4 animate-spin text-primary-600"}),(0,gs.jsx)("span",{children:"Speichert..."})]}):(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsx)(Ts,{className:"h-4 w-4 text-green-500"}),(0,gs.jsx)("span",{children:"Autosave aktiv"})]})})]}),(0,gs.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,gs.jsx)("div",{className:"border-b border-gray-200",children:(0,gs.jsx)("nav",{className:"flex space-x-8 px-6",children:Y.map(e=>{const t=e.icon;return(0,gs.jsxs)("button",{onClick:()=>i(e.id),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ".concat(a===e.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,gs.jsx)(t,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:e.name})]},e.id)})})}),(0,gs.jsxs)("div",{className:"p-6",children:["users"===a&&(0,gs.jsxs)("div",{className:"space-y-6",children:[(0,gs.jsxs)("div",{className:"flex justify-between items-center",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Benutzerverwaltung"}),(0,gs.jsx)("p",{className:"text-sm text-gray-600",children:"Verwalten Sie Benutzer und weisen Sie Rollen zu"})]}),(0,gs.jsxs)("button",{onClick:Q,disabled:m,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:[m?(0,gs.jsx)(co,{className:"animate-spin h-4 w-4 mr-2"}):(0,gs.jsx)(Qa,{className:"h-4 w-4 mr-2"}),"Benutzer neu laden"]})]}),(0,gs.jsx)("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:(0,gs.jsx)("ul",{className:"divide-y divide-gray-200",children:m?(0,gs.jsxs)("li",{className:"px-6 py-4 text-center",children:[(0,gs.jsx)(co,{className:"animate-spin h-6 w-6 mx-auto text-gray-400"}),(0,gs.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Lade Benutzer..."})]}):0===d.length?(0,gs.jsxs)("li",{className:"px-6 py-4 text-center",children:[(0,gs.jsx)(Qa,{className:"h-12 w-12 mx-auto text-gray-400"}),(0,gs.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Keine Benutzer gefunden"})]}):d.map(e=>{return(0,gs.jsx)("li",{className:"px-6 py-4 hover:bg-gray-50",children:(0,gs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gs.jsxs)("div",{className:"flex items-center",children:[(0,gs.jsx)("div",{className:"flex-shrink-0",children:(0,gs.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:(0,gs.jsx)(ca,{className:"h-5 w-5 text-gray-600"})})}),(0,gs.jsxs)("div",{className:"ml-4",children:[(0,gs.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.displayName||e.email}),(0,gs.jsx)("div",{className:"text-sm text-gray-500",children:e.email})]})]}),(0,gs.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,gs.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat((t=e.role,{admin:"bg-red-100 text-red-800",monteur:"bg-blue-100 text-blue-800",projektleiter:"bg-green-100 text-green-800"}[t]||"bg-gray-100 text-gray-800")),children:J(e.role)}),(0,gs.jsxs)("button",{onClick:()=>(e=>{y(e),b(e.role||"monteur"),g(!0)})(e),className:"inline-flex items-center px-3 py-1 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[(0,gs.jsx)(Ca,{className:"h-4 w-4 mr-1"}),"Rolle \xe4ndern"]})]})]})},e.id);var t})})})]}),"pv-configurator"===a&&(0,gs.jsx)("div",{className:"space-y-6",children:(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"PV Konfigurator Standardeinstellungen"}),(0,gs.jsx)("p",{className:"text-sm text-gray-600 mb-6",children:"Definieren Sie Standardwerte f\xfcr den PV Konfigurator. Diese werden beim Start des Konfigurators vorausgew\xe4hlt."}),(0,gs.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,gs.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,gs.jsx)("button",{onClick:()=>o("komponenten"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("komponenten"===l?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Standard Komponenten"}),(0,gs.jsx)("button",{onClick:()=>o("berechnung"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("berechnung"===l?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Berechnung"})]})}),"komponenten"===l&&(0,gs.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,gs.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,gs.jsx)("div",{className:"col-span-2",children:(0,gs.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 border-b-2 border-blue-500 pb-2",children:"PV Komponenten"})}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PV-Modul"}),(0,gs.jsxs)("select",{value:N.defaultModule,onChange:e=>W("defaultModule",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"1uOB8fBkWQYkPS0LOZxk"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dachtyp"}),(0,gs.jsxs)("select",{value:N.defaultRoofType,onChange:e=>W("defaultRoofType",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),(0,gs.jsx)("option",{value:"Ziegel",children:"Ziegeldach"}),(0,gs.jsx)("option",{value:"Trapez",children:"Trapezblechdach"}),(0,gs.jsx)("option",{value:"Flach",children:"Flachdach"})]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PV-Stecker Male"}),(0,gs.jsxs)("select",{value:N.defaultPvSteckerMale,onChange:e=>W("defaultPvSteckerMale",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"bArNeyutPDFXhpPBTsOw"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PV-Stecker Female"}),(0,gs.jsxs)("select",{value:N.defaultPvSteckerFemale,onChange:e=>W("defaultPvSteckerFemale",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"bArNeyutPDFXhpPBTsOw"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Smart Dongle-WLAN-FE"}),(0,gs.jsxs)("select",{value:N.defaultSmartDongle,onChange:e=>W("defaultSmartDongle",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"ZlqQZdDkuckVCHmCoU7T"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsx)("div",{className:"col-span-2",children:(0,gs.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 border-b-2 border-blue-500 pb-2",children:"Ziegeldach"})}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Montagesystem"}),(0,gs.jsxs)("select",{value:N.defaultPvMountingSystem,onChange:e=>W("defaultPvMountingSystem",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"mHvC6RpkDKFFCqoZjZcW"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Modulendklemmen"}),(0,gs.jsxs)("select",{value:N.defaultModulEndklemmen,onChange:e=>W("defaultModulEndklemmen",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"WGfZvGlkrPiTDUC3SqL2"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Modulklemmen"}),(0,gs.jsxs)("select",{value:N.defaultModulMittelklemmen,onChange:e=>W("defaultModulMittelklemmen",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"WGfZvGlkrPiTDUC3SqL2"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Profile"}),(0,gs.jsxs)("select",{value:N.defaultProfile,onChange:e=>W("defaultProfile",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"aAhBqQFaynXXCf42Ws1H"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Standard Potentialausgleich"}),(0,gs.jsxs)("select",{value:N.defaultPotentialausgleich,onChange:e=>W("defaultPotentialausgleich",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"YsKVAMcq3UBWfpEUmuYm"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Potentialausgleich UK-UK"}),(0,gs.jsxs)("select",{value:N.defaultPotentialausgleichUKUK,onChange:e=>W("defaultPotentialausgleichUKUK",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"YsKVAMcq3UBWfpEUmuYm"===e.categoryId||e.description&&e.description.toLowerCase().includes("potentialausgleich")).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsx)("div",{className:"col-span-2",children:(0,gs.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 border-b-2 border-blue-500 pb-2",children:"Befestigungsmaterial"})}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"BefestigungPotentialausgleich UK-UK"}),(0,gs.jsxs)("select",{value:N.defaultBefestigungPotentialausgleichUKUK,onChange:e=>W("defaultBefestigungPotentialausgleichUKUK",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"6Solbg6r30Ms1esXD8Jn"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Befestigung Leistungsoptimierer"}),(0,gs.jsxs)("select",{value:N.defaultBefestigungLeistungsoptimierer,onChange:e=>W("defaultBefestigungLeistungsoptimierer",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"6Solbg6r30Ms1esXD8Jn"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dammstoffd\xfcbel"}),(0,gs.jsxs)("select",{value:N.defaultDammstoffduebel||"",onChange:e=>W("defaultDammstoffduebel",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"dzWCk1eQz8uIFf71U5VR"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabelkanal Schrauben"}),(0,gs.jsxs)("select",{value:N.defaultKabelkanalSchrauben,onChange:e=>W("defaultKabelkanalSchrauben",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"eFnOPVhYKeqBjNhq6Dm0"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Standard Kabelkanal D\xfcbel"}),(0,gs.jsxs)("select",{value:N.defaultKabelkanalDuebel,onChange:e=>W("defaultKabelkanalDuebel",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"dzWCk1eQz8uIFf71U5VR"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Standard PV-Ger\xe4te Schrauben"}),(0,gs.jsxs)("select",{value:N.defaultPvGeraeteSchrauben,onChange:e=>W("defaultPvGeraeteSchrauben",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"NAuknAtWDNE89AM6btz8"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PV-Ger\xe4te D\xfcbel"}),(0,gs.jsxs)("select",{value:N.defaultPvGeraeteDuebel||"",onChange:e=>W("defaultPvGeraeteDuebel",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"dzWCk1eQz8uIFf71U5VR"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Schrauben Rohrschelle"}),(0,gs.jsxs)("select",{value:N.defaultSchraubenRohrschelle||"",onChange:e=>W("defaultSchraubenRohrschelle",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"uILovgnrVbnz0i8D5lBx"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"D\xfcbel Rohrschelle"}),(0,gs.jsxs)("select",{value:N.defaultDuebelRohrschelle||"",onChange:e=>W("defaultDuebelRohrschelle",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"dzWCk1eQz8uIFf71U5VR"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"D\xfcbel Ger\xfcstanker"}),(0,gs.jsxs)("select",{value:N.defaultDuebelGeruestanker,onChange:e=>W("defaultDuebelGeruestanker",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"dzWCk1eQz8uIFf71U5VR"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsx)("div",{className:"col-span-2",children:(0,gs.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 border-b-2 border-blue-500 pb-2",children:"Aufkleber Standardkomponenten"})}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aufkleber PV (Standard)"}),(0,gs.jsxs)("select",{value:N.defaultAufkleberPV,onChange:e=>W("defaultAufkleberPV",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"zy6rEAiGDjyG0Ox3CBN8"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aufkleber PV mit Speicher"}),(0,gs.jsxs)("select",{value:N.defaultAufkleberPVMitSpeicher,onChange:e=>W("defaultAufkleberPVMitSpeicher",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"zy6rEAiGDjyG0Ox3CBN8"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aufkleber PV mit Notstrom"}),(0,gs.jsxs)("select",{value:N.defaultAufkleberPVMitNotstrom,onChange:e=>W("defaultAufkleberPVMitNotstrom",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"zy6rEAiGDjyG0Ox3CBN8"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsx)("div",{className:"col-span-2",children:(0,gs.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 border-b-2 border-blue-500 pb-2",children:"Rohrschelle Komponenten"})}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rohrschelle Standard"}),(0,gs.jsxs)("select",{value:N.defaultRohrschelleStandard||"",onChange:e=>W("defaultRohrschelleStandard",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"Lby5LiXgEG5KJTo6NEia"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rohrschelle Gro\xdf"}),(0,gs.jsxs)("select",{value:N.defaultRohrschelleGross||"",onChange:e=>W("defaultRohrschelleGross",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"Lby5LiXgEG5KJTo6NEia"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rohrschelle Outdoor"}),(0,gs.jsxs)("select",{value:N.defaultRohrschelleOutdoor||"",onChange:e=>W("defaultRohrschelleOutdoor",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"Lby5LiXgEG5KJTo6NEia"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsx)("div",{className:"col-span-2",children:(0,gs.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 border-b-2 border-blue-500 pb-2",children:"Kabelverlegung"})}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabelmanagement"}),(0,gs.jsxs)("select",{value:N.defaultKabelmanagement,onChange:e=>W("defaultKabelmanagement",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"QVChNHri0HPhXpHW0spy"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Installationsrohr"}),(0,gs.jsxs)("select",{value:N.defaultInstallationsrohr||"",onChange:e=>W("defaultInstallationsrohr",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"Lby5LiXgEG5KJTo6NEia"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Flexrohr"}),(0,gs.jsxs)("select",{value:N.defaultFlexrohrStandard||"",onChange:e=>W("defaultFlexrohrStandard",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"Lby5LiXgEG5KJTo6NEia"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Flexrohr Gro\xdf"}),(0,gs.jsxs)("select",{value:N.defaultFlexrohrGross||"",onChange:e=>W("defaultFlexrohrGross",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"Lby5LiXgEG5KJTo6NEia"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"InstallationsrohrOutdoor"}),(0,gs.jsxs)("select",{value:N.defaultInstallationsrohrOutdoor||"",onChange:e=>W("defaultInstallationsrohrOutdoor",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"Lby5LiXgEG5KJTo6NEia"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Muffe Outdoor"}),(0,gs.jsxs)("select",{value:N.defaultMuffeOutdoor||"",onChange:e=>W("defaultMuffeOutdoor",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"Lby5LiXgEG5KJTo6NEia"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabelkanal Standard"}),(0,gs.jsxs)("select",{value:N.defaultKabelkanalStandard,onChange:e=>W("defaultKabelkanalStandard",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"Lby5LiXgEG5KJTo6NEia"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabelkanal Gro\xdf"}),(0,gs.jsxs)("select",{value:N.defaultKabelkanalGross,onChange:e=>W("defaultKabelkanalGross",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"Lby5LiXgEG5KJTo6NEia"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsx)("div",{className:"col-span-2",children:(0,gs.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 border-b-2 border-blue-500 pb-2",children:"Kabel Standardkomponenten"})}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabel 5x1,5mm\xb2"}),(0,gs.jsxs)("select",{value:N.defaultKabel5x15||"",onChange:e=>W("defaultKabel5x15",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Ausw\xe4hlen..."}),t.filter(e=>"BKL1zeVvHbOvtrD8udg9"===e.categoryId||"9wGooeSxShvDIs2bJAwF"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?" ".concat(e.description):""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabel 5x2,5mm\xb2"}),(0,gs.jsxs)("select",{value:N.defaultKabel5x25||"",onChange:e=>W("defaultKabel5x25",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Ausw\xe4hlen..."}),t.filter(e=>"BKL1zeVvHbOvtrD8udg9"===e.categoryId||"9wGooeSxShvDIs2bJAwF"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?" ".concat(e.description):""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabel 5x4mm\xb2"}),(0,gs.jsxs)("select",{value:N.defaultKabel5x4||"",onChange:e=>W("defaultKabel5x4",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Ausw\xe4hlen..."}),t.filter(e=>"BKL1zeVvHbOvtrD8udg9"===e.categoryId||"9wGooeSxShvDIs2bJAwF"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?" ".concat(e.description):""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabel 5x6mm\xb2"}),(0,gs.jsxs)("select",{value:N.defaultKabel5x6||"",onChange:e=>W("defaultKabel5x6",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Ausw\xe4hlen..."}),t.filter(e=>"BKL1zeVvHbOvtrD8udg9"===e.categoryId||"9wGooeSxShvDIs2bJAwF"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?" ".concat(e.description):""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabel 5x10mm\xb2"}),(0,gs.jsxs)("select",{value:N.defaultKabel5x10||"",onChange:e=>W("defaultKabel5x10",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Ausw\xe4hlen..."}),t.filter(e=>"BKL1zeVvHbOvtrD8udg9"===e.categoryId||"9wGooeSxShvDIs2bJAwF"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?" ".concat(e.description):""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabel 5x16mm\xb2"}),(0,gs.jsxs)("select",{value:N.defaultKabel5x16||"",onChange:e=>W("defaultKabel5x16",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Ausw\xe4hlen..."}),t.filter(e=>"BKL1zeVvHbOvtrD8udg9"===e.categoryId||"9wGooeSxShvDIs2bJAwF"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?" ".concat(e.description):""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adernleitung 10mm\xb2 Blau"}),(0,gs.jsxs)("select",{value:N.defaultAdernleitung10mm2Blau||"",onChange:e=>W("defaultAdernleitung10mm2Blau",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"fVXEVA2ecyaSx72cgafl"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adernleitung 10mm\xb2 Schwarz"}),(0,gs.jsxs)("select",{value:N.defaultAdernleitung10mm2Schwarz||"",onChange:e=>W("defaultAdernleitung10mm2Schwarz",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"fVXEVA2ecyaSx72cgafl"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adernleitung 10mm\xb2 Gr\xfcn/Gelb"}),(0,gs.jsxs)("select",{value:N.defaultAdernleitung10mm2GruenGelb||"",onChange:e=>W("defaultAdernleitung10mm2GruenGelb",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"fVXEVA2ecyaSx72cgafl"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adernleitung 16mm\xb2 Blau"}),(0,gs.jsxs)("select",{value:N.defaultAdernleitung16mm2Blau||"",onChange:e=>W("defaultAdernleitung16mm2Blau",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"fVXEVA2ecyaSx72cgafl"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adernleitung 16mm\xb2 Schwarz"}),(0,gs.jsxs)("select",{value:N.defaultAdernleitung16mm2Schwarz||"",onChange:e=>W("defaultAdernleitung16mm2Schwarz",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"fVXEVA2ecyaSx72cgafl"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adernleitung 16mm\xb2 Gr\xfcn/Gelb"}),(0,gs.jsxs)("select",{value:N.defaultAdernleitung16mm2GruenGelb||"",onChange:e=>W("defaultAdernleitung16mm2GruenGelb",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"fVXEVA2ecyaSx72cgafl"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PV-Kabel"}),(0,gs.jsxs)("select",{value:N.defaultPvKabel,onChange:e=>W("defaultPvKabel",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"b2Bf0YkhAA6x0T65W9hZ"===e.categoryId||e.description&&e.description.toLowerCase().includes("pv")&&e.description.toLowerCase().includes("kabel")).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ErdungHES"}),(0,gs.jsxs)("select",{value:N.defaultErdungHES||"",onChange:e=>W("defaultErdungHES",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"BKL1zeVvHbOvtrD8udg9"===e.categoryId||"9wGooeSxShvDIs2bJAwF"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Potentialausgleich HES-UK"}),(0,gs.jsxs)("select",{value:N.defaultPotentialausgleichHESUK||"",onChange:e=>W("defaultPotentialausgleichHESUK",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"9wGooeSxShvDIs2bJAwF"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SchutzleiterPV"}),(0,gs.jsxs)("select",{value:N.defaultSchutzleiterPV||"",onChange:e=>W("defaultSchutzleiterPV",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"BKL1zeVvHbOvtrD8udg9"===e.categoryId||"9wGooeSxShvDIs2bJAwF"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ErdungStaberder"}),(0,gs.jsxs)("select",{value:N.defaultErdungStaberder||"",onChange:e=>W("defaultErdungStaberder",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"9wGooeSxShvDIs2bJAwF"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsx)("div",{className:"col-span-2",children:(0,gs.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 border-b-2 border-blue-500 pb-2",children:"Sicherung Standardkomponenten"})}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sicherung 16A"}),(0,gs.jsxs)("select",{value:N.defaultSicherung16A||"",onChange:e=>W("defaultSicherung16A",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Ausw\xe4hlen..."}),t.filter(e=>"mMfrQeYNHrQJVT4hLAZs"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?" ".concat(e.description):""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sicherung 20A"}),(0,gs.jsxs)("select",{value:N.defaultSicherung20A||"",onChange:e=>W("defaultSicherung20A",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Ausw\xe4hlen..."}),t.filter(e=>"mMfrQeYNHrQJVT4hLAZs"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?" ".concat(e.description):""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sicherung 25A"}),(0,gs.jsxs)("select",{value:N.defaultSicherung25A||"",onChange:e=>W("defaultSicherung25A",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Ausw\xe4hlen..."}),t.filter(e=>"mMfrQeYNHrQJVT4hLAZs"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?" ".concat(e.description):""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sicherung 32A"}),(0,gs.jsxs)("select",{value:N.defaultSicherung32A||"",onChange:e=>W("defaultSicherung32A",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Ausw\xe4hlen..."}),t.filter(e=>"mMfrQeYNHrQJVT4hLAZs"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?" ".concat(e.description):""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sicherung 50A"}),(0,gs.jsxs)("select",{value:N.defaultSicherung50A||"",onChange:e=>W("defaultSicherung50A",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Ausw\xe4hlen..."}),t.filter(e=>"mMfrQeYNHrQJVT4hLAZs"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?" ".concat(e.description):""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sicherung 63A"}),(0,gs.jsxs)("select",{value:N.defaultSicherung63A||"",onChange:e=>W("defaultSicherung63A",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Ausw\xe4hlen..."}),t.filter(e=>"mMfrQeYNHrQJVT4hLAZs"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?" ".concat(e.description):""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"FI Schutzschalter Wallbox"}),(0,gs.jsxs)("select",{value:N.defaultFehlerstromschutzschalterWallbox||"",onChange:e=>W("defaultFehlerstromschutzschalterWallbox",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Ausw\xe4hlen..."}),t.filter(e=>"cpCa7ZqKiQfX37GvQVQn"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?" ".concat(e.description):""]},e.id))]})]}),(0,gs.jsx)("div",{className:"col-span-2",children:(0,gs.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 border-b-2 border-blue-500 pb-2",children:"Elektro"})}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Potentialausgleichsschiene"}),(0,gs.jsxs)("select",{value:N.defaultPotentialausgleichsschiene||"",onChange:e=>W("defaultPotentialausgleichsschiene",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"YUmVpnyibpJVq1Eo3Rf2"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hauptleitungsabzweigklemme"}),(0,gs.jsxs)("select",{value:N.defaultHauptleitungsabzweigklemme||"",onChange:e=>W("defaultHauptleitungsabzweigklemme",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"YUmVpnyibpJVq1Eo3Rf2"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"RJ45-Stecker"}),(0,gs.jsxs)("select",{value:N.defaultRJ45Stecker||"",onChange:e=>W("defaultRJ45Stecker",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"YUmVpnyibpJVq1Eo3Rf2"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sammelschienenklemme"}),(0,gs.jsxs)("select",{value:N.defaultSammelschienenklemme||"",onChange:e=>W("defaultSammelschienenklemme",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"YUmVpnyibpJVq1Eo3Rf2"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Abdeckstreifen"}),(0,gs.jsxs)("select",{value:N.defaultAbdeckstreifen||"",onChange:e=>W("defaultAbdeckstreifen",e.target.value||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"YUmVpnyibpJVq1Eo3Rf2"===e.categoryId).map(e=>(0,gs.jsxs)("option",{value:e.id,children:[e.name," ",e.description?e.description:""]},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabelschuh 6xM8"}),(0,gs.jsxs)("select",{value:N.defaultKabelschuh6M8,onChange:e=>W("defaultKabelschuh6M8",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"YUmVpnyibpJVq1Eo3Rf2"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabelschuh 10xM6"}),(0,gs.jsxs)("select",{value:N.defaultKabelschuh10M6,onChange:e=>W("defaultKabelschuh10M6",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"YUmVpnyibpJVq1Eo3Rf2"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabelschuh 16xM6"}),(0,gs.jsxs)("select",{value:N.defaultKabelschuh16M6,onChange:e=>W("defaultKabelschuh16M6",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"YUmVpnyibpJVq1Eo3Rf2"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aderendh\xfclsen 10mm\xb2"}),(0,gs.jsxs)("select",{value:N.defaultAderendhuelsen10mm2,onChange:e=>W("defaultAderendhuelsen10mm2",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"5psqw2EUItL72TMhfSfQ"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aderendh\xfclsen 16mm\xb2"}),(0,gs.jsxs)("select",{value:N.defaultAderendhuelsen16mm2,onChange:e=>W("defaultAderendhuelsen16mm2",e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"",children:"Kein Standard"}),t.filter(e=>"5psqw2EUItL72TMhfSfQ"===e.categoryId).map(e=>(0,gs.jsx)("option",{value:e.id,children:e.description},e.id))]})]})]})}),"berechnung"===l&&(0,gs.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,gs.jsxs)("div",{className:"space-y-8",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 border-b-2 border-blue-500 pb-2",children:"PV Komponenten"}),(0,gs.jsx)("div",{className:"grid grid-cols-2 gap-4",children:(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Smart Dongle Value"}),(0,gs.jsx)("input",{type:"number",step:"0.1",min:"0",value:N.smartDongleValue||"",onChange:e=>W("smartDongleValue",parseFloat(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 border-b-2 border-blue-500 pb-2",children:"Ziegeldach"}),(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Modul-Haken Verh\xe4ltnis"}),(0,gs.jsx)("input",{type:"number",step:"0.1",min:"0",value:N.modulHakenVerhaeltnis||"",onChange:e=>W("modulHakenVerhaeltnis",parseFloat(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Potentialausgleich UK-UK (m)"}),(0,gs.jsx)("input",{type:"number",step:"0.1",min:"0",value:N.PotentialausgleichUK||"",onChange:e=>W("PotentialausgleichUK",parseFloat(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 border-b-2 border-blue-500 pb-2",children:"Befestigungsmaterial"}),(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"RohrschelleBefestigungsmaterial"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"0",value:N.RohrschelleBefestigungsmaterial||"",onChange:e=>W("RohrschelleBefestigungsmaterial",parseInt(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"BefestigungPotentialausgleich UK-UK"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"0",value:N.BefestigungPotentialausgleichUKUK||"",onChange:e=>W("BefestigungPotentialausgleichUKUK",parseInt(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Befestigung Leistungsoptimierer"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"0",value:N.BefestigungLeistungsoptimierer||"",onChange:e=>W("BefestigungLeistungsoptimierer",parseInt(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabelkanal Befestigungsmaterial (Schrauben/D\xfcbel)"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"0",value:N.KabelkanalBefestigungsmaterial||"",onChange:e=>W("KabelkanalBefestigungsmaterial",parseInt(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PV-Ger\xe4te Befestigungsmaterial"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"0",value:N.PvGeraeteBefestigungsmaterial||"",onChange:e=>W("PvGeraeteBefestigungsmaterial",parseInt(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"D\xe4mmstoffd\xfcbel"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"0",value:N.Dammstoffduebel||"",onChange:e=>W("Dammstoffduebel",parseInt(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"D\xfcbel Ger\xfcstanker"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"0",value:N.DuebelGeruestanker||"",onChange:e=>W("DuebelGeruestanker",parseInt(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aufkleber Brandschutzzeichen (Anzahl)"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"0",value:N.AufkleberBrandschutzzeichen||"",onChange:e=>W("AufkleberBrandschutzzeichen",parseInt(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 border-b-2 border-blue-500 pb-2",children:"Rohrschelle"}),(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rohrschelle Standard"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"0",value:N.RohrschelleStandard||"",onChange:e=>W("RohrschelleStandard",parseInt(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rohrschelle Gro\xdf"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"0",value:N.RohrschelleGross||"",onChange:e=>W("RohrschelleGross",parseInt(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 border-b-2 border-blue-500 pb-2",children:"Kabelverlegung"}),(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"InstallationsrohrOutdoor Wert"}),(0,gs.jsx)("input",{type:"number",step:"0.1",min:"0",value:N.InstallationsrohrOutdoor||"",onChange:e=>W("InstallationsrohrOutdoor",parseFloat(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabelkanal Standard Wert"}),(0,gs.jsx)("input",{type:"number",step:"0.1",min:"0",value:N.KabelkanalStandard||"",onChange:e=>W("KabelkanalStandard",parseFloat(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabelkanal Gro\xdf Wert"}),(0,gs.jsx)("input",{type:"number",step:"0.1",min:"0",value:N.KabelkanalGross||"",onChange:e=>W("KabelkanalGross",parseFloat(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Muffe Outdoor Wert"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"0",value:N.MuffeOutdoor||"",onChange:e=>W("MuffeOutdoor",parseInt(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Flexrohr Wert"}),(0,gs.jsx)("input",{type:"number",step:"0.1",min:"0",value:N.Flexrohr||"",onChange:e=>W("Flexrohr",parseFloat(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Installationsrohr Wert"}),(0,gs.jsx)("input",{type:"number",step:"0.1",min:"0",value:N.Installationsrohr||"",onChange:e=>W("Installationsrohr",parseFloat(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 border-b-2 border-blue-500 pb-2",children:"Kabel"}),(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabell\xe4nge pro Ger\xe4t (m)"}),(0,gs.jsx)("input",{type:"number",min:"1",max:"100",value:N.defaultCableLength||10,onChange:e=>W("defaultCableLength",parseInt(e.target.value)||10),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SchutzleiterPV pro Ger\xe4t (m)"}),(0,gs.jsx)("input",{type:"number",step:"0.1",min:"0",value:N.SchutzleiterPV||"",onChange:e=>W("SchutzleiterPV",parseFloat(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ErdungHES (m)"}),(0,gs.jsx)("input",{type:"number",step:"0.1",min:"0",value:N.ErdungHES||"",onChange:e=>W("ErdungHES",parseFloat(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Potentialausgleich HES-UK (m)"}),(0,gs.jsx)("input",{type:"number",step:"0.1",min:"0",value:N.PotentialausgleichHESUK||"",onChange:e=>W("PotentialausgleichHESUK",parseFloat(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PV-Kabel Wert (m)"}),(0,gs.jsx)("input",{type:"number",step:"0.1",min:"0",value:N.PvKabel||"",onChange:e=>W("PvKabel",parseFloat(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabelmanagement UK Wert"}),(0,gs.jsx)("input",{type:"number",step:"0.1",min:"0",value:N.KabelmanagementUK||"",onChange:e=>W("KabelmanagementUK",parseFloat(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adernleitung16mm\xb2Blau"}),(0,gs.jsx)("input",{type:"number",step:"0.1",min:"0",value:N.Adernleitung16mm2Blau||"",onChange:e=>W("Adernleitung16mm2Blau",parseFloat(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adernleitung16mm\xb2Schwarz"}),(0,gs.jsx)("input",{type:"number",step:"0.1",min:"0",value:N.Adernleitung16mm2Schwarz||"",onChange:e=>W("Adernleitung16mm2Schwarz",parseFloat(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adernleitung16mm\xb2Gr\xfcnGelb"}),(0,gs.jsx)("input",{type:"number",step:"0.1",min:"0",value:N.Adernleitung16mm2GruenGelb||"",onChange:e=>W("Adernleitung16mm2GruenGelb",parseFloat(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adernleitung10mm\xb2Blau"}),(0,gs.jsx)("input",{type:"number",step:"0.1",min:"0",value:N.Adernleitung10mm2Blau||"",onChange:e=>W("Adernleitung10mm2Blau",parseFloat(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adernleitung10mm\xb2Schwarz"}),(0,gs.jsx)("input",{type:"number",step:"0.1",min:"0",value:N.Adernleitung10mm2Schwarz||"",onChange:e=>W("Adernleitung10mm2Schwarz",parseFloat(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adernleitung10mm\xb2Gr\xfcnGelb"}),(0,gs.jsx)("input",{type:"number",step:"0.1",min:"0",value:N.Adernleitung10mm2GruenGelb||"",onChange:e=>W("Adernleitung10mm2GruenGelb",parseFloat(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ErdungStaberder Value"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"1",value:N.defaultErdungStaberderValue||1,onChange:e=>W("defaultErdungStaberderValue",parseInt(e.target.value)||1),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{className:"col-span-2",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 border-b-2 border-blue-500 pb-2",children:"Strombelastbarkeit Werte"}),(0,gs.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Strombelastbarkeit 1,5mm\xb2 (A)"}),(0,gs.jsx)("input",{type:"number",value:N.strombelastbarkeit15||"",onChange:e=>W("strombelastbarkeit15",parseInt(e.target.value)||0),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",min:"1",max:"100"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Strombelastbarkeit 2,5mm\xb2 (A)"}),(0,gs.jsx)("input",{type:"number",value:N.strombelastbarkeit25||"",onChange:e=>W("strombelastbarkeit25",parseInt(e.target.value)||0),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",min:"1",max:"100"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Strombelastbarkeit 4mm\xb2 (A)"}),(0,gs.jsx)("input",{type:"number",value:N.strombelastbarkeit4||"",onChange:e=>W("strombelastbarkeit4",parseInt(e.target.value)||0),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",min:"1",max:"100"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Strombelastbarkeit 6mm\xb2 (A)"}),(0,gs.jsx)("input",{type:"number",value:N.strombelastbarkeit6||"",onChange:e=>W("strombelastbarkeit6",parseInt(e.target.value)||0),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",min:"1",max:"100"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Strombelastbarkeit 10mm\xb2 (A)"}),(0,gs.jsx)("input",{type:"number",value:N.strombelastbarkeit10||"",onChange:e=>W("strombelastbarkeit10",parseInt(e.target.value)||0),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",min:"1",max:"100"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Strombelastbarkeit 16mm\xb2 (A)"}),(0,gs.jsx)("input",{type:"number",value:N.strombelastbarkeit16||"",onChange:e=>W("strombelastbarkeit16",parseInt(e.target.value)||0),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",min:"1",max:"100"})]})]})]}),(0,gs.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 border-b-2 border-blue-500 pb-2",children:"Elektro"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aderendh\xfclsen pro Ger\xe4t"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"0",value:N.AderendhuelsenProGeraet||"",onChange:e=>W("AderendhuelsenProGeraet",parseInt(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabelschuh 6xM8 Anzahl"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"0",value:N.Kabelschuh6M8||"",onChange:e=>W("Kabelschuh6M8",parseInt(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabelschuh 10xM6 pro Ger\xe4t"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"0",value:N.Kabelschuh10M6||"",onChange:e=>W("Kabelschuh10M6",parseInt(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kabelschuh 16xM6 pro Notstroml\xf6sung"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"0",value:N.Kabelschuh16M6||"",onChange:e=>W("Kabelschuh16M6",parseInt(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Potentialausgleichsschiene"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"0",value:N.Potentialausgleichsschiene||"",onChange:e=>W("Potentialausgleichsschiene",parseInt(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hauptleitungsabzweigklemme"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"0",value:N.Hauptleitungsabzweigklemme||"",onChange:e=>W("Hauptleitungsabzweigklemme",parseInt(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"RJ45-Stecker"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"0",value:N.RJ45Stecker||"",onChange:e=>W("RJ45Stecker",parseInt(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sammelschienenklemme"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"0",value:N.Sammelschienenklemme||"",onChange:e=>W("Sammelschienenklemme",parseInt(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Abdeckstreifen"}),(0,gs.jsx)("input",{type:"number",step:"1",min:"0",value:N.Abdeckstreifen||"",onChange:e=>W("Abdeckstreifen",parseInt(e.target.value)||null),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]})]})]})})]})}),"kalkulation"===a&&(0,gs.jsx)(fo,{}),"leistungskatalog"===a&&(0,gs.jsx)(wo,{}),"categories"===a&&(0,gs.jsx)(ho,{title:"Kategorien & Spezifikationen",headerActions:(0,gs.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,gs.jsxs)("div",{className:"relative",children:[(0,gs.jsx)(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,gs.jsx)("input",{type:"text",placeholder:"Kategorien oder Spezifikationen suchen...",value:B,onChange:e=>q(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent w-64"})]}),(0,gs.jsxs)("button",{onClick:()=>G(!H),className:"px-4 py-2 rounded-lg flex items-center transition-colors ".concat(H?"bg-blue-100 text-blue-700 border border-blue-300":"bg-gray-100 text-gray-700 border border-gray-300 hover:bg-gray-200"),children:[(0,gs.jsx)(uo,{className:"h-4 w-4 mr-2"}),H?"IDs ausblenden":"IDs anzeigen"]}),(0,gs.jsxs)("button",{onClick:()=>M(!0),className:"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 flex items-center",children:[(0,gs.jsx)(ya,{className:"h-4 w-4 mr-2"}),"Neue Kategorie"]})]}),maxHeight:"max-h-[60vh]",children:U?(0,gs.jsxs)("div",{className:"text-center py-8",children:[(0,gs.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"}),(0,gs.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Lade Kategorien..."})]}):(0,gs.jsxs)("div",{className:"space-y-4",children:[I.filter(e=>{if(!B)return!0;const t=B.toLowerCase();if(e.name.toLowerCase().includes(t))return!0;return(T[e.id]||[]).some(e=>e.name.toLowerCase().includes(t)||e.unit&&e.unit.toLowerCase().includes(t))}).map(t=>(0,gs.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("h4",{className:"text-md font-medium text-gray-900",children:t.name}),H&&(0,gs.jsxs)("p",{className:"text-xs text-gray-500 font-mono mt-1",children:["ID: ",t.id]})]}),(0,gs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gs.jsx)("button",{onClick:()=>(e=>{O(e),F(e.name);const t=T[e.id]||T[e.name]||[];z(t.map(e=>({name:e.name,unit:e.unit||""}))),M(!0)})(t),className:"text-blue-600 hover:text-blue-800",children:(0,gs.jsx)(Ca,{className:"h-4 w-4"})}),(0,gs.jsx)("button",{onClick:()=>(async t=>{if(window.confirm("Kategorie wirklich l\xf6schen? Alle zugeh\xf6rigen Spezifikationen werden ebenfalls gel\xf6scht."))try{await ks.FirebaseService.deleteDocument("categories",t);const n=T[t]||[];for(const e of n)await ks.FirebaseService.deleteDocument("specifications",e.id);e("Kategorie erfolgreich gel\xf6scht","success"),Z()}catch(n){console.error("Fehler beim L\xf6schen der Kategorie:",n),e("Fehler beim L\xf6schen der Kategorie","error")}})(t.id),className:"text-red-600 hover:text-red-800",children:(0,gs.jsx)(Ea,{className:"h-4 w-4"})})]})]}),(0,gs.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,gs.jsx)("strong",{children:"Spezifikationen:"}),T[t.id]&&T[t.id].length>0?(0,gs.jsx)("ul",{className:"mt-2 space-y-1",children:T[t.id].map((e,t)=>(0,gs.jsx)("li",{className:"flex items-center justify-between bg-gray-50 px-3 py-2 rounded",children:(0,gs.jsxs)("span",{children:[(0,gs.jsx)("strong",{children:e.name}),e.unit&&" (".concat(e.unit,")"),H&&(0,gs.jsxs)("span",{className:"block text-xs text-gray-500 font-mono mt-1",children:["ID: ",e.id]})]})},t))}):(0,gs.jsx)("p",{className:"mt-2 text-gray-500 italic",children:"Keine Spezifikationen definiert"})]})]},t.id)),0===I.length&&(0,gs.jsxs)("div",{className:"text-center py-8",children:[(0,gs.jsx)(ba,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,gs.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Keine Kategorien"}),(0,gs.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Erstellen Sie Ihre erste Kategorie mit spezifischen Feldern."})]})]})})]})]}),(0,gs.jsx)(_a,{isOpen:P,onClose:()=>{M(!1),O(null),F(""),z([])},title:R?"Kategorie bearbeiten":"Neue Kategorie hinzuf\xfcgen",icon:ba,footerButtons:(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsx)("button",{onClick:()=>{M(!1),F(""),z([])},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Abbrechen"}),(0,gs.jsxs)("button",{onClick:R?async()=>{if(!L.trim())return void e("Bitte Kategoriename eingeben","error");if(I.find(e=>e.name.toLowerCase()===L.trim().toLowerCase()&&e.id!==R.id))e("Eine Kategorie mit diesem Namen existiert bereits","error");else try{const t={name:L,updatedAt:new Date};await ks.FirebaseService.updateDocument("categories",R.id,t);const n=R.id,r=T[n]||[],s={};r.forEach(e=>{s[e.id]=e});const a=new Set;for(let e=0;e<V.length;e++){const t=V[e],s=r[e];if(s&&s.id){const e={name:t.name,label:t.name,type:"text",required:!0,unit:t.unit||"",categoryId:n,updatedAt:new Date};await ks.FirebaseService.updateDocument("specifications",s.id,e),a.add(s.id)}else{const e={name:t.name,label:t.name,type:"text",required:!0,unit:t.unit||"",categoryId:n,createdAt:new Date},r=await ks.FirebaseService.addDocument("specifications",e);a.add(r.id)}}for(const e of r)if(!a.has(e.id)){await ks.FirebaseService.deleteDocument("specifications",e.id);const t=(await ks.FirebaseService.getDocuments("materials")).filter(e=>e.categoryId===R.id);for(const n of t)if(n.specifications&&n.specifications[e.id]){const t=(0,Le.A)({},n.specifications);delete t[e.id],await ks.FirebaseService.updateDocument("materials",n.id,{specifications:t,updatedAt:new Date})}}e("Kategorie erfolgreich aktualisiert","success"),M(!1),O(null),F(""),z([]),Z()}catch(t){console.error("Fehler beim Aktualisieren der Kategorie:",t),e("Fehler beim Aktualisieren der Kategorie","error")}}:async()=>{if(!L.trim())return void e("Bitte Kategoriename eingeben","error");if(I.find(e=>e.name.toLowerCase()===L.trim().toLowerCase()))e("Eine Kategorie mit diesem Namen existiert bereits","error");else try{const t={name:L,createdAt:new Date},n=(await ks.FirebaseService.addDocument("categories",t)).id||L;for(const e of V){const t={name:e.name,label:e.name,type:"text",required:!0,unit:e.unit||"",categoryId:n,createdAt:new Date};await ks.FirebaseService.addDocument("specifications",t)}e("Kategorie erfolgreich hinzugef\xfcgt","success"),M(!1),F(""),z([]),Z()}catch(t){console.error("Fehler beim Hinzuf\xfcgen der Kategorie:",t),e("Fehler beim Hinzuf\xfcgen der Kategorie","error")}},disabled:!L.trim(),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[(0,gs.jsx)(Aa,{className:"h-4 w-4"}),(0,gs.jsx)("span",{children:R?"Kategorie aktualisieren":"Kategorie erstellen"})]})]}),children:(0,gs.jsxs)("div",{className:"space-y-6",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kategoriename *"}),(0,gs.jsx)("input",{type:"text",value:L,onChange:e=>F(e.target.value),placeholder:"z.B. Module, Wechselrichter, Kabel...",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Spezifikationen f\xfcr diese Kategorie"}),(0,gs.jsxs)("button",{onClick:()=>{z([...V,{name:"",unit:""}])},className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 flex items-center",children:[(0,gs.jsx)(ya,{className:"h-4 w-4 mr-1"}),"Spezifikation hinzuf\xfcgen"]})]}),(0,gs.jsxs)("div",{className:"space-y-4",children:[V.map((e,t)=>(0,gs.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,gs.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,gs.jsxs)("h4",{className:"text-sm font-medium text-gray-900",children:["Spezifikation #",t+1]}),(0,gs.jsx)("button",{onClick:()=>(e=>{z(V.filter((t,n)=>n!==e))})(t),className:"text-red-600 hover:text-red-800",children:(0,gs.jsx)(Ms,{className:"h-4 w-4"})})]}),(0,gs.jsxs)("div",{className:"space-y-4",children:[(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Feldname *"}),(0,gs.jsx)("input",{type:"text",value:e.name,onChange:e=>X(t,"name",e.target.value),placeholder:"z.B. Leistung, Spannung, Abmessungen",className:"w-full border border-gray-300 rounded px-2 py-1 text-sm focus:ring-1 focus:ring-primary-500 focus:border-transparent"})]}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Einheit (optional)"}),(0,gs.jsx)("input",{type:"text",value:e.unit,onChange:e=>X(t,"unit",e.target.value),placeholder:"z.B. W, V, mm, kg",className:"w-full border border-gray-300 rounded px-2 py-1 text-sm focus:ring-1 focus:ring-primary-500 focus:border-transparent"})]})]})]},t)),0===V.length&&(0,gs.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,gs.jsx)("p",{className:"text-sm",children:"Noch keine Spezifikationen definiert."}),(0,gs.jsx)("p",{className:"text-xs mt-1",children:'Klicken Sie auf "Spezifikation hinzuf\xfcgen" um zu beginnen.'})]})]})]})]})}),(0,gs.jsx)(_a,{isOpen:f,onClose:()=>g(!1),title:"Benutzerrolle zuweisen",children:(0,gs.jsxs)("div",{className:"space-y-4",children:[x&&(0,gs.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,gs.jsxs)("div",{className:"flex items-center",children:[(0,gs.jsx)(ca,{className:"h-5 w-5 text-gray-600 mr-2"}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("p",{className:"font-medium text-gray-900",children:x.displayName||x.email}),(0,gs.jsx)("p",{className:"text-sm text-gray-600",children:x.email})]})]})}),(0,gs.jsxs)("div",{children:[(0,gs.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Neue Rolle ausw\xe4hlen"}),(0,gs.jsxs)("select",{value:v,onChange:e=>b(e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,gs.jsx)("option",{value:"admin",children:"Administrator - Vollzugriff auf alle Module"}),(0,gs.jsx)("option",{value:"projektleiter",children:"Projektleiter - Projekte, Kunden, Bestellungen, PV Konfigurator"}),(0,gs.jsx)("option",{value:"monteur",children:"Monteur - Materialien, VDE Protokolle, Buchungen"})]})]}),(0,gs.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,gs.jsx)("button",{onClick:()=>g(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Abbrechen"}),(0,gs.jsx)("button",{onClick:async()=>{if(x&&v){j(!0);try{const t=(0,bs.Qg)(ws.C,"setUserRole");await t({uid:x.id,role:v}),e("Rolle erfolgreich zugewiesen","success"),g(!1),y(null),b("monteur"),Q()}catch(t){console.error("Fehler beim Zuweisen der Rolle:",t),e("Fehler beim Zuweisen der Rolle: "+t.message,"error")}finally{j(!1)}}else e("Bitte Benutzer und Rolle ausw\xe4hlen","error")},disabled:w,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:opacity-50",children:w?(0,gs.jsxs)("div",{className:"flex items-center",children:[(0,gs.jsx)(co,{className:"animate-spin h-4 w-4 mr-2"}),"Wird zugewiesen..."]}):(0,gs.jsxs)("div",{className:"flex items-center",children:[(0,gs.jsx)(Ia,{className:"h-4 w-4 mr-2"}),"Rolle zuweisen"]})})]})]})})]})},No=_s("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),ko=()=>{const{user:e,logout:t}=ys(),[n,r]=(0,s.useState)(!1);return e?(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsx)("button",{onClick:()=>r(!0),className:"h-10 w-10 bg-blue-500 rounded-full flex items-center justify-center hover:bg-blue-600 transition-colors duration-200",title:e.displayName||e.email,children:(0,gs.jsx)(ma,{className:"h-5 w-5 text-white"})}),n&&(0,l.createPortal)((0,gs.jsx)(_a,{isOpen:n,onClose:()=>r(!1),title:"Abmelden",size:"sm",children:(0,gs.jsxs)("div",{className:"text-center py-4",children:[(0,gs.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:(0,gs.jsx)(No,{className:"h-6 w-6 text-red-600"})}),(0,gs.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"M\xf6chten Sie sich abmelden?"}),(0,gs.jsx)("p",{className:"text-sm text-gray-500 mb-6",children:"Sie werden zur Anmeldeseite weitergeleitet."}),(0,gs.jsxs)("div",{className:"flex justify-center space-x-3",children:[(0,gs.jsx)("button",{onClick:()=>r(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors duration-200",children:"Abbrechen"}),(0,gs.jsx)("button",{onClick:async()=>{try{await t(),r(!1)}catch(e){console.error("Fehler beim Logout:",e)}},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors duration-200",children:"Abmelden"})]})]})}),document.body)]}):null},So=_s("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),Co=e=>{let{isOpen:t,setIsOpen:n}=e;const{canAccessModule:r,loading:a}=(0,s.useContext)(js)||{userRole:null,permissions:[],loading:!1,hasPermission:()=>!0,isAdmin:()=>!1,isPVAdmin:()=>!1,canAccessModule:()=>!0,assignUserRole:async()=>{throw new Error("RoleProvider nicht verf\xfcgbar")},setupFirstAdmin:async()=>{throw new Error("RoleProvider nicht verf\xfcgbar")},loadUserRole:()=>{}},i=[{name:"Materialien",href:"/materials",icon:ba,permission:"materials"},{name:"Bestellungen",href:"/orders",icon:qa,permission:"orders"},{name:"Kunden",href:"/customers",icon:Qa,permission:"customers"},{name:"Projekte",href:"/projects",icon:Va,permission:"projects"},{name:"Buchungshistorie",href:"/bookings",icon:$i,permission:"bookings"},{name:"St\xfcckliste",href:"/bill-of-materials",icon:di,permission:"materials"},{name:"VDE Protokolle",href:"/vde-protocols",icon:di,permission:"vde"},{name:"PV Konfigurator",href:"/pv-configurator",icon:bl,permission:"pv-configurator"},{name:"Angebote",href:"/offers",icon:oo,permission:"pv-configurator"},{name:"Einstellungen",href:"/settings",icon:ja,permission:"settings"}].filter(e=>r(e.permission));return a?(0,gs.jsx)("div",{className:"fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg",children:(0,gs.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,gs.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsx)("div",{className:"lg:hidden",children:(0,gs.jsx)("button",{onClick:()=>n(!t),className:"fixed top-4 left-4 z-50 p-2 rounded-md bg-white shadow-lg",children:t?(0,gs.jsx)(Ms,{className:"h-6 w-6"}):(0,gs.jsx)(So,{className:"h-6 w-6"})})}),t&&(0,gs.jsx)("div",{className:"fixed inset-0 z-40 lg:hidden bg-black bg-opacity-50",onClick:()=>n(!1)}),(0,gs.jsxs)("div",{className:"\n        fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg transform transition-transform duration-300 ease-in-out\n        lg:translate-x-0\n        ".concat(t?"translate-x-0":"-translate-x-full","\n      "),children:[(0,gs.jsx)("div",{className:"flex items-center justify-center h-16 px-4 bg-primary-600",children:(0,gs.jsx)("h1",{className:"text-xl font-bold text-white",children:"Lagermanagement"})}),(0,gs.jsx)("nav",{className:"mt-8",children:(0,gs.jsx)("div",{className:"px-4 space-y-2",children:i.map(e=>(0,gs.jsxs)(De,{to:e.href,onClick:()=>n(!1),className:e=>{let{isActive:t}=e;return"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors duration-200 ".concat(t?"bg-primary-100 text-primary-700 border-r-2 border-primary-600":"text-gray-600 hover:bg-gray-100 hover:text-gray-900")},children:[(0,gs.jsx)(e.icon,{className:"mr-3 h-5 w-5"}),e.name]},e.name))})}),(0,gs.jsxs)("div",{className:"absolute bottom-0 w-full p-4 space-y-3",children:[(0,gs.jsx)("div",{className:"flex justify-center",children:(0,gs.jsx)(ko,{})}),(0,gs.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[(0,gs.jsx)("p",{className:"text-xs text-gray-500",children:"Version 1.0.0"}),(0,gs.jsx)("p",{className:"text-xs text-gray-500",children:"\xa9 2024 Lagermanagement"})]})]})]})]})};const Eo=function(){const[e,t]=s.useState(!0);return(0,gs.jsx)(vs,{children:(0,gs.jsx)(Ns,{children:(0,gs.jsx)(Ls,{children:(0,gs.jsx)(zs,{children:(0,gs.jsx)(Bs,{children:(0,gs.jsx)(Gs,{children:(0,gs.jsx)(Es,{children:(0,gs.jsx)(Zs,{children:(0,gs.jsx)(na,{children:(0,gs.jsx)(oa,{children:(0,gs.jsx)(Ae,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:(0,gs.jsx)("div",{className:"min-h-dvh bg-gray-50",children:(0,gs.jsxs)(be,{children:[(0,gs.jsx)(ye,{path:"/login",element:(0,gs.jsx)(pa,{})}),(0,gs.jsx)(ye,{path:"/*",element:(0,gs.jsx)(fa,{children:(0,gs.jsxs)(gs.Fragment,{children:[(0,gs.jsx)(Co,{isOpen:e,setIsOpen:t}),(0,gs.jsx)("div",{className:"lg:ml-64 h-dvh",children:(0,gs.jsxs)(be,{children:[(0,gs.jsx)(ye,{path:"/materials",element:(0,gs.jsx)("div",{className:"p-6 h-full",children:(0,gs.jsx)(Ba,{})})}),(0,gs.jsx)(ye,{path:"/orders",element:(0,gs.jsx)("div",{className:"p-6 h-full",children:(0,gs.jsx)(Wa,{})})}),(0,gs.jsx)(ye,{path:"/customers",element:(0,gs.jsx)("div",{className:"p-6 h-full",children:(0,gs.jsx)(Zi,{})})}),(0,gs.jsx)(ye,{path:"/projects",element:(0,gs.jsx)("div",{className:"p-6 h-full",children:(0,gs.jsx)(Yi,{})})}),(0,gs.jsx)(ye,{path:"/bookings",element:(0,gs.jsx)("div",{className:"p-6 h-full",children:(0,gs.jsx)(tl,{})})}),(0,gs.jsx)(ye,{path:"/bill-of-materials",element:(0,gs.jsx)("div",{className:"p-6 h-full",children:(0,gs.jsx)(ll,{})})}),(0,gs.jsx)(ye,{path:"/vde-protocols",element:(0,gs.jsx)("div",{className:"p-6 h-full",children:(0,gs.jsx)(dl,{})})}),(0,gs.jsx)(ye,{path:"/pv-configurator",element:(0,gs.jsx)($l,{})}),(0,gs.jsx)(ye,{path:"/offers",element:(0,gs.jsx)("div",{className:"p-6 h-full",children:(0,gs.jsx)(so,{})})}),(0,gs.jsx)(ye,{path:"/offers/new",element:(0,gs.jsx)(io,{})}),(0,gs.jsx)(ye,{path:"/offers/:id",element:(0,gs.jsx)(io,{})}),(0,gs.jsx)(ye,{path:"/settings",element:(0,gs.jsx)("div",{className:"p-6 h-full",children:(0,gs.jsx)(jo,{})})}),(0,gs.jsx)(ye,{path:"/",element:(0,gs.jsx)(xe,{to:"/materials",replace:!0})})]})})]})})})]})})})})})})})})})})})})})};i.createRoot(document.getElementById("root")).render((0,gs.jsx)(s.StrictMode,{children:(0,gs.jsx)(Eo,{})}))})();
//# sourceMappingURL=main.660b66d0.js.map